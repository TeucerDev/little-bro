"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[234],{61523:(e,n,t)=>{t.r(n),t.d(n,{default:()=>L});var a=t(92252),o=t(67550),l=t(7671),s=t(41075),i=t(92794),r=t(30609),c=t(5896),d=t(79906),p=t(83249),u=t(62197),h=t(2784),Z=t(61877),g=t(21548),w=t(87985),m=t(29432),f=t(46026),y=t(71765),x=t(29117),v=t(71026),C=t(51650),W=t(36617),I=t(82716),P=t(25434),b=t(36893),S=t(10618),k=t(1661),X=t(41015),B=t(77712),T=t(64120),E=t(3694),N=t(52903);const z=h.lazy((()=>t.e(592).then(t.bind(t,89431)))),$=(0,h.lazy)((()=>Promise.all([t.e(592),t.e(334)]).then(t.bind(t,15878)))),D={xs:1,sm:2,md:3,lg:3,xl:4},G={xs:10,sm:12,md:24,lg:24,xl:24},_=Object.keys(B.gd),A=(0,S.X)([...b.wC]);function L(){const{t:e}=(0,g.$G)(["page_weapon","ui","weaponNames_gen"]),{database:n}=(0,h.useContext)(C.t),[t,u]=(0,h.useState)(n.displayWeapon.get());(0,h.useEffect)((()=>n.displayWeapon.follow(((e,n)=>u(n)))),[n]);const[S,L]=(0,h.useState)(!1),[q,H]=(0,W.Z)(),K=(0,h.useRef)(null),[V,j]=(0,h.useState)(0);(0,h.useEffect)((()=>(Z.ZP.send({hitType:"pageview",page:"/weapon"}),n.weapons.followAny(((e,n)=>("new"===n||"remove"===n)&&H())))),[H,n]);const F=(0,I.Z)(),O=G[F],R=(0,P.Z)((()=>v.Z.getAll),[]),J=(0,h.useCallback)((async a=>{const o=n.weapons.get(a);if(!o)return;const l=e(`weaponNames_gen:${o.key}`);window.confirm(e("removeWeapon",{value:l}))&&(n.weapons.remove(a),t.editWeaponId===a&&n.displayWeapon.set({editWeaponId:""}))}),[t.editWeaponId,n,e]),Q=(0,h.useCallback)((e=>{n.displayWeapon.set({editWeaponId:e})}),[n]),U=(0,h.useCallback)((e=>{Q(n.weapons.new((0,T.xg)(e)))}),[n,Q]),[Y,ee]=(0,h.useState)(""),ne=(0,h.useDeferredValue)(Y),{sortType:te,ascending:ae,weaponType:oe,rarity:le}=t,{weaponIdList:se,totalWeaponNum:ie}=(0,h.useMemo)((()=>{var e;const t=n.weapons.values,a=t.length;if(!R)return{weaponIdList:[],totalWeaponNum:a};const o=t.filter((0,k.C)({weaponType:oe,rarity:le,name:ne},(0,B.Xg)(R))).sort((0,k.e)(null!=(e=B.gd[te])?e:[],ae,(0,B.Sn)(R))).map((e=>e.id));return q&&{weaponIdList:o,totalWeaponNum:a}}),[q,n,R,te,ae,le,oe,ne]),{weaponIdsToShow:re,numPages:ce,currentPageIndex:de}=(0,h.useMemo)((()=>{const e=Math.ceil(se.length/O),n=(0,X.uZ)(V,0,e-1);return{weaponIdsToShow:se.slice(n*O,(n+1)*O),numPages:e,currentPageIndex:n}}),[se,V,O]),pe=se.length!==ie?`${se.length}/${ie}`:`${ie}`,ue=(0,h.useCallback)(((e,n)=>{var t;null==(t=K.current)||t.scrollIntoView({behavior:"smooth"}),j(n-1)}),[j,K]),he=(0,h.useCallback)((()=>n.displayWeapon.set({editWeaponId:""})),[n]),{editWeaponId:Ze}=t;return(0,h.useEffect)((()=>{Ze&&(n.weapons.get(Ze)||he())}),[n,Ze,he]),(0,N.BX)(o.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:[(0,N.tZ)(h.Suspense,{fallback:!1,children:(0,N.tZ)(z,{show:S,onHide:()=>L(!1),onSelect:U})}),(0,N.tZ)(h.Suspense,{fallback:!1,children:(0,N.tZ)($,{weaponId:Ze,footer:!0,onClose:he})}),(0,N.tZ)(w.Z,{ref:K,children:(0,N.BX)(l.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,N.BX)(s.ZP,{container:!0,spacing:1,children:[(0,N.tZ)(s.ZP,{item:!0,children:(0,N.tZ)(x.Z,{sx:{height:"100%"},onChange:e=>n.displayWeapon.set({weaponType:e}),value:oe,size:"small"})}),(0,N.tZ)(s.ZP,{item:!0,children:(0,N.tZ)(m.Z,{sx:{height:"100%"},value:le,size:"small",children:b.wC.map((e=>(0,N.tZ)(i.Z,{value:e,onClick:()=>n.displayWeapon.set({rarity:A(le,e)}),children:(0,N.BX)(o.Z,{display:"flex",gap:1,children:[(0,N.tZ)("strong",{children:e}),(0,N.tZ)(y.q,{stars:1})]})},e)))})}),(0,N.tZ)(s.ZP,{item:!0,flexGrow:1,children:(0,N.tZ)(r.Z,{autoFocus:!0,size:"small",value:Y,onChange:e=>ee(e.target.value),label:e("weaponName"),sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})}),(0,N.tZ)(s.ZP,{item:!0,children:(0,N.tZ)(f.Z,{sx:{height:"100%"},sortKeys:_,value:te,onChange:e=>n.displayWeapon.set({sortType:e}),ascending:ae,onChangeAsc:e=>n.displayWeapon.set({ascending:e})})})]}),(0,N.BX)(s.ZP,{container:!0,alignItems:"flex-end",children:[(0,N.tZ)(s.ZP,{item:!0,flexGrow:1,children:(0,N.tZ)(c.Z,{count:ce,page:de+1,onChange:ue})}),(0,N.tZ)(s.ZP,{item:!0,children:(0,N.tZ)(M,{numShowing:re.length,total:pe,t:e})})]})]})}),(0,N.BX)(h.Suspense,{fallback:(0,N.tZ)(d.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:500}}),children:[(0,N.tZ)(p.Z,{fullWidth:!0,onClick:()=>L(!0),color:"info",startIcon:(0,N.tZ)(a.Z,{}),children:e("page_weapon:addWeapon")}),(0,N.tZ)(s.ZP,{container:!0,spacing:1,columns:D,children:re.map((e=>(0,N.tZ)(s.ZP,{item:!0,xs:1,children:(0,N.tZ)(E.Z,{weaponId:e,onDelete:J,onEdit:Q,canEquip:!0})},e)))})]}),ce>1&&(0,N.tZ)(w.Z,{children:(0,N.tZ)(l.Z,{children:(0,N.BX)(s.ZP,{container:!0,alignItems:"flex-end",children:[(0,N.tZ)(s.ZP,{item:!0,flexGrow:1,children:(0,N.tZ)(c.Z,{count:ce,page:de+1,onChange:ue})}),(0,N.tZ)(s.ZP,{item:!0,children:(0,N.tZ)(M,{numShowing:re.length,total:pe,t:e})})]})})})]})}function M({numShowing:e,total:n,t}){return(0,N.tZ)(u.Z,{color:"text.secondary",children:(0,N.BX)(g.cC,{t,i18nKey:"showingNum",count:e,value:n,children:["Showing ",(0,N.tZ)("b",{children:{count:e}})," out of ",{value:n}," Weapons"]})})}},94758:(e,n,t)=>{t.d(n,{Z:()=>l});var a=t(2784),o=t(51650);function l(e=""){const{database:n}=(0,a.useContext)(o.t),[t,l]=(0,a.useState)(n.weapons.get(e));return(0,a.useEffect)((()=>l(n.weapons.get(e))),[n,e]),(0,a.useEffect)((()=>e?n.weapons.follow(e,((e,n,t)=>"update"===n&&l(t))):void 0),[e,l,n]),t}},10618:(e,n,t)=>{t.d(n,{X:()=>o});var a=t(41015);function o(e){return(n,t)=>{const o=n.length;return o===e.length?[t]:1===o&&n[0]===t?[...e]:[...new Set((0,a.nh)(n,t))]}}}}]);