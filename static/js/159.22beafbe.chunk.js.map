{"version":3,"file":"static/js/159.22beafbe.chunk.js","mappings":"udAYe,SAASA,EAAT,GAAwH,IAA3FC,EAA0F,EAA1FA,MAA0F,IAAnFC,MAAAA,OAAmF,MAA3E,GAA2E,EAAvEC,EAAuE,EAAvEA,KAAMC,EAAiE,EAAjEA,MAAOC,EAA0D,EAA1DA,WAAYC,EAA8C,EAA9CA,YAAaC,EAAiC,EAAjCA,MACnG,OAAO,UAACC,EAAA,GAAD,gBAAsBP,MAAOA,GAAWM,GAAxC,eACL,SAACE,EAAA,EAAD,UAAeP,KACf,SAACQ,EAAA,EAAD,CAAcC,uBAAwB,CAAEC,MAAO,CAAEC,WAAYR,EAAaD,EAAMU,WAAWC,iBAAmBX,EAAMU,WAAWE,oBAA/H,SACGb,IAEFG,GAAeA,KALIL,G,qbCkBxB,SAASgB,EAAT,GACyC,IADuDC,EACxD,EADwDA,2BAA4BC,EACpF,EADoFA,qBAAsBC,EAC1G,EAD0GA,gBAAiBC,EAC3H,EAD2HA,QAASC,EACpI,EADoIA,SAAUC,EAC9I,EAD8IA,MAAUhB,GACxJ,YAChCH,GAAQoB,EAAAA,EAAAA,KAKRC,GAAUC,EAAAA,EAAAA,UAAQ,kBAAMR,EAA2BS,KAAI,gBAAGC,EAAH,EAAGA,IAAKC,EAAR,EAAQA,QAAR,MAAuB,CAAED,IAAAA,EAAKL,MAAOF,EAAQO,GAAMC,QAAAA,QAAa,CAACX,EAA4BG,IAC1J,OAAO,SAACS,EAAA,GAAD,QACLC,eAAa,EACbC,UAAQ,EACRC,sBAAoB,EACpBR,QAASA,EACTxB,MAAOkB,EAAqBQ,KAAI,SAAAC,GAAG,MAAK,CAAEA,IAAKA,EAAKL,MAAOF,EAAQO,OACnEM,SAVmB,SAACC,EAAGlC,GACvBmB,EAAgBnB,EAAM0B,KAAI,SAAAS,GAAC,OAAIA,EAAER,SAUjCS,eAAgB,SAACC,GAAD,OAAYA,EAAOf,OACnCgB,qBAAsB,SAACD,EAAQrC,GAAT,OAAmBqC,EAAOV,MAAQ3B,EAAM2B,KAC9DY,YAAa,SAACC,GAAD,OAAY,SAACC,EAAA,GAAD,kBACnBD,GADmB,IAEvBlB,MAAOA,EACPoB,QAAQ,SACRC,gBAAiB,CAAEhC,MAAO,CAAEiC,MAAOzC,EAAM0C,QAAQ3C,KAAK4C,UACtDF,MAAO1B,EAAqB6B,OAAS,UAAY,UACjDC,KAAK,aAEPC,aAAc,SAAC3C,EAAO+B,GAAR,OACZ,SAACtC,EAAD,CAEEC,MAAOqC,EAAOV,IACd1B,OAAO,SAAC,IAAD,CAAW2C,MAAOM,EAAAA,GAAAA,WAAkBb,EAAOV,KAA3C,SAAkDN,EAASgB,EAAOV,OACzEzB,MAAM,SAAC,IAAD,CAAW0C,MAAOM,EAAAA,GAAAA,WAAkBb,EAAOV,KAA3C,SAAkDU,EAAOf,QAC/DnB,MAAOA,EACPC,WAAYc,EAAqBiC,SAASd,EAAOV,KACjDrB,MAAOA,GANF+B,EAAOV,MAShByB,WAAY,SAACC,EAAUC,GAAX,OAA2BD,EAAS3B,KAAI,SAAC1B,EAAOuD,GAC1D,IAAMC,EAAUC,EAAAA,GAAAA,MAAwB,SAAAC,GAAG,OAAI1D,EAAM2B,MAAN,UAAiB+B,EAAjB,YACzCd,EAAQY,QAAoBG,EAClC,OAAO,mBAACC,EAAA,GAAD,kBAAUN,EAAY,CAAEC,MAAAA,KAAxB,IAAkC5B,IAAK3B,EAAM2B,IAAKkC,KAAMxC,EAASrB,EAAM2B,KAAML,MAAOtB,EAAMsB,MAAOsB,MAAOA,UAE7GtC,IAQD,SAASwD,EAAT,GAAmH,IAA3EC,EAA0E,EAA1EA,WAAYC,EAA8D,EAA9DA,cAAkB1D,GAA4C,YACjH2D,GAAiBC,EAAAA,EAAAA,IAAW,kBAAMC,EAAAA,EAAAA,SAAsB,IACtDC,GAAMC,EAAAA,EAAAA,GAAe,CAAC,WAAY,sBAAlCD,EACR,IAAKH,EAAgB,OAAO,KAE5B,IAAMK,EAA6BC,OAAOC,QAAQL,EAAAA,EAAAA,kBAAgCF,IAC/EQ,SAAQ,+BAAEC,EAAF,iBAAyBhD,KAAI,SAAAiD,GAAG,MAAK,CAAEhD,IAAKgD,EAAK/C,SAAU8C,SACnEE,KAAKC,GAER,OAAO,SAAC7D,GAAD,QACLC,2BAA4BqD,EAC5BpD,qBAAsB6C,EACtB5C,gBAAiB6C,EACjB5C,QAAS,SAACO,GAAD,OAAyByC,EAAE,qBAAD,OAAsBzC,KACzDN,SAAU,SAACM,GAAD,OAAyBsC,EAAetC,GAAKmD,SACvDxD,MAAO8C,EAAE,oCACTW,QAAS,SAAC1C,GAAD,mCAAYA,EAAOT,eAAnB,aAAY,EAAgBoD,kBAA5B,QAA0C,IACnDC,YAAa,SAACzC,GAAD,OAA2CA,EAAO0C,QAAS,UAACC,EAAA,EAAD,CAAyBC,UAAWC,EAAAA,EAApC,WACtE,UAACC,EAAA,EAAD,CAA6CC,GAAI,CAAEC,IAAK,QAAxD,UACGhD,EAAO0C,MADV,KACiB,SAAC,IAAD,CAAcO,OAAQjD,EAAO0C,UAD9C,UAAuB1C,EAAO0C,MAA9B,WAGC1C,EAAOkD,WAJyElD,EAAO0C,SAMtF5E,IAQD,SAASqF,EAAT,GAAiI,IAApFC,EAAmF,EAAnFA,aAAcC,EAAqE,EAArEA,gBAAoBvF,GAAiD,YAC7H8D,GAAMC,EAAAA,EAAAA,GAAe,YAArBD,EACR,OAAO,SAACpD,GAAD,QACLC,2BAA4B6E,EAAAA,EAAAA,KAAoB,SAAAnE,GAAG,MAAK,CAAEA,IAAAA,MAC1DT,qBAAsB0E,EACtBzE,gBAAiB0E,EACjBzE,QAAS,SAACO,GAAD,OAAsBuB,EAAAA,GAAAA,UAAiBvB,IAChDN,SAAU,SAACM,GAAD,OAAsBoE,EAAAA,EAASpE,IACzCL,MAAO8C,EAAE,iCACL9D,IAQD,SAAS0F,EAAT,GAA6H,IAAjFC,EAAgF,EAAhFA,YAAaC,EAAmE,EAAnEA,eAAmB5F,GAAgD,YACzH8D,GAAMC,EAAAA,EAAAA,GAAe,YAArBD,EACR,OAAO,SAACpD,GAAD,QACLC,2BAA4BkF,EAAAA,EAAAA,KAAmB,SAAAxE,GAAG,MAAK,CAAEA,IAAAA,MACzDT,qBAAsB+E,EACtB9E,gBAAiB+E,EACjB9E,QAAS,SAACO,GAAD,OAAqBuB,EAAAA,GAAAA,UAAiBvB,IAC/CN,SAAU,SAACM,GAAD,OAAqBoE,EAAAA,EAASpE,IACxCL,MAAO8C,EAAE,gCACL9D,IAsBR,SAAS8F,EAAT,GAC0C,IADwDnF,EACzD,EADyDA,2BAA4BoF,EACrF,EADqFA,oBAAqBC,EAC1G,EAD0GA,eAAgBlF,EAC1H,EAD0HA,QAASC,EACnI,EADmIA,SAAUC,EAC7I,EAD6IA,MAC7I,IADoJiF,QAAAA,OACpJ,MAD8J,kBAAM,GACpK,MAD2KC,YAAAA,OAC3K,aADgMC,YAAAA,OAChM,MAD8M,GAC9M,EADuOnG,GACvO,EADkNoG,aAClN,aACjCvG,GAAQoB,EAAAA,EAAAA,KAERC,GAAUC,EAAAA,EAAAA,UAAQ,kBACrB+E,EACG,CAAC,CAAE7E,IAAK,GAASL,MAAOmF,IACxB,IACFE,OAAO1F,EAA2BS,KAAI,gBAAGC,EAAH,EAAGA,IAAKC,EAAR,EAAQA,QAAR,MACtC,CAAED,IAAAA,EAAKL,MAAOF,EAAQO,GAAMC,QAAAA,SACzB,CAACX,EAA4BG,EAASqF,EAAaD,IAE1D,OAAO,SAAC3E,EAAA,GAAD,QACLC,eAAa,EACbN,QAASA,EACToF,UAAWP,OAAsB1C,EAAY,GAC7C3D,MAAO,CAAE2B,IAAK0E,EAAqB/E,MAAOF,EAAQiF,IAClDpE,SAAU,SAAC4E,EAAOC,EAAUC,GAAlB,OAA6C,WAAfF,EAAM7D,MAAgC,UAAX+D,IAAuBT,EAAeQ,EAAWA,EAASnF,IAAM,KACnIS,eAAgB,SAACC,GAAD,OAAYA,EAAOf,MAAQe,EAAOf,MAAQmF,GAC1DnE,qBAAsB,SAACD,EAAQrC,GAAT,OAAmBqC,EAAOV,MAAQ3B,EAAM2B,KAC9DqF,kBAAmB,SAAA3E,GAAM,OAAIkE,EAAQlE,EAAOV,MAC5CY,YAAa,SAACjC,GAAD,OAAW,SAAC,KAAD,kBAClBA,GADkB,IAEtBgB,MAAOA,EACP2F,eAAgB5F,EAASgF,GACzBa,WAAUb,MAEZpD,aAAc,SAAC3C,EAAO+B,GAAR,OACZ,SAACtC,EAAD,CAEEC,MAAOqC,EAAOV,IACd1B,MAAOoB,EAASgB,EAAOV,KACvBzB,KAAMmC,EAAOf,MACbnB,MAAOA,EACPC,WAAYiG,IAAwBhE,EAAOV,IAC3CrB,MAAOA,GANF+B,EAAOV,OASZrB,IAaD,SAAS6G,EAAT,GAA+H,IAAtFC,EAAqF,EAArFA,UAAWC,EAA0E,EAA1EA,aAA0E,IAA5D/F,MAAAA,OAA4D,MAApD,GAAoD,EAA7ChB,GAA6C,YAC7H2D,GAAiBC,EAAAA,EAAAA,IAAW,kBAAMC,EAAAA,EAAAA,SAAsB,IACtDC,GAAMC,EAAAA,EAAAA,GAAe,CAAC,WAAY,sBAAlCD,EAER,GADA9C,EAAQA,GAAgB8C,EAAE,oCACrBH,EAAgB,OAAO,KAE5B,IAAMK,EAA6BC,OAAOC,QAAQL,EAAAA,EAAAA,kBAAgCF,IAC/EQ,SAAQ,+BAAEC,EAAF,iBAAyBhD,KAAI,SAAAiD,GAAG,MAAK,CAAEhD,IAAKgD,EAAK/C,SAAU8C,SACnEE,KAAKC,GAER,OAAO,SAACuB,GAAD,QACLnF,2BAA4BqD,EAC5B+B,oBAAqBe,EACrBd,eAAgBe,EAChBjG,QAAS,SAACO,GAAD,OAA8BA,GAAOyC,EAAE,qBAAD,OAAsBzC,KACrEN,SAAU,SAACM,GAAD,OAA8BA,EAAMsC,EAAetC,GAAKmD,SAAU,yBAC5ExD,MAAOA,EACPyD,QAAS,SAAC1C,GAAD,mCAAYA,EAAOT,eAAnB,aAAY,EAAgBoD,kBAA5B,QAA0C,IACnDC,YAAa,SAACzC,GAAD,OAA2CA,EAAO0C,QAAS,UAACC,EAAA,EAAD,CAAyBC,UAAWC,EAAAA,EAApC,WACtE,UAACC,EAAA,EAAD,CAA6CC,GAAI,CAAEC,IAAK,QAAxD,UACGhD,EAAO0C,MADV,KACiB,SAAC,IAAD,CAAcO,OAAQjD,EAAO0C,UAD9C,UAAuB1C,EAAO0C,MAA9B,WAGC1C,EAAOkD,WAJyElD,EAAO0C,SAMtF5E,IAIR,SAASuE,EAAoByC,EAAqDC,GAChF,GAAID,EAAE1F,QAAU2F,EAAE3F,QAChB,OAAQ,EAEV,GAAI0F,EAAE1F,QAAU2F,EAAE3F,QAChB,OAAO,EAGT,IAAM4F,EAAQC,EAAAA,EAAAA,EAAA,4BAA4BH,EAAE3F,MACtC+F,EAAQD,EAAAA,EAAAA,EAAA,4BAA4BF,EAAE5F,MAC5C,OAAI6F,EAAQE,GACF,EAENF,EAAQE,EACH,EAGF,I,uIC1PM,SAASC,EAAT,GASX,IAT0CC,EAS3C,EAT2CA,SAAUC,EASrD,EATqDA,UAAWC,EAShE,EATgEA,OAAQC,EASxE,EATwEA,QAASC,EASjF,EATiFA,QASjF,IAT0FC,KAAAA,OAS1F,aATwGC,SAAAA,OASxG,aAT0HC,cAAAA,OAS1H,SACD,GAAkCC,EAAAA,EAAAA,UAASR,GAA3C,eAAOS,EAAP,KAAkBC,EAAlB,KACA,GAAoCF,EAAAA,EAAAA,UAASP,GAA7C,eAAOU,EAAP,KAAmBC,EAAnB,KACMC,GAAYC,EAAAA,EAAAA,cAChB,SAACC,EAAY3I,GACX,GAAoB,iBAATA,EAAmB,MAAM,IAAI4I,UACxC,cAAe5I,EAAf,GAAO6I,EAAP,KAAUC,EAAV,KACAR,EAAaO,GACbL,EAAcM,KAEhB,CAACR,EAAcE,IAIjB,OAHAO,EAAAA,EAAAA,YAAU,kBAAMT,EAAaV,KAAW,CAACU,EAAcV,KAEvDmB,EAAAA,EAAAA,YAAU,kBAAMP,EAAcX,KAAY,CAACW,EAAeX,KACnD,UAAC,IAAD,CAAMtC,GAAI,CAAEyD,MAAO,OAAQC,QAAS,OAAQC,WAAY,SAAUC,QAASlB,EAAO,mBAAqB,qBAAvG,WACL,SAAC,KAAD,CACEjI,MAAOqI,EACPpG,SAAU,SAAAmH,GAAG,OAAItB,GAAOuB,EAAAA,EAAAA,IAAMD,EAAK,EAAGvB,KACtCtC,GAAI,CAAE+D,GAAI,EAAGC,GAAIpB,EAAgB,OAAIxE,EAAWqF,MAAOb,EAAgB,IAAM,IAC7EqB,WAAY,CAAEjE,GAAI,CAAEkE,UAAWtB,EAAgB,QAAU,WACzDlB,eAAgBkB,EAAgB,eAAYxE,EAC5CuE,SAAUA,KAEZ,SAAC,KAAD,CAAQ3C,GAAI,CAAEyD,MAAO,IAAKU,SAAU,EAAGC,GAAI,GACzCC,aAAc,iBAAM,uBACpB5J,MAAO,CAACqI,EAAWE,GACnBtG,SAAUwG,EACVoB,kBAAmB,SAAClB,EAAG3I,GAAJ,OAAcgI,EAAQhI,EAAM,GAAIA,EAAM,KACzD8J,kBAAkB,OAClBC,IAAK,EAAGC,IAAK,GAAIC,KAAM,EAAGC,OAAK,EAC/BhC,SAAUA,KAEZ,SAAC,KAAD,CACElI,MAAOuI,EACPtG,SAAU,SAAAmH,GAAG,OAAIrB,GAAQsB,EAAAA,EAAAA,IAAMD,EAAKxB,EAAU,MAC9CrC,GAAI,CAAE+D,GAAI,EAAGN,MAAO,IACpBQ,WAAY,CAAEjE,GAAI,CAAEkE,UAAW,WAC/BvB,SAAUA,S,2FChDD,SAASiC,EAAT,GAA0H,IAA9FC,EAA6F,EAA7FA,OAAQC,EAAqF,EAArFA,MAAOC,EAA8E,EAA9EA,OACxD,OAAO,UAAC,IAAD,CAAKrB,QAAQ,OAAOsB,IAAK,EAAGC,EAAG,EAAGtB,WAAW,SAA7C,UACJkB,GACD,SAAC,IAAD,CAAY1H,QAAQ,YAAY6C,GAAI,CAAEmE,SAAU,GAAhD,SAAsDW,IACrDC,IAAU,SAAC,IAAD,CAAY5H,QAAQ,UAApB,SAA+B4H,S,qTCQ/B,SAASG,EAAT,GAA4F,IAA7DC,EAA4D,EAA5DA,YAA4D,IAA/CxC,SAAAA,OAA+C,SACxG,OAA+C,IAA3C3D,OAAOoG,KAAKD,EAAYE,QAAQ7H,QAAgB,SAAU2H,GACrD,SAACG,EAAD,CAA2BH,YAAaA,EAAaxC,SAAUA,IAC7D,SAAUwC,GACZ,SAACI,EAAD,CAA8BJ,YAAaA,EAAaxC,SAAUA,KAElE,SAAC6C,EAAD,CAA6BL,YAAaA,EAAaxC,SAAUA,IAO5E,SAAS2C,EAAT,GAA+F,IAA1DH,EAAyD,EAAzDA,YAAaxC,EAA4C,EAA5CA,SAChD,GAAyC8C,EAAAA,EAAAA,YAAWC,EAAAA,GAA5CC,EAAR,EAAQA,UAAWC,EAAnB,EAAmBA,kBACXC,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACFE,GAAiB5C,EAAAA,EAAAA,cAAY,SAACvG,GAClC,IAAMoJ,GAAoBC,EAAAA,EAAAA,IAAUN,EAAUR,aAC1CvI,GACFsJ,EAAAA,EAAAA,IAAkBF,EAAmBb,EAAYgB,KAAMvJ,IAEvDwJ,EAAAA,EAAAA,IAAeJ,EAAmBb,EAAYgB,MAEhDP,EAAkB,CAAET,YAAaa,MAChC,CAACb,EAAaQ,EAAWC,IAEtBS,EAAmBR,EAAKS,IAAInB,EAAY1K,OAAOA,MACrD,UAAuBuE,OAAOC,QAAQkG,EAAYE,QAAQ,GAA1D,GAAOkB,EAAP,KACMC,EAAQC,EADd,KAC+BC,MACzBC,EAAWC,EAAYzB,EAAYuB,MAEzC,OAAO,UAACG,EAAA,EAAD,CAAQC,WAAS,EAACC,KAAK,QAAQ/G,GAAI,CAAEgH,aAAc,GAAK3J,MAAOgJ,EAAmB,UAAY,UAAWY,QAAS,kBAAMlB,EAAeM,OAAmBjI,EAAYmI,IAAW5D,SAAUA,EAAUuE,UAAWb,GAAmB,SAACc,EAAA,EAAD,KAAe,SAACC,EAAA,EAAD,IAAlP,UACJT,EADI,IACOH,KAOhB,SAASjB,EAAT,GAAqG,IAA7DJ,EAA4D,EAA5DA,YAAaxC,EAA+C,EAA/CA,SACnD,GAAyC8C,EAAAA,EAAAA,YAAWC,EAAAA,GAA5CC,EAAR,EAAQA,UAAWC,EAAnB,EAAmBA,kBACXC,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACFE,GAAiB5C,EAAAA,EAAAA,cAAY,SAACvG,GAClC,IAAMoJ,GAAoBC,EAAAA,EAAAA,IAAUN,EAAUR,aAC1CvI,GACFsJ,EAAAA,EAAAA,IAAkBF,EAAmBb,EAAYgB,KAAMvJ,IAEvDwJ,EAAAA,EAAAA,IAAeJ,EAAmBb,EAAYgB,MAEhDP,EAAkB,CAAET,YAAaa,MAChC,CAACb,EAAaQ,EAAWC,IAEtBS,EAAmBR,EAAKS,IAAInB,EAAY1K,OAAOA,MAC/C4M,EAAQhB,EAAmBlB,EAAYE,OAAOgB,QAAoBjI,EAClEoI,EAAQa,EAAQZ,EAAcY,EAAMX,OAAQ,SAACY,EAAA,EAAD,CAASjK,MAAM,YAAf,wBAC5CsJ,EAAWC,EAAYzB,EAAYuB,MAEzC,OAAO,UAACa,EAAA,EAAD,CAAgBT,WAAS,EAACC,KAAK,QAAQ/G,GAAI,CAAEgH,aAAc,GAAK3J,MAAOgJ,EAAmB,UAAY,UAAWvB,OAAO,4BAAO6B,EAAP,IAAkBH,KAAe7D,SAAUA,EAAnK,WACL,SAAC3H,EAAA,EAAD,CAAUiM,QAAS,kBAAMlB,KAAkBjI,UAAWuJ,EAAO1E,UAAW0E,EAAxE,UACE,4CAEF,SAACG,EAAA,EAAD,IACCxI,OAAOC,QAAQkG,EAAYE,QAAQlJ,KAAI,+BAAEoK,EAAF,KAAYkB,EAAZ,YACtC,SAACzM,EAAA,EAAD,CAAyBiM,QAAS,kBAAMlB,EAAeQ,IAAWzI,SAAUuI,IAAqBE,EAAU5D,SAAU0D,IAAqBE,EAA1I,SAAsJkB,EAAGf,MAA1IH,SAOrB,SAASf,EAAT,GAAmG,IAA5DL,EAA2D,EAA3DA,YAAaxC,EAA8C,EAA9CA,SAClD,GAAyC8C,EAAAA,EAAAA,YAAWC,EAAAA,GAA5CC,EAAR,EAAQA,UAAWC,EAAnB,EAAmBA,kBACXC,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACFE,GAAiB5C,EAAAA,EAAAA,cAAY,SAACgD,EAAyBvJ,GAC3D,IAAMoJ,GAAoBC,EAAAA,EAAAA,IAAUN,EAAUR,aAC1CvI,GACFsJ,EAAAA,EAAAA,IAAkBF,EAAmBG,EAAMvJ,IAE3CwJ,EAAAA,EAAAA,IAAeJ,EAAmBG,GAEpCP,EAAkB,CAAET,YAAaa,MAChC,CAACL,EAAWC,IAEf,OAAO,SAAC8B,EAAA,EAAD,CAAaZ,WAAS,EAACa,YAAY,WAAWC,kBAAgB,EAACvK,MAAM,YAArE,SACJ2B,OAAOC,QAAQkG,EAAYE,QAAQlJ,KAAI,YAAqB,IAAD,eAAlBoK,EAAkB,KAARkB,EAAQ,KACpDpB,EAAmBR,EAAKS,IAAImB,EAAGhN,OAAOA,MACtCI,EAAawL,IAAqBE,EACxC,OAAO,SAACM,EAAA,EAAD,CACLxJ,MAAOxC,EAAa,UAAY,UAChC8H,SAAUA,EACVmE,WAAS,EAETG,QAAS,kBAAMlB,EAAe0B,EAAGtB,KAAME,OAAmBjI,EAAYmI,IACtEQ,KAAK,QACLG,UAAWrM,GAAa,SAACsM,EAAA,EAAD,KAAe,SAACC,EAAA,EAAD,IACvCpH,GAAI,CAAEgH,aAAc,GARf,SAUJJ,EAAYa,EAAGf,OANXH,QAYb,SAASsB,EAAUC,GACjB,MAAwB,kBAATA,EAIjB,SAASrB,EAAcsB,GACrB,IAAKA,EAAW,MAAO,GAEvB,IAAIC,EAAmC,UACnCC,EAAYF,EAOhB,OANIA,GAAaF,EAAUE,IACrBA,EAAUhN,MAAMsC,QAClB2K,EAAaD,EAAUhN,MAAMsC,MAC7B4K,GAAY,0BAAOF,EAAUhN,MAAMoF,aAGhC,SAACmH,EAAA,EAAD,CAAStH,GAAI,CAAEkI,GAAI,IAAO7K,MAAO2K,EAAjC,SAA8CC,IAIvD,SAASrB,EAAYD,GACnB,GAAIkB,EAAUlB,GAAW,CACvB,IAAMvK,EAAMuK,EAAS5L,MAAMoN,MACrBC,EAAKzB,EAAS5L,MAAMqN,GACpBC,EAAS1B,EAAS5L,MAAMsN,OAC9B,OAAO,SAACC,EAAA,EAAD,CAAWF,GAAIA,EAAID,MAAO/L,EAAKiM,OAAQA,EAAQE,UAAQ,IAEhE,OAAO5B,ECjIM,SAAS6B,EAAT,GAA6G,IAEtHC,EAFuCtD,EAA8E,EAA9EA,YAA8E,IAAjEuD,WAAAA,OAAiE,aAA7CC,SAAAA,OAA6C,SACjH9C,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KAER,GAAI,SAAUV,EAAa,CAAC,IAAD,EACnByD,EAAU/C,EAAKS,IAAInB,EAAY1K,OAAOA,MAC5CgO,EAASG,IAAO,UAAIzD,EAAYE,OAAOuD,UAAvB,aAAI,EAA6BH,aAEjDA,EAASzJ,OAAOqJ,OAAOlD,EAAYE,QAAQnG,SAAQ,SAAAmI,GAEjD,OADiBxB,EAAKS,IAAIe,EAAM5M,OAAOA,MACrB4M,EAAMoB,OAAS,MAGrC,OAAO,UAACI,EAAA,EAAD,aACHC,EAAAA,EAAAA,IAAWJ,EAAYvD,KAAgB,SAAC4D,EAAD,CAAeC,OAAQ7D,EAAY6D,OAAQL,SAAUA,KAC9F,SAACM,EAAA,EAAD,CAAajJ,GAAI,CAAEiF,EAAG,EAAG,eAAgB,CAAEiE,GAAI,IAA/C,UACE,SAAChE,EAAD,CAAqBC,YAAaA,MAEnCsD,IAAU,SAAC,KAAD,CAAeA,OAAQA,O,eCfvB,SAASU,EAAT,GAAkH,IAAvFC,EAAsF,EAAtFA,SAAUC,EAA4E,EAA5EA,aAA4E,IAA9DV,SAAAA,OAA8D,aAA5CD,WAAAA,OAA4C,SACtH7C,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACR,IAAKuD,EAAS5L,OAAQ,OAAO,KAC7B,IAAM8L,EAAkBF,EAASjN,KAAI,SAACoN,EAAGC,GAEvC,OAAID,EAAEE,UAAY5D,EAAKS,IAAIiD,EAAEE,SAAShP,OAElC4O,IAAiBE,EAAEG,SAF6B,MAG7C,SAACC,EAAD,CAAgBC,QAASL,EAAWZ,SAAUA,EAAUD,WAAYA,GAAnCc,MACvCK,QAAO,SAAAN,GAAC,OAAIA,KACf,OAAKD,EAAgB9L,QACd,SAACsC,EAAA,EAAD,CAAK4D,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAAhD,SAAoDsE,IADvB,KAItC,SAASK,EAAT,GAA8L,IAApKC,EAAmK,EAAnKA,QAAmK,IAA1JjB,SAAAA,OAA0J,aAAxID,WAAAA,OAAwI,SAC3L,MAAI,WAAYkB,GACP,SAACG,EAAD,CAAsBH,QAASA,EAASjB,SAAUA,EAAUD,WAAYA,IACtE,WAAYkB,GACd,SAACpB,EAAD,CAAoBrD,YAAayE,EAASjB,SAAUA,EAAUD,WAAYA,KAE1E,SAACsB,EAAD,CAAoBJ,QAASA,IAIxC,SAASG,EAAT,GAAoL,IAApJH,EAAmJ,EAAnJA,QAASjB,EAA0I,EAA1IA,SAAUD,EAAgI,EAAhIA,WACjD,OAAO,UAACG,EAAA,EAAD,aACHC,EAAAA,EAAAA,IAAWJ,EAAYkB,IAAYA,EAAQZ,SAC3C,SAACD,EAAD,CAAeC,OAAQY,EAAQZ,OAAQL,SAAUA,EAAUsB,YAAuC,IAA1BL,EAAQnB,OAAOjL,UAEzF,SAAC,KAAD,CAAeiL,OAAQmB,EAAQnB,YAInC,SAASuB,EAAT,GAAsE,IAAxCJ,EAAuC,EAAvCA,QACpB/D,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACR,OAAO,0BACJiD,EAAAA,EAAAA,IAAWc,EAAQjP,KAAMkL,KAIvB,SAASkD,EAAT,GAA6K,IAApJC,EAAmJ,EAAnJA,OAAQL,EAA2I,EAA3IA,SAAUsB,EAAiI,EAAjIA,YACxCpE,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACFvH,EAAwB0K,EAAxB1K,KAAMwG,EAAkBkE,EAAlBlE,MAAOC,EAAWiE,EAAXjE,OACnBzG,GAAOwK,EAAAA,EAAAA,IAAWxK,EAAMuH,GACxB,IAAMqE,GAAevB,IAAYG,EAAAA,EAAAA,IAAWE,EAAOkB,YAAarE,GAC1DsE,EAAexB,EAAW7D,GAAQ,4BAAOA,EAAP,KAAc,SAACsF,EAAA,EAAD,CAAatF,OAAO,SAACuF,EAAA,EAAD,UAAaH,SACvF,OAAO,iCACL,SAACtF,EAAA,EAAD,CAAkBC,OAAQvG,EAAMwG,MAAOqF,EAAcpF,OAAQA,KAC3DkF,IAAe,SAACzC,EAAA,EAAD,S,4LCzDN,SAAS8C,EAAT,GAAsM,IAA/KC,EAA8K,EAA9KA,MAAOC,EAAuK,EAAvKA,UAAW/H,EAA4J,EAA5JA,QAA4J,IAAnJgI,OAAAA,OAAmJ,SAC1M5L,GAAMC,EAAAA,EAAAA,GAAe,MAArBD,EACF6L,EAAqBD,EAASE,EAAAA,GAAuBC,EAAAA,GACrDC,GAAW1H,EAAAA,EAAAA,cAAY,WAAwB,IAAvBoH,EAAsB,uDAAN,EAC5CA,GAAQzG,EAAAA,EAAAA,IAAMyG,EAAO,EAAGE,EAASK,EAAAA,GAAcC,EAAAA,IAC/C,IAAMP,EAAYE,EAAmBM,WAAU,SAAAC,GAAO,OAAIV,GAASU,KACnExI,EAAQ,CAAE8H,MAAAA,EAAOC,UAAAA,MAChB,CAAC/H,EAASiI,EAAoBD,IAC3BS,GAAe/H,EAAAA,EAAAA,cAAY,WAC/B,IAAMgI,EAAiBT,EAAmBM,WAAU,SAAAC,GAAO,OAAc,KAAVV,GAAgBA,IAAUU,KACvDxI,EAA9B+H,IAAcW,EAAwB,CAAEX,UAAYA,EAAY,GACvD,CAAEA,UAAWW,MACzB,CAAC1I,EAASiI,EAAoBF,EAAWD,IAC5C,OAAO,UAAC,IAAD,CAAavK,GAAI,CAAE4D,QAAS,SAAA/E,GAAC,OAAIA,EAAEvB,QAAQ8N,YAAYC,OAAvD,WACL,SAAC,KAAD,WACE,SAAC,KAAD,CAAmB3O,SAAUmO,EAAUpQ,MAAO8P,EAC5C7I,eAAe,OACfuC,WAAY,CAAEO,IAAK,EAAGC,IAAK,GAAIzE,GAAI,CAAEkE,UAAW,SAAUT,MAAO,QACjEzD,GAAI,CAAEsL,OAAQ,OAAQtH,GAAI,QAE9B,SAAC,IAAD,CAAQhE,GAAI,CAAEgE,GAAI,EAAGuH,WAAY,UAAY5I,WAAY8H,EAASe,EAAAA,GAAoBC,EAAAA,IAAgBlB,GAAQtD,QAASiE,EAAvH,UAAqI,mCAAWN,EAAAA,GAAkBJ,SAClK,SAAC,IAAD,CAAgB1F,MAAOjG,EAAE,eAAgBmB,GAAI,CAAEmE,SAAU,GAAzD,UACG,OAAKsG,EAASiB,EAAAA,GAAqBC,EAAAA,IAAkBxP,KAAI,YAAe,IAAD,eAAZyP,EAAY,KAARC,EAAQ,KAChE/N,EAAW8N,IAAOrB,GAASsB,IAAOrB,EACxC,OAAO,SAAC,IAAD,CAA8B1M,SAAUA,EAAU6E,SAAU7E,EAAUmJ,QAAS,kBAAMxE,EAAQ,CAAE8H,MAAOqB,EAAIpB,UAAWqB,KAArH,SACJD,IAAOlB,EAAmBmB,GAA1B,cAAuCD,GAAvC,cAAqDA,EAArD,YAA2DlB,EAAmBmB,KAD1E,UAAkBD,EAAlB,YAAwBC,c,gHC5BxB,SAASC,EAAT,GAAgI,IAAlGC,EAAiG,EAAjGA,WAAYC,EAAqF,EAArFA,cAC/CnN,GAAMC,EAAAA,EAAAA,GAAe,MAArBD,EACR,OAAO,SAAC,IAAD,CAAgBiG,MAAOjG,EAAE,aAAc,CAAEpE,MAAOsR,IAAhD,SACJE,EAAAA,EAAAA,KAAkB,SAAAC,GAAC,OAClB,SAAC,IAAD,CAAkBjF,QAAS,kBAAM+E,EAAcE,IAAIpO,SAAUiO,IAAeG,EAAGvJ,SAAUoJ,IAAeG,EAAxG,SACGrN,EAAE,aAAc,CAAEpE,MAAOyR,KADbA,U,0ICPfC,GAAiBC,EAAAA,EAAAA,IAAOvF,EAAAA,EAAPuF,EAAe,gBAAGxR,EAAH,EAAGA,MAAH,MAAgB,CACpD,iBAAkB,CAChByR,gBAAiBzR,EAAM0C,QAAQC,QAAQmF,KACvCrF,MAAOzC,EAAM0C,QAAQ3C,KAAK2R,eAIf,SAASC,EAAT,GAAoE,IAA9CpM,EAA6C,EAA7CA,SAAuBpF,GAAsB,EAAnC4H,UAAmC,aAChF,OAAO,SAACwJ,GAAD,kBAAoBpR,GAApB,IAA2B4H,UAAQ,EAAnC,SACJxC,O,ghBCJCqM,EAA0BC,EAAAA,MAAW,kBAAM,iCAElC,SAASC,IAAsB,IAAD,EACnC7N,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACA8N,GAAmBlH,EAAAA,EAAAA,YAAWC,EAAAA,GAA9BiH,eACR,GAAkC9J,EAAAA,EAAAA,WAAS,GAA3C,eAAO+J,EAAP,KAAkBC,EAAlB,KACMC,GAAeC,EAAAA,EAAAA,KACrB,OAAO,iCACL,SAAC,EAAAC,SAAD,CAAUC,UAAU,EAApB,UACE,SAACT,EAAD,CAAyBU,KAAMN,EAAWO,OAAQ,kBAAMN,GAAa,IAAQO,SAAUN,OAEzF,SAACjG,EAAA,EAAD,CAAQxJ,MAAM,OAAO4J,QAAS,kBAAM4F,GAAa,IAAO3F,WAAW,SAACmG,EAAA,EAAD,CAAWC,IAAG,OAAEX,QAAF,IAAEA,OAAF,EAAEA,EAAgBY,eAAnG,0BAAuHZ,QAAvH,IAAuHA,OAAvH,EAAuHA,EAAgBjG,YAAvI,QAA+I7H,EAAE,wB,iKCGtI,SAAS2O,KACtB,IAAQC,GAAchI,EAAAA,EAAAA,YAAWiI,EAAAA,GAAzBD,UACAE,GAAmBlI,EAAAA,EAAAA,YAAWiI,EAAAA,GAA9BC,eACFC,GAAiBzK,EAAAA,EAAAA,cAAY,yBAAMwK,QAAN,IAAMA,OAAN,EAAMA,OAAiBvP,OAAWA,KAAY,CAACuP,IAClF,OAAO,SAACE,GAAA,EAAD,CAAcC,OAAQL,EAAWM,QAASH,EAA1C,UACL,UAAC/E,EAAA,EAAD,YACE,SAACmF,EAAA,EAAD,CAAYlJ,MAAM,0BAA0BC,QAAQ,SAACkJ,EAAA,EAAD,CAAahH,QAAS2G,OAC1E,SAAC3E,EAAA,EAAD,CAAajJ,GAAI,CAAEkO,GAAI,GAAvB,UACE,SAACC,GAAD,WAMR,SAASA,KACP,IAAQtI,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACMuI,GAAgB3I,EAAAA,EAAAA,YAAWiI,EAAAA,GAAjC7H,KACFuD,GAAWiF,EAAAA,GAAAA,GAAkB,OAACD,QAAD,IAACA,EAAAA,EAAevI,GACnD,OAAO,SAAC,EAAAmH,SAAD,CAAUC,UAAU,SAACqB,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,MAAzE,UACL,SAACxL,EAAA,EAAD,CAAKE,GAAI,CAAEuO,IAAK,EAAGC,IAAK,GAAxB,SACGpF,EAASjN,KAAI,+BAAEC,EAAF,KAAOqS,EAAP,YACZ,SAACC,GAAD,CAAuBC,UAAWF,EAAOG,WAAYxS,GAAnCA,UAI1B,SAASsS,GAAT,GAA6G,IAAtFE,EAAqF,EAArFA,WAAYD,EAAyE,EAAzEA,UACzB9I,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACAgJ,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACMT,GAAgB3I,EAAAA,EAAAA,YAAWiI,EAAAA,GAAjC7H,KACFmD,GAASrK,EAAAA,EAAAA,IAAW,kBAAMoQ,EAAAA,GAAAA,GAAgB,OAACX,QAAD,IAACA,EAAAA,EAAevI,EAAM+I,EAAYC,KAAW,CAACT,EAAavI,EAAM+I,IACjH,IAAK5F,EAAQ,OAAO,KACpB,GAAIhK,OAAOC,QAAQ0P,GAAWK,OAAM,gDAAoBC,WAAU,OAAO,KACzE,IAAQnK,EAAwBkE,EAAxBlE,MAAOxG,EAAiB0K,EAAjB1K,KAAMyG,EAAWiE,EAAXjE,OACrB,OAAO,UAACmK,EAAA,EAAD,CAAWlP,GAAI,CAAEwO,GAAI,GAArB,WACL,SAAC5J,GAAA,EAAD,CAAkBC,OAAQvG,IAAQ,SAAC6Q,GAAA,EAAD,CAASpI,KAAM,EAAG/G,GAAI,CAAEoP,GAAI,GAAK9B,IAAKhP,IAAUwG,MAAOA,EAAOC,OAAQA,IAAU,SAACuC,EAAA,EAAD,UAAUvC,OAC5H,SAACyC,EAAA,EAAD,KACA,SAACyB,EAAA,EAAD,UACGjK,OAAOC,QAAQ0P,GAAWxS,KAAI,+BAAEC,EAAF,KAAOiT,EAAP,YAAkBA,EAAKJ,UAAW,SAACK,GAAD,CAA4BD,KAAMA,GAAXjT,WAI9F,SAASkT,GAAT,GAA4D,IAAhCD,EAA+B,EAA/BA,KACZE,GAAgB9J,EAAAA,EAAAA,YAAWiI,EAAAA,GAAjC2B,KACR,GAAgCxM,EAAAA,EAAAA,WAAS,GAAzC,eAAO2M,EAAP,KAAiBC,EAAjB,KACMC,GAAevM,EAAAA,EAAAA,cAAY,SAACC,EAAyBuM,GAA1B,OAAkDF,EAAYE,KAAa,IACtGC,GAAYC,EAAAA,EAAAA,UAMlB,OAJArM,EAAAA,EAAAA,YAAU,WACJ6L,IAASE,GAAaO,YAAW,iCAAMF,QAAN,IAAMA,GAAN,UAAMA,EAAWG,eAAjB,iBAAM,EAAoBC,sBAA1B,aAAM,SAAqC,CAAEC,SAAU,aAAa,OACxG,CAACL,EAAWP,EAAME,KAEd,UAACW,EAAA,EAAD,CAAWlQ,GAAI,CAAE4D,QAAS,oBAAsB4L,SAAUH,IAASE,GAAeC,EAAU9S,SAAUgT,EAAcS,IAAKP,EAAzH,WACL,UAACQ,EAAA,EAAD,CAAkBC,YAAY,SAACC,EAAA,EAAD,IAA9B,WACE,UAACjG,EAAA,EAAD,YAAY,SAAC,KAAD,CAAWhN,MAAOgS,EAAKkB,KAAKpT,QAA5B,SAAsCkS,EAAKkB,KAAK7J,OAA5D,KAA8E,6BAAS8J,EAAAA,GAAAA,GAASnB,QAC/FoB,EAAAA,GAAAA,SAAyBpB,EAAKkB,KAAKpT,WAAmB,SAAC2C,EAAA,EAAD,CAAKE,GAAI,CAAE0D,QAAS,eAAgBwE,GAAI,OAAQqG,GAAI,GAApD,UACrD,SAACmC,GAAA,EAAD,CAAqBC,SAAUtB,EAAKkB,KAAKpT,QAA2ByT,QAASvB,EAAKkB,KAAKM,mBAG3F,SAACC,EAAA,EAAD,UACGzB,EAAK0B,SAAS5U,KAAI,SAAC6U,EAASxH,GAAV,OAAgB,SAACa,EAAA,EAAD,CAAoBxK,UAAU,MAA9B,SAAqCmR,GAApBxH,W,mNChE1D,IAXqB4C,EAAAA,GAAAA,KAAO,SAACrR,GACEA,EAArBkW,OAAR,IAAmBC,GAAnB,QAA6BnW,EAA7B,IACA,OAAO,SAACoW,GAAA,GAAD,WAAgBD,MAFJ9E,EAGlB,gBAAGxR,EAAH,EAAGA,MAAH,MAAwB,CACzBwW,UADC,EAAUH,OAC2B,iBAAjB,eACrBI,WAAY,OACZC,WAAa1W,EAAc2W,YAAYC,OAAO,YAAa,CACzDC,SAAW7W,EAAc2W,YAAYE,SAASC,e,0JCK5CC,IAAkBvF,EAAAA,GAAAA,IAAO1E,GAAAA,EAAP0E,CAAoB,CAC1C1I,QAAS,SAGI,SAASkO,GAAT,GAAuK,IAAlJlL,EAAiJ,EAAjJA,KAAMvG,EAA2I,EAA3IA,SAAU1F,EAAiI,EAAjIA,MAAOoX,EAA0H,EAA1HA,YAA0H,IAA7GC,aAAAA,OAA6G,MAA9F,EAA8F,EAA3FC,EAA2F,EAA3FA,cAA2F,IAA5EC,QAAAA,OAA4E,aAA3DrP,SAAAA,OAA2D,SAAzCsP,EAAyC,EAAzCA,QAAYC,GAA6B,cAEnL,OAAO,UAACP,IAAD,oBAAqBO,GAArB,cACJ/R,GACD,SAACoM,GAAA,EAAD,CAAYvM,GAAI,CAAE+D,GAAI,GAAtB,SACG2C,KAEH,SAACyL,GAAA,GAAD,CAAqCnS,GAAI,CAAEoS,UAAW,OAAQjO,SAAU,GAAxE,UACE,SAACgO,GAAA,GAAD,CACEnS,GAAI,CAAE+D,GAAI,GACVE,WAAY,CACVjE,GAAI,CAAEkE,UAAW,UAEnBmO,MAAOL,EACPH,YAAaA,EACbpX,MAAOA,EACPiC,SAAUqV,EACVpP,SAAUA,EACV2P,aAAcN,EAAU,SAAM5T,OAGlC,SAACyI,EAAA,EAAD,CAAQ7G,GAAI,CAAEuS,WAAY,GAAKxL,KAAK,QAAQ1J,MAAM,QAAQ4J,QAAS,kBAAMgL,EAAUA,IAAYF,EAAcD,IAAenP,SAAUA,GAAYlI,IAAUqX,EAA5J,UACE,SAACU,GAAA,EAAD,UC3BC,SAASC,KACd,IAAQ5T,GAAMC,EAAAA,EAAAA,GAAe,MAArBD,EACA+G,GAAsBH,EAAAA,EAAAA,YAAWC,EAAAA,GAAjCE,kBACAC,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACR,GAAgChD,EAAAA,EAAAA,WAAS,GAAzC,eAAO2M,EAAP,KAAiBkD,EAAjB,KACMC,GAASxP,EAAAA,EAAAA,cAAY,kBAAMuP,GAAalD,KAAW,CAACkD,EAAalD,IACjEoD,EAAW/M,EAAKS,IAAIuM,GAAAA,GAAAA,MAAAA,OACpBC,EAAUjN,EAAKS,IAAIuM,GAAAA,GAAAA,MAAAA,QACnBE,EAAUlN,EAAKS,IAAIuM,GAAAA,GAAAA,MAAAA,QACnBZ,GAAU9O,EAAAA,EAAAA,cAAY,kBAAMyC,EAAkB,CAAEoN,cAAe,OAAO,CAACpN,IAE7E,OAAO,UAACsJ,EAAA,EAAD,YACL,UAACjG,EAAA,EAAD,CAAajJ,GAAI,CAAE0D,QAAS,OAAQsB,IAAK,EAAGrB,WAAY,SAAUsP,SAAU,QAA5E,WACE,SAAC5U,GAAA,EAAD,CAAM0I,KAAK,QAAQ1J,MAAM,UAAUtB,OAAO,4BAAO6W,EAASrC,KAAK7J,KAArB,KAA2B,4BAASkM,EAASnY,aACtFyD,EAAAA,GAAAA,KAAuB,SAAAD,GAAO,OAAI,SAACoM,EAAA,EAAD,WAA2B,SAAC6I,GAAD,CAAcjV,QAASA,KAAjCA,OACpD,UAACoM,EAAA,EAAD,wBAAsBmG,EAAAA,GAAAA,GAASsC,OAC/B,UAACzI,EAAA,EAAD,0BAAwBmG,EAAAA,GAAAA,GAASuC,OACjC,UAACjT,EAAA,EAAD,CAAKqE,SAAU,EAAGT,QAAQ,OAAOyP,eAAe,WAAWnO,IAAK,EAAhE,WACE,SAAC6B,EAAA,EAAD,CAAQE,KAAK,QAAQ1J,MAAM,QAAQ4J,QAASgL,EAAS/K,WAAW,SAACsL,GAAA,EAAD,IAAhE,SAA6E3T,EAA7E,gCACA,SAAC,GAAD,CACEoS,OAAQzB,EACRvI,QAAS0L,EACT,gBAAenD,EACf,aAAW,YACXzI,KAAK,QACL/G,GAAI,CAAEqR,WAAY,GANpB,UAQE,SAACf,EAAA,EAAD,aAIN,SAAC8C,GAAA,EAAD,CAAUC,GAAI7D,EAAU8D,QAAQ,OAAOC,eAAa,EAApD,UACE,SAACtK,EAAA,EAAD,CAAajJ,GAAI,CAAEkO,GAAI,GAAvB,UACE,SAACsF,GAAD,WAMD,SAASN,GAAT,GAAoE,IAA5CjV,EAA2C,EAA3CA,QAEvBoR,GADW5J,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACUS,IAAIuM,GAAAA,GAAAA,MAAA,UAAe5U,EAAf,WAEhBwV,GADUC,SAASrE,EAAK5U,QACL,4BAAQ+F,GAAAA,EAASvC,GAAjB,cACvB,4BAAQuC,GAAAA,EAASvC,GAAjB,KAA2B,6BAASuS,EAAAA,GAAAA,GAASnB,QAC/C,OAAO,SAAC,KAAD,CAAWhS,MAAOY,EAAlB,SAA4BwV,IAG9B,SAASD,GAAT,GAA6E,IAAD,UAArDG,QAAAA,OAAqD,MAA3C,CAAEC,GAAI,GAAIC,GAAI,GAA6B,EACjF,GAA4DpO,EAAAA,EAAAA,YAAWC,EAAAA,GAAlDsN,EAArB,EAAQrN,UAAaqN,cAAiBpN,EAAtC,EAAsCA,kBAC9BC,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KAGFiO,EAAI,UAAGd,EAAce,kBAAjB,QAA+BlO,EAAKS,IAAIuM,GAAAA,GAAAA,KAAWpY,MACvDqY,EAAO,UAAGE,EAAcgB,oBAAjB,QAAiC,EACxCjB,EAAO,UAAGC,EAAciB,oBAAjB,QAAiC,EAC9C,OAAO,UAACC,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,WACL,SAACF,GAAA,IAAD,kBAAMG,MAAI,GAAKV,GAAf,cACE,SAAC9M,EAAA,EAAD,CAAQC,WAAS,EAAC9G,GAAI,CAAEsL,OAAQ,QAAUvE,KAAK,QAAQlH,UAAU,IAAIxC,MAAM,UAAUiX,KAAK,2EAA2EC,OAAO,SAASC,IAAI,aAAzL,0FAIF,SAACN,GAAA,IAAD,kBAAMG,MAAI,GAAKV,GAAf,cACE,SAAC/B,GAAD,CACE5R,GAAI,CAAE4D,QAAS,SAAA/E,GAAC,OAAIA,EAAEvB,QAAQmX,aAAapJ,MAAM5H,MAAO,QACxDiD,MAAM,uBAAI/I,GAAAA,GAAAA,IAAW,gBACrBlD,MAAOqZ,EACPjC,YAAalU,GAAAA,GAAAA,OAAc,cAC3BmU,aAAcjM,EAAKS,IAAIuM,GAAAA,GAAAA,KAAWpY,MAClCsX,cAAe,SAAAtX,GAAK,OAAImL,EAAkB,CAAEnI,KAAM,gBAAiBiX,QAAS,aAAcja,MAAAA,KAC1FwX,QAAS,kBAAMrM,EAAkB,CAAEnI,KAAM,gBAAiBiX,QAAS,aAAcja,WAAO2D,UAG3FF,EAAAA,GAAAA,KAAuB,SAAAyW,GACtB,IAAMD,EAAO,UAAMC,EAAN,cACP9Q,EAAMmP,EAAc0B,GACpBE,EAAkB/Q,IAAQgR,OAAOC,UACvC,OAAO,SAACZ,GAAA,IAAD,kBAAMG,MAAI,GAAkBV,GAA5B,cACL,SAAC/B,GAAD,CACE5R,GAAI,CAAE4D,QAAS,SAAA/E,GAAC,OAAIA,EAAEvB,QAAQmX,aAAapJ,MAAM5H,MAAO,QACxDiD,MAAM,SAAC,KAAD,CAAWrJ,MAAOsX,EAAlB,UAA0B,uBAAIhX,GAAAA,GAAAA,IAAW+W,OAC/Cja,WAAe2D,IAARyF,EAAqB+Q,EAAkBG,EAAAA,EAAWlR,EAAO,GAChEgO,YAAa+C,EAAkB,UAAOjX,GAAAA,GAAAA,OAAc+W,GACpD5C,aAhCW,GAiCXC,cAAe,SAAAtX,GAAK,OAAImL,EAAkB,CAAEnI,KAAM,gBAAiBiX,QAAAA,EAASja,MAAAA,KAC5EkI,SAAUiS,EACV5C,SAAO,EART,UAUE,SAACnL,EAAA,EAAD,CAAQxJ,MAAOsX,EAAQ1N,QAAS,kBAAMrB,EAAkB,CAAEnI,KAAM,gBAAiBiX,QAAAA,EAASja,MAAOma,EArCtF,GAqCqHC,OAAOC,aAAc5N,UAAW0N,GAAkB,SAACzN,GAAA,EAAD,KAAe,SAACC,GAAA,EAAD,IAAjM,0BAXmBuN,OAiBzB,SAACT,GAAA,IAAD,kBAAMG,MAAI,GAAKV,GAAf,cACE,SAAC/B,GAAD,CACE5R,GAAI,CAAE4D,QAAS,SAAA/E,GAAC,OAAIA,EAAEvB,QAAQmX,aAAapJ,MAAM5H,MAAO,QACxDiD,MAAM,uBAAI/I,GAAAA,GAAAA,IAAW,kBACrBlD,MAAOqY,EACPjB,YAAalU,GAAAA,GAAAA,OAAc,gBAC3BmU,aAAc,EACdC,cAAe,SAAAtX,GAAK,OAAImL,EAAkB,CAAEnI,KAAM,gBAAiBiX,QAAS,eAAgBja,MAAAA,KAC5FuX,SAAO,QAGX,SAACkC,GAAA,IAAD,kBAAMG,MAAI,GAAKV,GAAf,cACE,SAAC/B,GAAD,CACE5R,GAAI,CAAE4D,QAAS,SAAA/E,GAAC,OAAIA,EAAEvB,QAAQmX,aAAapJ,MAAM5H,MAAO,QACxDiD,MAAM,uBAAI/I,GAAAA,GAAAA,IAAW,kBACrBlD,MAAOsY,EACPlB,YAAalU,GAAAA,GAAAA,OAAc,gBAC3BmU,aAAc,EACdC,cAAe,SAAAtX,GAAK,OAAImL,EAAkB,CAAEnI,KAAM,gBAAiBiX,QAAS,eAAgBja,MAAAA,KAC5FuX,SAAO,QAGX,SAACkC,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAf,UACE,oM,+BClHAoB,GAAO,CACXpB,GAAI,EAAGC,GAAI,EAAGoB,GAAI,GAGL,SAASC,GAAT,GAAuC,IAAlBpH,EAAiB,EAAjBA,KAAMC,EAAW,EAAXA,QAChClP,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACR,OAAO,SAACgP,GAAA,EAAD,CAAcC,KAAMA,EAAMC,QAASA,EAAnC,UACL,UAAClF,EAAA,EAAD,YACE,SAACmF,EAAA,EAAD,CAAYlJ,MAAOjG,EAAF,sCAAqBkG,QAAQ,SAACkJ,EAAA,EAAD,CAAahH,QAAS8G,OACpE,SAAC9E,EAAA,EAAD,CAAajJ,GAAI,CAAEkO,GAAI,GAAvB,UACE,UAACiH,GAAA,EAAD,CAAOf,QAAS,EAAhB,WACE,SAACgB,GAAD,KACA,SAAC3C,GAAD,KACA,SAAC4C,GAAD,cAKV,IAAMjQ,IAAI,QAAOkQ,GAAAA,IACXC,GAAc,SAACnS,GAAD,OAAoB,SAAC8Q,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,SAAmBxQ,KAC3D,SAASgS,KACP,OAAyD3P,EAAAA,EAAAA,YAAWC,EAAAA,GAA/C8P,EAArB,EAAQ7P,UAAa6P,WAAc5P,EAAnC,EAAmCA,kBAC7B6P,GAAYtS,EAAAA,EAAAA,cAAY,SAACqS,GAAD,OAAgB5P,EAAkB,CAAE4P,WAAAA,MAAe,CAAC5P,IAClF,OAAO,SAACsJ,EAAA,EAAD,WACL,SAACjG,EAAA,EAAD,CAAajJ,GAAI,CAAE0D,QAAS,QAA5B,UACE,SAACwQ,GAAA,GAAD,CAAMC,WAAS,EAACuB,QAASV,GAAMhV,GAAI,CAAEkO,GAAI,GAAKkG,QAAS,EAAvD,UACE,SAACuB,GAAA,EAAD,CAAgBC,SAAUxQ,GAAMyQ,YAAaL,EAAYM,eAAgBL,EAAWF,YAAaA,WAMzG,IACMQ,GAAc,CAAC,SAAU,YAAa,WAAY,YAAa,SAC/DC,GAAgB,UAFD,CAAC,KAAM,MAAO,OAEQD,IAAa5Z,KAAI,SAAA8Z,GAAC,OAAIpD,GAAAA,GAAAA,MAAYoD,MACvEC,GAAY,CAAI,OAAQ,MAAO,MAAO,KAAM,OAAQ,OAAxC,OAAkDH,IAE9DI,GAAa,mBACdC,GAAAA,KADc,QAEdC,GAAAA,IAFc,CAGjB,UAAW,WAAY,UAAW,WAG9BC,GAAehB,GAAAA,GAAAA,QAA0B,SAAAW,GAAC,OAAKC,GAAatY,SAASqY,KAAcE,GAAcvY,SAASqY,MAGhH,SAASM,GAAT,GAAmG,IAArEC,EAAoE,EAApEA,MAAOC,EAA6D,EAA7DA,MACnC,GAA0BhR,EAAAA,EAAAA,YAAWK,EAAAA,GAA7BD,EAAR,EAAQA,KAAM6Q,EAAd,EAAcA,QACd,OAAO,UAACC,GAAA,GAAD,WACJH,EAAMra,KAAI,SAAAya,GAAE,aAAI,SAAC,MAAD,CAAkB/W,UAAWgX,GAAAA,GAAwCxH,KAAMxJ,EAAKS,IAAIsQ,GAAKE,SAAQ,OAAEJ,QAAF,IAAEA,GAAF,UAAEA,EAASpQ,IAAIsQ,UAAf,aAAE,EAAkBnc,OAAzEsc,KAAKC,UAAUJ,EAAGrG,UAC9EkG,KAIL,SAASpB,KACP,IAAQ1I,GAAmBlH,EAAAA,EAAAA,YAAWC,EAAAA,GAA9BiH,eACA9G,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACFoR,EAAcpR,EAAKS,IAAIuM,GAAAA,GAAAA,SACvBqE,EAAUvK,EAAewK,WACzBC,EAAUzK,EAAeyK,UAEzBC,GAAqBnb,EAAAA,EAAAA,UAAQ,WAOjC,OANcia,GAActM,QAAO,SAAAoM,GACjC,OAAIA,EAAErY,SAASsZ,KACXE,GAAWnB,EAAErY,SAAS,aAAoB,MAE7CzB,KAAI,SAAA8Z,GAAC,OAAIpD,GAAAA,GAAAA,MAAYoD,MAEXpM,QAAO,SAAAyN,GAAC,QAAMzR,EAAKS,IAAIgR,GAAG7c,WACtC,CAACoL,EAAMqR,EAASE,IAGbG,GAAoBrb,EAAAA,EAAAA,UAAQ,kBAAMoa,GAAana,KAAI,SAAA8Z,GAAC,OAAIpD,GAAAA,GAAAA,MAAYoD,MAAIpM,QAAO,SAAAyN,GAAC,OAAIzR,EAAKS,IAAIgR,GAAG7c,WAAQ,CAACoL,IAE/G,OAAO,SAACqJ,EAAA,EAAD,WAAW,SAACjG,EAAA,EAAD,WAChB,UAACiL,GAAA,GAAD,CAAMC,WAAS,EAACuB,QAASV,GAAMZ,QAAS,EAAxC,WACE,SAACF,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAAC4D,GAAD,CAAiB1S,MAAM,aAAvB,UACE,SAACyR,GAAD,CAAoBC,MAAOR,GACzBS,MAAOQ,IAAe,UAACJ,GAAA,GAAD,CAAU7W,GAAI,CAAE0D,QAAS,OAAQyP,eAAgB,iBAAjD,WACpB,6BAAM,oCAAN,KAAsB,UAAC,KAAD,CAAW9V,MAAO4Z,EAAY1G,KAAKpT,QAAnC,UAA6C8Z,EAAY1G,KAAKjS,KAA9D,IAAqE2Y,EAAY1G,KAAK7J,YAC5G,2BAAQ8J,EAAAA,GAAAA,GAASyG,eAKzB,SAAC/C,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAAC4D,GAAD,CAAiB1S,MAAM,cAAvB,UACE,SAACyR,GAAD,CAAoBC,MAAOa,UAG5BE,EAAkB/Z,SAAU,SAAC0W,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UAC7B,SAAC4D,GAAD,CAAiB1S,MAAM,aAAvB,UACE,SAACyR,GAAD,CAAoBC,MAAOe,eAMrC,SAASC,GAAT,GAA+C,IAApB1S,EAAmB,EAAnBA,MAAO3E,EAAY,EAAZA,SAChC,OAAO,UAAC0I,EAAA,EAAD,YACL,SAACI,EAAA,EAAD,CAAajJ,GAAI,CAAEyX,GAAI,GAAvB,UACE,SAAC,KAAD,CAAK/T,QAAQ,OAAOyP,eAAe,gBAAnC,UACE,SAAC9I,EAAA,EAAD,CAAYlN,QAAQ,YAApB,SAAiC2H,QAGpC3E,K,gKC3HQuX,IAA4BC,EAAAA,EAAAA,oBAAcvZ,G,0IC+WtCwZ,IAAAA,IAAAA,EAAAA,GAAAA,KAAAA,KAoBAC,IA5XV,SAASC,GAAStB,EAAkBuB,EAAmBC,EAAuBC,EAAgBC,EAA4BC,GAU/H,IATA,IAAIC,EAASD,EAEPE,EACQ,CAAEC,gBAAgB,GAD1BD,EAEW,CAAEC,gBAAgB,GAF7BD,EAGY,CAAEE,UAAU,GAHxBF,EAIM,CAAEG,YAAY,EAAMC,eAAe,EAAMH,gBAAgB,GAEjEI,EAAQ,EACL1Z,OAAOqJ,OAAO+P,GAAQO,MAAK,SAAAC,GAAC,OAAIA,MAAMF,IAAU,IAAI,CACzD,GAAIN,EAAOI,WAAY,QACdJ,EAAOI,WACd,IAAMK,EAAUL,GAAWR,EAAMC,EAAQC,GACrCF,IAASa,IACXb,EAAOa,EACPT,GAAM,oBAAQA,GAAWC,IAG7B,GAAID,EAAOK,cAAe,QACjBL,EAAOK,cACd,IAAMI,EAAUJ,GAAcjC,EAAOwB,EAAMD,GACvCC,IAASa,IACXb,EAAOa,EACPT,GAAM,oBAAQA,GAAWC,IAG7B,GAAID,EAAOE,eAAgB,QAClBF,EAAOE,eACd,IAAMQ,EAAWR,GAAe9B,EAAOwB,GACnCxB,IAAUsC,IACZtC,EAAQsC,EACRV,GAAM,oBAAQA,GAAWC,IAG7B,GAAID,EAAOG,SAAU,QACZH,EAAOG,SACd,MAA2CA,GAAS/B,EAAOwB,GAA5Cc,EAAf,EAAQtC,MAAuBqC,EAA/B,EAAyBb,KACrBxB,IAAUsC,GAAYd,IAASa,IACjCrC,EAAQsC,EACRd,EAAOa,EACPT,GAAM,oBAAQA,GAAWC,KAI/B,MAAO,CAAE7B,MAAAA,EAAOwB,KAAAA,GAGX,SAASe,GAAevC,EAAkB0B,GAE/C,IADA,IAAMc,EAAkD,GACxD,MAAuBha,OAAOC,QAAQiZ,GAAtC,eAAkD,CAA7C,sBAAO9b,EAAP,KAAYgH,EAAZ,KACEA,EAAExF,SAAS,KAChBob,EAAU5c,GAAOgH,EAAExF,SAAS,GAAK,EAAI,GAEvC,OAAOqb,EAAAA,GAAAA,IAAYzC,GAAO,SAAA0C,GAAC,OAAIA,KAAG,SAAAA,GAChC,GAAoB,cAAhBA,EAAEC,UAA2B,OAAOD,EAExC,cAA2BA,EAAEE,SAA7B,GAAOxc,EAAP,KAAUiC,EAAV,KAAawa,EAAb,KAAmBC,EAAnB,KACA,GAAoB,SAAhB1c,EAAEuc,WAAwC,UAAhBta,EAAEsa,UAAuB,CACrD,IAAM/c,EAAMQ,EAAEuJ,KAAKvJ,EAAEuJ,KAAK3I,OAAS,GAAI+b,EAAQ1a,EAAEpE,MACjD,GAAI2B,KAAO4c,EAAW,CAEpB,GADoBA,EAAU5c,GACpBmd,EAAO,OAAOD,EACxB,GAAc,IAAVC,GAAerB,EAAU9b,GAAMwB,SAAS,GAC1C,OAAO4b,EAAAA,GAAAA,IAAU5c,EAAG,EAAGyc,EAAMC,IAGnC,OAAOJ,KAIX,SAASX,GAAS/B,EAAkBwB,GAAmG,IAA5EyB,EAA2E,wDAC9HC,EAAc,IAAIC,IAAgBC,EAAiB,IAAID,IAE7D,SAASE,EAAMxK,EAAeyK,GACxBA,EAAUJ,EAAYK,IAAI1K,GACzBA,EAAK+J,SAASY,SAAQ,SAAAC,GAAE,OAAIP,EAAYQ,IAAID,IAAOL,EAAeG,IAAIE,MAG7E,IAAME,EAAU,IAAIR,IAsBpB,IApBAS,EAAAA,GAAAA,IAAa5D,GAAO,SAAA7Z,OAAU,SAAAuc,GAC5B,IAAQC,EAAcD,EAAdC,UACR,OAAQA,GACN,IAAK,OACHgB,EAAQJ,IAAIb,EAAE/S,KAAK,IACnB0T,EAAMX,GAAG,GACT,MACF,IAAK,MAAOW,EAAMX,EAAGA,EAAEE,SAASpK,OAAM,SAAAiL,GAAE,OAAIP,EAAYQ,IAAID,OAAO,MACnE,IAAK,MACH,IAAMI,EAAWnB,EAAEE,SAASvP,QAAO,SAAAoQ,GAAE,MAAqB,UAAjBA,EAAGd,aAC5CU,EAAMX,EAAuB,IAApBmB,EAAS7c,QAAqC,IAApB6c,EAAS7c,QAAgBkc,EAAYQ,IAAIG,EAAS,KACrF,MAEF,IAAK,QAASR,EAAMX,GAAG,GAAO,MAC9B,IAAK,MAAO,IAAK,YAAa,IAAK,WACnC,IAAK,MAAO,IAAK,MAAOW,EAAMX,GAAG,GAAQ,MACzC,SAASoB,EAAAA,GAAAA,IAAkBnB,QAI3B,QAAIS,GAAgB5K,OAAM,gBAAGmK,EAAH,EAAGA,UAAH,MAAiC,SAAdA,GAAsC,UAAdA,MACvEna,OAAOoG,KAAK4S,EAAKuC,MAAM/c,SAAW2c,EAAQpT,KAC1C,MAAO,CAAEyP,MAAAA,EAAOwB,KAAAA,GAElB,IAAIjI,GAAW,EACf,SAASyK,IACP,KAAOL,EAAQD,IAAR,YAAiBnK,MACxB,MAAM,GAAN,OAAUA,GAGZyG,EAAMwD,SAAQ,SAAA3K,GAAI,OAAIqK,EAAYQ,IAAI7K,IAASuK,EAAeG,IAAI1K,MAClE,IAAMoL,GAAS,QAAIb,GAAgB/P,QAAO,SAAAqP,GAAC,MAAoB,UAAhBA,EAAEC,aAC3CuB,EAAY,IAAIC,IAAIF,EAAOte,KAAI,SAAAkT,GAAI,MAAI,CAACA,EAC3CoK,GAAkC,SAAnBpK,EAAK8J,WAAyC,QAAjB9J,EAAKlJ,KAAK,IAAvD,qBAESyU,EAAAA,GAAAA,IAAW,CAAC,MAAD,UAAWJ,QAF/B,IAEiDK,KAAM,QADnDxL,OAIN,SAASyL,EAAYC,GACnB,IAAM1S,GAAS2S,EAAAA,GAAAA,KAAa,QAAIN,EAAUtV,QAAS,CACjD6V,KAAKC,EAAAA,GAAAA,IAAUH,GAAM,SAACtgB,GAAD,OAAW0gB,EAAAA,GAAAA,IAAS1gB,QACjC,SAAAkC,GAAC,OAAI,KACf,OAAOqC,OAAOoc,aAAY,QAAIV,EAAUrS,UAAUlM,KAAI,SAACS,EAAG4M,GAAJ,MAAU,CAAC5M,EAAEuJ,KAAK,GAAKkC,EAAOmB,GAA4B/O,WAUlH,IARA,IAAM4gB,EAAS,CACb7E,MATFA,GAAQyC,EAAAA,GAAAA,IAAYzC,GAAO,SAAA0C,GAAC,uBAAIwB,EAAUpU,IAAI4S,UAAlB,QAAwBA,KAAG,SAAAA,GAAC,OAAIA,KASnDlB,KAAM,CACXuC,KAAMO,EAAY9C,EAAKuC,MACvBlS,QAAQiT,EAAAA,GAAAA,GAAaC,EAAAA,IAAa,SAAAC,GAAI,OACpCxD,EAAK3P,OAAOmT,GAAMrf,KAAI,kBAA0B,CAAEsf,GAA5B,EAAGA,GAA6Brc,IAAhC,EAAOA,IAA8BiJ,OAAQyS,EAA7C,EAAYzS,iBAGlCqT,EAAU1c,OAAOC,QAAQ6b,EAAY,KAC3C,MAAmB9b,OAAOqJ,OAAOgT,EAAOrD,KAAK3P,QAA7C,gBAAK,IAAL,EAAW2P,EAAI,KAAf,WAC2BA,GAD3B,IACE,2BACE,OADW3P,EACX,QADWA,OACX,WAA+BqT,GAA/B,+BACE,iBAAAjhB,MAAA,GADU2B,EACV,KADeuf,EACf,KAAAtT,EAAOjM,IAAQuf,GADjB,0BAAAzC,MAFJ,0BAAAA,KAIA,OAAOmC,EAGT,SAAS7C,GAAWR,EAAuBC,EAAgBC,GAA8C,IAAD,EAClG0D,GAAW,EACTC,IAAY,UAAC3D,EAAU4D,eAAX,OAAC,EAAmBte,QAChCue,EAAa,IAAIpC,IAAI3a,OAAOC,QAAQiZ,GAAWrO,QAAO,gDAAcrM,UAAQrB,KAAI,sCAChF6f,EAAc,IAAIrC,IAAI3a,OAAOC,QAAQiZ,GAAWrO,QAAO,+BAAKjN,GAAL,kBAAYA,EAAEgB,SAAS,KAAOhB,EAAEgB,SAAS,MAAIzB,KAAI,sCACxGkM,GAASiT,EAAAA,GAAAA,GAAaC,EAAAA,IAAa,SAAAC,GACvC,IAAMS,EAAOjE,EAAK3P,OAAOmT,GACnBU,EAAUD,EAAKpS,QAAO,SAAAsS,GAC1B,IAAIzD,EAAQ,EACZ,OAAOuD,EAAKjN,OAAM,SAAAkC,GAChB,IAAMkL,EAAepd,OAAOC,QAAQiS,EAAM7I,QAAQ2G,OAAM,+BAAEiH,EAAF,kBAAiBkG,EAAI9T,OAAO4N,MAC9EoG,EAAUrd,OAAOC,QAAQiS,EAAM7I,QAAQsQ,MAAK,+BAAE1C,EAAF,iBAAgBkG,EAAI9T,OAAO4N,MAI7E,OAHImG,IAAiBC,GAAWnL,EAAMuK,GAAKU,EAAIV,MAC3CI,IAAcE,EAAW7B,IAAIhJ,EAAM9R,OAAU4c,EAAY9B,IAAIiC,EAAI/c,MAAU+c,EAAI/c,MAAQ8R,EAAM9R,MAC/FsZ,IACKA,EAAQT,QAInB,OADIiE,EAAQ1e,SAAWye,EAAKze,SAAQoe,GAAW,GACxCM,KAET,OAAON,EAAW,CAAErB,KAAMvC,EAAKuC,KAAMlS,OAAAA,GAAW2P,EAGlD,SAASS,GAAcjC,EAAkBwB,EAAuBD,GAG9D,IAFA,IAAMuE,EAAYtd,OAAOoc,YAAYpc,OAAOC,QAAQ+Y,EAAKuC,MAAMpe,KAAI,+BAAEC,EAAF,KAAOwc,EAAP,WAAc,CAACxc,EAAK,CAAEoI,IAAKoU,EAAGnU,IAAKmU,QAChG2D,EAAO,CAAEvE,KAAAA,GAFmF,aAIhG,IAAMwE,GAAYlB,EAAAA,GAAAA,GAAaC,EAAAA,IAAa,SAAAC,GAAI,OAAIiB,GAAgBF,EAAKvE,KAAK3P,OAAOmT,OAC/EkB,GAAiBpB,EAAAA,GAAAA,GAAaC,EAAAA,IAAa,SAAAnf,GAAG,OAClDugB,GAAY3d,OAAOC,QAAQud,GAAWrgB,KAAI,SAAA4F,GAAC,OAAIA,EAAE,KAAO3F,EAAMkgB,EAAYva,EAAE,MAAI8H,QAAO,SAAA+O,GAAC,OAAIA,SAE1FgD,GAAW,EACTvT,GAASiT,EAAAA,GAAAA,GAAaC,EAAAA,IAAa,SAAAC,GACvC,IAAMH,EAASkB,EAAKvE,KAAK3P,OAAOmT,GAAM3R,QAAO,SAAAsS,GAC3C,IAAMS,EAAOD,GAAY,CAACF,GAAgB,CAACN,IAAOO,EAAelB,KAC3DqB,EAAWC,GAAiBtG,EAAOoG,GACzC,OAAOpG,EAAMxH,OAAM,SAACK,EAAM7F,GAAP,aAAaqT,EAASvW,IAAI+I,GAAO5K,MAApB,UAA4BsT,EAAQvO,UAApC,SAA2CuL,EAAAA,SAI7E,OAFIsG,EAAO7d,SAAW+e,EAAKvE,KAAK3P,OAAOmT,GAAMhe,SAC3Coe,GAAW,GACNP,KAET,IAAKO,EAAU,cACfW,EAAKvE,KAAO,CAAEuC,KAAMgC,EAAKvE,KAAKuC,KAAMlS,OAAAA,MAjBzB,kBAgBI,MAGjB,OAAOkU,EAAKvE,KAEd,SAASM,GAAe9B,EAAkBwB,GACxC,IAEM+E,EAAYD,GAAiBtG,EADrBmG,GAAY,CADR3d,OAAOoc,YAAYpc,OAAOC,QAAQ+Y,EAAKuC,MAAMpe,KAAI,+BAAEC,EAAF,KAAOwc,EAAP,WAAc,CAACxc,EAAK,CAAEoI,IAAKoU,EAAGnU,IAAKmU,SAC7E,gBAAgB5Z,OAAOqJ,OAAO2P,EAAK3P,QAAQlM,KAAI,SAAAkM,GAAM,OAAIoU,GAAgBpU,UAGlG,OAAO4Q,EAAAA,GAAAA,IAAYzC,GAAO,SAAA0C,GAEtB,MAAqB6D,EAAUzW,IAAI4S,GAA3B1U,EAAR,EAAQA,IACR,GAAIA,IADJ,EAAaC,IACI,OAAO0W,EAAAA,GAAAA,IAAS3W,GAEnC,IAAQ2U,EAAcD,EAAdC,UACF6D,EAAgB9D,EAAEE,SAASjd,KAAI,SAAAyc,GAAC,OAAImE,EAAUzW,IAAIsS,MACxD,OAAQO,GACN,IAAK,YACH,cAAuC6D,EAAvC,GAAOviB,EAAP,KAAc+e,EAAd,KAAyBH,EAAzB,KAA+BC,EAA/B,KACA,GAAI7e,EAAM+J,KAAOgV,EAAU/U,IAAK,OAAOyU,EAAEE,SAAS,GAC7C,GAAI3e,EAAMgK,IAAM+U,EAAUhV,IAAK,OAAO0U,EAAEE,SAAS,GACtD,GAAIC,EAAK5U,MAAQ4U,EAAK7U,KACpB8U,EAAK7U,MAAQ6U,EAAK9U,KAClB6U,EAAK7U,MAAQ8U,EAAK9U,KAAOkP,SAAS2F,EAAK7U,KACvC,OAAO2W,EAAAA,GAAAA,IAAS9B,EAAK5U,KACvB,MAEF,IAAK,MACH,IAAMwY,EAAc/D,EAAEE,SAASvP,QAAO,SAAClN,EAAG6M,GACxC,IAAM0T,EAAMF,EAAcxT,GAC1B,OAAOwT,EAAchO,OAAM,SAACmO,EAAKC,GAAN,OAAYF,EAAI1Y,KAAO2Y,EAAI1Y,UAExD,GAAIwY,EAAYzf,OAASwf,EAAcxf,OAAQ,OAAOgH,GAAAA,GAAAA,WAAA,WAAOyY,IAC7D,MAEF,IAAK,MACH,IAAMA,EAAc/D,EAAEE,SAASvP,QAAO,SAAClN,EAAG6M,GACxC,IAAM0T,EAAMF,EAAcxT,GAC1B,OAAOwT,EAAchO,OAAM,SAAAmO,GAAG,OAAID,EAAIzY,KAAO0Y,EAAI3Y,UAEnD,GAAIyY,EAAYzf,OAASwf,EAAcxf,OAAQ,OAAOiH,GAAAA,GAAAA,WAAA,WAAOwY,IAIjE,OAAO/D,KACN,SAAAA,GAAC,OAAIA,KAEV,SAASyD,GAAYU,GACnB,IAAMhC,EAAoB,GAS1B,OARAgC,EAAOrD,SAAQ,SAAAsD,GACbte,OAAOC,QAAQqe,GAAOtD,SAAQ,YAAmB,IAAD,eAAhB5d,EAAgB,KAAX3B,EAAW,KAC1C4gB,EAAOjf,IACTif,EAAOjf,GAAKoI,KAAO/J,EAAM+J,IACzB6W,EAAOjf,GAAKqI,KAAOhK,EAAMgK,KACpB4W,EAAOjf,IAAP,WAAmB3B,SAGvB4gB,EAET,SAASoB,GAAgBzE,GACvB,IAAMqD,EAAoB,GAe1B,OAdIrD,EAAKxa,SACPwB,OAAOoG,KAAK4S,EAAK,GAAG3P,QACjBwB,QAAO,SAAAzN,GAAG,OAAI4b,EAAKhJ,OAAM,SAAAmN,GAAG,OAAIA,EAAI9T,OAAOjM,SAC3C4d,SAAQ,SAAA5d,GAAG,OAAIif,EAAOjf,GAAO,CAAEoI,IAAKwT,EAAK,GAAG3P,OAAOjM,GAAMqI,IAAKuT,EAAK,GAAG3P,OAAOjM,OAChF4b,EAAKgC,SAAQ,YACX,IAD4B,IAAd3R,EAAa,EAAbA,OACd,MAA2BrJ,OAAOC,QAAQoJ,GAA1C,eAAmD,CAA9C,sBAAOjM,EAAP,KAAY3B,EAAZ,KACE4gB,EAAOjf,IAENif,EAAOjf,GAAKqI,IAAMhK,IAAO4gB,EAAOjf,GAAKqI,IAAMhK,GAC3C4gB,EAAOjf,GAAKoI,IAAM/J,IAAO4gB,EAAOjf,GAAKoI,IAAM/J,IAH/B4gB,EAAOjf,GAAO,CAAEoI,IAAK,EAAGC,IAAKhK,QAQ9C4gB,EAMF,SAASyB,GAAiBtG,EAAkB+G,GACjD,IAAMD,EAAQ,IAAI3C,IA+ClB,OA7CAP,EAAAA,GAAAA,IAAa5D,GAAO,SAAA7Z,OAAU,SAAAuc,GAAM,IAAD,EAG7BnJ,EAFIoJ,EAAcD,EAAdC,UACFC,EAAWF,EAAEE,SAASjd,KAAI,SAAA8d,GAAE,OAAIqD,EAAMhX,IAAI2T,MAEhD,OAAQd,GACN,IAAK,OACH,GAAkB,QAAdD,EAAE/S,KAAK,GACT,MAAM,IAAIqX,MAAJ,6BAAgCtE,EAAE/S,KAAlC,2BACR4J,EAAO,UAAGwN,EAAMrE,EAAE/S,KAAK,WAAhB,QAAuB,CAAE3B,IAAK,EAAGC,IAAK,GAC7C,MACF,IAAK,QAASsL,EAAU0N,GAAc,CAACvE,EAAEze,QAAS,MAClD,IAAK,MAAO,IAAK,MAAO,IAAK,MAC3BsV,EAAU,CACRvL,IAAKkZ,GAAAA,GAAcvE,GAAWC,EAASjd,KAAI,SAAAyc,GAAC,OAAIA,EAAEpU,QAClDC,IAAKiZ,GAAAA,GAAcvE,GAAWC,EAASjd,KAAI,SAAAyc,GAAC,OAAIA,EAAEnU,SACjD,MACL,IAAK,MAAOsL,EAAU,CACpBvL,IAAKkZ,GAAAA,GAAcvE,GAAW,CAACC,EAAS,GAAG3U,MAC3CA,IAAKiZ,GAAAA,GAAcvE,GAAW,CAACC,EAAS,GAAG5U,OAC1C,MACH,IAAK,MAAOuL,EAAUqJ,EAASuE,QAAO,SAAC9C,EAAM9K,GAAP,OAAmB0N,GAAc,CACrE5C,EAAKrW,IAAMuL,EAAQvL,IAAKqW,EAAKrW,IAAMuL,EAAQtL,IAC3CoW,EAAKpW,IAAMsL,EAAQvL,IAAKqW,EAAKpW,IAAMsL,EAAQtL,SACxC,MACL,IAAK,YACqCsL,EAApCqJ,EAAS,GAAG5U,KAAO4U,EAAS,GAAG3U,IAAe2U,EAAS,GAClDA,EAAS,GAAG3U,IAAM2U,EAAS,GAAG5U,IAAe4U,EAAS,GAChDqE,GAAc,GAAI,CAACrE,EAAS,GAAIA,EAAS,KACxD,MACF,IAAK,WACH,cAAeA,EAAf,GAAOR,EAAP,KAAUgF,EAAV,KAAyBC,EAAM,CAAErZ,IAAKoU,EAAEpU,IAAMoZ,EAAEpZ,IAAKC,IAAKmU,EAAEnU,IAAMmZ,EAAEnZ,KAElEsL,EADE8N,EAAIrZ,KAAO,GAAKqZ,EAAIpZ,KAAO,EAClBmU,EAAEpU,KAAO,GAAKoU,EAAEnU,KAAO,EAAK,CAAED,IAAKsZ,IAAKrZ,IAAKqZ,KAAQ,CAAEtZ,KAAMuQ,EAAAA,EAAUtQ,IAAKsQ,EAAAA,GAG7E0I,GAAc,CACtB7E,EAAEpU,IAAMqZ,EAAIrZ,IAAKoU,EAAEpU,IAAMqZ,EAAIpZ,IAC7BmU,EAAEnU,IAAMoZ,EAAIrZ,IAAKoU,EAAEnU,IAAMoZ,EAAIpZ,MAEjC,MAEF,SAAS6V,EAAAA,GAAAA,IAAkBnB,GAE7BmE,EAAMle,IAAI8Z,EAAGnJ,MAERuN,EAET,SAASG,GAAcpV,GAAsE,IAA3C0V,EAA0C,uDAAZ,GACxEtZ,EAAMuZ,KAAKvZ,IAAL,MAAAuZ,MAAI,QAAQ3V,GAAR,gBAAmB0V,EAAS5hB,KAAI,SAAAyc,GAAC,OAAIA,EAAEnU,UACjDD,EAAMwZ,KAAKxZ,IAAL,MAAAwZ,MAAI,QAAQ3V,GAAR,gBAAmB0V,EAAS5hB,KAAI,SAAAyc,GAAC,OAAIA,EAAEpU,UACvD,MAAO,CAAEA,IAAAA,EAAKC,IAAAA,GAiBT,SAASwZ,GAAYC,EAAmBC,GAC7C,OAAOD,EAAOhf,SAAQ,SAAA0Z,GAAC,OAAIA,KAAGvZ,MAAK,SAAC0C,EAAGC,GAAJ,OAAUA,EAAEvH,MAAQsH,EAAEtH,SAAO2jB,MAAM,EAAGD,GAEpE,SAASE,GAAUC,GAGxB,IAFA,IAAIC,EAAQ,IACRnZ,EAAO,IAAIuU,IAAI2E,EAAMpf,SAAQ,SAAA0Z,GAAC,OAAI5Z,OAAOqJ,OAAOuQ,GAAGzc,KAAI,SAAAS,GAAC,OAAIohB,KAAKQ,MAAM5hB,EAAE6hB,KAAQF,UAC9EnZ,EAAK2B,KAFuC,MAGjDwX,GAHmC,EAInCnZ,EAAO,IAAIuU,KAAI,QAAIvU,GAAMjJ,KAAI,SAAAC,GAAG,OAAI4hB,KAAKQ,MAAMpiB,EAJZ,OAMrC,IAPqD,EAO/Cif,EAAmB,GAP4B,WAQlCiD,GARkC,IAQrD,2BACE,QADSG,EACT,cAAoBzf,OAAOqJ,OAAOoW,GAAlC,eAAyC,CAApC,IAAMC,EAAK,KACR9F,EAAIoF,KAAKQ,MAAME,EAAMD,KAAQF,GAASA,IACvClD,EAAOzC,IAAMyC,EAAOzC,GAAIne,MAAQikB,EAAMjkB,SACzC4gB,EAAOzC,GAAK8F,IAZmC,8BAcrD,OAAOrD,EAQF,SAAUzD,GAAmB+G,EAAkCC,GAA/D,yFACCC,GAAU3D,EAAAA,GAAAA,IAAU0D,EAASvW,QAAQ,SAAAA,GAAM,OAAI,IAAIsR,IAAItR,EAAOlM,KAAI,SAAAS,GAAC,OAAIA,EAAEwC,WAD1E,WAE6Buf,GAF7B,yDAEmB9U,EAFnB,qBAGE,sBAAO2R,EAAP,KAAatC,EAAb,KACG4F,EAAYD,EAAQrD,GAC1B,OAAQtC,EAAE6F,MACR,IAAK,WAAY,IAAI,QAAI7F,EAAE8F,MAAMhQ,OAAM,SAAAzF,GAAC,OAAKuV,EAAU5E,IAAI3Q,MAAK,6BAAsB,MACtF,IAAK,UAAW,IAAI,QAAIuV,GAAW9P,OAAM,SAAAzF,GAAC,OAAI2P,EAAE8F,KAAK9E,IAAI3Q,MAAM,+BAPhE,MAGqBvK,OAAOC,QAAQ4K,GAHpC,4JAWH,OAXG,UAWGA,EAXH,sHAAAqP,IAAA,0EAcA,SAAS+F,GAAmB/G,GACjC,OAAO,IAAIyB,IAAa,OAATzB,QAAS,IAATA,GAAAA,EAAWta,SAAS,GAC/Bsa,EAAUta,SAAS,GAAK,CAAC,EAAG,GAAK,CAAC,EAAG,EAAG,EAAG,GAClC,OAATsa,QAAS,IAATA,GAAAA,EAAWta,SAAS,GAAK,CAAC,EAAG,EAAG,EAAG,GAAK,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAGvD,SAAUia,GAAWK,EAA4B0G,GAAjD,YAaIM,EAUAC,EAvBJ,YAuDKC,EAvDL,6EA8BL,IAyBUA,EAvDL,SAuDWC,GAvDX,sBAmEOD,EA6BAE,EAhGP,uEAgGOA,EAhGP,SAgGkB9V,GAhGlB,uGAiGK+V,EAAYC,EAAShiB,OAASgM,EAAGiW,EAA6B,GAAIC,EAA4B,GAAIC,EAA6B,GACjIC,EAAW,EAlGd,WAmGiBf,GAnGjB,0BAmGUzf,EAnGV,QAoGOygB,EAAaC,EAAc1gB,GAAMsZ,EAAQqH,EAAO3gB,GACtD,IAAKygB,EAAY,kBACbvC,EAAAA,GAAAA,IAAM,EAAGiC,GAAWvQ,OAAM,SAAAoO,GAAC,OAAKyC,EAAW3F,IAAIxB,EAAQ0E,MAAKuC,EAASK,KAAK5gB,GACpEygB,EAAW3F,IAAIxB,IAIhB4E,EAAAA,GAAAA,IAAM,EAAGiC,GAAW5G,MAAK,SAAAyE,GAAC,OAAKyC,EAAW3F,IAAIxB,EAAQ0E,OAAKqC,EAASO,KAAK5gB,IAHhFwgB,IAAY,QAAIC,GAAYI,MAAK,SAAArH,GAAC,OAAIA,EAAIF,KAAUA,EACpDgH,EAAQM,KAAK5gB,KAzGhB,0OAAA8Z,IAAA,0BA6GG0G,EAAWL,GA7Gd,sDA8GG/V,IAAMgW,EAAShiB,OA9GlB,iBA+GC,OA/GD,WA+GC,WAAW6d,GA/GZ,6CAkHGuE,IAAaL,EAlHhB,4BAmHmBG,GAnHnB,2DAsHG,OAHStgB,EAnHZ,QAoHG2gB,EAAO3gB,KACPic,EAAOE,EAAAA,GAAYiE,EAAShW,KAAO,CAAEuV,KAAM,WAAYC,KAAM,IAAIrF,IAAI,CAACva,KACtE,gBAAOkgB,EAAW9V,EAAI,GAAtB,SAtHH,QAuHGuW,EAAO3gB,KAvHV,wHAAA8Z,IAAA,uEA2HqBuG,EAAaC,GA3HlC,0CA8HC,OAHStgB,EA3HV,KA4HC2gB,EAAO3gB,KACPic,EAAOE,EAAAA,GAAYiE,EAAShW,KAAO,CAAEuV,KAAM,WAAYC,KAAM,IAAIrF,IAAI,CAACva,KACtE,gBAAOkgB,EAAW9V,EAAI,GAAtB,SA9HD,QA+HCuW,EAAO3gB,KA/HR,oCAkID,OADAic,EAAOE,EAAAA,GAAYiE,EAAShW,KAAO,CAAEuV,KAAM,UAAWC,KAAM,IAAIrF,IAAJ,UAAY+F,EAAYC,EAAaF,KACjG,gBAAOH,EAAW9V,EAAI,GAAtB,SAlIC,2EAmEO4V,EAnEP,SAmEa5V,GAnEb,oFAoEGA,IAAM0W,EAAS1iB,OApElB,gBAqEQ,uBAAO8hB,EAAW,GAAlB,QArER,wDAuEiBT,GAvEjB,iIAuEUzf,EAvEV,SAwEK+gB,EAAKjG,IAAI9a,GAxEd,+DAyEO5B,EAAS0iB,EAAS1W,GAAGhM,OAAQqiB,EAAaC,EAAc1gB,GAC1DghB,EAAmB,GAEnBP,GAAeA,EAAW3F,IAAI1c,GA5EnC,sBA8EG4iB,GAAmB,WAAC9C,EAAAA,GAAAA,IAAM9f,EAAS,EAAG,GAAGyiB,MAAK,SAAA3c,GAAC,OAAIuc,EAAW3F,IAAI5W,aAA/C,QAAsD,GAAK9F,GACvD6iB,GA/E1B,4DAuFC,OALAF,EAAKpG,IAAI3a,GACT2gB,EAAO3gB,GAAO8gB,EAAS1W,GAAGhM,OAC1B0iB,EAAS1W,GAAGwQ,SAAQ,SAAAoD,GAAC,OAAI/B,EAAOE,EAAAA,GAAY6B,IAAM,CAAE2B,KAAM,WAAYC,KAAM,IAAIrF,IAAI,CAACva,QACrFihB,GAAkBD,EAElB,gBAAOhB,EAAM5V,EAAI,GAAjB,SAvFD,QAyFC6W,GAAkBD,EAClBL,EAAO3gB,GAAO,EACd+gB,EAAKG,OAAOlhB,GA3Fb,gUAAA8Z,IAAA,4FAmEOkG,GAnEP,kBAgGOE,GAxCJa,EAA4B,IAAIxG,IAClCuG,EAAuB,GAAIV,EAAqB,GAzDjD,WA0DaH,GA1Db,IA0DH,2BAAW7V,EAAY,QACrB0W,EAASF,KAAK,IACJ,IAANxW,EAASgW,EAASQ,KAAKE,EAAS1iB,OAAS,GACxC0iB,EAAS1W,GAAGwW,KAAKE,EAAS1iB,OAAS,GA7DvC,0BAAA0b,IAoIH,OArEAgH,EAAWA,EAASrW,QAAO,SAAAjN,GAAC,OAAIA,EAAEY,UAAQ6B,MAAK,SAAC0C,EAAGC,GAAJ,OAAUA,EAAExE,OAASuE,EAAEvE,UAClE6iB,EAAiBb,EAAShiB,OAoE9B,gBAAO4hB,EAAM,GAAb,SApIG,yCAuBID,EAvBJ,SAuBiBE,EAAiBkB,GACrC,KAAIjD,EAAAA,GAAAA,IAAMiD,EAAY,EAAG,GAAG5H,MAAK,SAAAnP,GAAC,OAAiB,IAAb6V,EAAM7V,MAI5C,OAFA6V,GAAK,QAAOA,IACNkB,GAAa,EACZlB,EAAM1B,QAAO,SAAC5b,EAAGC,GAAJ,OAAc,EAAJD,EAAQC,IAAG,IAflCkd,EAbJ,SAamBnP,EAAmBkM,EAAmBuD,GAC5D,GAAuB,IAAnBzP,EAAQvS,OAAZ,CADgF,iBAMhEye,GANgE,yBAMrEzS,EANqE,QAM1D0V,EAAe,GAAD,gBAAKnP,GAAL,CAAcvG,IAAIyS,EAAMuD,EAAS3V,QAAO,SAAAuT,GAAC,OAAIA,IAAM5T,OAAvF,2BAAsB,IAN0D,8BAOhF0V,EAAe,GAAD,gBAAKnP,GAAL,CAAcA,EAAQvS,SAAS,IAAImc,IAAJ,mBAAYsC,GAAZ,CAAkBlM,EAAQvS,UAAzD,mBAAuEgiB,GAAvE,CAAiFzP,EAAQvS,eALjGgjB,EAAgBtG,IAAIsF,EAAShiB,SAC/BijB,EAAOT,KAAKjQ,IAhBb,kBAuDKqP,GA5CJP,GAXD,QAWe,IAAIlF,IAAIiF,IAAY4B,EAAkBvB,GAAmB/G,EAAU4D,SACnF2E,EAAqB,GAUzBvB,EAAe,CAAC,GAAI,IAAIvF,IAAI,CAAC,IAAK,CAAC,IAtB9B,WA8BI4G,GACP,IA/BG,EA+BGX,EAAgC,IAAIjF,IA/BvC,WAgCiB8F,GAhCjB,IAgCH,2BAA4B,CAAC,IAAD,EAAjBpB,EAAiB,QACpB5D,EAAK0D,EAAaE,EAAOkB,QACpBniB,IAAPqd,GACJmE,EAASxgB,IAAIqc,GAAI,UAACmE,EAAStZ,IAAImV,UAAd,QAAqB,IAAI9B,IAAI0F,EAAMjB,MAAM,EAAGmC,IAAYxZ,KAAO,GAAK,IAnCpF,0BAAAmS,IAAA,iBAqC2B0G,EAAS3gB,WArCpC,8CAqCSwc,EArCT,KAsCD,GAAkB,IAtCjB,KAsCoB,CACnB,IAAM4D,GAAK,QAAOoB,EAAOR,MAAK,SAAAZ,GAAK,OAAIF,EAAaE,EAAOkB,KAAe9E,MAC1E4D,EAAMkB,GAAa,EACnBE,EAASA,EAAO5W,QAAO,SAAAwV,GAAK,OAAIF,EAAaE,EAAOkB,KAAe9E,KACnEgF,EAAOT,KAAKX,KALhB,2BAAmD,IArChD,0BAAAnG,MA8BIqH,EAAY,EAAGA,GAAa,EAAGA,IAAc,EAA7CA,GAmBHG,EAAW,CAAE3B,KAAM,UAAoBC,KAAM,IAAIrF,KACjD0B,GAAwBC,EAAAA,GAAAA,GAAaC,EAAAA,IAAa,SAAA5e,GAAC,OAAI+jB,KAEvDX,GApDD,qBAoDe7E,EAAAA,GAAAA,IAAUhD,GAAW,SAAAvb,GAAC,OAAI,OAAO2e,EAAAA,GAAAA,GAAauD,GAAS,SAAAliB,GAAC,OAAI,MAC1EmjB,GAAgB5E,EAAAA,GAAAA,IAAUhD,EAAW+G,IArDtC,WAsIewB,GAtIf,2DAsIuB,OAAjBpB,EAtIN,QAsIuB,gBAAOD,EAAMC,GAAb,SAtIvB,wHAAAnG,IAAA,2E,gECxXQ,SAASyH,GAAT,GAAsG,IAAD,EAAzEC,EAAyE,EAAzEA,OAAQC,EAAiE,EAAjEA,UAAiE,IAAtDnY,WAAAA,OAAsD,aAAlCoY,iBAAAA,OAAkC,SAC5GC,GAAQpiB,EAAAA,EAAAA,IAAW,kBAAMC,GAAAA,EAAAA,IAAkBgiB,KAAS,CAACA,IAC3D,IAAKG,EAAO,OAAO,KAEnB,IAAMC,EAAWF,EAAgB,UAAGC,EAAME,kBAAkBJ,UAA3B,aAAG,EAAoChX,QAAO,SAAAD,GAAO,MAAI,WAAYA,KAAWmX,EAAME,kBAAkBJ,GACzI,OAAO,SAAC/gB,EAAA,EAAD,CAAK4D,QAAQ,OAAOoG,cAAc,SAAlC,SACJkX,GAAW,SAAC7X,GAAA,EAAD,CAAiBC,SAAU4X,EAAUtY,WAAYA,IAAiB,O,oGCdnE,SAASwY,GAAgBC,GACtC,IAAQtS,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAAwChM,EAAAA,EAAAA,WAAS,kBAAMgM,EAASuS,cAAc9a,IAAI6a,MAAlF,eAAOE,EAAP,KAAqBC,EAArB,KAOA,OANA9d,EAAAA,EAAAA,YAAU,kBAAM8d,EAAgBzS,EAASuS,cAAc9a,IAAI6a,MAAgB,CAACtS,EAAUsS,KACtF3d,EAAAA,EAAAA,YAAU,kBACRqL,EAASuS,cAAcG,OAAOJ,GAAc,SAAClL,EAAG/J,EAAGtP,GAAP,MAAmB,WAANsP,GAAkBoV,EAAgB1kB,QAC3F,CAACukB,EAAcG,EAAiBzS,IAG3B,CAAEwS,aAAcA,EAA8BG,sBAFxBre,EAAAA,EAAAA,cAAY,SAAC4B,GAAD,OAAuCoc,GAAgBtS,EAASuS,cAAchiB,IAAI+hB,EAAcpc,KAAS,CAACoc,EAActS,KCiBpJ,SAAS4S,GAAT,GAAmE,IAAD,IAArC9e,EAAqC,EAArCA,SAClC9D,GAAMC,EAAAA,EAAAA,GAAe,CAAC,0BAA2B,UAAjDD,EACF6iB,GAAcjc,EAAAA,EAAAA,YAAWK,EAAAA,GACvB+I,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAA6EpJ,EAAAA,EAAAA,YAAWC,EAAAA,GAAxF,IAAQC,UAAkBwb,EAA1B,EAAqB/kB,IAAmB+I,EAAxC,EAAwCA,YAAeS,EAAvD,EAAuDA,kBACvD,EAAoEsb,GAAgBC,GAA5DQ,EAAxB,EAAQN,aAAgBM,gBAAmBH,EAA3C,EAA2CA,qBAC3C,GAAwB3e,EAAAA,EAAAA,WAAS,GAAjC,eAAOiL,EAAP,KAAa8T,EAAb,KACMC,GAAS1e,EAAAA,EAAAA,cAAY,kBAAMye,GAAQ,KAAO,CAACA,IAC3C7T,GAAU5K,EAAAA,EAAAA,cAAY,kBAAMye,GAAQ,KAAQ,CAACA,IAC7CljB,GAAiBC,EAAAA,EAAAA,IAAW,kBAAMC,GAAAA,EAAAA,SAAsB,IAE9D,GAA+BkjB,EAAAA,GAAAA,KAA/B,eAAOC,EAAP,KAAgBC,EAAhB,MACAxe,EAAAA,EAAAA,YAAU,kBAAMqL,EAASmJ,KAAKiK,UAAUD,KAAc,CAACnT,EAAUmT,IAEjE,IAAME,GAAUhmB,EAAAA,EAAAA,UAAQ,kBAAMwC,GAAkBM,OAAOC,QAAQL,GAAAA,EAAAA,kBAAgCF,IAC5FyjB,UACAjjB,SAAQ,qCACR2K,QAAO,SAAAzN,GAAG,OAAKA,EAAIwB,SAAS,gBAC/B,CAACc,IACK0jB,GAAelmB,EAAAA,EAAAA,UAAQ,WAC3B,IAAMkmB,EAA8DF,EAChEljB,OAAOoc,YAAY8G,EAAQ/lB,KAAI,SAAA8Z,GAAC,MAAI,CAACA,EAAGjX,OAAOoc,YAAYG,EAAAA,GAAAA,KAAgB,SAAA8G,GAAE,MAAI,CAACA,EAAI,YACtF,GAEJ,OADAxT,EAASmJ,KAAK3P,OAAOlM,KAAI,SAAAggB,GAAG,OAAIiG,EAAajG,EAAIyE,SAAWwB,EAAajG,EAAIyE,QAASzE,EAAImG,cACnFP,GAAWK,IACjB,CAACL,EAASlT,EAAUqT,IACjBK,GAAgBrmB,EAAAA,EAAAA,UAAQ,kBAAMgmB,EAChCA,EAAQ7iB,MAAK,SAAC0C,EAAGC,GACjB,IAAMwgB,EAASC,GAAYL,EAAargB,IAClC2gB,EAASD,GAAYL,EAAapgB,IACxC,OAAIwgB,EAASE,EAAe,EACxBF,EAASE,GAAgB,EACtB,KAEP,KACJ,CAACN,EAAcF,IAETS,IAAgB,UAAChB,EAAgB7F,eAAjB,OAAC,EAAyBle,SAAS,IACnDglB,IAAgB,UAACjB,EAAgB7F,eAAjB,OAAC,EAAyBle,SAAS,IAEzD,GAA+C1B,EAAAA,EAAAA,UAAQ,iBAAO,CAC5D2mB,OAAQN,EAAc1Y,QAAO,SAAAoM,GAAC,cAAI,UAAC0L,EAAgB1L,UAAjB,OAAC,EAAoBrY,SAAS,OAAIJ,OACpEslB,OAAQP,EAAc1Y,QAAO,SAAAoM,GAAC,cAAI,UAAC0L,EAAgB1L,UAAjB,OAAC,EAAoBrY,SAAS,OAAIJ,OACpEulB,SAAUR,EAAc1Y,QAAO,SAAAoM,GAAC,uBAAI0L,EAAgB1L,UAApB,aAAI,EAAoBrY,SAAS,MAAIJ,OACrEwlB,SAAUT,EAAc1Y,QAAO,SAAAoM,GAAC,uBAAI0L,EAAgB1L,UAApB,aAAI,EAAoBrY,SAAS,MAAIJ,UACnE,CAAC+kB,EAAeZ,IALZkB,EAAR,EAAQA,OAAQC,EAAhB,EAAgBA,OAAQC,EAAxB,EAAwBA,SAAUC,GAAlC,EAAkCA,SAM5BC,IAAoB/mB,EAAAA,EAAAA,UAAQ,kBAC/B8C,OAAOoG,KAAKD,GAAc0E,QAAO,SAAAoM,GAAC,OACjCiN,EAAAA,GAAAA,SAAyBjN,IAA+D,IAAvCjX,OAAOoG,KAAKD,EAAY8Q,IAAIzY,UAAcA,SAC3F,CAAC2H,IACCge,IAAqBjnB,EAAAA,EAAAA,UAAQ,2BAAC,WAC/BwlB,GAD8B,IAEjC7b,KAAM,IAAIud,GAAAA,GAAJ,oBAAgB1B,EAAY7b,KAAKA,KAAK,IAAtC,IAA0Cwd,QAAQ/H,EAAAA,GAAAA,GAAa4H,EAAAA,IAAiB,SAAAvmB,GAAC,OAAIwe,EAAAA,GAAAA,IAAS,aAAO/c,OACzG,CAACsjB,IACC4B,IAAgBngB,EAAAA,EAAAA,cAAY,WAChC,IAAMogB,EAAevkB,OAAOoc,YAAYpc,OAAOC,QAAQkG,GAAa0E,QAAO,+BAAEoM,EAAF,iBAAaiN,EAAAA,GAAAA,SAAyBjN,OACjHrQ,EAAkB,CAAET,YAAaoe,MAChC,CAACpe,EAAaS,IACX4d,IAAkBrgB,EAAAA,EAAAA,cACtB,SAACsgB,GAAoC,IAApBC,IAAmB,yDAC5BC,GAAmB1d,EAAAA,GAAAA,IAAU0b,GACnCY,EAAcvI,SAAQ,SAAA/D,GAAM,IAAD,EACrByN,EAASC,EAAiB1N,GAAjB,6BAA2B0N,EAAiB1N,UAA5C,QAAkD,IAAlD,CAAuDwN,IAC3DE,EAAiB1N,KAAI0N,EAAiB1N,GAAK0N,EAAiB1N,GAAGpM,QAAO,SAAAyN,GAAC,OAAIA,IAAMmM,SAE5FjC,EAAqB,CAAEG,gBAAiBgC,MAE1C,CAACpB,EAAeZ,EAAiBH,IAGnC,OAAO,iCACL,UAACtS,EAAA,EAAD,CAAWlP,GAAI,CAAE0D,QAAS,QAA1B,WACE,UAACuF,EAAA,EAAD,CAAajJ,GAAI,CAAEmE,SAAU,GAA7B,WACE,SAACkG,EAAA,EAAD,WACE,4BAASxL,EAAT,+CAEF,UAACsW,GAAA,EAAD,CAAOf,QAAS,EAAhB,WACE,UAAC/J,EAAA,EAAD,WAAaxL,EAAb,oDAAyC,UAACyI,EAAA,EAAD,CAASjK,MAAO4lB,GAAoB,UAAY,YAAhD,UAA8DA,GAA9D,IAAkFpkB,EAAU,+BACrI,UAACwL,EAAA,EAAD,WAAaxL,EAAb,uCAA4B,UAACyI,EAAA,EAAD,CAASjK,MAAM,UAAf,UAA0BwlB,EAA1B,KAAkC,SAAC,KAAD,CAAiBvkB,KAAMslB,GAAAA,IAAaC,UAAU,UAAhF,IAA4FhlB,EAAU,6BAAqCkkB,GAAY,QAASA,IAAY,UAACzb,EAAA,EAAD,CAASjK,MAAM,YAAf,UAA4B0lB,EAA5B,KAAsC,SAAC,KAAD,CAAiBzkB,KAAMwlB,GAAAA,IAAOD,UAAU,UAA9E,IAA0FhlB,EAAU,gCAC5S,UAACwL,EAAA,EAAD,WAAaxL,EAAb,uCAA4B,UAACyI,EAAA,EAAD,CAASjK,MAAM,UAAf,UAA0BylB,EAA1B,KAAkC,SAAC,KAAD,CAAiBxkB,KAAMslB,GAAAA,IAAaC,UAAU,UAAhF,IAA4FhlB,EAAU,6BAAqCmkB,IAAY,QAASA,KAAY,UAAC1b,EAAA,EAAD,CAASjK,MAAM,YAAf,UAA4B2lB,GAA5B,KAAsC,SAAC,KAAD,CAAiB1kB,KAAMwlB,GAAAA,IAAOD,UAAU,UAA9E,IAA0FhlB,EAAU,gCAC5S,UAACwL,EAAA,EAAD,WAAaxL,EAAb,kDAAuC,UAACyI,EAAA,EAAD,CAASjK,MAAOslB,EAAgB,UAAY,YAA5C,WAAyD,SAAC,KAAD,CAAiBrkB,KAAMqkB,EAAgBiB,GAAAA,IAAcE,GAAAA,IAAOD,UAAU,UAA/H,IAA2IlB,EAAgB9jB,EAAU,wBAA0B,kBACtO,UAACwL,EAAA,EAAD,WAAaxL,EAAb,kDAAuC,UAACyI,EAAA,EAAD,CAASjK,MAAOulB,EAAgB,UAAY,YAA5C,WAAyD,SAAC,KAAD,CAAiBtkB,KAAMskB,EAAgBgB,GAAAA,IAAcE,GAAAA,IAAOD,UAAU,UAA/H,IAA2IjB,EAAgB/jB,EAAU,wBAA0B,wBAI1O,SAACgI,EAAA,EAAD,CAAQI,QAAS4a,EAAQlf,SAAUA,EAAUtF,MAAM,OAAO2C,GAAI,CAAEgH,aAAc,GAA9E,UACE,SAAC+c,GAAA,EAAD,SAGHrlB,IAAkB,SAACmP,GAAA,EAAD,CAAcC,KAAMA,EAAMC,QAASA,EAAnC,UAA6C,UAAClF,EAAA,EAAD,YAC9D,UAACI,EAAA,EAAD,CAAajJ,GAAI,CAAE0D,QAAS,OAAQsB,IAAK,EAAGmO,eAAgB,iBAA5D,WACE,SAAC9I,EAAA,EAAD,CAAYlN,QAAQ,KAApB,SAA2B0B,EAA3B,6CACA,SAACoP,EAAA,EAAD,CAAahH,QAAS8G,QAExB,SAACvG,EAAA,EAAD,KACA,UAACyB,EAAA,EAAD,YACE,SAACiG,EAAA,EAAD,CAAWlP,GAAI,CAAEwO,GAAI,GAArB,UAA0B,UAACvF,EAAA,EAAD,YACxB,UAACnJ,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAzB,WACE,SAACqF,EAAA,EAAD,WAAY,4BAASxL,EAAT,6DACZ,SAACwL,EAAA,EAAD,CAAYrK,GAAI,CAAEmE,SAAU,GAA5B,UAAiC,UAACmD,EAAA,EAAD,CAASjK,MAAO4lB,GAAoB,UAAY,YAAhD,UAA8DA,GAA9D,IAAkFpkB,EAAU,+BAC7H,SAACgI,EAAA,EAAD,CAAQE,KAAK,QAAQE,QAASqc,GAAejmB,MAAM,QAAQ6J,WAAW,SAACsL,GAAA,EAAD,IAAtE,SAAmF3T,EAAnF,8DAEF,SAACwL,EAAA,EAAD,UAAaxL,EAAb,+DAEF,SAACqQ,EAAA,EAAD,CAAWlP,GAAI,CAAEwO,GAAI,GAArB,UAA0B,UAACvF,EAAA,EAAD,YACxB,SAACoB,EAAA,EAAD,CAAYrK,GAAI,CAAEmE,SAAU,GAA5B,UAAiC,6BAC/B,UAAC6f,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,wCAArB,4BAA4E,UAAC,KAAD,CAAW5mB,MAAM,UAAjB,qBAAkC,SAAC,KAAD,CAAiBiB,KAAMslB,GAAAA,IAAaC,UAAU,aAA5J,OAAqL,UAAC,KAAD,CAAWxmB,MAAM,YAAYF,QAAQ,QAArC,sBAAqD,SAAC,KAAD,CAAiBmB,KAAMwlB,GAAAA,IAAOD,UAAU,qBAEpR,SAACxZ,EAAA,EAAD,WAAY,UAAC2Z,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,wCAArB,4GAA2J,kCAA3J,oBAA6L,kCAA7L,6BACZ,SAAC5Z,EAAA,EAAD,WAAY,UAAC2Z,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,uCAArB,WAA4D,6BAAQ,UAAC,KAAD,CAAW5mB,MAAM,YAAYF,QAAQ,QAArC,uBAAsD,SAAC,KAAD,CAAiBmB,KAAMwlB,GAAAA,IAAOD,UAAU,UAA9F,cAApE,iCAAoO,+BAAQ,SAAC,KAAD,CAAWxmB,MAAM,YAAYF,QAAQ,QAArC,gBAAR,SAApO,SAAwT,+BAAQ,SAAC,KAAD,CAAWE,MAAM,YAAYF,QAAQ,QAArC,iBAAR,QAAxT,UACZ,SAACkN,EAAA,EAAD,WAAY,UAAC2Z,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,uCAArB,WAA4D,6BAAQ,UAAC,KAAD,CAAW5mB,MAAM,YAAYF,QAAQ,QAArC,uBAAsD,SAAC,KAAD,CAAiBmB,KAAMwlB,GAAAA,IAAOD,UAAU,UAA9F,cAApE,iCAAoO,+BAAQ,SAAC,KAAD,CAAWxmB,MAAM,YAAYF,QAAQ,QAArC,kBAAR,OAApO,SAAwT,6BAAQ,SAAC,KAAD,CAAWE,MAAM,YAAYF,QAAQ,QAArC,qBAAhU,UACZ,SAACkN,EAAA,EAAD,WAAY,UAAC2Z,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,wCAArB,WAA6D,6BAAQ,UAAC,KAAD,CAAW5mB,MAAM,YAAYF,QAAQ,QAArC,uBAAsD,SAAC,KAAD,CAAiBmB,KAAMwlB,GAAAA,IAAOD,UAAU,UAA9F,kBAArE,6CAAqP,oCAAU,SAAC,KAAD,CAAWxmB,MAAM,YAAYF,QAAQ,QAArC,oBAA/P,SAAyU,qCAAW,SAAC,KAAD,CAAWE,MAAM,YAAYF,QAAQ,QAArC,mBAApV,UACZ,SAACkN,EAAA,EAAD,WAAY,UAAC2Z,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,wCAArB,WAA6D,6BAAQ,UAAC,KAAD,CAAW5mB,MAAM,YAAYF,QAAQ,QAArC,uBAAsD,SAAC,KAAD,CAAiBmB,KAAMwlB,GAAAA,IAAOD,UAAU,UAA9F,kBAArE,0CAAkP,6BAAQ,SAAC,KAAD,CAAWxmB,MAAM,YAAYF,QAAQ,QAArC,qBAA1P,eAEd,UAAC+W,GAAA,GAAD,CAAMC,WAAS,EAACuB,QAAS,CAAE9B,GAAI,EAAGqB,GAAI,GAAKjV,GAAI,CAAEwO,GAAI,GAAK4F,QAAS,EAAnE,WACE,SAACF,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAACsQ,GAAD,CAAwBC,OAAQ,EAAGC,SAAUvB,EAAQwB,WAAYtB,EAAUS,gBAAiBA,QAE9F,SAACtP,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAACsQ,GAAD,CAAwBC,OAAQ,EAAGC,SAAUtB,EAAQuB,WAAYrB,GAAUQ,gBAAiBA,QAE9F,SAACtP,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAAC1E,EAAA,EAAD,WACE,UAACjG,EAAA,EAAD,YACE,SAACoB,EAAA,EAAD,CAAYia,cAAY,EAAxB,UAAyB,6BAAQ,UAACN,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,2BAArB,WAAgD,UAAC,KAAD,CAAW5mB,MAAM,UAAjB,oBAAiC,SAAC,KAAD,CAAiBiB,KAAMslB,GAAAA,IAAaC,UAAU,aAA/H,OAAwJ,UAAC,KAAD,CAAWxmB,MAAM,YAAYF,QAAQ,QAArC,sBAAqD,SAAC,KAAD,CAAiBmB,KAAMwlB,GAAAA,IAAOD,UAAU,aAArP,0BACjC,UAAC/jB,EAAA,EAAD,CAAKE,GAAI,CAAE0D,QAAS,OAAQoG,cAAe,SAAU9E,IAAK,GAA1D,WACE,SAAC6B,EAAA,EAAD,CAAQC,WAAS,EAACG,QAAS,kBAAMua,EAAqB,CAAE/jB,KAAM,kBAAmBmjB,OAAQ,UAAW2D,IAAK,KAAMlnB,MAAOslB,EAAgB,UAAY,YAAazb,UAAYyb,GAA2C,SAACxb,GAAA,EAAD,KAA3B,SAACC,GAAA,EAAD,IAAyCod,SAAS,SAAC,KAAD,CAAiBlmB,KAAMqkB,EAAgBiB,GAAAA,IAAcE,GAAAA,IAAOD,UAAU,UAAnT,SAAgUhlB,EAAhU,gDACA,SAACgI,EAAA,EAAD,CAAQC,WAAS,EAACG,QAAS,kBAAMua,EAAqB,CAAE/jB,KAAM,kBAAmBmjB,OAAQ,UAAW2D,IAAK,KAAMlnB,MAAOulB,EAAgB,UAAY,YAAa1b,UAAY0b,GAA2C,SAACzb,GAAA,EAAD,KAA3B,SAACC,GAAA,EAAD,IAAyCod,SAAS,SAAC,KAAD,CAAiBlmB,KAAMskB,EAAgBgB,GAAAA,IAAcE,GAAAA,IAAOD,UAAU,UAAnT,SAAgUhlB,EAAhU,6DAMV,SAACqV,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAGsB,QAAS,CAAE9B,GAAI,EAAGqB,GAAI,GAAlD,SACGsN,EAAcpmB,KAAI,SAAAykB,GACjB,OAAO,SAAC6D,GAAD,CAA8B7D,OAAQA,EAAQG,MAAOriB,EAAekiB,GAASuC,mBAAoBA,GAAoBuB,UAAWtC,EAAaxB,IAAvHA,YAInC,SAACpZ,EAAA,EAAD,KACA,SAACyB,EAAA,EAAD,CAAajJ,GAAI,CAAEyX,GAAI,GAAvB,UACE,SAACxJ,EAAA,EAAD,CAAa0W,OAAK,EAAC1d,QAAS8G,cAKpC,SAASmW,GAAT,GAA0M,IAAxKE,EAAuK,EAAvKA,SAAUC,EAA6J,EAA7JA,WAAYF,EAAiJ,EAAjJA,OAAQX,EAAyI,EAAzIA,gBACtD3kB,GAAMC,EAAAA,EAAAA,GAAe,CAAC,0BAA2B,UAAjDD,EACR,OAAO,SAACqQ,EAAA,EAAD,WACL,UAACjG,EAAA,EAAD,YACE,UAACoB,EAAA,EAAD,CAAYia,cAAY,EAAxB,WAAyB,4BAASzlB,EAAE,SAAD,OAAUslB,EAAV,UAAnC,KAAoE,UAAC7c,EAAA,EAAD,CAASjK,MAAM,UAAf,UAA0B+mB,EAA1B,KAAoC,SAAC,KAAD,CAAiB9lB,KAAMslB,GAAAA,IAAaC,UAAU,UAAlF,IAA8FhlB,EAAU,6BAAqCwlB,GAAc,QAASA,IAAc,UAAC/c,EAAA,EAAD,CAASjK,MAAM,YAAf,UAA4BgnB,EAA5B,KAAwC,SAAC,KAAD,CAAiB/lB,KAAMwlB,GAAAA,IAAOD,UAAU,UAAhF,IAA4FhlB,EAAU,gCAC5V,UAACiB,EAAA,EAAD,CAAKE,GAAI,CAAE0D,QAAS,OAAQoG,cAAe,SAAU9E,IAAK,GAA1D,WACE,SAAC6B,EAAA,EAAD,CAAQC,WAAS,EAACnE,UAAW0hB,EAAYpd,QAAS,kBAAMuc,EAAgBW,GAAQ,IAAQ9mB,MAAM,UAAU6J,WAAW,SAAC,KAAD,CAAiB5I,KAAMslB,GAAAA,IAAaC,UAAU,UAAjK,SAA8KhlB,EAAE,wBAAD,OAAyBslB,EAAzB,WAC/K,SAACtd,EAAA,EAAD,CAAQC,WAAS,EAACnE,UAAWyhB,EAAUnd,QAAS,kBAAMuc,EAAgBW,GAAQ,IAAO9mB,MAAM,YAAY6J,WAAW,SAAC,KAAD,CAAiB5I,KAAMwlB,GAAAA,IAAOD,UAAU,UAA1J,SAAuKhlB,EAAE,0BAAD,OAA2BslB,EAA3B,kBAKhL,SAASM,GAAT,GAAsM,IAAD,MAA1K1D,EAA0K,EAA1KA,MAAOH,EAAmK,EAAnKA,OAAQuC,EAA2J,EAA3JA,mBAAoBuB,EAAuI,EAAvIA,UACpD7lB,GAAMC,EAAAA,EAAAA,GAAe,SAArBD,EAER,EAA+CqiB,IADFzb,EAAAA,EAAAA,YAAWC,EAAAA,GAAhDC,UAAavJ,KACbilB,EAAR,EAAQA,aAAcG,EAAtB,EAAsBA,qBAChBoD,EAAe,iBAAGvD,QAAH,IAAGA,GAAH,UAAGA,EAAcM,uBAAjB,aAAG,EAAgCf,UAAnC,QAA8C,GAC7DkC,GAAU8B,EAAgBhnB,SAAS,GACnCinB,GAAQ3oB,EAAAA,EAAAA,UAAQ,kBAAMumB,GAAYiC,KAAY,CAACA,IAG/CI,GAAe5oB,EAAAA,EAAAA,UAAQ,WAC3B,OAAK4mB,GAAU+B,EAAQ,EAAU,GAC1B7lB,OAAOoG,KAAK2b,EAAMgE,YAAYlb,QAAO,SAAAgX,GAAS,uBAAIE,EAAMgE,WAAWlE,UAArB,aAAI,EAA6BG,SAASrI,MAAK,SAAAqM,GAAG,MAAI,WAAYA,UACtH,CAACjE,EAAMgE,WAAYjC,EAAQ+B,IACxB9B,EAAW6B,EAAgBhnB,SAAS,GACpColB,EAAW4B,EAAgBhnB,SAAS,GAC1C,OAAO,SAACsW,GAAA,GAAD,CAAMG,MAAI,EAAcT,GAAI,EAA5B,UACL,UAAC1E,EAAA,EAAD,CAAWlP,GAAI,CAAEsL,OAAQ,OAAQ2Z,QAASJ,EAAQ,EAAI,WAAQzmB,GAA9D,WACE,UAAC0B,EAAA,EAAD,CAAK+jB,UAAS,eAAU9C,EAAM5hB,OAAO,GAAvB,QAAiCsE,MAAM,OAAOzD,GAAI,CAAE0D,QAAS,QAA3E,WACE,SAAC5D,EAAA,EAAD,CAAKD,UAAU,MAAMyN,IAAKyT,EAAMmE,WAAYllB,GAAI,CAAEsL,OAAQ,IAAK7H,MAAO,OAAQW,IAAK,MACnF,UAACtE,EAAA,EAAD,CAAKE,GAAI,CAAEmE,SAAU,EAAGJ,GAAI,EAAGL,QAAS,OAAQoG,cAAe,SAAUqJ,eAAgB,UAAzF,WACE,SAAC9I,EAAA,EAAD,CAAYlN,QAAQ,KAApB,mBAA0B4jB,EAAMra,YAAhC,QAAwC,MACxC,UAAC5G,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAzB,WACE,SAACqF,EAAA,EAAD,CAAYlN,QAAQ,YAApB,SAAiC4jB,EAAM5hB,OAAOhD,KAAI,SAACiM,EAAIoB,GAAL,OAAW,4BAAgBpB,EAAhB,KAAoB,SAAC,KAAD,CAAclI,MAAO,IAAzC,IAAgDsJ,EAAKuX,EAAM5hB,OAAO3B,OAAS,EAAK,KAAO,OAA5E4K,SAExE,SAACgC,GAAA,EAAD,CAAatF,OAAO,UAAChF,EAAA,EAAD,YAClB,SAACuK,EAAA,EAAD,WAAY,SAAC/C,EAAA,EAAD,CAASjK,MAAM,UAAf,SAA0BwB,EAA1B,iCACZ,SAACwL,EAAA,EAAD,WAAY,SAAC/B,GAAA,EAAD,CAAWF,GAAE,mBAAcwY,EAAd,QAA4BzY,MAAO,oBAC5D,UAACrI,EAAA,EAAD,CAAKqlB,WAAY,EAAGnlB,GAAI,CAAEilB,QAASL,EAAgBhnB,SAAS,GAAK,GAAM,GAAvE,WACE,SAACyM,EAAA,EAAD,WAAY,SAAC/C,EAAA,EAAD,CAASjK,MAAM,UAAf,SAA0BwB,EAA1B,iCACZ,SAACwL,EAAA,EAAD,WAAY,SAAC/B,GAAA,EAAD,CAAWF,GAAE,mBAAcwY,EAAd,QAA4BzY,MAAO,+BAIlE,SAACrI,EAAA,EAAD,CAAKE,GAAI,CAAE0D,QAAS,OAAQsB,IAAK,GAAjC,SAAuChG,OAAOC,QAAQylB,GAAWvoB,KAAI,+BAAEmmB,EAAF,KAAW5J,EAAX,YAAsB,SAACrO,EAAA,EAAD,CAA0BrK,GAAI,CAAEmE,SAAU,GAAKhH,QAAQ,YAAvD,UAAoE,UAACmK,EAAA,EAAD,CAAStH,GAAI,CAAEyD,MAAO,QAAUpG,MAAOqb,EAAQ,UAAY,YAA3D,WAAyE0M,EAAAA,GAAAA,IAAiB9C,GAAU5J,MAAvJ4J,eAGhH,UAAC5a,GAAA,EAAD,CAAa1H,GAAI,CAAE,kBAAmB,CAAEgH,aAAc,IAAOF,WAAS,EAAtE,UACG+d,GAAS,IAAK,SAAChe,EAAA,EAAD,CAAQK,UAAW6b,GAAW,SAAC3b,GAAA,EAAD,KAA2B,SAACD,GAAA,EAAD,IAAcF,QAAS,kBAAMua,EAAqB,CAAE/jB,KAAM,kBAAmBmjB,OAAAA,EAAQ2D,IAAK,KAAMlnB,MAAO0lB,EAAW,YAAc,UAAWyB,SAAS,SAAC,KAAD,CAAiBlmB,KAAMykB,EAAWe,GAAAA,IAAQF,GAAAA,IAAaC,UAAU,UAA9Q,SAA2RhlB,EAA3R,8BACdgmB,GAAS,IAAK,SAAChe,EAAA,EAAD,CAAQK,UAAW8b,GAAW,SAAC5b,GAAA,EAAD,KAA2B,SAACD,GAAA,EAAD,IAAcF,QAAS,kBAAMua,EAAqB,CAAE/jB,KAAM,kBAAmBmjB,OAAAA,EAAQ2D,IAAK,KAAMlnB,MAAO2lB,EAAW,YAAc,UAAWwB,SAAS,SAAC,KAAD,CAAiBlmB,KAAM0kB,EAAWc,GAAAA,IAAQF,GAAAA,IAAaC,UAAU,UAA9Q,SAA2RhlB,EAA3R,mCAGdimB,EAAatnB,SAAU,SAACsI,EAAA,WAAD,CAAsBrL,MAAO0oB,EAA7B,UACxB,SAACla,EAAA,EAAD,CAAajJ,GAAI,CAAE0D,QAAS,OAAQoG,cAAe,SAAU9E,IAAK,GAAlE,SACG8f,EAAa3oB,KAAI,SAAA0kB,GAAS,OACzB,SAACF,GAAD,CAAkCC,OAAQA,EAAQC,UAAWwE,SAASxE,GAAsBnY,YAAU,EAACoY,kBAAgB,GAAhGD,cA7BVD,GAqCzB,SAAS6B,GAAYiC,GACnB,OAAOA,EAAY1lB,OAAOqJ,OAAOqc,GAAW/G,QAAO,SAAC2H,EAAK1oB,GAAN,OAAY0oB,GAAO1oB,EAAI,EAAI,KAAI,GAAK,EC5OzF,IAAM2oB,GAAS,CAAC,EAAG,EAAG,EAAG,GAAI,GAAI,IAClB,SAASC,GAAT,GAAuG,IAAD,IAArEC,wBAAAA,OAAqE,MAA3C,EAA2C,EAAxCC,EAAwC,EAAxCA,2BAA4B/iB,EAAY,EAAZA,SAC/F9D,GAAMC,EAAAA,EAAAA,GAAe,2BAArBD,EACR,OAAO,SAAC0I,GAAA,EAAD,CAAgBT,WAAS,EAACzJ,MAAOooB,EAA0B,UAAY,UAAW9iB,SAAUA,EACjGmC,MAAO2gB,EAA0B5mB,EAAE,6BAA8B,CAAE8mB,IAAKF,IAA6B5mB,EAAE,6BADlG,SAEJ0mB,GAAOppB,KAAI,SAACwpB,GAAD,OAAS,SAAC3qB,GAAA,EAAD,CAAoBiM,QAAS,kBAAMye,EAA2BC,IAA9D,SAAqEA,EAAM9mB,EAAE,6BAA8B,CAAE8mB,IAAAA,IAAS9mB,EAAE,8BAAzG8mB,QCDzB,SAASC,KACtB,IAAqBpQ,GAAiB/P,EAAAA,EAAAA,YAAWC,EAAAA,GAAzCC,UAAa6P,WACb3P,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACFggB,EAAiB7mB,OAAOoG,KAAKoQ,GACnC,IAAKqQ,EAAeroB,OAAQ,OAAO,KACnC,IAAMgZ,EAAQqP,EAAe1pB,KAAI,SAAA8Z,GAAC,OAAIpQ,EAAKS,IAAIuM,GAAAA,GAAAA,YAAkBoD,OACjE,OAAO,UAAC/G,EAAA,EAAD,YACL,SAACjG,EAAA,EAAD,WACE,SAACoB,EAAA,EAAD,6BAEF,SAAC7C,EAAA,EAAD,KACA,SAACyB,EAAA,EAAD,UACGuN,EAAMra,KAAI,SAAAmb,GAAC,OAAI,SAAC,MAAD,CAA+CjI,KAAMiI,GAA9BP,KAAKC,UAAUM,EAAE/G,e,4BCLxDuV,IAAY1Z,EAAAA,GAAAA,IAAO,SAAPA,CAAiB,CACjC2Z,WAAY,cAGRC,IAAuB5Z,EAAAA,GAAAA,IAAO6Z,GAAAA,EAAP7Z,EAAuB,cAAGxR,MAAH,MAAgB,CAClE0Q,OAAQ,GACRtE,aAAc,MAED,SAASkf,GAAT,GAAsK,IAAD,IAA/IC,OAAU1oB,EAAqI,EAArIA,KAAM2oB,EAA+H,EAA/HA,OAAgBC,GAA+G,EAAvHC,OAAuH,EAA/GD,SAASE,EAAsG,EAAtGA,MAAOC,EAA+F,EAA/FA,UAAWC,EAAoF,EAApFA,WAAcC,EAAsE,EAAtEA,cACtGC,EAAWjT,SAAS6S,GAEpBK,EAA4B,aAATnpB,EACnBopB,EAAYN,EAAQF,EAEpBS,GAAe,SAAChB,GAAD,UAAYM,EAAOW,mBAClCC,GAAkB,SAAClB,GAAD,UAAYe,EAAUE,mBACxCE,IAAgBZ,IAAW,iCAAO,wBAAI,SAACP,GAAD,UAAYO,EAAQU,qBAA/B,eAE3BG,GAAiB,SAACpB,GAAD,WAAYqB,EAAAA,GAAAA,IAAanJ,KAAKQ,OAAM,OAACiI,QAAD,IAACA,EAAAA,EAAcW,YAAYC,QAA3B,OAAqCb,QAArC,IAAqCA,EAAAA,EAAa1I,SAGzGhZ,EAAQ,GACRwiB,EAAW,GACX1L,OAAWxd,EAEf,GAAIwoB,EACFhL,EAAoB,IAATwK,EAAgBS,EAC3B/hB,GAAQ,UAACuF,EAAA,EAAD,qCAAoCyc,EAAcH,GAAW,oCAAIK,UAAsB5oB,EAAvF,mDAAgJ,uBAAIsoB,IAApJ,KAAyKO,KACjLK,GAAW,UAACjd,EAAA,EAAD,4BAA2B6c,SACjC,MAAId,EAASC,GAKlB,OAAO,KAJPzK,EAAW,IACX9W,GAAQ,UAACuF,EAAA,EAAD,mCAAkCyc,EAAlC,mDAA8F,uBAAIJ,IAAlG,KAAuHO,KAC/HK,GAAW,UAACjd,EAAA,EAAD,8BAA6B6c,KAK1C,OAAO,UAACK,GAAA,EAAD,CAAOC,SAjBF,UAiBmBrqB,QAAQ,SAAS6C,GAAI,CAClD,sBAAuB,CACrBmE,SAAU,IAFP,UAKJW,EACAwiB,OACalpB,IAAbwd,IAA0B,UAAC1H,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAGzQ,WAAW,SAAvC,UACxBgjB,IAAY,SAACzS,GAAA,GAAD,CAAMG,MAAI,EAAV,UACX,SAAChK,EAAA,EAAD,oBAAgBuR,EAAS6L,QAAQ,GAAjC,UAEF,SAACvT,GAAA,GAAD,CAAMG,MAAI,EAAClQ,SAAU,EAArB,UACE,SAAC6hB,GAAD,CAAsB7oB,QAASwpB,EAAW,cAAgB,gBAAiBlsB,MAAOmhB,EAAUve,MAAM,oB,oJC/B3F,SAASqqB,GAAT,GAAwJ,IAAD,IAA3HC,EAA2H,EAA3HA,WAAqBC,EAAsG,EAA/GtF,QAA+G,IAA5FmD,wBAAAA,OAA4F,MAAlE,EAAkE,MAA/DoC,aAAAA,OAA+D,SAAzC5gB,EAAyC,EAAzCA,QAAyC,IAAhC6gB,YAAAA,OAAgC,MAAlBjf,EAAAA,EAAkB,EAC9JsT,GAAM4L,EAAAA,GAAAA,GAAYJ,GAChB9Y,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACFkS,GAAQpiB,EAAAA,EAAAA,IAAW,kBAAMC,GAAAA,EAAAA,IAAA,OAAkBud,QAAlB,IAAkBA,OAAlB,EAAkBA,EAAKyE,UAAS,QAACzE,QAAD,IAACA,OAAD,EAACA,EAAKyE,SAC/DoH,GAAoB7kB,EAAAA,EAAAA,cAAY,SAAAhD,GAAQ,OAAI,SAAC8nB,GAAA,EAAD,CAAgBhhB,QAASA,EAASjH,GAAI,CAAEsL,OAAQ,QAAhD,SAA2DnL,MAA4B,CAAC8G,IACpIrM,GAAQoB,EAAAA,GAAAA,KACd,IAAKmgB,EAAK,OAAO,SAAC2L,EAAD,CAAa9nB,GAAI,CAAE0D,QAAS,OAAQ4H,OAAQ,OAAQ3H,WAAY,SAAUwP,eAAgB,UAA1F,UACf,SAACrT,EAAA,EAAD,CAAKD,UAAU,MAAMyN,IAAK4a,GAAAA,EAAAA,KAAYN,GAAW5nB,GAAI,CAAEyD,MAAO,MAAO6H,OAAQ,OAAQ2Z,QAAS,QAGhG,IAAQ3C,EAA4DnG,EAA5DmG,QAASnjB,EAAmDgd,EAAnDhd,OAAQoL,EAA2C4R,EAA3C5R,MAAO4d,EAAoChM,EAApCgM,YAAaC,EAAuBjM,EAAvBiM,SAAUC,EAAalM,EAAbkM,SACjDC,EAAgBtK,KAAKvZ,IAAIuZ,KAAKxZ,IAAIihB,EAAkC,EAATtmB,GAAaoL,GACxEge,EAAe5qB,GAAAA,GAAAA,KAAYwqB,GAC3BlqB,EAAUC,EAAAA,GAAAA,MAAwB,SAAAC,GAAG,OAAIge,EAAIgM,YAAYvqB,SAASO,MAClEd,EAAQY,GAAUuqB,EAAAA,GAAAA,IAAM5tB,EAAM0C,QAAQW,GAASoN,KAAM,KAAOmd,EAAAA,GAAAA,IAAM5tB,EAAM0C,QAAQgP,UAAUjB,KAAM,IACtG,OAAO,SAACyc,EAAD,CAAa9nB,GAAI,CAAEsL,OAAQ,QAA3B,UAAqC,SAACmd,GAAA,EAAD,CAAoBC,YAAazhB,EAAS0hB,QAASX,EAAnD,UAC1C,UAACloB,EAAA,EAAD,CAAK4D,QAAQ,OAAO4H,OAAO,OAA3B,WACE,UAACxL,EAAA,EAAD,CAAK+jB,UAAS,eAAU1kB,EAAV,QAAwBa,GAAI,CAAE4oB,SAAU,WAAYzkB,SAAU,EAAGT,QAAS,OAAQoG,cAAe,SAAUnG,WAAY,SAAUwP,eAAgB,UAA/J,WACE,SAAC0V,GAAA,EAAD,CAAiB1M,IAAKA,EAAtB,UACE,SAACrc,EAAA,EAAD,CACED,UAAU,MACVyN,IAAG,iBAAEyT,QAAF,IAAEA,OAAF,EAAEA,EAAO+H,UAAUxG,UAAnB,QAA+B,GAClCtiB,GAAI,CAAEoP,GAAI,EAAG2Z,UAAW,OAAQC,SAAU,aAG9C,UAAClpB,EAAA,EAAD,CAAKE,GAAI,CAAE4oB,SAAU,WAAYnlB,MAAO,OAAQ6H,OAAQ,OAAQrG,EAAG,GAAKggB,QAAS,IAAMvhB,QAAS,OAAQyP,eAAgB,gBAAiB8V,cAAe,QAAxJ,WACE,SAAC5qB,GAAA,EAAD,CAAM0I,KAAK,QAAQhL,OAAO,wCAAcwO,KAAmBlN,MAAO6rB,GAAAA,GAAAA,aAAsB3e,KACvFsd,IAAgB,SAACxpB,GAAA,EAAD,CAAM0I,KAAK,QAAQhL,OAAO,SAACotB,GAAD,CAAcC,QAASf,GAAYxZ,EAASwa,MAAMC,uBAAuBjB,KAAehrB,MAAO,YAAa2C,GAAI,CACzJupB,SAAU,UAAW,iBAAkB,CACrCA,SAAU,kBAKhB,SAAClrB,GAAA,EAAD,CAAM0I,KAAK,QAAQ/G,GAAI,CAAE4oB,SAAU,WAAYY,OAAQ,EAAGhb,GAAI,EAAGnC,gBAAiBhP,GAChFtB,OAAO,UAACsO,EAAA,EAAD,CAAYrK,GAAI,CAAE0D,QAAS,OAAQsB,IAAK,GAAKjB,GAAI,EAAG0lB,OAAQ,GAA5D,WACL,SAACC,GAAA,EAAD,CAAkBC,UAAU,MAAM7kB,OAAO,SAACuF,EAAA,EAAD,WAAY,SAAC,KAAD,CAAqBqK,QAASyT,MAA8ByB,oBAAkB,EAAnI,UACE,0BAAOppB,GAAAA,EAAS2nB,QAElB,UAAC,KAAD,CAAW9qB,MAAOirB,IAAkB/d,EAAQ,eAAYnM,EAAxD,WAAoEyrB,EAAAA,GAAAA,IAAgB,UAACX,GAAAA,GAAAA,cAAuBf,EAAahpB,EAAQmpB,UAA7C,QAA+D,EAAG3qB,GAAAA,GAAAA,KAAYwqB,IAAeI,cAIvL,SAACzoB,EAAA,EAAD,CAAK4D,QAAQ,OAAOoG,cAAc,SAASqJ,eAAe,gBAAgBnT,GAAI,CAAEiF,EAAG,GAAnF,SACGmjB,EAASjsB,KAAI,SAAC4e,EAAsBvR,GAAvB,OAAqC,SAACsgB,GAAD,CAAmC/O,KAAMA,GAApBvR,EAAIuR,EAAK3e,iBAKzF,SAAS0tB,GAAT,GAA6D,IAAD,IAAlC/O,EAAkC,EAAlCA,KACxB,IAAKA,EAAKtgB,MAAO,OAAO,KACxB,IAAMsvB,EAAQ,oBAAGhP,EAAKiP,aAAR,aAAG,EAAYxsB,cAAf,QAAyB,EACjCysB,EAAS,eAAUnmB,EAAAA,GAAAA,IAAMimB,EAAU,EAAG,IACtCG,EAAOvsB,GAAAA,GAAAA,KAAYod,EAAK3e,KAC9B,OAAQ,SAAC0D,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAGmlB,aAAa,SAAzC,UACN,UAAC9f,EAAA,EAAD,CAAYrK,GAAI,CAAEmE,SAAU,EAAGT,QAAS,OAAQsB,IAAK,IAAO3H,MAAQ0sB,EAAQ,UAAME,EAAN,SAAyB,aAAsBpqB,UAAU,OAArI,WACE,SAAC6pB,GAAA,EAAD,CAAkBC,UAAU,MAAM7kB,OAAO,SAACuF,EAAA,EAAD,UAAa0Q,EAAK3e,MAAO,SAAC,KAAD,CAAqBsY,QAASqG,EAAK3e,QAAuBwtB,oBAAkB,EAA9I,UACE,0BAAOppB,GAAAA,EAASua,EAAK3e,UAEvB,qCAAUytB,EAAAA,GAAAA,IAAiB9O,EAAKtgB,MAAOkD,GAAAA,GAAAA,KAAYod,EAAK3e,OAAxD,OAAgE8tB,UAItE,SAASf,GAAT,GAAoE,IAA5CC,EAA2C,EAA3CA,QACdgB,GAAWC,EAAAA,EAAAA,KAAXD,OACFzd,GAAiBhO,EAAAA,EAAAA,IAAW,kBAAM2rB,EAAAA,EAAAA,IAAmBlB,EAASgB,KAAS,CAAChB,EAASgB,IACvF,OAAOzd,GAAiB,SAAC+c,GAAA,EAAD,CAAkBC,UAAU,YAAY7kB,OAAO,SAACuF,EAAA,EAAD,UAAasC,EAAejG,OAA3E,UAA+F,SAACyI,GAAA,EAAD,CAAS7B,IAAKX,EAAeY,aAAcvN,GAAI,CAAEsL,OAAQ,MAAOif,UAAW,SAAUlZ,WAAY,eAAoC,SAACmZ,GAAA,EAAD,I,4BChF/O,SAASC,KACtB,IAAQ5kB,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACFuD,GAAWlN,EAAAA,EAAAA,UAAQ,kBACvBmS,EAAAA,GAAAA,GAAmBxI,GAAMgE,QAAO,gBAAIzB,GAAJ,sBAAYpJ,OAAOqJ,OAAOD,GAAIuQ,MAAK,SAAArB,GAAC,OAAKA,EAAErI,gBAC3E,CAACpJ,IACH,OAAO,SAAC,KAAD,CAAK7F,GAAI,CAAEuO,IAAK,EAAGC,IAAK,GAAxB,UACL,SAACkc,GAAA,GAAD,CAAShV,QAAS,CAAE9B,GAAI,EAAG+W,GAAI,EAAG9W,GAAI,EAAG+W,GAAI,GAAKxW,QAAS,EAA3D,SACGhL,EAASjN,KAAI,+BAAEC,EAAF,KAAOqS,EAAP,YACZ,SAACoc,GAAD,CAAmBlc,UAAWF,EAAOG,WAAYxS,GAAnCA,UAKtB,SAASyuB,GAAT,GAAyG,IAAtFlc,EAAqF,EAArFA,UAAWC,EAA0E,EAA1EA,WACtBkc,GAAqBrlB,EAAAA,EAAAA,YAAWiS,IACtC,GAA0BjS,EAAAA,EAAAA,YAAWK,EAAAA,GAA7BD,EAAR,EAAQA,KAAM6Q,EAAd,EAAcA,QACN7H,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACF7F,GAASrK,EAAAA,EAAAA,IAAW,kBAAMoQ,EAAAA,GAAAA,GAAiBlJ,EAAM+I,EAAYC,KAAW,CAAChJ,EAAM+I,IAC/Emc,GAAiB7uB,EAAAA,EAAAA,UAAQ,kBAAMgf,EAAAA,GAAAA,IAAUvM,GAAW,SAAC2I,EAAG0T,GAAJ,OAAgBpQ,EAAAA,GAAAA,IAAW,CAAC,UAAWhM,EAAYoc,SAAY,CAACrc,EAAWC,IACrI,IAAK5F,EAAQ,OAAO,SAACH,EAAA,EAAD,IAEpB,IAAQ/D,EAAwBkE,EAAxBlE,MAAOxG,EAAiB0K,EAAjB1K,KAAMyG,EAAWiE,EAAXjE,OACrB,OAAO,UAAC8D,EAAA,EAAD,YACL,SAACjE,GAAA,EAAD,CAAkBC,OAAQvG,IAAQ,SAAC6Q,GAAA,EAAD,CAASpI,KAAM,EAAG/G,GAAI,CAAEoP,GAAI,GAAK9B,IAAKhP,IAAUwG,MAAOA,EAAOC,OAAQA,IAAU,SAACuC,EAAA,EAAD,UAAUvC,OAC5H,SAACyC,EAAA,EAAD,KACA,SAACmP,GAAA,GAAD,CAAkB3W,GAAI,CAAEoP,EAAG,GAA3B,SACGpQ,OAAOC,QAAQ0P,GAAWxS,KAAI,+BAAE6uB,EAAF,KAAW1T,EAAX,YAC7B,SAAC,MAAD,CAAgCjI,KAAMiI,EAAGR,SAAUJ,EAAUA,EAAQpQ,IAAIykB,EAAeC,IAAWvwB,WAAQ2D,EAAWyB,UAAWgX,GAAAA,GAC/HoU,UAAWlU,KAAKC,UAAU8T,KAAwB/T,KAAKC,UAAU,CAACpI,EAAYoc,KADzDA,W,wCCpBhB,SAASE,GAAT,GAAqG,IAA3EC,EAA0E,EAA1EA,SAA0E,IAAhEtD,aAAAA,OAAgE,SAA1C5gB,EAA0C,EAA1CA,QAA0C,IAAjC6gB,YAAAA,OAAiC,MAAnBjf,EAAAA,EAAmB,EAC3GuiB,GAASC,EAAAA,GAAAA,GAAUF,GACnBG,GAAc3sB,EAAAA,EAAAA,IAAW,kBAAY,OAANysB,QAAM,IAANA,OAAA,EAAAA,EAAQhvB,MAAOmvB,GAAAA,EAAAA,IAAgBH,EAAOhvB,OAAM,QAACgvB,QAAD,IAACA,OAAD,EAACA,EAAQhvB,MACpF4rB,GAAoB7kB,EAAAA,EAAAA,cAAY,SAAAhD,GAAQ,OAAI,SAAC8nB,GAAA,EAAD,CAAgBjoB,GAAI,CAAEsL,OAAQ,QAAUrE,QAASA,EAAjD,SAA2D9G,MAA4B,CAAC8G,IACpImc,GAASlnB,EAAAA,EAAAA,UAAQ,kBAAMovB,GAAeF,IAAUI,EAAAA,GAAAA,IAAc,CAACF,EAAYzlB,MAAM4lB,EAAAA,GAAAA,IAAiBL,OAAW,CAACE,EAAaF,IACjI,IAAKA,IAAWE,IAAgBlI,EAAQ,OAAO,SAAC0E,EAAD,CAAa9nB,GAAI,CAAEsL,OAAQ,QAA3B,UAAqC,SAACgD,EAAA,EAAD,CAAUnR,QAAQ,cAAc6C,GAAI,CAAEyD,MAAO,OAAQ6H,OAAQ,YACjJ,IAAQS,EAAyBqf,EAAzBrf,WAAYsc,EAAa+C,EAAb/C,SACpB,OAAO,SAACP,EAAD,CAAa9nB,GAAI,CAAEsL,OAAQ,QAA3B,UAAqC,SAACmd,GAAA,EAAD,CAAoBC,YAAazhB,EAAS0hB,QAASX,EAAnD,UAC1C,UAACloB,EAAA,EAAD,CAAK4D,QAAQ,OAAO4H,OAAO,OAAO3H,WAAW,UAA7C,WACE,UAAC7D,EAAA,EAAD,CAAK+jB,UAAS,eAAUyH,EAAYnsB,OAAtB,QAAoCa,GAAI,CAAEsL,OAAQ,OAAQsd,SAAU,WAAYzkB,SAAU,EAAGT,QAAS,OAAQoG,cAAe,SAAUnG,WAAY,SAAUwP,eAAgB,YAA3L,WACE,SAACuY,GAAA,EAAD,CAAmB3K,MAAOuK,EAA1B,UACE,SAACxrB,EAAA,EAAD,CACED,UAAU,MACVyN,IAAKge,EAAYK,OAAOP,EAAO5gB,WAC/BxK,GAAI,CAAEoE,IAAK,EAAG2kB,UAAW,OAAQC,SAAU,aAG/C,UAAClpB,EAAA,EAAD,CAAKE,GAAI,CAAE4oB,SAAU,WAAYnlB,MAAO,OAAQ6H,OAAQ,OAAQrG,EAAG,GAAKggB,QAAS,IAAMvhB,QAAS,OAAQyP,eAAgB,gBAAiB8V,cAAe,QAAxJ,WACE,SAAC5qB,GAAA,EAAD,CAAM0I,KAAK,QAAQhL,OAAO,4BAASwvB,GAAAA,EAAAA,eAA2BH,KAAmB/tB,MAAM,YACtFwqB,IAAgB,SAACxpB,GAAA,EAAD,CAAM0I,KAAK,QAAQhL,OAAO,SAAC,GAAD,CAAcssB,SAAUA,IAAchrB,MAAO,YAAa2C,GAAI,CACvGupB,SAAU,UAAW,iBAAkB,CACrCA,SAAU,kBAIhB,SAACzpB,EAAA,EAAD,CAAKE,GAAI,CAAE4oB,SAAU,WAAYnlB,MAAO,OAAQ6H,OAAQ,OAAQrG,EAAG,GAAKggB,QAAS,IAAMvhB,QAAS,OAAQyP,eAAgB,WAAYxP,WAAY,YAAhJ,SACG2nB,EAAYM,gBAAiB,SAACvtB,GAAA,EAAD,CAAM0I,KAAK,QAAQ1J,MAAM,OAAOtB,OAAO,kCAAUgQ,aAGnF,UAACjM,EAAA,EAAD,CAAK4D,QAAQ,OAAOoG,cAAc,SAAS9J,GAAI,CAAEiF,EAAG,GAApD,WACE,SAAC4mB,GAAD,CAAYxc,KAAM+T,EAAO9c,IAAIuM,GAAAA,GAAAA,OAAAA,SAC7B,SAACgZ,GAAD,CAAYxc,KAAM+T,EAAO9c,IAAIuM,GAAAA,GAAAA,OAAAA,iBAKrC,SAASgZ,GAAT,GAAsD,IAAhCxc,EAA+B,EAA/BA,KACpB,OAAKA,EAAKkB,KAAK7J,MACP,SAAC5G,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAGmlB,aAAa,SAAzC,UACN,UAAC9f,EAAA,EAAD,CAAYrK,GAAI,CAAEmE,SAAU,EAAGT,QAAS,OAAQsB,IAAK,GAAKnF,UAAU,OAApE,WACE,SAAC6pB,GAAA,EAAD,CAAkBC,UAAU,MAAM7kB,OAAO,SAACuF,EAAA,EAAD,UAAagF,EAAKkB,KAAK7J,OAAoBkjB,oBAAkB,EAAtG,UACE,0BAAOva,EAAKkB,KAAKjS,UAEnB,2BAAOkS,EAAAA,GAAAA,GAASnB,UANQ,KAU9B,SAAS8Z,GAAT,GAAgE,IAAxCd,EAAuC,EAAvCA,SACdxZ,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACAub,GAAWC,EAAAA,EAAAA,KAAXD,OACFzd,GAAiBhO,EAAAA,EAAAA,IAAW,kBAAM2rB,EAAAA,EAAAA,IAAmBjC,EAAWxZ,EAASwa,MAAMC,uBAAuBjB,GAAY,GAAI+B,KAAS,CAAC/B,EAAU+B,IAChJ,OAAOzd,GAAiB,SAAC+c,GAAA,EAAD,CAAkBC,UAAU,YAAY7kB,OAAO,SAACuF,EAAA,EAAD,UAAasC,EAAejG,OAA3E,UAA+F,SAACyI,GAAA,EAAD,CAAS7B,IAAKX,EAAeY,aAAcvN,GAAI,CAAEsL,OAAQ,MAAOif,UAAW,SAAUlZ,WAAY,eAAoC,SAACmZ,GAAA,EAAD,I,gBCxC/O,SAASsB,GAAT,GAA0H,IAA9F9tB,EAA6F,EAA7FA,MAAO+tB,EAAsF,EAAtFA,aAAcC,EAAwE,EAAxEA,kBAAmBC,EAAqD,EAArDA,iBAAkBtpB,EAAmC,EAAnCA,SACnG,GAAgE8C,EAAAA,EAAAA,YAAWC,EAAAA,GAAnEC,UAAkBwb,EAA1B,EAAqB/kB,IAAmB8vB,EAAxC,EAAwCA,kBAChBzG,EAA8BvE,GAAgBC,GAA9DE,aAAgBoE,wBAChB5W,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACF6S,GAAcjc,EAAAA,EAAAA,YAAWK,EAAAA,GAEvBD,EAAkB6b,EAAlB7b,KAAM6Q,EAAYgL,EAAZhL,QACd,GAA4B7T,EAAAA,EAAAA,eAASzE,GAArC,eAAO+tB,EAAP,KAAeC,EAAf,KACMC,GAAQlpB,EAAAA,EAAAA,cAAY,kBAAMipB,OAAUhuB,KAAY,CAACguB,IAEjDE,GAAanpB,EAAAA,EAAAA,cAAY,WACxBopB,OAAOC,QAAQ,wDACpBjR,EAAAA,GAAAA,SAAoB,SAAAhS,GAClB,IAAMkjB,EAAM5mB,EAAKS,IAAIuM,GAAAA,GAAAA,IAAUtJ,GAAGkS,IAAIhhB,MAClCgyB,GAAK5d,EAASmJ,KAAK5Y,IAAIqtB,EAAK,CAAEpE,UAAUqE,EAAAA,EAAAA,IAAoBvL,QAElEtS,EAAS8d,QAAQvtB,IAAIyG,EAAKS,IAAIuM,GAAAA,GAAAA,OAAAA,IAAiBpY,MAAQ,CAAE4tB,UAAUqE,EAAAA,EAAAA,IAAoBvL,QACtF,CAACA,EAActb,EAAMgJ,IAElB+d,GAAsB1wB,EAAAA,EAAAA,UAAQ,WAClC,IAAM2wB,GAAY,WAAQnL,GAE1B,OADKqK,IAAcc,EAAanW,aAAUtY,GACnCyuB,IACN,CAACnL,EAAaqK,IAGXe,GAAW5wB,EAAAA,EAAAA,UAAQ,kBAAMqf,EAAAA,GAAAA,KAAgB,SAAA+G,GAAO,OACpD,SAACpO,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAAC8T,GAAD,CAAkBG,cAAY,EAACvF,QAASA,EAASqF,WAAY9hB,EAAKS,IAAIuM,GAAAA,GAAAA,IAAUyP,GAAS7G,IAAIhhB,MAAOgrB,wBAAyBA,EAAyBxe,QAAS,WAC7J,IAAM8lB,EAAQb,EAAkB5J,GAC1B0K,EAAQnnB,EAAKS,IAAIuM,GAAAA,GAAAA,IAAUyP,GAAS7G,IAAIhhB,MAC9C2xB,EAAU,CAAEW,MAAOA,IAAUC,EAAQD,OAAQ3uB,EAAW4uB,MAAAA,QAJrC1K,QAMb,CAACzc,EAAMumB,EAAWF,EAAmBzG,IAEjD,IAAK/O,EAAS,OAAO,KACrB,IAAMuW,EAAoB1R,EAAAA,GAAAA,OAAkB,SAAA+G,GAAO,OAAIzc,EAAKS,IAAIuM,GAAAA,GAAAA,IAAUyP,GAAS7G,IAAIhhB,QAAUic,EAAQpQ,IAAIuM,GAAAA,GAAAA,IAAUyP,GAAS7G,IAAIhhB,UAAUoL,EAAKS,IAAIuM,GAAAA,GAAAA,OAAAA,IAAiBpY,QAAUic,EAAQpQ,IAAIuM,GAAAA,GAAAA,OAAAA,IAAiBpY,MAE/M,OAAO,SAACyU,EAAA,EAAD,WACL,UAAC,EAAAlC,SAAD,CAAUC,UAAU,SAACqB,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,MAAzE,UACG6gB,IAAU,SAACe,GAAD,CAAsBf,OAAQA,EAAQ1G,wBAAyBA,EAAyB1X,QAASse,KAC5G,UAACpjB,EAAA,EAAD,YACE,UAAC,KAAD,CAAKvF,QAAQ,OAAOsB,IAAK,EAAGhF,GAAI,CAAEkJ,GAAI,GAAK+J,SAAS,OAApD,eACa7U,IAAVJ,IAAuB,SAACsJ,EAAA,EAAD,CAASjK,MAAM,OAAf,UAAsB,SAACgN,EAAA,EAAD,WAAY,kCAAUrM,EAAQ,EAAGivB,EAAoB,cAAgB,WACnH,SAACE,GAAD,CAAWF,kBAAmBA,KAC9B,SAAC,KAAD,CAAKjtB,GAAI,CAAEmE,SAAU,EAAGT,QAAS,OAAQyP,eAAgB,cAExD8Y,GACD,SAACplB,EAAA,EAAD,CAAQE,KAAK,QAAQ1J,MAAM,UAAU4J,QAASqlB,EAAY3pB,SAAUA,GAAYsqB,EAAmB/lB,WAAW,SAACkmB,GAAA,EAAD,IAA9G,yBACCpB,MAEH,UAAC9X,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAGpU,GAAI,CAAEkJ,GAAI,GAAKwM,QAAS,CAAE9B,GAAI,EAAG+W,GAAI,EAAG9W,GAAI,EAAGoB,GAAI,GAA/E,WACE,SAACf,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAACsX,GAAD,CAAgBrD,cAAY,EAACsD,SAAUtlB,EAAKS,IAAIuM,GAAAA,GAAAA,OAAAA,IAAiBpY,UAElEqyB,MAEH,SAAChnB,EAAA,WAAD,CAAsBrL,MAAOmyB,EAA7B,UACE,SAACnC,GAAD,cAMV,SAAS0C,GAAT,GAAmF,IAAD,IAA7DF,kBAAAA,OAA6D,SACxEpnB,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACFwnB,EAAyD,GAO/D,OANA9R,EAAAA,GAAAA,SAAoB,SAAA+G,GAClB,IAAMljB,EAAMyG,EAAKS,IAAIuM,GAAAA,GAAAA,IAAUyP,GAASljB,KAAK3E,MACxC2E,IACDiuB,EAAWjuB,GAAMiuB,EAAWjuB,GAAM4gB,KAAKsC,GACtC+K,EAAWjuB,GAAO,CAACkjB,QAEnB,8BAAGtjB,OAAOC,QAAQouB,GAAYhuB,MAAK,iCAAMiuB,GAAN,2CAA6C9vB,OAAS8vB,EAAS9vB,UAAQrB,KAAI,+BAAEC,EAAF,KAAOmxB,EAAP,YACnH,SAACC,GAAD,CAAoB5M,OAAQxkB,EAAK6wB,kBAAmBA,EAAmBM,QAASA,GAAjEnxB,QAInB,SAASoxB,GAAT,GAAuJ,IAAD,EAAlI5M,EAAkI,EAAlIA,OAAkI,IAA1HqM,kBAAAA,OAA0H,SAA/FM,EAA+F,EAA/FA,QAC/CE,GAAgB9uB,EAAAA,EAAAA,IAAW,kBAAMC,GAAAA,EAAAA,IAAkBgiB,KAAS,IAClE,IAAK6M,EAAe,OAAO,KAC3B,IAAMC,EAAWH,EAAQ/vB,OACnBmwB,EAAY3uB,OAAOoG,KAAKqoB,EAAc1I,YAAY5oB,KAAI,SAACykB,GAAD,OAAYyE,SAASzE,MAAS/W,QAAO,SAAAsa,GAAM,OAAIA,GAAUuJ,KACrH,OAAO,SAAC,KAAD,WACL,SAACE,GAAA,EAAD,CAAoBH,cAAeA,EAAeC,SAAUA,EAA5D,UACE,SAACpmB,EAAA,EAAD,CAASjK,MAAO4vB,EAAoB,UAAY,UAAhD,UAA4D,UAAC5iB,EAAA,EAAD,WACzDkjB,EAAQpxB,KAAI,SAAAmmB,GAAO,OAAI8C,EAAAA,GAAAA,IAAiB9C,MADiB,cACLmL,EAAc/mB,YADT,QACiB,GAC1EinB,EAAUxxB,KAAI,SAAAmb,GAAC,OAAI,SAAChQ,EAAA,EAAD,CAAStH,GAAI,CAAEkI,GAAI,IAAe7K,MAAM,UAAxC,SAAmDia,GAApBA,eAM3D,SAAS4V,GAAT,GAAyK,IAAD,IAAxIf,OAAUa,EAA8H,EAA9HA,MAAOD,EAAuH,EAAvHA,MAAStH,EAA8G,EAA9GA,wBAAyB1X,EAAqF,EAArFA,QACzEc,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACkBsS,GAAmB1b,EAAAA,EAAAA,YAAWC,EAAAA,GAAhDC,UAAavJ,IACfyxB,GAAU1qB,EAAAA,EAAAA,cAAY,WACrBopB,OAAOC,QAAQ,2DACpB3d,EAASmJ,KAAK5Y,IAAI4tB,EAAO,CAAE3E,UAAUqE,EAAAA,EAAAA,IAAoBvL,KACzDpT,OACC,CAACif,EAAOne,EAAUsS,EAAcpT,IAEnC,OAAO,SAACF,GAAA,EAAD,CAAcC,OAAQkf,EAAOjf,QAASA,EAAS+f,eAAgB,CAAE9E,SAAU+D,EAAQ,KAAO,MAA1F,UACL,SAAClkB,EAAA,EAAD,WACE,UAACI,EAAA,EAAD,CAAajJ,GAAI,CAAE0D,QAAS,OAAQyP,eAAgB,SAAUxP,WAAY,UAAWqB,IAAK,EAAGsG,OAAQ,QAArG,UACGyhB,IAAS,SAAC,KAAD,CAAKgB,SAAU,IAAf,UAAoB,SAACC,GAAA,EAAD,CAAcrG,WAAYoF,EAAOtH,wBAAyBA,EAAyBwI,YAAU,EAACC,UAAQ,EAACC,YAAa,CAAEC,YAAY,EAAMC,aAAa,OAClLtB,IAAS,SAAC,KAAD,CAAKrpB,QAAQ,OAAOS,SAAU,IACvC4oB,IAAS,SAAC,KAAD,CAAKrpB,QAAQ,OAAOC,WAAW,SAASwP,eAAe,SAAvD,UAAgE,SAACtM,EAAA,EAAD,CAAQI,QAAS4mB,EAAS7tB,GAAI,CAAE0D,QAAS,QAAzC,UAAmD,SAAC4qB,GAAA,EAAD,CAActuB,GAAI,CAAEuuB,SAAU,UAC1JxB,IAAS,SAAC,KAAD,CAAKrpB,QAAQ,OAAOS,SAAU,KACxC,SAAC,KAAD,CAAK4pB,SAAU,IAAf,UAAoB,SAACC,GAAA,EAAD,CAAcrG,WAAYqF,EAAOvH,wBAAyBA,EAAyBwI,YAAU,EAACC,UAAQ,EAACC,YAAa,CAAEC,YAAY,EAAMC,aAAa,c,mKCxHlK,SAASG,GAAT,GAAiH,IAA5FC,EAA2F,EAA3FA,UAAWC,EAAgF,EAAhFA,SAAUC,EAAsE,EAAtEA,YAAsE,IAAzDhsB,SAAAA,OAAyD,aAAvCisB,YAAAA,OAAuC,SACrH/vB,GAAMC,EAAAA,EAAAA,GAAe,CAAC,0BAA2B,OAAjDD,EACR,GAAwCgE,EAAAA,EAAAA,WAAS,GAAjD,eAAOgsB,EAAP,KAAqBC,EAArB,KACA,GAA8BjsB,EAAAA,EAAAA,WAAS,GAAvC,eAAOksB,EAAP,KAAgBC,EAAhB,KAEA,GAAsC9yB,EAAAA,EAAAA,UAAQ,WAAO,IAAD,IAClD,IAAKuyB,EAAW,MAAO,CAAEQ,YAAa,KAAMC,aAAc,MAC1D,IAFkD,EAG5CC,EADSV,EAAU5oB,KAAK1J,KAAI,gBAAUizB,EAAV,EAAG30B,MAAH,MAA4B,CAAEme,EAA9B,EAAa6F,KAAoB2Q,EAAAA,MAC/B/vB,MAAK,SAAC0C,EAAGC,GAAJ,OAAUD,EAAE6W,EAAI5W,EAAE4W,KACrDyW,EAAuB,GAJqB,WAK9BF,GAL8B,IAKlD,2BAAiC,CAE/B,IAFgC,IAAvBG,EAAsB,QAC3BC,OAAuB,EACnBA,EAAOF,EAAYG,OACzB,GAAID,EAAKH,EAAIE,EAAMF,EAAG,CACpBC,EAAYrP,KAAKuP,GACjB,MAGJF,EAAYrP,KAAKsP,IAb+B,+BAmB9C,UAAAD,EAAY,UAAZ,eAAgBzW,MAAhB,UAAsBuW,EAAY,UAAlC,aAAsB,EAAgBvW,KACxCuW,EAAY,GAAG3qB,IAAM6qB,EAAY,GAAGD,GACtCC,EAAYrV,SAAQ,SAAApB,GAAOA,EAAEpU,IAAMoU,EAAEwW,KAErC,IAAMF,EAAe,CACnBnX,QAASsX,EAAYlzB,KAAI,kBAAc,CAAd,EAAGyc,EAAH,EAAMwW,MAC/BK,QAASN,EAAYhzB,KAAI,kBAAc,CAAd,EAAGyc,EAAH,EAAMwW,OAEjC,MAAO,CAAEH,YAAaE,EAAaD,aAAAA,KAClC,CAACT,IA5BIQ,EAAR,EAAQA,YAAaC,EAArB,EAAqBA,aA8BrB,OAAO,UAAChgB,EAAA,EAAD,YACL,SAACjG,EAAA,EAAD,WACE,UAACiL,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAGzQ,WAAW,SAAvC,WACE,SAACuQ,GAAA,GAAD,CAAMG,MAAI,EAAV,UACE,SAAChK,EAAA,EAAD,UAAcxL,EAAd,uCAEF,SAACqV,GAAA,GAAD,CAAMG,MAAI,EAAV,UACE,SAACqV,GAAA,EAAD,CAAkBC,UAAU,MAAM7kB,MAAO8pB,EAAc/vB,EAAE,6CAA+C,GAAxG,UACE,2BACE,SAAC6wB,GAAA,EAAD,CACE5E,mBAAoB4D,EACpBiB,UAAW,SAAApb,GAAM,OAAIoa,EAAYpa,IACjCrT,YAAarC,EAAE,4DACf8D,SAAUA,WAKlB,SAACuR,GAAA,GAAD,CAAMG,MAAI,EAAV,UACE,SAACqV,GAAA,EAAD,CAAkB5kB,MAAQ4pB,EAAgB7vB,EAAE,YAAP,GAAoB8qB,UAAU,MAAnE,UACE,2BAAM,SAAC9iB,EAAA,EAAD,CAAQxJ,MAAM,QAAQ4J,QAAS,kBAAM0nB,OAAYvwB,IAAYuE,UAAW+rB,EAAxE,UACJ,SAAClc,GAAA,EAAD,aAIN,SAAC0B,GAAA,GAAD,CAAMG,MAAI,EAAClQ,SAAU,EAArB,UACE,SAACiG,GAAA,EAAD,CAAauf,UAAU,MAAM7kB,MAAOjG,EAAE,8CAErCqwB,IAAgB,SAAChb,GAAA,GAAD,CAAMG,MAAI,EAAV,UACjB,SAACxN,EAAA,EAAD,CAAQE,KAAK,QAAQG,UAAW6nB,GAAU,SAAC5nB,GAAA,EAAD,KAAe,SAACC,GAAA,EAAD,IACvD/J,MAAO0xB,EAAU,UAAY,YAC7B9nB,QAAS,kBAAM+nB,GAAYD,IAF7B,SAEwClwB,EAFxC,oDAICqwB,IAAgB,SAAChb,GAAA,GAAD,CAAMG,MAAI,EAAV,UACjB,SAACxN,EAAA,EAAD,CAAQE,KAAK,QAAQ1J,MAAM,OAAO6J,WAAW,SAAC0oB,GAAA,EAAD,IAAc3oB,QAAS,kBAAM6nB,GAAiBD,IAA3F,SAA2GhwB,EAA3G,uDAIHowB,IAAe,SAACznB,EAAA,EAAD,IACjBinB,KAAeQ,IAAe,UAAChmB,EAAA,EAAD,YAC7B,SAACmK,GAAA,EAAD,CAAUC,KAAM6b,GAAgBL,EAAhC,UACE,SAAChmB,EAAA,EAAD,CAAU7I,GAAI,CAAEwO,GAAI,GAApB,UACE,UAACvF,EAAA,EAAD,YACE,SAACoB,EAAA,EAAD,wBACA,SAACwlB,GAAD,CAAahqB,KAAI,OAAEqpB,QAAF,IAAEA,OAAF,EAAEA,EAAcnX,WACjC,SAAC1N,EAAA,EAAD,wBACA,SAACwlB,GAAD,CAAahqB,KAAI,OAAEqpB,QAAF,IAAEA,OAAF,EAAEA,EAAcO,kBAIvC,SAACK,GAAD,CAAOb,YAAaA,EAAac,SAAUtB,EAAUsB,SAAUC,UAAWvB,EAAUuB,UAAWjB,QAASA,UAI9G,IAAMkB,IAAW7jB,EAAAA,GAAAA,IAAO,WAAPA,CAAmB,CAClC3I,MAAO,OACPsiB,WAAY,YACZmK,OAAQ,WACRC,UAAW,QAEb,SAASN,GAAT,GAAoD,IAA7BhqB,EAA4B,EAA5BA,KACrB,OAAO,SAACoqB,GAAD,CAAUG,UAAQ,EAAC31B,MAAOsc,KAAKC,UAAUnR,GAAOoB,QAAS,SAAA7D,GAC9D,IAAMmR,EAASnR,EAAEmR,OACjBA,EAAO8b,eAAiB,EACxB9b,EAAO+b,aAAe/b,EAAO9Z,MAAM+C,UAGvC,SAASsyB,GAAT,GAKI,IAAD,IALcb,EAKd,EALcA,YAAac,EAK3B,EAL2BA,SAAUC,EAKrC,EALqCA,UAAWjB,EAKhD,EALgDA,QAMzClwB,GAAMC,EAAAA,EAAAA,GAAe,2BAArBD,EAEF0xB,GAAS,SAACC,GAAA,EAAD,CAAOC,KAAK,QAAQC,GAAI,GAAxB,SACZC,GAAiBZ,EAAUlxB,KAExB+xB,GAAS,SAACJ,GAAA,EAAD,CAAOC,KAAK,QAAQI,OAAQ,GAAIC,IAAK,GAArC,SACZH,GAAiBX,EAAWnxB,KAE/B,OAAO,SAACkyB,GAAA,EAAD,CAAqBttB,MAAM,OAAO6H,OAAQ,IAA1C,UACL,UAAC0lB,GAAA,EAAD,CAAenrB,KAAMopB,EAArB,WACE,SAACgC,GAAA,EAAD,CAAeC,gBAAgB,SAC/B,SAACC,GAAA,EAAD,CAAOC,QAAQ,IAAI7S,MAAM,SAAS2L,KAAI,UAAE6F,EAASxf,YAAX,aAAE,EAAe2Z,KAAMmH,OAAQ,CAAC,OAAQ,QAASC,KAAM,CAAEb,KAAM,SAAWhzB,KAAK,SAAS8zB,cAAe,SAAAja,GAAC,OAAIA,EAAI,IAAQA,EAAEmQ,UAAYnQ,EAAEmQ,QAAQ,IAAI1rB,MAAOw0B,EAAQjlB,OAAQ,MACjN,SAACkmB,GAAA,EAAD,CAAO9qB,KAAK,MAAM2qB,OAAQ,CAAC,OAAQ,QAASnH,KAAI,UAAE8F,EAAUzf,YAAZ,aAAE,EAAgB2Z,KAAMuH,eAAe,EAAOH,KAAM,CAAEb,KAAM,SAAWhzB,KAAK,SAAS1B,MAAO60B,EAAQntB,MAAO,OAC3J,SAACiuB,GAAA,EAAD,CAAON,QAAQ,IAAI9T,MAAO,CAAC,EAAG,OAC9B,SAACqU,GAAA,EAAD,KACA,SAACC,GAAA,EAAD,CAASlrB,KAAM7H,EAAF,yCAAwBuyB,QAAQ,IAAIX,KAAK,UAAUoB,MAAI,EAACC,SAAS,UAAUC,mBAAmB,IAC1GhD,IAAW,SAACiD,GAAA,EAAD,CAAMtrB,KAAM7H,EAAF,6CAA4BuyB,QAAQ,MAAMa,OAAO,UAAUx0B,KAAK,aAAay0B,cAAY,EAACC,YAAa,EAAGJ,mBAAmB,SAKzJ,SAASpB,GAAiBthB,EAAexQ,GAAS,IAAD,cAE/C,OADAuzB,QAAQC,IAAIhjB,GACsB,kBAA3B,UAAOA,EAAKkB,YAAZ,aAAO,EAAW7J,MACrB2I,EAAKkB,KAAK7J,KADP,UAEA7H,EAAE,GAAD,iBAAIwQ,EAAKkB,YAAT,iBAAI,EAAW7J,YAAf,aAAI,EAAiB3L,MAAMqN,GAA3B,sBAAiCiH,EAAKkB,YAAtC,iBAAiC,EAAW7J,YAA5C,aAAiC,EAAiB3L,MAAMoN,SAFzD,OAEoE,UAAAkH,EAAKkB,YAAL,SAAW+hB,WAAX,qBAA4BjjB,EAAKkB,YAAjC,aAA4B,EAAW+hB,YAAe,IChJ5H,I,MAAMC,GAAkC,CAAC,QAAS,SAAU,WAEpD,SAASC,GAAT,GAEX,IAAD,IAF6C7vB,SAAAA,OAE7C,SACO9D,GAAMC,EAAAA,EAAAA,GAAe,YAArBD,EAER,EAAiEqiB,IADpBzb,EAAAA,EAAAA,YAAWC,EAAAA,GAAhDC,UAAavJ,KACGiE,EAAxB,EAAQghB,aAAgBhhB,aAAgBmhB,EAAxC,EAAwCA,qBAExC,OAAO,SAAC,KAAD,CAAK9d,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAAhD,SACJutB,GAAgCp2B,KAAI,SAAAmmB,GACnC,IAAMmQ,EAASpyB,EAAaiiB,GAAS9kB,OACrC,OAAO,UAAC,KAAD,YACL,SAACgK,EAAA,EAAD,KACA,UAACyB,EAAA,EAAD,CAAajJ,GAAI,CAAEkO,GAAI,GAAvB,WACE,UAAC,KAAD,CAAKlO,GAAI,CAAE0D,QAAS,OAAQsB,IAAK,EAAGrB,WAAY,SAAUuF,GAAI,GAA9D,WACE,SAACwgB,GAAA,EAAD,CAAkBC,UAAU,MAAM7kB,OAAO,SAACuF,EAAA,EAAD,UAAaxL,EAAE,YAAD,OAAayjB,MAApE,UACE,2BAAO8C,EAAAA,GAAAA,IAAiB9C,QAE1B,SAAC,KAAD,CAAKne,SAAU,EAAf,UACE,SAACmD,EAAA,EAAD,CAASjK,MAAM,OAAf,SAAuBo1B,EAAM,UAAMA,EAAN,wBAE/B,SAAC5rB,EAAA,EAAD,CAAQxJ,MAAM,QAAQ0J,KAAK,QAAQpE,UAAWtC,EAAaiiB,GAAS9kB,QAAUmF,EAAU3C,GAAI,CAAE0yB,IAAK,EAAGlkB,IAAK,GACzGvH,QAAS,kBAAMua,EAAqB,CAAE/jB,KAAM,cAAe6kB,QAAAA,KAD7D,UAEE,SAAC9P,GAAA,EAAD,UAGJ,SAAC0B,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,SACG8U,GAAAA,GAAAA,cAAuB5G,GAASnmB,KAAI,SAACgsB,EAAa3e,GACjD,IAAMvL,EAAUC,EAAAA,GAAAA,MAAwB,SAAAC,GAAG,OAAIgqB,EAAYvqB,SAASO,MAC9Dd,EAAQgD,EAAaiiB,GAAS1kB,SAASuqB,GAA/B,OACVlqB,QADU,IACVA,EAAAA,EAAW,UACX,YACJ,OAAO,SAACiW,GAAA,GAAD,CAAMG,MAAI,EAAmBlQ,SAAU,EAAGyP,GAAKpK,EAAI,GAAiB,WAAZ8Y,EAAwB,OAAIlkB,EAApF,UACL,SAACsrB,GAAA,EAAD,CAAkBC,UAAU,MAAM7kB,OAAO,SAACuF,EAAA,EAAD,WAAY,6BAAQ,SAAC,KAAD,CAAqBqK,QAASyT,QAAuCyB,oBAAkB,EAApJ,UACE,SAAC/iB,EAAA,EAAD,CAAQC,WAAS,EAACC,KAAK,QAAQ1J,MAAOA,EAAO2C,GAAI,CAAEuuB,SAAU,QAASjjB,OAAQ,OAAQ2d,cAAetmB,EAAW,YAASvE,EAAWu0B,OAAQhwB,EAAW,YAASvE,GAC9J6I,QAAS,kBAAMua,EAAqB,CAAE/jB,KAAM,cAAe6kB,QAAAA,EAAS6F,YAAAA,KADtE,SAEG3nB,GAAAA,EAAS2nB,QAJOA,aArBd7F,QCdR,SAASsQ,GAAT,GAAuE,IAAD,IAA5CjwB,SAAAA,OAA4C,SAC3E9D,GAAMC,EAAAA,EAAAA,GAAe,2BAArBD,EACkBsiB,GAAmB1b,EAAAA,EAAAA,YAAWC,EAAAA,GAAhDC,UAAavJ,IACbyJ,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACR,EAAgEqb,GAAgBC,GAAxDtL,EAAxB,EAAQwL,aAAgBxL,YAAe2L,EAAvC,EAAuCA,qBACjC1L,GAAiB3S,EAAAA,EAAAA,cAAY,SAAC0S,GAAD,OAAwC2L,EAAqB,CAAE3L,YAAAA,MAAgB,CAAC2L,IAE7G5L,GAAW1Z,EAAAA,EAAAA,UAAQ,WACvB,IAAM0Z,EAAsB,CAAC,MAAO,KAAM,MAAO,SAAU,YAAa,WAAY,QAAS,aACnC,aAAtD/P,EAAKS,IAAIuM,GAAAA,GAAAA,YAAkBpY,OAAuCmb,EAASoK,KAAK,iBACpF,IAAM9I,EAAUrR,EAAKS,IAAIuM,GAAAA,GAAAA,SAAepY,MAExC,OADAmb,EAASoK,KAAT,UAAiB9I,EAAjB,UACOtB,IACN,CAAC/P,IAGJ,OAAO,UAAC/F,EAAA,EAAD,YACL,SAACoP,EAAA,EAAD,WACE,UAACjG,EAAA,EAAD,CAAajJ,GAAI,CAAE0D,QAAS,OAAQsB,IAAK,EAAGmO,eAAgB,iBAA5D,WACE,SAAC9I,EAAA,EAAD,UAAaxL,EAAb,iDACA,SAACuL,GAAA,EAAD,CAAatF,OAAO,SAACuF,EAAA,EAAD,UAAaxL,EAAb,0DAGxB,SAACiB,EAAA,EAAD,CAAK4D,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,GAAhD,UACE,SAAC2Q,GAAA,EAAD,CAAgBC,SAAUA,EAAUC,YAAaA,EAAaC,eAAgBA,EAAgBnT,SAAUA,S,sGChBxG6J,GAA0BC,EAAAA,MAAW,kBAAM,iCAElC,SAASomB,GAAT,GAAoE,IAAD,IAA5ClwB,SAAAA,OAA4C,SACxE9D,GAAMC,EAAAA,EAAAA,GAAe,2BAArBD,EACkBsiB,GAAmB1b,EAAAA,EAAAA,YAAWC,EAAAA,GAAhDC,UAAavJ,IACrB,EAAoE8kB,GAAgBC,GAA5D2R,EAAxB,EAAQzR,aAAgByR,gBAAmBtR,EAA3C,EAA2CA,qBACnC3S,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAAgCkkB,EAAAA,EAAAA,IAAa,GAA7C,eAAO7lB,EAAP,KAAa2U,EAAb,KAAqB9T,EAArB,KACA,GAA8DlL,EAAAA,EAAAA,UAASgM,EAASmkB,gBAAgB1sB,OAAhG,eAA4B2sB,EAA5B,KAASC,kBAA4CC,EAArD,MACA3vB,EAAAA,EAAAA,YAAU,kBAAMqL,EAASmkB,gBAAgBzR,QAAO,SAACrV,EAAGknB,GAAJ,OAAWD,EAAMC,QAAM,CAACvkB,EAAUskB,IAElF,IAAMD,GAAoBh3B,EAAAA,EAAAA,UAAQ,kBAAM,QAAI,IAAIyd,IAAIsZ,IAAwBppB,QAAO,SAAAwpB,GAAE,OAAIxkB,EAASwa,MAAM/iB,IAAI+sB,QAAM,CAACxkB,EAAUokB,IACvHK,GAAUnwB,EAAAA,EAAAA,cAAY,SAAC+vB,GAAD,OAAuCrkB,EAASmkB,gBAAgB5zB,IAAI,CAAE8zB,kBAAAA,MAAsB,CAACrkB,IAEnH0kB,GAAcpwB,EAAAA,EAAAA,cAAY,SAACqwB,EAAWC,GAC1C,IAAMC,GAAG,QAAOR,GACZj1B,EAAUy1B,EAAIF,GAClBE,EAAIC,OAAOH,EAAW,GACtBE,EAAIC,OAAOF,EAAS,EAAGx1B,GACvBq1B,EAAQI,KACP,CAACR,EAAmBI,IACjBM,GAAazwB,EAAAA,EAAAA,cAAY,SAACqwB,GAC9B,IAAME,GAAG,QAAOR,GAChBQ,EAAIC,OAAOH,EAAW,GACtBF,EAAQI,KACP,CAACR,EAAmBI,IACjBO,GAAU1wB,EAAAA,EAAAA,cAAY,SAACkwB,GAAD,OAAsBC,EAAQ,GAAD,gBAAKJ,GAAL,CAAwBG,OAAM,CAACH,EAAmBI,IACrGQ,GAAY3wB,EAAAA,EAAAA,cAAY,kBAAMmwB,EAAQ,MAAK,CAACA,IAE5CS,GAAW73B,EAAAA,EAAAA,UAAQ,WACvB,IAAI63B,EAAWb,EAAkB11B,OAC3BQ,EAAQk1B,EAAkBc,QAAQ7S,GAExC,OADInjB,GAAS,IAAG+1B,EAAW/1B,GACpB+1B,IACN,CAAC5S,EAAc+R,IACZe,GAAqB/3B,EAAAA,EAAAA,UAAQ,WACjC,OAAO2S,EAASwa,MAAMjkB,KAAK5H,OAAS,EAAIu2B,IACvC,CAACA,EAAUllB,IACRqlB,GAAch4B,EAAAA,EAAAA,UAAQ,WAC1B,OAAO2S,EAASwa,MAAMjkB,KAAK5H,OAAS01B,EAAkB11B,SACrD,CAAC01B,EAAmBrkB,IAEvB,OAAO,UAAC/O,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAzB,WACL,SAAC6I,GAAA,EAAD,CAAcC,KAAMZ,EAAMa,QAASA,EAAS+f,eAAgB,CAAE9E,SAAU,MAAxE,UAAgF,UAACngB,EAAA,EAAD,YAC9E,SAACI,EAAA,EAAD,WACE,UAACiL,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,WACE,SAACF,GAAA,GAAD,CAAMG,MAAI,EAAClQ,SAAU,EAArB,UACE,SAACkG,EAAA,EAAD,CAAYlN,QAAQ,KAApB,SAA0B0B,EAA1B,oDAEF,SAACqV,GAAA,GAAD,CAAMG,MAAI,EAACrU,GAAI,CAAEwO,IAAK,GAAtB,UACE,SAACP,EAAA,EAAD,CAAahH,QAAS8G,YAI5B,SAACvG,EAAA,EAAD,KACA,UAACyB,EAAA,EAAD,YACE,SAACiG,EAAA,EAAD,CAAWlP,GAAI,CAAEwO,GAAI,GAArB,UACE,UAACvF,EAAA,EAAD,YACE,SAACoB,EAAA,EAAD,CAAYia,cAAY,EAAxB,UAAyB,SAACN,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,0BAArB,mKACzB,SAAC5Z,EAAA,EAAD,CAAYia,cAAY,EAAxB,UAAyB,SAACN,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,0BAArB,uKAG7B,UAACnkB,EAAA,EAAD,CAAK4D,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAAhD,UACGkuB,EAAkB/2B,KAAI,SAACk3B,EAAI7pB,GAAL,OACrB,SAAC2qB,GAAD,CAAqBhT,aAAckS,EAAIe,KAAM5qB,EAAI,EAAG6qB,QAASnB,EAAkB11B,OAAQ82B,QAAS,SAAC/P,GAAD,OAASA,GAAOgP,EAAY/pB,EAAG+a,EAAM,IAAIgQ,SAAU,kBAAMX,EAAWpqB,IAAIuqB,SAAUA,GAAjKV,OACnB,UAACvzB,EAAA,EAAD,CAAKE,GAAI,CAAE0D,QAAS,OAAQsB,IAAK,GAAjC,WACE,SAACwvB,GAAD,CAASC,MAAOZ,EAAS5X,KAAMiX,KAC/B,SAACrsB,EAAA,EAAD,CAAQxJ,MAAM,QAAQ4J,QAAS6sB,EAAW5sB,WAAW,SAACsL,GAAA,EAAD,IAArD,UAAiE,SAACwR,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,8BAArB,+BAEhEgQ,IAAsB,SAAC3sB,EAAA,EAAD,CAASjK,MAAM,UAAf,UAAyB,SAACgN,EAAA,EAAD,WAAY,UAAC2Z,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,6BAA6BvL,MAAOwb,EAAzD,mCAA2F,4BAAS,CAAExb,MAAOwb,KAA7G,0CAIpE,UAACxsB,GAAA,EAAD,CAAa1H,GAAI,CAAE0D,QAAS,OAAQD,MAAO,QAA3C,WACE,SAACoD,EAAA,EAAD,CAAQ7G,GAAI,CAAEmE,SAAU,GAAK8C,QAAS,kBAAMua,EAAqB,CAAEsR,iBAAkBA,KAAoBnwB,SAAUA,EAAUuE,UAAW4rB,GAAkB,SAAC3rB,GAAA,EAAD,KAAe,SAACC,GAAA,EAAD,IAA0B/J,MAAOy1B,EAAkB,UAAY,YAAxO,UACE,UAAChzB,EAAA,EAAD,YACE,2BAAM,SAACkkB,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,oBAArB,sCACL6O,IAAmB,SAACxrB,EAAA,EAAD,WAAS,UAAC0c,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,uBAAuBvL,MAAOub,EAAnD,yBAAkF,4BAAS,CAAEvb,MAAOub,KAApG,wBAGhCnB,IAAmB,SAACjsB,EAAA,EAAD,CAAQ7G,GAAI,CAAEuS,WAAY,GAAKlV,MAAM,OAAO4J,QAAS4a,EAAQlf,SAAUA,EAAvE,UAAiF,SAACohB,GAAA,EAAD,YAM3G,SAASoQ,GAAT,GAOI,IAPkBhT,EAOnB,EAPmBA,aAAciT,EAOjC,EAPiCA,KAAMC,EAOvC,EAPuCA,QAASC,EAOhD,EAPgDA,QAASC,EAOzD,EAPyDA,SAAUR,EAOnE,EAPmEA,SAQ5Dl1B,GAAMC,EAAAA,EAAAA,GAAe,2BAArBD,EACAgQ,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACFlJ,GAAY+uB,EAAAA,EAAAA,GAAavT,GACzBla,GAAU8F,EAAAA,EAAAA,KAChB,IAAKpH,EAAW,OAAO,KACvB,IAAQgvB,EAAsChvB,EAAtCgvB,eAAgBzI,EAAsBvmB,EAAtBumB,kBACxB,OAAO,UAAChd,EAAA,EAAD,CAAWlP,GAAI,CAAEiF,EAAG,GAApB,WACL,UAACnF,EAAA,EAAD,CAAKE,GAAI,CAAEkJ,GAAI,EAAGxF,QAAS,OAAQyP,eAAgB,gBAAiBnO,IAAK,GAAzE,WACE,SAACsC,EAAA,EAAD,CAASjK,MAAM,OAAf,UACE,UAACgN,EAAA,EAAD,eAAc+pB,QAEhB,SAAC9sB,EAAA,EAAD,CAAStH,GAAI,CAAEmE,SAAU,GAAK9G,MAAO02B,IAAcK,EAAO,EAAK,UAAaA,EAAO,EAAKL,EAAW,QAAU,UAA7G,UACE,SAAC1pB,EAAA,EAAD,UAAa0pB,IAAcK,EAAO,GAAK,SAACpQ,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,gCAArB,+BAClCmQ,EAAO,EAAKL,GAAW,SAAC/P,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,gCAArB,kCACxB,SAACD,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,+BAArB,gCAEN,SAACnkB,EAAA,EAAD,WACE,UAAC4H,GAAA,EAAD,CAAa1H,GAAI,CAAEmE,SAAU,GAAK4C,KAAK,QAAvC,WACE,SAACoL,GAAA,GAAD,WACE,SAACA,GAAA,GAAD,CAAmBzV,SAAU43B,EAAS75B,MAAO25B,EAE3CnwB,WAAY,CAAEO,IAAK,EAAGC,IAAK4vB,EAASr0B,GAAI,CAAEkE,UAAW,WACrDlE,GAAI,CAAEyD,MAAO,OAAQ6H,OAAQ,OAAQtH,GAAI,QAE7C,SAAC6C,EAAA,EAAD,CAAQlE,SAAmB,IAATyxB,EAAYntB,QAAS,kBAAMqtB,EAAQ,IAArD,UACE,SAACM,GAAA,EAAD,OAEF,SAAC/tB,EAAA,EAAD,CAAQlE,SAAmB,IAATyxB,EAAYntB,QAAS,kBAAMqtB,EAAQF,EAAO,IAA5D,UACE,SAACS,GAAA,EAAD,OAEF,SAAChuB,EAAA,EAAD,CAAQlE,SAAUyxB,IAASC,EAASptB,QAAS,kBAAMqtB,EAAQF,EAAO,IAAlE,UACE,SAACU,GAAA,EAAD,OAEF,SAACjuB,EAAA,EAAD,CAAQlE,SAAUyxB,IAASC,EAASptB,QAAS,kBAAMqtB,EAAQD,IAA3D,UACE,SAACU,GAAA,EAAD,OAEF,SAACluB,EAAA,EAAD,CAAQxJ,MAAM,QAAQ4J,QAASstB,EAA/B,UACE,SAACS,GAAA,EAAD,eAKR,UAAC9gB,GAAA,GAAD,CAAMC,WAAS,EAACuB,QAAS,EAAGtB,QAAS,EAArC,WACE,SAACF,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAACqhB,GAAA,EAAD,CAAmB9T,aAAcA,EAAcla,QAASA,OAE1D,SAACiN,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UAAkB,SAACshB,GAAA,EAAD,CAAgB/J,SAAUwJ,MAC3C31B,OAAOC,QAAQitB,GAAmB/vB,KAAI,+BAAEmmB,EAAF,KAAW6S,EAAX,YAAoB,SAACjhB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UAAiC,SAACwhB,GAAA,EAAD,CAAkB9S,QAASA,EAAS+S,YAAaxmB,EAASmJ,KAAK1R,IAAI6uB,MAA7E7S,YAKxF,SAASkS,GAAT,GAAgG,IAA7EC,EAA4E,EAA5EA,MAAOxY,EAAqE,EAArEA,KAChBpd,GAAMC,EAAAA,EAAAA,GAAe,2BAArBD,EACR,GAAgCk0B,EAAAA,EAAAA,IAAa,GAA7C,eAAO7lB,EAAP,KAAa2U,EAAb,KAAqB9T,EAArB,KACMlE,GAAS1G,EAAAA,EAAAA,cAAY,SAACmyB,GAC1B,QAAKA,IACGrZ,EAAKre,SAAS03B,EAAKl5B,OAC1B,CAAC6f,IACJ,OAAO,iCACL,SAAC,EAAAjP,SAAD,CAAUC,UAAU,EAApB,UACE,SAAC,GAAD,CAAyBC,KAAMA,EAAMC,OAAQY,EAASX,SAAUqnB,EAAO5qB,OAAQA,OAEjF,SAAChD,EAAA,EAAD,CAAQC,WAAS,EAAC9G,GAAI,CAAEsL,OAxEX,IAwE+BjO,MAAM,OAAO4J,QAAS4a,EAAQ3a,WAAW,SAACquB,GAAA,EAAD,IAArF,UACE,SAACvR,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,wBAArB,wCC1KS,SAASuR,GAAT,GAAkG,IAAD,IAA1E7yB,SAAAA,OAA0E,SAAxD8yB,EAAwD,EAAxDA,UAC9C52B,GAAMC,EAAAA,EAAAA,GAAe,2BAArBD,EACkBsiB,GAAmB1b,EAAAA,EAAAA,YAAWC,EAAAA,GAAhDC,UAAavJ,IACrB,EAAoE8kB,GAAgBC,GAA5DuU,EAAxB,EAAQrU,aAAgBqU,gBAAmBlU,EAA3C,EAA2CA,qBACnC3S,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACF8mB,GAAiBz5B,EAAAA,EAAAA,UAAQ,kBAAMu5B,GAAa5mB,EAASmJ,KAAK3P,OAAOsV,QAAO,SAAC5b,EAAGoa,GAAJ,OAAYpa,GAAMoa,EAAIuH,SAAWvH,EAAIkM,WAAalH,EAAgB,EAAI,KAAI,KAAI,CAACtS,EAAU4mB,EAAWtU,IAClL,OAAO,SAACta,EAAA,EAAD,CAAQC,WAAS,EAACG,QAAS,kBAAMua,EAAqB,CAAEkU,iBAAkBA,KAAoB/yB,UAAWgzB,GAAkBhzB,EAAUuE,UAAWwuB,GAAkB,SAACvuB,GAAA,EAAD,KAAe,SAACC,GAAA,EAAD,IAA0B/J,MAAOq4B,EAAkB,UAAY,YAAhP,UACL,UAAC51B,EAAA,EAAD,YACE,2BAAM,SAACkkB,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,oBAAoBvL,MAAOid,EAAhD,sCACLD,IAAmB,SAACpuB,EAAA,EAAD,WAAS,UAAC0c,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,uBAAuBvL,MAAOid,EAAnD,oBAAyE,4BAAS,CAAEjd,MAAOid,KAA3F,gC,0CCR7BC,IAAUC,EAAAA,GAAAA,KAAgB5vB,EAAAA,GAAAA,IAAU,CAAEgV,KAAI,oBAAMpI,GAAAA,GAAAA,KAAcA,GAAAA,GAAAA,WACvDijB,GAAc,CACzB3Z,KAAKb,EAAAA,GAAAA,GAAa,GAAD,gBAAK/a,GAAAA,IAAL,QAAyBK,GAAAA,KAAiB,SAAAxE,GAAG,OAAIw5B,GAAQ3a,IAAI7e,MAC9EinB,QAAQnI,EAAAA,GAAAA,IAAUrI,GAAAA,GAAAA,QAAc,SAAClW,EAAGP,GAAJ,OAAYw5B,GAAQ3a,IAAI7e,OAGnD,SAAS25B,GAAiB/d,EAAyByN,EAAiCuQ,GACzF,IADiI,EAC3H3a,EAA0B,CAC9Bd,KAAM,GACNlS,OAAQ,CAAE4tB,OAAQ,GAAIC,MAAO,GAAIC,OAAQ,GAAIC,QAAS,GAAIC,MAAO,KAE7DjxB,EAAO,IAAIuU,IALgH,WAO/G3B,GAP+G,IAOjI,2BAAwB,CAAC,IAAD,EAAbmE,EAAa,QAChBma,EAAcpN,GAAAA,GAAAA,cAAuB/M,EAAIgM,YAAahM,EAAIhd,OAAQ6e,KAAKvZ,IAAIuZ,KAAKxZ,IAAIihB,EAAsC,EAAbtJ,EAAIhd,QAAagd,EAAI5R,QAElI1E,EAA0B,CAC9B4V,GAAIU,EAAIV,GAAIrc,IAAK+c,EAAIyE,OACrBvY,QAAO,yBACJ8T,EAAIyE,OAAS,IADV,UAEHzE,EAAIgM,YAAchM,EAAIgM,YAAYoO,SAAS,KAAOD,EAAc,IAAMA,GAFnE,GAGDt3B,OAAOoc,YAAYe,EAAIiM,SAASjsB,KAAI,SAAAq6B,GAAO,MAC5C,CAACA,EAAQp6B,IAAKo6B,EAAQp6B,IAAIm6B,SAAS,KAAOC,EAAQC,cAAgB,IAAMD,EAAQC,4BAG/E5wB,EAAKwC,OAAO,IACnBgT,EAAOhT,OAAO8T,EAAImG,SAAStC,KAAKna,GAChC7G,OAAOoG,KAAKS,EAAKwC,QAAQ2R,SAAQ,SAAApB,GAAC,OAAIxT,EAAK2U,IAAInB,OArBgF,8BAwBjI,GADAyC,EAAOd,MAAOe,EAAAA,GAAAA,IAAa,QAAIlW,IAAO,SAAAzI,GAAC,OAAI,KACvCq5B,EACF,cAAoBh3B,OAAOqJ,OAAOgT,EAAOhT,QAAzC,gBAAgB,KACR2X,KAAK,CAAEvE,GAAI,GAAIpT,OAAQ,KACjC,OAAOgT,ECIM,SAASqb,KAAY,IAAD,IACzB73B,GAAMC,EAAAA,EAAAA,GAAe,2BAArBD,EACR,GAA0D4G,EAAAA,EAAAA,YAAWC,EAAAA,GAA7DC,UAAkBwb,EAA1B,EAAqB/kB,IAAmBu6B,EAAxC,EAAwCA,YAChC9nB,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SAER,GAAsChM,EAAAA,EAAAA,UAAS,CAAEpF,KAAM,WAAY2oB,OAAQ,EAAGE,OAAQ,EAAGD,QAAS,EAAGE,MAAO,IAA5G,eAAOqQ,EAAP,KAAoBC,EAApB,KACMjQ,EAAwC,aAArBgQ,EAAYn5B,KAErC,GAAkCoF,EAAAA,EAAAA,eAASzE,GAA3C,eAAOqwB,EAAP,KAAkBqI,EAAlB,KAEA,GAAkChV,EAAAA,GAAAA,KAAlC,eAAO2T,EAAP,KAAkBsB,EAAlB,KAEA,GAA0El0B,EAAAA,EAAAA,UAASgM,EAASmkB,gBAAgB1sB,OAA5G,sBAAS4sB,EAAT,EAASA,kBAAT,IAA4B8D,QAAAA,OAA5B,MAAsCC,GAAAA,EAAtC,EAAoDC,EAApD,MACA1zB,EAAAA,EAAAA,YAAU,kBAAMqL,EAASmkB,gBAAgBzR,QAAO,SAACrV,EAAGknB,GAAJ,OAAW8D,EAAmB9D,QAAM,CAACvkB,EAAUqoB,IAE/F,IAAMC,EAAaH,EAAUC,GAAAA,EAAaA,GAAAA,EAAaD,EACjDI,GAAgBj0B,EAAAA,EAAAA,cAAY,SAAA6zB,GAAO,OAAInoB,EAASmkB,gBAAgB5zB,IAAI,CAAE43B,QAAAA,MAAY,CAACnoB,IAEnFjJ,GAAoByxB,EAAAA,EAAAA,GAAoBlW,GACxCmW,GAAkBvqB,EAAAA,EAAAA,KAElBwqB,GAAar7B,EAAAA,EAAAA,UAAQ,kBAAO2S,EAASmJ,KAAK3P,OAAO7K,SAAQ,CAACqR,IAEhE,GAA+CqS,GAAgBC,GAAvDE,GAAR,GAAQA,aAAcG,GAAtB,GAAsBA,qBACdkN,GAA8GrN,GAA9GqN,SAAU5D,GAAoGzJ,GAApGyJ,mBAAoBrF,GAAgFpE,GAAhFoE,wBAAyBuQ,GAAuD3U,GAAvD2U,aAAcwB,GAAyCnW,GAAzCmW,gBAAiBn1B,GAAwBgf,GAAxBhf,SAAUC,GAAc+e,GAAd/e,UACxG,GCnEa,SAAwB6e,GACrC,IAAQtS,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAAsChM,EAAAA,EAAAA,WAAS,kBAAMgM,EAAS4oB,YAAYnxB,IAAI6a,MAA9E,eAAOsW,EAAP,KAAoBC,EAApB,KAOA,OANAl0B,EAAAA,EAAAA,YAAU,kBAAMk0B,EAAe7oB,EAAS4oB,YAAYnxB,IAAI6a,MAAgB,CAACtS,EAAUsS,KACnF3d,EAAAA,EAAAA,YAAU,kBACRqL,EAAS4oB,YAAYlW,OAAOJ,GAAc,SAAClL,EAAG/J,EAAGtP,GAAP,MAAmB,WAANsP,GAAkBwrB,EAAe96B,QACxF,CAACukB,EAAcuW,EAAgB7oB,IAG1B,CAAE4oB,YAAAA,EAAaE,qBAFMx0B,EAAAA,EAAAA,cAAY,SAAC4B,GAAD,OAAmCoc,GAAgBtS,EAAS4oB,YAAYr4B,IAAI+hB,EAAcpc,KAAS,CAACoc,EAActS,KD4DtF+oB,CAAezW,GAAnF,MAAQsW,YAAevZ,GAAvB,GAAuBA,OAAQ2Z,GAA/B,GAA+BA,UAAaF,GAA5C,GAA4CA,oBACtCG,IAAWC,EAAAA,EAAAA,GAAY5W,EAAcsE,IAC3C,oBAAyCqS,SAAzC,IAAyCA,QAAzC,EAAyCA,GAAW3W,UAApD,QAAqF,GAA7ExU,GAAR,GAAQA,eAAwB9G,GAAhC,GAAwB0O,OAClByjB,GAAO,CAAC,KAAM,MAAMp6B,UAASq6B,EAAAA,GAAAA,OAGnCz0B,EAAAA,EAAAA,YAAU,kBACRqL,EAASmJ,KAAKiK,UAAU8U,KACxB,CAACA,EAAcloB,IAGjB,IAAMqpB,IAAcroB,EAAAA,EAAAA,SAAO,gBAE3BrM,EAAAA,EAAAA,YAAU,kBAAM,kBAAM00B,GAAYnoB,aAAW,IAC7C,IAAMooB,IAAiBh1B,EAAAA,EAAAA,cAAW,yBAAC,uGAuExBi1B,GAGAC,GAGAC,GAOAC,GApFwB,oHAoFxBA,GApFwB,WAqF/B,IAAM1uB,EAAS2uB,EAAehJ,MAC9B,OAAQ3lB,EAAqB,CAC3B4uB,QAAS,UACTjf,UAAW4e,KAAgBvuB,OAAAA,QAFZzL,GATVk6B,GA7EwB,WA8E/B,MAAwBI,EAAgBC,OAAhCC,EAAR,EAAQA,KAAMn+B,EAAd,EAAcA,MACd,OAAOm+B,OAAOx6B,EAAY,CACxBq6B,QAAS,QAASI,SAAUC,EAC5Btf,UAAW4e,KAAgBvuB,OAAQpP,IAP9B49B,GA1EwB,WA2E/B,MAAO,CAAEI,QAAS,QAAS5uB,YAAQzL,EAAWy6B,SAAUC,EAAgBtf,UAAW4e,OAJ5EA,GAvEwB,WAwE/B,OAAO7b,EAAKwc,YAAYvB,EAAkB,GAAG3zB,KAvEvC8d,EAA4LN,GAA5LM,gBAAiB+M,EAA2KrN,GAA3KqN,SAAU7Y,EAAiKwL,GAAjKxL,YAAaxV,EAAoJghB,GAApJhhB,aAAcyqB,EAAsIzJ,GAAtIyJ,mBAAoBrF,EAAkHpE,GAAlHoE,wBAAyBiQ,EAAyFrU,GAAzFqU,gBAAiB5C,EAAwEzR,GAAxEyR,gBAAiBkD,EAAuD3U,GAAvD2U,aAAcwB,EAAyCnW,GAAzCmW,gBAAiBn1B,EAAwBgf,GAAxBhf,SAAUC,EAAc+e,GAAd/e,UACjL6e,GAAiB2J,EAFW,wDAI7BkO,EAA0C,IAAIrf,IAC9CmZ,KACI90B,EAAQk1B,EAAkBc,QAAQ7S,IAC5B,EAAG+R,EAAkBlZ,SAAQ,SAAAif,GAAE,OAAID,EAAajf,KAAI2S,EAAAA,EAAAA,IAAoBuM,OAC/E/F,EAAkB9U,MAAM,EAAGpgB,GAAOgc,SAAQ,SAAAif,GAAE,OAAID,EAAajf,KAAI2S,EAAAA,EAAAA,IAAoBuM,QAEtFC,EAAerqB,EAASmJ,KAAK3P,OAAOwB,QAAO,SAAAsS,GAC/C,GAAIA,EAAI5R,MAAQlI,EAAU,OAAO,EACjC,GAAI8Z,EAAI5R,MAAQjI,EAAW,OAAO,EAClC,IAAM62B,EAAY94B,EAAa8b,EAAImG,SACnC,QAAa,OAAT6W,QAAS,IAATA,GAAAA,EAAW37B,SAAW27B,EAAUv7B,SAASue,EAAIgM,gBAG7ChM,EAAIkM,YAAaqE,EAAAA,EAAAA,IAAoBvL,MAErChF,EAAIuH,UAAYgS,OAChBvZ,EAAIkM,WAAayK,MACjB3W,EAAIkM,UAAYyK,GAAmBkG,EAAa9e,IAAIiC,EAAIkM,gBAGxD+Q,EAAQrD,GAAiBmD,EAAczT,EAAyBuQ,GAxBrC,WA0BVqD,EAAAA,EAAAA,GAAYxqB,EAAUsS,EAAcsE,EAAyB,IA1BnD,WA0B3BqS,EA1B2B,6DA4B3BwB,EA5B2B,WA4BdC,EAAAA,GAAAA,IAAczB,EAASA,SAAU3W,GAAcA,UA5BjC,aA4Bd,EAA8E5M,OAAO1O,KAAM,GA5B7E,sDA8BjC7G,OAAOw6B,OAAOF,GAAYG,EAAAA,GAAAA,IAAU,CAACH,EAAYxD,MAC7C4D,GAAoCC,EAAAA,GAAAA,IAAY,UAACL,EAAW51B,eAAZ,QAAuB,GAAIonB,GA/B9C,mDAiGjC,IAhEM8O,EAAaF,EACbG,EAAqD76B,OAAOC,QAAQ4W,GAAa1Z,KAAI,YAAmB,IAAD,eAAhBC,EAAgB,KAAX3B,EAAW,KAE3G,OADI2B,EAAIm6B,SAAS,OAAM97B,GAAgB,KAChC,CAAEA,MAAOoY,GAAAA,GAAAA,MAAYzW,GAAM2b,QAAStd,MAC1CoP,QAAO,SAAA+O,GAAC,OAAIA,EAAEne,OAASme,EAAEb,SAAWhD,EAAAA,KAEvC+hB,OAAa14B,GAEP07B,EAAY,IAAIC,SAAc,SAAA7tB,GAAC,OAAIgsB,GAAYnoB,QAAU7D,KAE3D8tB,EA3C6B,mBA2CNH,EAAY19B,KAAI,SAAAyc,GAAC,OAAIA,EAAEne,UA3CjB,CA2CyBi/B,IAAoC1hB,EAAOohB,EAC/Fa,EAAWriB,GAAmBC,GAAW8J,EAAiB3iB,OAAOqJ,OAAO+wB,EAAM/wB,QAAQnJ,SAAQ,SAAA0Z,GAAC,OAAIA,EAAEzc,KAAI,SAAAyc,GAAC,OAAIA,EAAExZ,WAASg6B,GAEzHrhB,EA9C2B,mBA8Cb8hB,EAAY19B,KAAI,SAAAyc,GAAC,OAAIA,EAAEb,YA9CV,EA8CqBhD,EAAAA,IAChDoR,EAAoC,CAAEC,OAAQ,EAAGE,OAAQ,EAAGD,QAAS,EAAGE,MAAOzI,IAAK0I,UAAWY,YAAYC,OAC7GqH,IACFsL,EAAiBha,MAAK2Z,EAAAA,GAAAA,IAAY,UAACL,EAAW51B,eAAZ,QAAuB,GAAIgrB,IAC7D3W,EAAQiI,MAAMjL,EAAAA,IAGVmlB,EAAeliB,EAErBxB,EAAQuC,GADJvC,GAAQ2jB,EAAAA,GAAAA,IAASH,EAAkBV,GAAY,kBAAyB,SAAzB,SAAGnzB,KAAH,SACrBwb,GAvDG,EAwDd7J,GAAStB,EAAOuB,EAASC,EAAMwf,EAAiB7V,EAAiB,CAClFpJ,UAAU,EAAME,eAAe,EAAMH,gBAAgB,EAAME,YAAY,IADtEhC,EAxD8B,EAwD9BA,MAAOwB,EAxDuB,EAwDvBA,KAGVxB,GAAQ2jB,EAAAA,GAAAA,IAAS3jB,EAAO,IAAI,SAAA7Z,GAAC,OAAI,KAE3By9B,EAAe1L,EAAWlY,EAAMgZ,WAAQpxB,EAC1Ci8B,EAAyB7jB,EAAMgZ,MAE7BjT,EAAO,CAAEwc,YAAauB,MAAM9C,GAAiB/G,KAAK,GAAGt0B,KAAI,SAAAQ,GAAC,MAAK,CAAE2Q,IAAK,GAAIzJ,KAAMkR,EAAAA,OAEhF+jB,EAAiB,KAAYyB,EAAwC,GAAbpD,EACxDuB,EAAkBuB,EAASO,OAAOC,YAAajC,EAAkC,GACjFkC,EAAwB,GAAIC,EAAmB,IAAIhhB,IACnDihB,EAAoB,GAuBpBjc,GAAUnI,EACbra,KAAI,SAAC1B,EAAO+O,GAAR,MAAe,CAAE/O,MAAAA,EAAO+J,IAAKuT,EAAQvO,OACzCK,QAAO,SAAA+O,GAAC,OAAIA,EAAEpU,KAAOuQ,EAAAA,KAElB8lB,GAA2C,GAhGhB,YAiGxBrxB,GACP,IAAMsxB,EAAS,IAAIC,OAAO,IAAIC,IAAI,mBAE5BC,EAAe,CACnBxC,QAAS,QACThd,GAAIjS,EAAGwO,KAAAA,EACP8S,mBAAoBuP,EACpB3L,SAAU0L,EACVc,UAAW1D,EACX7Y,QAAAA,IAGF,GADAmc,EAAOK,YAAYF,OAAO78B,GAChB,IAANoL,EAAS,CACX,IAAM4xB,EAA8B,CAAE3C,QAAS,QAASvgB,UAAWyJ,EAAiB3J,KAAM,CAACA,EAAMkiB,IACjGY,EAAOK,YAAYC,OAAch9B,GAEnC,IAAIi9B,OAAqC,EACnCC,EAAY,IAAIvB,SAAwB,SAAA7tB,GAAC,OAAImvB,EAAWnvB,KAC9D4uB,EAAOS,UAAP,2CAAmB,yGAAS11B,EAAT,EAASA,KAAT,KACTA,EAAK4yB,QADI,OAEV,YAFU,OAYV,UAZU,OAmBV,YAnBU,QAsBV,aAtBU,QA0BV,UA1BU,+BAGbtS,EAAOC,QAAUvgB,EAAKugB,OACtBD,EAAOG,QAAUzgB,EAAKygB,OACtBH,EAAOE,SAAWxgB,EAAKwgB,QACnBxgB,EAAKkzB,cACPxc,EAAKwc,YAAcxc,EAAKwc,YAAYlvB,QAAO,qBAAGyD,MAAkBzH,EAAK21B,WACrE,EAAAjf,EAAKwc,aAAY/Y,KAAjB,iBAAyBna,EAAKkzB,YAAY58B,KAAI,SAAA0H,GAAG,MAAK,CAAEyJ,IAAKzH,EAAK21B,OAAQ33B,IAAAA,QAC1E0Y,EAAKwc,YAAY15B,MAAK,SAAC0C,EAAGC,GAAJ,OAAUA,EAAE6B,IAAM9B,EAAE8B,OAAK8vB,OAAO6D,IAT3C,mCAaT3xB,EAAKgE,QACP2uB,EAAexY,KAAKna,EAAKgE,QACzB8wB,EAAiB5gB,IAAIlU,EAAK4V,KACrBkf,EAAiBra,OAAOza,EAAK4V,IACpCif,EAAY1a,KAAKna,EAAK4V,IAjBT,oCAoBbif,EAAY1a,KAAKna,EAAK4V,IApBT,oCAuBbqf,EAAOW,YACPJ,EAASx1B,GAxBI,4CA2BeA,EAAKka,OA3BpB,GA2BN2b,EA3BM,KA2BEC,EA3BF,KA4BbxV,EAAOI,MAAQoV,EACfxV,EAAOE,SAAWsV,EAAYD,EA7BjB,2BA+BNtJ,QAAQC,IAAI,QAASxsB,GA/Bf,YAiCV60B,EAAYl9B,OAjCF,oBAkCTie,EAAKif,EAAYlL,MAAQsL,EAASF,EAAQnf,GAC5CmgB,OAnCW,EAoCXpD,EAAeh7B,OAAS+8B,KAC1BqB,EAAOtD,OACMqC,EAAiBzgB,IAAIuB,KAAKmgB,EAAOvD,MAE3CuD,IAAMA,EAAOrD,OACdqD,EAzCW,iBAyCLd,EAAOK,YAAYS,GAzCd,+BA2CblB,EAAY1a,KAAKvE,GACbif,EAAYl9B,SAAW,EAAI25B,GAAa,WAC1C,IAAMsB,EAAyB,CAAEA,QAAS,YAC1CmC,EAAQ5gB,SAAQ,SAAA8gB,GAAM,OAAIA,EAAOK,YAAY1C,MAFH,GA5C/B,yFAAnB,sDAqDAmC,EAAQ5a,KAAK8a,GACbhB,EAAU+B,MAAK,kBAAMf,EAAOW,eAC5BZ,GAAc7a,KAAKsb,IAzEZ9xB,GAAI,EAAGA,GAAI2tB,EAAY3tB,KAAM,GAA7BA,IA2ET,IAASA,GAAI,EAAGA,GAAI,EAAGA,KACrBkxB,EAAY1a,KAAZ,MAAA0a,GAAW,SAASpd,EAAAA,GAAAA,IAAM,EAAG6Z,EAAa,KA7KX,OA+K3B2E,GAAaC,aAAY,kBAAMlF,GAAe,SAAEp5B,KAAM,UAAa0oB,MAAW,KA/KnD,UAgLX4T,QAAQiC,IAAI,CAACjC,QAAQkC,IAAIpB,IAAgBf,IAhL9B,QAgL3BoC,GAhL2B,OAiLjCC,cAAcL,IACd5D,GAAYnoB,QAAU,aAEjBmsB,IAMCxN,IACI0N,GAAW/d,GAAU6d,GAAQ//B,KAAI,SAAAyc,GAAC,OAAIA,EAAEwjB,aACxChC,IAAeT,EAAAA,GAAAA,IAAY,WAACL,EAAW51B,eAAZ,UAAuB,GAAIgrB,GACxD7oB,GAAO7G,OAAOqJ,OAAO+zB,IACK,OAA1B,WAAAxC,EAAWrpB,YAAX,iBAAiB2Z,QACnBrkB,GAAOA,GAAK1J,KAAI,kBAAsB,CAAE1B,MAAe,IAAvC,EAAGA,MAAyCgkB,KAA5C,EAAUA,UACI,OAA5B,WAAA2b,GAAa7pB,YAAb,iBAAmB2Z,QACrBrkB,GAAOA,GAAK1J,KAAI,gBAAG1B,EAAH,EAAGA,MAAOgkB,EAAV,EAAUA,KAAV,MAAsB,CAAEhkB,MAAAA,EAAOgkB,KAAoB,KAAd,OAACA,QAAD,IAACA,EAAAA,EAAQ,QAChEqY,EAAa,CACX9G,UAAW4J,EACX7J,SAAUqK,GACVv0B,KAAAA,MAGEqY,GAASD,GAAYie,GAAQ//B,KAAI,SAAAyc,GAAC,OAAIA,EAAEsF,UAASsZ,GAEvDG,GAAoB,CAAEzZ,OAAQA,GAAO/hB,KAAI,SAAAuiB,GAAK,OAAIA,EAAM2d,eAAcxE,UAAWyE,KAAKjV,UArBtFlB,EAAOC,OAAS,EAChBD,EAAOG,OAAS,EAChBH,EAAOE,QAAU,EACjBF,EAAOI,MAAQ,GAoBjBsQ,GAAe,oBAAK1Q,GAAN,IAAc1oB,KAAM,WAAYgpB,WAAYW,YAAYC,SA5MrC,4CA6MhC,CAAClG,EAActS,EAAU8oB,GAAqBR,EAAY9V,GAAc6R,IAErExM,GAAa,iBAAG/Z,SAAH,IAAGA,QAAH,EAAGA,GAAgBjG,YAAnB,QAA2B,iBAExCioB,IAAcxrB,EAAAA,EAAAA,cAAY,SAAAurB,GAC9BlN,GAAqB,CAAEkN,SAAAA,IACvBoI,OAAa14B,KACZ,CAACojB,KACEE,IAA0CxlB,EAAAA,EAAAA,UAAQ,WACtD,OAAO2J,IAAQiyB,IAAY,CAAEjyB,KAAAA,GAAMiyB,SAAAA,MAClC,CAACjyB,GAAMiyB,KAEJyE,IAAiB,SAAC7M,GAAA,EAAD,CACrB5E,mBAAoBA,GACpB6E,UAAW,SAAApb,GAAM,OAAIiN,GAAqB,CAAEsJ,mBAAoBvW,KAChE5R,WAAYikB,IAGd,OAAO,UAAC9mB,EAAA,EAAD,CAAK4D,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAAhD,UACJuyB,IAAc,UAAChQ,GAAA,EAAD,CAAOC,SAAS,UAAUrqB,QAAQ,SAAlC,mGAAgI,SAACq/B,GAAA,EAAD,CAAM38B,UAAW48B,EAAAA,GAAYrJ,GAAG,YAAhC,uBAAhI,yBAEd1R,KAAe,UAAC5b,EAAA,WAAD,CAAsBrL,MAAOinB,GAA7B,WAEd,UAACxN,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,WAEE,SAACF,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAI+W,GAAI,EAAG1V,GAAI,EAAGvR,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAA5E,UAEE,SAAClF,EAAA,EAAD,WAAK,SAAC48B,GAAA,EAAD,CAAevb,aAAcA,EAAcmW,gBAAiBA,SAInE,UAACpjB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAI+W,GAAI,EAAG1V,GAAI,EAAGvR,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAA5E,WACE,UAACkK,EAAA,EAAD,YACE,UAACjG,EAAA,EAAD,YACE,SAACoB,EAAA,EAAD,CAAYia,cAAY,EAAxB,SAA0BzlB,EAA1B,yCACA,SAAC6qB,GAAA,EAAD,CAAkBC,UAAU,MAAM7kB,OAAO,UAAChF,EAAA,EAAD,YACvC,SAACuK,EAAA,EAAD,CAAYlN,QAAQ,KAApB,SAA0B0B,EAA1B,yDACA,SAACwL,EAAA,EAAD,UAAaxL,EAAb,0DAFF,UAIE,SAACiB,EAAA,EAAD,WACE,SAAC0lB,GAAD,CAAuBC,wBAAyBA,GAAyBC,2BAA4B,SAAAD,GAAuB,OAAIjE,GAAqB,CAAEiE,wBAAAA,KAA4B9iB,SAAUikB,YAKnM,SAAC4L,GAAD,CAAuB7vB,SAAUikB,QAEnC,SAAChB,GAAD,QAIF,UAAC1R,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAI+W,GAAI,EAAG1V,GAAI,EAAGvR,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAA5E,WACE,SAACyc,GAAD,CAAmB9e,SAAUikB,KAG7B,SAAC4O,GAAD,CAAa7yB,SAAUikB,EAAkB6O,UAAWA,KAGpD,SAAC5C,GAAD,CAAalwB,SAAUikB,KAEvB,SAAC/f,EAAA,EAAD,CACEC,WAAS,EACTI,UAAW8uB,IAAe,SAAC7uB,GAAA,EAAD,KAAe,SAACC,GAAA,EAAD,IACzC/J,MAAO24B,GAAe,UAAY,YAClC/uB,QAAS,kBAAMua,GAAqB,CAAEwU,cAAeA,MACrDrzB,SAAUikB,EALZ,SAOK/nB,EAPL,uCAUA,UAACqQ,EAAA,EAAD,YACE,SAACjG,EAAA,EAAD,UAAcpK,EAAd,sCACA,SAACuD,GAAA,EAAD,CAAqBC,SAAUA,GAAUC,UAAWA,GAClDC,OAAQ,SAAAF,GAAQ,OAAImf,GAAqB,CAAEnf,SAAAA,KAC3CG,QAAS,SAAAF,GAAS,OAAIkf,GAAqB,CAAElf,UAAAA,KAC7CG,QAAS,SAACJ,EAAUC,GAAX,OAAyBkf,GAAqB,CAAEnf,SAAAA,EAAUC,UAAAA,KACnEK,SAAUikB,QAKd,SAACgM,GAAD,CAAgBjwB,SAAUikB,UAK7BoR,IAAQuE,IACT,UAAC70B,GAAA,EAAD,YACIswB,IAAQuE,IACV,UAACh1B,GAAA,EAAD,CAAgB5E,SAAUikB,IAAqBzF,EAC7Crc,OAAO,UAACkf,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,QAAQvL,MAAO8e,GAApC,UACJ,CAAE9e,MAAO8e,IADL,aADT,WAIE,SAACx8B,GAAA,EAAD,WACE,SAACqP,EAAA,EAAD,CAAYlN,QAAQ,UAAUE,MAAM,YAApC,SACGwB,EAAE,0BAGP,SAAC2I,EAAA,EAAD,IACCm1B,GAAAA,EAAAA,KAAwB,SAAA//B,GAAC,OAAI,SAAC5B,GAAA,EAAD,CAC5BiM,QAAS,kBAAMua,GAAqB,CAAEgW,gBAAiB56B,KAD3B,UAE5B,UAAConB,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,QAAQvL,MAAO9b,EAApC,UACG,CAAE8b,MAAO9b,GADZ,cAF2CA,UAO/C,UAAC2K,GAAA,EAAD,CAAgB5E,SAAUikB,IAAqBzF,EAC7CnhB,GAAI,CAAEgH,aAAc,mBACpBlC,OAAO,UAACkf,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,SAASvL,MAAOye,EAArC,UACJ,CAAEze,MAAOye,GADL,cAFT,WAKE,SAACn8B,GAAA,EAAD,WACE,SAACqP,EAAA,EAAD,CAAYlN,QAAQ,UAAUE,MAAM,YAApC,SACGwB,EAAE,2BAGP,SAAC2I,EAAA,EAAD,KACC8V,EAAAA,GAAAA,IAAM,EAAG2Z,GAAAA,GAAY9U,UAAUhmB,KAAI,SAAAS,GAAC,OAAI,SAAC5B,GAAA,EAAD,CACvCiM,QAAS,kBAAMmwB,EAAcx6B,IADU,UAEvC,UAAConB,GAAA,EAAD,CAAOnlB,EAAGA,EAAGolB,QAAQ,SAASvL,MAAO9b,EAArC,UACG,CAAE8b,MAAO9b,GADZ,eAFsDA,UAO1D,SAAC8sB,GAAA,EAAD,CAAkBC,UAAU,MAAM7kB,MAAQgmB,GAA8C,GAAzBjsB,EAAE,qBAAjE,UACE,2BACE,SAACgI,EAAA,EAAD,CACElE,UAAWwe,IAAiB2J,MAAuB6O,EAAAA,GAAAA,IAAY,OAAC9zB,SAAD,IAACA,QAAD,EAACA,GAAM+2B,aAAc9R,IACpFztB,MAAOupB,EAAmB,QAAU,UACpC3f,QAAS2f,EAAmB,kBAAMsR,GAAYnoB,WAAYooB,GAC1DjxB,UAAW0f,GAAmB,SAACoO,GAAA,EAAD,KAAY,SAAC6H,EAAA,EAAD,IAC1C78B,GAAI,CAAEgH,aAAc,mBALtB,SAME4f,EAAmB,SAAW,6BAKnCzF,IAAgB,SAAC+E,GAAD,CAAkBC,OAAQyQ,EAAalQ,cAAAA,GAAe8Q,gBAAAA,MACzE,SAAC13B,EAAA,EAAD,WACE,SAAC0uB,GAAD,CAAW7rB,SAAUikB,IAAqBkE,GAAoB2D,UAAWA,EAAWC,SAAUA,GAAUC,YAAaA,GAAaC,aAAc9D,QAElJ,SAAC5b,EAAA,EAAD,WACE,UAACjG,EAAA,EAAD,YACE,UAACnJ,EAAA,EAAD,CAAK4D,QAAQ,OAAOC,WAAW,SAASqB,IAAK,EAAGwJ,GAAI,EAApD,WACE,SAACnE,EAAA,EAAD,CAAYrK,GAAI,CAAEmE,SAAU,GAA5B,SACG+Z,IAAS,wCAAc,4BAASA,GAAO1gB,SAA9B,yBAAqEkpB,GAArE,OAAwFmR,KAAa,oDAA0B,4BAAU,IAAIyE,KAAKzE,IAAY9Q,0BACpK,wEAEN,SAAClgB,EAAA,EAAD,CAAQlE,UAAWub,GAAO1gB,OAAQH,MAAM,QAAQ4J,QAAS,kBAAM0wB,GAAoB,CAAEzZ,OAAQ,GAAI2Z,UAAW,KAA5G,8BAEF,UAAC3jB,GAAA,GAAD,CAAMC,WAAS,EAACzQ,QAAQ,OAAO0Q,QAAS,EAAxC,WACE,SAACF,GAAA,GAAD,CAAMG,MAAI,EAAV,UAAW,SAAC,KAAD,CAAetN,KAAK,aAC/B,SAACmN,GAAA,GAAD,CAAMG,MAAI,EAAV,UAAW,SAAC,KAAD,CAAgBtN,KAAK,aAChC,SAACmN,GAAA,GAAD,CAAMG,MAAI,EAAClQ,SAAU,KACrB,SAAC+P,GAAA,GAAD,CAAMG,MAAI,EAAV,UAAW,UAACyoB,GAAA,EAAD,CAAwBC,WAAS,EAACtiC,MAAOk8B,EAAaj6B,SAAU,SAAC0G,EAAGxG,GAAJ,OAAUgJ,EAAkB,CAAE+wB,YAAa/5B,KAAMmK,KAAK,QAAtH,WACT,SAACi2B,GAAA,EAAD,CAAcviC,OAAO,EAAOkI,UAAWg0B,EAAvC,8BACA,SAACqG,GAAA,EAAD,CAAcviC,OAAO,EAAMkI,SAAUg0B,EAArC,gDAKR,SAACjf,GAA0BulB,SAA3B,CAAoCxiC,MAAOqwB,GAA3C,UACE,SAACoS,GAAD,CAAWhf,OAAQA,GAAQiD,aAAcA,EAActb,KAAMA,GAAM8wB,YAAaA,EAAah0B,WAAYikB,YAKjH,SAASsW,GAAT,GAMI,IANiBhf,EAMlB,EANkBA,OAAQiD,EAM1B,EAN0BA,aAActb,EAMxC,EANwCA,KAAM8wB,EAM9C,EAN8CA,YAAah0B,EAM3D,EAN2DA,SAmB5D,OAXazG,EAAAA,EAAAA,UAAQ,kBAAM,SAAC,EAAA8Q,SAAD,CAAUC,UAAU,SAACqB,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,MAAzE,gBACxB4S,QADwB,IACxBA,OADwB,EACxBA,EAAQ/hB,KAAI,SAACuiB,EAAO1gB,GAAR,OAAkBmjB,GAAgBtb,IAAQ,SAACs3B,GAAD,CAErDhc,aAAcA,EACdzC,MAAOA,EACPhI,QAAS7Q,EAJ4C,UAMrD,SAACu3B,GAAD,CAAkBp/B,MAAOA,EAAO0gB,MAAOA,EAAOiY,YAAaA,EAAah0B,SAAUA,KAL7E3E,EAAQ0gB,EAAM2e,eAQV,CAACnf,EAAQiD,EAActb,EAAM8wB,EAAah0B,IAGzD,SAASy6B,GAAT,GAKI,IALwBp/B,EAKzB,EALyBA,MAAO0gB,EAKhC,EALgCA,MAAOiY,EAKvC,EALuCA,YAAah0B,EAKpD,EALoDA,SAM/C0lB,GAAWiV,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,MACXC,GAAOt6B,EAAAA,EAAAA,cAAY,WACvB,IAAMu6B,EAAQrV,EAASsV,SAASvE,MAAM,KACtCsE,EAAMlO,MACN+N,EAAS,GAAD,OAAIG,EAAML,KAAK,KAAf,gBAAmC,CAAEh2B,MAAO,CAAEqX,MAAAA,OACrD,CAAC6e,EAAU7e,EAAO2J,EAASsV,WAE9B,OAAO,SAAC7R,GAAD,CAAkB9tB,MAAOA,EAAO+tB,aAAc4K,EAAah0B,SAAUA,EAC1EspB,kBAAkB,SAACplB,EAAA,EAAD,CAAQxJ,MAAM,OAAO0J,KAAK,QAAQG,WAAW,SAAC02B,EAAA,EAAD,IAAa32B,QAASw2B,EAAnE,2BAStB,SAASN,GAAT,GAA+E,IAAjDh9B,EAAgD,EAAhDA,SAAUghB,EAAsC,EAAtCA,aAAczC,EAAwB,EAAxBA,MAAOhI,EAAiB,EAAjBA,QACnD7H,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACgB4W,EAA8BvE,GAAgBC,GAA9DE,aAAgBoE,wBAExB,GAA0B3D,EAAAA,GAAAA,KAA1B,eAAO+b,EAAP,KAAcC,EAAd,MACAt6B,EAAAA,EAAAA,YAAU,kBAAMqL,EAASmJ,KAAKiK,WAAU,SAACxG,GAAD,OAAQiD,EAAM9gB,SAAS6d,IAAOqiB,SAAa,CAACjvB,EAAU6P,EAAOof,IACrG,IAAMC,GAAa7hC,EAAAA,EAAAA,UAAQ,kBAAM2hC,GAASnf,EAAMviB,KAAI,SAAAqN,GAAC,OAAIqF,EAASmJ,KAAK1R,IAAIkD,QAAM,CAACq0B,EAAOnf,EAAO7P,IAC1FipB,GAAWC,EAAAA,EAAAA,GAAY5W,EAAcsE,EAAyBsY,GAC9DC,GAAgB9hC,EAAAA,EAAAA,UAAQ,kBAAM47B,GAAa,CAAEjyB,KAAMiyB,EAAS3W,GAAe5M,OAAQujB,SAAAA,EAAUphB,QAAAA,KAAY,CAACohB,EAAUphB,EAASyK,IACnI,OAAK6c,GACE,SAACl4B,EAAA,WAAD,CAAsBrL,MAAOujC,EAA7B,SACJ79B,IAFwB,K,2LEjfd,SAAS89B,GAAT,GAAyF,IAA3DC,EAA0D,EAA1DA,MAAO/S,EAAmD,EAAnDA,SAC1CtsB,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACR,GAA+Bk0B,EAAAA,EAAAA,IAAa,GAA5C,eAAO7lB,EAAP,KAAaixB,EAAb,KAAqBhxB,EAArB,KAEA,OAAO,iCACL,SAACU,GAAA,EAAD,CAAcC,KAAMZ,EAAMa,QAASZ,EAAQ2gB,eAAgB,CAAE9E,SAAU,MAAvE,UACE,SAACoV,GAAD,CAAgBF,MAAOA,EAAO/S,SAAUA,EAAUhe,OAAQA,OAE5D,SAACkxB,GAAA,EAAD,CAASv5B,OAAO,SAACuF,EAAA,EAAD,UAAaxL,EAAb,0CAAgD8qB,UAAU,MAAM2U,OAAK,EAArF,UACE,SAACz3B,EAAA,EAAD,CAAQxJ,MAAM,OAAO0J,KAAK,QAAQE,QAASk3B,EAA3C,UAAoD,SAACI,GAAA,EAAD,WAI1D,SAASH,GAAT,GAAiH,IAAvFF,EAAsF,EAAtFA,MAAO/S,EAA+E,EAA/EA,SAAUhe,EAAqE,EAArEA,OACjC0B,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAAgEpJ,EAAAA,EAAAA,YAAWC,EAAAA,GAAnEC,UAAkBwb,EAA1B,EAAqB/kB,IAAmB8vB,EAAxC,EAAwCA,kBAChBzG,EAA8BvE,GAAgBC,GAA9DE,aAAgBoE,wBACV/O,GAAYjR,EAAAA,EAAAA,YAAWK,EAAAA,GAA7BD,KACF6Y,GAAQxiB,EAAAA,EAAAA,UAAQ,WACpB,IAAMsiC,EAAS3vB,EAASmJ,KAAK1R,IAAd,OAAkB43B,QAAlB,IAAkBA,EAAAA,EAAS,IACpCO,GAASvjB,EAAAA,GAAAA,IAAUgR,GAAmB,SAACzQ,EAAID,GAAL,OAAcA,KAAI,OAAKgjB,QAAL,IAAKA,OAAL,EAAKA,EAAQlc,SAAUkc,EAAS3vB,EAASmJ,KAAK1R,IAAImV,MAChH,OAAOzc,OAAOqJ,OAAOo2B,GAAQ50B,QAAO,SAAA9H,GAAC,OAAIA,OACxC,CAAC8M,EAAUqd,EAAmBgS,IAC3BpG,GAAWC,EAAAA,EAAAA,GAAY5W,EAAcsE,EAAyB/G,EAAOyM,EAAWtc,EAAS8d,QAAQrmB,IAAI6kB,QAAY/sB,GACjHsgC,GAAoBxiC,EAAAA,EAAAA,UAAQ,kBAAM47B,GAAa,CAAEjyB,KAAMiyB,EAAS3W,GAAe5M,OAAQujB,SAAAA,EAAUphB,QAAAA,KAAY,CAACyK,EAAc2W,EAAUphB,IAC5I,OAAO,SAAC,EAAA1J,SAAD,CAAUC,UAAU,SAACqB,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,MAAzE,SACJozB,IAAqB,SAAC54B,EAAA,WAAD,CAAsBrL,MAAOikC,EAA7B,UACpB,SAAC5S,GAAD,CAAkBC,cAAc,EAAME,kBAAkB,iCAAE,SAAC,KAAD,CAAellB,KAAK,WAAU,SAAC,KAAD,CAAgBA,KAAK,aAAeilB,mBAAmB,+BAAE,SAACnlB,EAAA,EAAD,CAAQE,KAAK,QAAQ1J,MAAM,QAAQ4J,QAASkG,EAA5C,UAAqD,SAAC6nB,GAAA,EAAD,cC1B5M,IAAM2J,GAAe,CAAE/qB,GAAI,EAAG+W,GAAI,EAAG9W,GAAI,EAAGoB,GAAI,GAAI2V,GAAI,IAElDgU,IAAwBC,EAAAA,EAAAA,OAAK,kBAAM,kCAE1B,SAASC,GAAT,GACgF,IADnDC,EACkD,EADlDA,WAAYzc,EACsC,EADtCA,QAASpV,EAC6B,EAD7BA,KAAMa,EACuB,EADvBA,QAE7DlP,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACAgQ,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACFmwB,GAAe77B,EAAAA,EAAAA,cAAY,SAACsY,GAChCsjB,EAAWtjB,GACX1N,MACC,CAACgxB,EAAYhxB,IACVkxB,GAAsB97B,EAAAA,EAAAA,cAAY,SAACkE,EAAOtC,GAAR,gBAAC,oBAAwBsC,GAAUtC,GAAnC,IAA2Cm6B,SAAU,CAAC5c,OAAa,CAACA,IAE5G,GAAoF6c,EAAAA,EAAAA,YAAWF,GAAD,SAAC,YAA0BG,EAAAA,GAAAA,OAA3B,IAAkDF,SAAU,CAAC5c,MAA3J,eAAO+c,EAAP,KAAqBC,EAArB,KAEA,GAA+Bxd,EAAAA,GAAAA,KAA/B,eAAOC,EAAP,KAAgBC,EAAhB,MACAxe,EAAAA,EAAAA,YAAU,WAAQ,OAAOqL,EAASmJ,KAAKiK,UAAUD,KAAgB,CAACnT,EAAUmT,IAE5E,IAAMud,GAAOtH,EAAAA,GAAAA,KAEPuH,GAAgBtjC,EAAAA,EAAAA,UAAQ,kBAAMujC,EAAAA,GAAAA,QAAyB,IACvDC,GAAYxjC,EAAAA,EAAAA,UAAQ,WACxB,IAAMyjC,GAAaC,EAAAA,GAAAA,GAAeP,EAAcG,GAChD,OAAOzd,GAAWlT,EAASmJ,KAAK3P,OAAOwB,OAAO81B,GAAYxjC,KAAI,SAAAggB,GAAG,OAAIA,EAAIV,MAAI2C,MAAM,EAAGugB,GAAaY,MAClG,CAACxd,EAASlT,EAAU2wB,EAAeH,EAAcE,IAEpD,OAAO,SAAC1xB,GAAA,EAAD,CAAcC,KAAMZ,EAAMa,QAASA,EAAS+f,eAAgB,CAAE9E,SAAU,MAAxE,UACL,UAACngB,EAAA,EAAD,YACE,UAACI,EAAA,EAAD,CAAajJ,GAAI,CAAEyX,GAAI,EAAG/T,QAAS,OAAQyP,eAAgB,gBAAiBxP,WAAY,UAAxF,WACE,UAAC0G,EAAA,EAAD,CAAYlN,QAAQ,KAApB,UAA0BmlB,GAAU,SAACnT,GAAA,EAAD,CAAS7B,IAAK4a,GAAAA,EAAAA,KAAY5F,KAAe,KAA7E,IAAoFzjB,EAApF,4CACA,SAACoP,EAAA,EAAD,CAAahH,QAAS8G,QAExB,SAACvG,EAAA,EAAD,KACA,UAACyB,EAAA,EAAD,YACE,SAAC,EAAA+D,SAAD,CAAUC,UAAU,SAACqB,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,MAAzE,UACE,SAACszB,GAAD,CAAuBS,aAAcA,EAAcC,qBAAsBA,EAAsBO,mBAAiB,OAElH,SAAC//B,EAAA,EAAD,CAAK4yB,GAAI,EAAT,UACE,SAAC,EAAA1lB,SAAD,CAAUC,UAAU,SAACqB,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,MAAzE,UACE,SAAC4I,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAGsB,QAAS,CAAE9B,GAAI,EAAGC,GAAI,EAAGoB,GAAI,GAAzD,SACGyqB,EAAUvjC,KAAI,SAAAsf,GAAE,OACf,SAACvH,GAAA,GAAD,CAAMG,MAAI,EAAUT,GAAI,EAAxB,UACE,SAACoa,GAAA,EAAD,CACErG,WAAYlM,EACZqkB,cAAc,SAAC7B,GAAD,CAAoBC,MAAOziB,IACzCxU,QAAS+3B,KAJGvjB,oB,6DCrC1BskB,IAAgBC,EAAAA,GAAAA,IAAkB,QAAIC,EAAAA,KAE7B,SAASC,GAAT,GAAgL,IAArJnB,EAAoJ,EAApJA,WAAYoB,EAAwI,EAAxIA,cAAejzB,EAAyH,EAAzHA,KAAMa,EAAmH,EAAnHA,QACjElP,GAAMC,EAAAA,EAAAA,GAAe,CAAC,iBAAkB,cAAe,oBAAvDD,EACAgQ,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACFmwB,GAAe77B,EAAAA,EAAAA,cAAY,SAACsY,GAChCsjB,EAAWtjB,GACX1N,MACC,CAACgxB,EAAYhxB,IAEhB,GAA+B+T,EAAAA,GAAAA,KAA/B,eAAOC,EAAP,KAAgBC,EAAhB,MACAxe,EAAAA,EAAAA,YAAU,kBAAMqL,EAAS8d,QAAQ1K,UAAUD,KAAc,CAACA,EAAanT,IAEvE,IAAMuxB,GAAezhC,EAAAA,EAAAA,IAAW,kBAAM4sB,GAAAA,EAAAA,SAAoB,IAE1D,GAA4B1oB,EAAAA,EAAAA,UAAmB,CAAC,EAAG,EAAG,IAAtD,eAAO1D,EAAP,KAAekhC,EAAf,KACA,GAAoCx9B,EAAAA,EAAAA,UAAS,IAA7C,eAAOy9B,EAAP,KAAmBC,EAAnB,KACMC,GAAqBC,EAAAA,EAAAA,kBAAiBH,GAEtCI,GAAexkC,EAAAA,EAAAA,UAAQ,oCAAOkkC,GAAgBre,GAAWlT,EAAS8d,QAAQtkB,OAC7EwB,QAAO+1B,EAAAA,GAAAA,GAAe,CAAEe,WAAYR,EAAehhC,OAAAA,EAAQuH,KAAM85B,IAAsBI,EAAAA,GAAAA,IAAoBR,KAC3G/gC,MAAKwhC,EAAAA,GAAAA,GAAY,UAACC,GAAAA,GAAAA,aAAD,QAA2B,IAAI,GAAOC,EAAAA,GAAAA,IAAkBX,KACzEjkC,KAAI,SAAAivB,GAAM,OAAIA,EAAO3P,aAHK,QAGG,KAC5B,CAACsG,EAASlT,EAAUuxB,EAAcjhC,EAAQghC,EAAeK,IAE7D,OAAO,SAAC3yB,GAAA,EAAD,CAAcC,KAAMZ,EAAMa,QAASA,EAAnC,UACL,UAAClF,EAAA,EAAD,YACE,SAACI,EAAA,EAAD,CAAajJ,GAAI,CAAEyX,GAAI,GAAvB,UACE,UAACvD,GAAA,GAAD,CAAMC,WAAS,EAAf,WACE,SAACD,GAAA,GAAD,CAAMG,MAAI,EAAClQ,SAAU,EAArB,UACE,UAACkG,EAAA,EAAD,CAAYlN,QAAQ,KAApB,UAA0BgjC,GAAgB,SAAChxB,GAAA,EAAD,CAAS7B,IAAK4a,GAAAA,EAAAA,YAAmBiY,KAAqB,KAAhG,IAAuGthC,EAAvG,gEAEF,SAACqV,GAAA,GAAD,CAAMG,MAAI,EAAV,UACE,SAACpG,EAAA,EAAD,CAAahH,QAAS8G,YAI5B,SAACvG,EAAA,EAAD,KACA,UAACyB,EAAA,EAAD,YACE,UAACiL,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAG5F,GAAI,EAAhC,WACE,SAAC0F,GAAA,GAAD,CAAMG,MAAI,EAAV,UACE,SAACyoB,GAAA,EAAD,CAAwB98B,GAAI,CAAEsL,OAAQ,QAAU7Q,MAAO0E,EAAQ4H,KAAK,QAApE,SACGk5B,EAAAA,GAAAA,KAAgB,SAAAe,GAAI,OAAI,SAAChE,GAAA,EAAD,CAAyBviC,MAAOumC,EAAM/5B,QAAS,kBAAMo5B,EAAUN,GAAc5gC,EAAQ6hC,KAArF,UACvB,UAAClhC,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAzB,WAA4B,4BAASg8B,KAAc,SAAC,KAAD,CAAc9gC,MAAO,QAD9B8gC,WAKhD,SAAC9sB,GAAA,GAAD,CAAMG,MAAI,EAAClQ,SAAU,EAArB,UACE,SAACjH,GAAA,EAAD,CACE+jC,WAAS,EACTl6B,KAAK,QACLtM,MAAO6lC,EACP5jC,SAAU,SAAC0G,GAAD,OAAyCm9B,EAAcn9B,EAAEmR,OAAO9Z,QAC1EsB,MAAO8C,EAAE,0BACTmB,GAAI,CAAEsL,OAAQ,QACd41B,WAAY,CACVlhC,GAAI,CAAEsL,OAAQ,iBAKtB,SAAC4I,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,SACGssB,EAAavkC,KAAI,SAAAgvB,GAAQ,OACxB,SAACjX,GAAA,GAAD,CAAMG,MAAI,EAAgBT,GAAI,EAAG+W,GAAI,EAAG9W,GAAI,EAAGoB,GAAI,EAAnD,UACE,SAACksB,GAAA,EAAD,CACEhW,SAAUA,EACVlkB,QAAS+3B,EACTc,cAAc,SAAC7B,GAAD,CAAoB9S,SAAUA,OAJhCA,gBCpD5B,IAAMiW,IAAevC,EAAAA,EAAAA,OAAK,kBAAM,kCAEjB,SAASwC,KAAoB,IAAD,EACzC,GAA6E57B,EAAAA,EAAAA,YAAWC,EAAAA,GAAxF,IAAQC,UAAagvB,EAArB,EAAqBA,eAAqBxT,EAA1C,EAAqC/kB,IAAqBuQ,EAA1D,EAA0DA,eAClC8Y,EAA8BvE,GAAgBC,GAA9DE,aAAgBoE,wBACxB,GAA2BhgB,EAAAA,EAAAA,YAAWK,EAAAA,GAA9BgyB,EAAR,EAAQA,SAAUjyB,EAAlB,EAAkBA,KACZylB,EAAW,UAAGwM,EAAS3W,UAAZ,aAAG,EAAwBmK,YAC5C,GAAgCzoB,EAAAA,EAAAA,UAAS,IAAzC,eAAOsoB,EAAP,KAAiBmW,EAAjB,KACMC,GAAap+B,EAAAA,EAAAA,cAAY,kBAAMm+B,EAAY3M,KAAiB,CAACA,IAC7D6M,GAAar+B,EAAAA,EAAAA,cAAY,kBAAMm+B,EAAY,MAAK,KAGtD99B,EAAAA,EAAAA,YAAU,WACJ2nB,GAAYA,IAAawJ,GAC3B2M,EAAY3M,KACb,CAACxJ,EAAUwJ,IAEd,IAAM/5B,GAAQoB,EAAAA,GAAAA,KACRylC,GAAaC,EAAAA,GAAAA,GAAc9mC,EAAM+mC,YAAYC,GAAG,OAEhDC,GAAY3lC,EAAAA,EAAAA,UAAQ,kBAAMovB,GAAeA,EAAYtK,SAASxjB,OAAS,IAAK,SAAC0R,EAAA,EAAD,WAAW,SAACjG,EAAA,EAAD,WAAa,SAACE,GAAA,EAAD,CAAiBC,SAAUkiB,EAAYtK,iBAAwC,CAACsK,IAClLwW,GAAaC,EAAAA,GAAAA,GAAY5gB,GAAzB2gB,SACFE,GAAmBvB,EAAAA,EAAAA,kBAAiBqB,GACpCG,GAAgB/lC,EAAAA,EAAAA,UAAQ,kBAAM,IAAIyd,IAAIqoB,KAAmB,CAACA,IAChE,OAAO,UAACliC,EAAA,EAAD,YACL,SAAC,EAAAkN,SAAD,CAAUC,UAAU,EAApB,UACE,SAACm0B,GAAD,CACEjW,SAAUA,EACV+W,QAAM,EACNn0B,QAASyzB,EACT1B,cAAc,SAACqC,GAAD,CAAuBhC,cAAexzB,EAAewzB,qBAGvE,UAACjsB,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,UACGqtB,IAAc,UAACvtB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAIC,GAAI,GAAIoB,GAAI,EAAG2V,GAAI,EAAG5qB,GAAI,CAAE0D,QAAS,OAAQoG,cAAe,SAAU9E,IAAK,GAA9F,UACZ68B,GAAaA,GACd,SAACO,GAAD,QAEF,UAACluB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAIC,GAAI,GAAIoB,GAAI,EAAG2V,GAAI,EAAGzW,WAAS,EAACC,QAAS,EAA5D,WACE,SAACF,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAI+W,GAAI,EAAG9W,GAAI,EAAGnQ,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAA5E,UACE,SAACm8B,GAAA,EAAD,CAAYhW,SAAUwJ,EAAgB0N,OAAQd,EAAYrT,UAAQ,EAAC4R,cAAc,SAACwC,GAAD,CAAkBnC,cAAexzB,EAAewzB,oBAElI5kB,EAAAA,GAAAA,KAAgB,SAAA+G,GAAO,OAAI,SAACpO,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAI+W,GAAI,EAAG9W,GAAI,EAA9B,SACvBhO,EAAKS,IAAIuM,GAAAA,GAAAA,IAAUyP,GAAS7G,IAAIhhB,OACjC,SAACuzB,GAAA,EAAD,CAAcrG,WAAY9hB,EAAKS,IAAIuM,GAAAA,GAAAA,IAAUyP,GAAS7G,IAAIhhB,MAAOgrB,wBAAyBA,EAAyB8c,UAAWN,EAC5HnC,cAAc,SAAC0C,GAAD,CAAoBlgB,QAASA,IAAa6L,YAAa,GAAIF,YAAU,EAACC,UAAQ,KAC9F,SAACuU,GAAD,CAAangB,QAASA,KAJwCA,UAOlEmf,IAAc,UAACvtB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAIC,GAAI,GAAI+W,GAAI,EAAGzW,WAAS,EAACC,QAAS,EAArD,UACbytB,IAAa,SAAC3tB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAIC,GAAI,EAAGoB,GAAI,EAA9B,SAAkC4sB,KAChD,SAAC3tB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAIC,GAAI,EAAGoB,GAAI,EAAGjV,GAAI,CAAE0D,QAAS,OAAQoG,cAAe,SAAU9E,IAAK,GAAtF,UACE,SAACo9B,GAAD,eAMV,SAASK,GAAT,GAAyD,IAAlCngB,EAAiC,EAAjCA,QACKnB,GAAmB1b,EAAAA,EAAAA,YAAWC,EAAAA,GAAhDC,UAAavJ,IACbyS,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAAgCkkB,EAAAA,EAAAA,KAAhC,eAAO7lB,EAAP,KAAa2U,EAAb,KAAqB9T,EAArB,KACA,OAAO,UAACmB,EAAA,EAAD,CAAWlP,GAAI,CAAEsL,OAAQ,OAAQ7H,MAAO,OAAQ0sB,UAAW,IAAKzsB,QAAS,OAAQoG,cAAe,UAAhG,WACL,SAACb,EAAA,EAAD,WACE,SAACoB,EAAA,EAAD,WAAY,SAAC,MAAD,CAAkBiY,QAASA,SAEzC,SAAC9a,EAAA,EAAD,KACA,UAAC1H,EAAA,EAAD,CAAKE,GAAI,CACPmE,SAAU,EACVT,QAAS,OACTyP,eAAgB,SAChBxP,WAAY,UAJd,WAOE,SAACm7B,GAAD,CAAmBxc,QAASA,EAASpV,KAAMA,EAAMa,QAASA,EAASgxB,WAAY,SAAAtjB,GAAE,OAAI5M,EAASmJ,KAAK5Y,IAAIqc,EAAI,CAAE4M,UAAUqE,EAAAA,EAAAA,IAAoBvL,SAC3I,SAACta,EAAA,EAAD,CAAQI,QAAS4a,EAAQxkB,MAAM,OAAO2C,GAAI,CAAEgH,aAAc,OAA1D,UACE,SAAC07B,GAAA,EAAD,CAAW1iC,GAAI,CAAEsL,OAAQ,IAAK7H,MAAO,eAK7C,SAAS6+B,GAAT,GAAgF,IAApDnC,EAAmD,EAAnDA,cAClBthC,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACkBsiB,GAAmB1b,EAAAA,EAAAA,YAAWC,EAAAA,GAAhDC,UAAavJ,IACbyS,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAAgCkkB,EAAAA,EAAAA,KAAhC,eAAO7lB,EAAP,KAAa2U,EAAb,KAAqB9T,EAArB,KACA,OAAO,iCACL,SAACswB,GAAA,EAAD,CAASv5B,OAAO,SAACuF,EAAA,EAAD,UAAaxL,EAAb,6CAAmD8qB,UAAU,MAAM2U,OAAK,EAAxF,UACE,SAACz3B,EAAA,EAAD,CAAQxJ,MAAM,OAAO0J,KAAK,QAAQE,QAAS4a,EAA3C,UAAoD,SAAC6gB,GAAA,EAAD,SAEtD,SAACxC,GAAD,CAAiBC,cAAeA,EAAepB,WAAY,SAAAtjB,GAAE,OAAI5M,EAAS8d,QAAQvtB,IAAIqc,EAAI,CAAE4M,UAAUqE,EAAAA,EAAAA,IAAoBvL,MAAkBjU,KAAMA,EAAMa,QAASA,OAGrK,SAASo0B,GAAT,GAAqF,IAApDhC,EAAmD,EAAnDA,cACvBthC,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACkBsiB,GAAmB1b,EAAAA,EAAAA,YAAWC,EAAAA,GAAhDC,UAAavJ,IACbyS,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAAgCkkB,EAAAA,EAAAA,KAAhC,eAAO7lB,EAAP,KAAa2U,EAAb,KAAqB9T,EAArB,KACA,OAAO,iCACL,SAAClH,EAAA,EAAD,CAAQxJ,MAAM,OAAO4J,QAAS4a,EAAQ3a,WAAW,SAACw7B,GAAA,EAAD,IAAjD,SAAkE7jC,EAAlE,8CACA,SAACqhC,GAAD,CAAiBC,cAAeA,EAAepB,WAAY,SAAAtjB,GAAE,OAAI5M,EAAS8d,QAAQvtB,IAAIqc,EAAI,CAAE4M,UAAUqE,EAAAA,EAAAA,IAAoBvL,MAAkBjU,KAAMA,EAAMa,QAASA,OAGrK,SAASy0B,GAAT,GAAgE,IAAlClgB,EAAiC,EAAjCA,QACpBzjB,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACkBsiB,GAAmB1b,EAAAA,EAAAA,YAAWC,EAAAA,GAAhDC,UAAavJ,IACbyS,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAAgCkkB,EAAAA,EAAAA,KAAhC,eAAO7lB,EAAP,KAAa2U,EAAb,KAAqB9T,EAArB,KACA,OAAO,iCACL,SAACswB,GAAA,EAAD,CAASv5B,OAAO,SAACuF,EAAA,EAAD,UAAaxL,EAAb,0CAAgD8qB,UAAU,MAAM2U,OAAK,EAArF,UACE,SAACz3B,EAAA,EAAD,CAAQxJ,MAAM,OAAO0J,KAAK,QAAQE,QAAS4a,EAA3C,UAAoD,SAAC6gB,GAAA,EAAD,SAEtD,SAAC5D,GAAD,CAAmBxc,QAASA,EAASpV,KAAMA,EAAMa,QAASA,EAASgxB,WAAY,SAAAtjB,GAAE,OAAI5M,EAASmJ,KAAK5Y,IAAIqc,EAAI,CAAE4M,UAAUqE,EAAAA,EAAAA,IAAoBvL,WAG/I,SAASihB,KAAuB,IAAD,EACrBvjC,GAAMC,EAAAA,EAAAA,GAAe,CAAC,iBAAkB,aAAxCD,EACAgQ,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAA2EpJ,EAAAA,EAAAA,YAAWC,EAAAA,GAA9EC,EAAR,EAAQA,UAAR,IAAmBA,UAAkBwb,EAArC,EAAgC/kB,IAAmB8vB,EAAnD,EAAmDA,kBAC3CrmB,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACFnH,GAAiBC,EAAAA,EAAAA,IAAW,kBAAMC,GAAAA,EAAAA,SAAsB,IACxD+jC,GAAczmC,EAAAA,EAAAA,UAAQ,mBAAQ8C,OAAOqJ,OAAO6jB,GAAmBriB,QAAO,SAAAL,GAAC,OAAIA,KAAGhM,SAAQ,CAAC0uB,IACvF0W,GAAcz/B,EAAAA,EAAAA,cAAY,WACzBwC,GACA4mB,OAAOC,QAAQ,uEACpBxtB,OAAOqJ,OAAO6jB,GAAmBlS,SAAQ,SAAAyS,GAAG,OAAI5d,EAASmJ,KAAK5Y,IAAIqtB,EAAK,CAAEpE,SAAU,UAClF,CAAC1iB,EAAWkJ,EAAUqd,IAEnBnH,GAAa7oB,EAAAA,EAAAA,UAAQ,kBAAMwC,GAAkBE,GAAAA,EAAAA,WAAyBF,EAAgBmH,KAAO,CAACnH,EAAgBmH,IAC5Gi8B,GAAaC,EAAAA,GAAAA,GAAY5gB,GAAzB2gB,SACFe,GAAc1/B,EAAAA,EAAAA,cAAY,SAAA2+B,GAAQ,OAAIjzB,EAASi0B,SAAS1jC,IAAI+hB,EAAc,CAAE2gB,SAAAA,MAAa,CAACjzB,EAAUsS,IAE1G,GAA+B4R,EAAAA,EAAAA,KAA/B,eAAO7lB,EAAP,KAAaixB,EAAb,KAAqBhxB,EAArB,KACM41B,GAAmBtC,EAAAA,EAAAA,kBAAiBqB,GAC1C,GAA8B5lC,EAAAA,EAAAA,UAAQ,WACpC,MAAiF8C,OAAOqJ,OAAO6jB,GAAmBvO,QAAO,SAAC5b,EAAGihC,GAC3H,IAAM7mB,EAAMtN,EAASmJ,KAAK1R,IAAI08B,GAC9B,GAAI7mB,EAAK,CACP,MAA6C+M,GAAAA,GAAAA,sBAA+B/M,EAAK,IAAIxC,IAAIopB,IAAjFE,EAAR,EAAQA,kBAAmBC,EAA3B,EAA2BA,cAC3B,EAAiFha,GAAAA,GAAAA,sBAA+B/M,EAAK,IAAIxC,IAAI/Y,GAAAA,IAAlGuiC,EAA3B,EAAQF,kBAAsDG,EAA9D,EAA+CF,cAC/CnhC,EAAEkhC,kBAAoBlhC,EAAEkhC,kBAAoBA,EAC5ClhC,EAAEmhC,cAAgBnhC,EAAEmhC,cAAgBA,EAEpCnhC,EAAEohC,mBAAqBphC,EAAEohC,mBAAqBA,EAC9CphC,EAAEqhC,eAAiBrhC,EAAEqhC,eAAiBA,EAExC,OAAOrhC,IACN,CAAEkhC,kBAAmB,EAAGE,mBAAoB,EAAGD,cAAe,EAAGE,eAAgB,IAZ5EH,EAAR,EAAQA,kBAAmBE,EAA3B,EAA2BA,mBAAoBD,EAA/C,EAA+CA,cAAeE,EAA9D,EAA8DA,eAwB9D,MAAO,CAAEC,QAXsB,CAC7B1oC,KAAMkE,EAAF,iDACJpE,MAASwoC,EAAoBE,GAC3B,6BAAM,SAACG,GAAA,EAAD,CAAc7oC,MAAOwoC,EAAmBx+B,IAAK,KAAM8+B,OAAK,IAA9D,OAAoE,SAACD,GAAA,EAAD,CAAc7oC,MAAO0oC,EAAoB1+B,IAAK,KAAM8+B,OAAK,QAD5E,SAACD,GAAA,EAAD,CAAc7oC,MAAOwoC,EAAmBx+B,IAAK,KAAM8+B,OAAK,KAS3FC,SANc,CAC9B7oC,KAAMkE,EAAF,iDACJ4K,QAAS,oBAAS05B,EAAqBC,IACvC3oC,MAASyoC,EAAgBE,GACvB,6BAAM,SAACE,GAAA,EAAD,CAAc7oC,MAAOyoC,EAAez+B,IAAK,KAAM8+B,OAAK,IAA1D,OAAgE,SAACD,GAAA,EAAD,CAAc7oC,MAAO2oC,EAAgB3+B,IAAK,KAAM8+B,OAAK,QAD5E,SAACD,GAAA,EAAD,CAAc7oC,MAAOyoC,EAAez+B,IAAK,KAAM8+B,OAAK,QAIhG,CAAC1kC,EAAGkkC,EAAkB7W,EAAmBrd,IA1BpCw0B,EAAR,EAAQA,QAASG,EAAjB,EAAiBA,SA4BjB,OAAO,UAACt0B,EAAA,EAAD,WACJyzB,IAAe,SAAC97B,EAAA,EAAD,CAAQxJ,MAAM,QAAQ4J,QAAS27B,EAAa97B,WAAS,EAAC9G,GAAI,CAAEyjC,wBAAyB,EAAGC,uBAAwB,GAAhH,SAAsH7kC,EAAtH,+CAChB,SAACoK,EAAA,EAAD,WACE,UAACkM,GAAA,EAAD,CAAOf,QAAS,EAAhB,WACE,UAACvL,EAAA,EAAD,YACE,SAAChC,EAAA,EAAD,CAAQC,WAAS,EAACzJ,MAAM,OAAO6J,WAAW,SAAC6c,GAAA,EAAD,IAAc/jB,GAAI,CAAE0jC,uBAAwB,EAAGD,wBAAyB,GAAKx8B,QAASk3B,EAAhI,wBACA,SAACtwB,GAAA,EAAD,CAAcC,KAAMZ,EAAMa,QAASZ,EAAnC,UACE,SAACtE,EAAA,EAAD,WACE,SAACI,EAAA,EAAD,WACE,SAAC06B,GAAA,EAAD,CAAeC,aAAc9B,EAAUplC,SAAUmmC,WAIvD,UAAClsB,GAAA,GAAD,YACE,SAAC,MAAD,CAAmBktB,MAAOR,EAASxjC,UAAWgX,GAAAA,MACrC,OAAR2sB,QAAQ,IAARA,GAAA,UAAAA,EAAU/5B,eAAV,oBAAA+5B,EAAoB39B,MAAS,SAAC,MAAD,CAAmBg+B,MAAOL,EAAU3jC,UAAWgX,GAAAA,WAGhFnY,GAAkBqmB,GAAc/lB,OAAOC,QAAQ8lB,GAAY7lB,SAAQ,+BAAE0hB,EAAF,iBACrDzkB,KAAI,SAAA0kB,GAAS,OAAI,SAAChY,EAAA,EAAD,CAAmC7I,GAAI,CAAE0D,QAAS,OAAQoG,cAAe,SAAU9E,IAAK,GAAxF,UAC5B,SAAC2b,GAAD,CAA2CC,OAAQA,EAAQC,UAAWA,GAA/CD,EAASC,IADWD,EAASC,iBC3LjD,SAASijB,KACtB,IAAMl0B,GAAYC,EAAAA,EAAAA,UACZk0B,GAAW5gC,EAAAA,EAAAA,cAAY,iCAAMyM,QAAN,IAAMA,GAAN,UAAMA,EAAWG,eAAjB,iBAAM,EAAoBC,sBAA1B,aAAM,SAAqC,CAAEC,SAAU,aAAa,CAACL,IAElG,OAAO,UAACuF,GAAA,EAAD,CAAOf,QAAS,EAAhB,WACL,UAACF,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAGpU,GAAI,CAAEmT,eAAgB,UAAlD,WACE,SAACe,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAG+W,GAAI,EAAG9W,GAAI,EAAGoB,GAAI,IAApC,UACE,SAAC+uB,GAAD,OAEF,UAAC9vB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAI+W,GAAI,EAAG9W,GAAI,EAAGoB,GAAI,IAAKjV,GAAI,CAAE0D,QAAS,OAAQoG,cAAe,SAAU9E,IAAK,GAA/F,WACE,SAACi/B,GAAD,CAAch9B,QAAS88B,KACvB,SAAC70B,EAAA,EAAD,CAAWlP,GAAI,CAAEmE,SAAU,EAAGc,EAAG,GAAjC,UACE,SAACwlB,GAAD,aAIN,SAAC3qB,EAAA,EAAD,CAAKqQ,IAAKP,EAAV,UACE,SAACyxB,GAAD,SAIN,SAAS4C,GAAT,GAA6D,IAArCh9B,EAAoC,EAApCA,QACD0tB,GAAqBlvB,EAAAA,EAAAA,YAAWC,EAAAA,GAA7CC,UAAagvB,eACb9uB,GAAUJ,EAAAA,EAAAA,YAAWK,EAAAA,GAArBD,KAER,OAAO,UAACqO,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAGsB,QAAS,CAAE9B,GAAI,EAAG+W,GAAI,EAAG9W,GAAI,EAAGoB,GAAI,EAAG2V,GAAI,GAAvE,WACL,SAAC1W,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAACsX,GAAD,CAAgBC,SAAUwJ,EAAgB7M,YAAa5Y,EAAAA,EAAWjI,QAASA,MAE5EsU,EAAAA,GAAAA,KAAgB,SAAA+G,GAAO,OACtB,SAACpO,GAAA,GAAD,CAAMG,MAAI,EAAeT,GAAI,EAA7B,UACE,SAAC8T,GAAD,CAAkBC,WAAY9hB,EAAKS,IAAIuM,GAAAA,GAAAA,IAAUyP,GAAS7G,IAAIhhB,MAAO6nB,QAASA,EAASwF,YAAa5Y,EAAAA,EAAWjI,QAASA,KAD1Gqb,SAMtB,SAAS0hB,KAAwB,IAAD,EACtBn1B,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAAmEpJ,EAAAA,EAAAA,YAAWC,EAAAA,GAAtEiH,EAAR,EAAQA,eAAR,IAAwBhH,UAAkBwb,EAA1C,EAAqC/kB,IAAmB8nC,EAAxD,EAAwDA,KAChDr+B,GAAUJ,EAAAA,EAAAA,YAAWK,EAAAA,GAArBD,KACFD,GAAoByxB,EAAAA,EAAAA,GAAoBlW,GACxCoc,GAAWC,EAAAA,EAAAA,MACXtmB,EAAUrR,EAAKS,IAAIuM,GAAAA,GAAAA,SAAepY,MAClC0lC,EAAgBxzB,EAAewzB,cAC/B51B,EAAQ1E,EAAKS,IAAIuM,GAAAA,GAAAA,KAAWpY,MAC5B+P,EAAY3E,EAAKS,IAAIuM,GAAAA,GAAAA,KAAWpY,MAChC0pC,EAAgBt+B,EAAKS,IAAIuM,GAAAA,GAAAA,eAAqBpY,MAC9C2pC,EAAO,CACXC,KAAMx+B,EAAKS,IAAIuM,GAAAA,GAAAA,MAAAA,MAAkBpY,MACjC6pC,MAAOz+B,EAAKS,IAAIuM,GAAAA,GAAAA,MAAAA,OAAmBpY,MACnC8pC,MAAO1+B,EAAKS,IAAIuM,GAAAA,GAAAA,MAAAA,OAAmBpY,OAE/B+pC,EAAS,CACbH,KAAMx+B,EAAKS,IAAIuM,GAAAA,GAAAA,MAAAA,MAAkBpY,MACjC6pC,MAAOz+B,EAAKS,IAAIuM,GAAAA,GAAAA,MAAAA,OAAmBpY,MACnC8pC,MAAO1+B,EAAKS,IAAIuM,GAAAA,GAAAA,MAAAA,OAAmBpY,OAE7BgqC,GAAa1C,EAAAA,GAAAA,GAAY5gB,GAAzBsjB,SACR,OAAO,UAACv1B,EAAA,EAAD,CAAWlP,GAAI,CAAEsL,OAAQ,QAAzB,WACL,UAACxL,EAAA,EAAD,CAAKE,GAAI,CAAE4oB,SAAU,YAArB,WACE,UAAC9oB,EAAA,EAAD,CAAKE,GAAI,CAAE4oB,SAAU,WAAYnlB,MAAO,OAAQ6H,OAAQ,QAAxD,WACE,SAACjB,EAAA,EAAD,CAAYlN,QAAQ,KAAK6C,GAAI,CAAE4oB,SAAU,WAAY8b,KAAM,MAAOlb,OAAQ,EAAGpY,UAAW,wBAAyB6T,QAAS,KAA1H,UACE,SAAC,KAAD,CAAc/kB,MAAOyM,EAAexN,OAAQwlC,SAAO,OAErD,SAAC7kC,EAAA,EAAD,CAAKE,GAAI,CAAE4oB,SAAU,WAAY8b,KAAM,MAAOlb,OAAQ,KAAMpY,UAAW,wBAAyB6T,QAAS,IAAMxhB,MAAO,OAAQC,QAAS,OAAQyP,eAAgB,SAAUpP,GAAI,GAA7K,UACE,SAAC1F,GAAA,EAAD,CAAMhB,MAAO6Z,EAASlX,GAAI,CAAEsL,OAAQ,QAClCvP,OAAO,UAACsO,EAAA,EAAD,CAAYlN,QAAQ,KAAK6C,GAAI,CAAE0D,QAAS,OAAQsB,IAAK,EAAGrB,WAAY,UAApE,UACJnD,GAAAA,EAAS0W,IACV,SAACpX,EAAA,EAAD,CAAKE,GAAI,CAAEuL,WAAY,SAAUrH,UAAW,UAA5C,SAAyDyI,EAAejG,QACxE,SAACyI,GAAA,EAAD,CAAS7B,IAAG,UAAE4a,GAAAA,EAAAA,mBAAF,aAAE,EAAqBiY,aAGzC,SAACrgC,EAAA,EAAD,CAAKE,GAAI,CAAE4oB,SAAU,WAAY8b,KAAM,EAAGzkC,IAAK,GAA/C,UACE,SAACkR,GAAA,EAAD,CAAYnR,GAAI,CAAEiF,EAAG,GAAK5H,MAAM,QAAQ4J,QAAS,kBAAM4H,EAASi0B,SAAS1jC,IAAI+hB,EAAc,CAAEsjB,UAAWA,KAAxG,SACGA,GAAW,SAACG,GAAA,EAAD,KAAe,SAACC,GAAA,EAAD,SAG/B,SAACx6B,EAAA,EAAD,CAAYrK,GAAI,CAAEiF,EAAG,EAAG2jB,SAAU,WAAYkc,MAAO,EAAG7kC,IAAK,EAAGglB,QAAS,IAAzE,UACE,SAAC3d,EAAA,EAAD,WAAUy9B,EAAAA,GAAAA,IAAex6B,EAAOC,WAGpC,SAAC1K,EAAA,EAAD,CAAKwN,IAAKX,EAAeq4B,QAASnlC,UAAU,MAAM4D,MAAM,OAAO6H,OAAO,aAExE,UAACxL,EAAA,EAAD,YACE,SAACmoB,GAAA,EAAD,CAAgBjoB,GAAI,CAAEiF,EAAG,GAAKgC,QAAS,kBAAMs2B,EAAS,WAAtD,UACE,SAACrpB,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAGse,IAAK,EAAjC,SACI,CAAC,OAAQ,QAAS,SAAqCv2B,KAAI,SAAA8oC,GAAI,aAC/D,SAAC/wB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAACsxB,GAAA,EAAD,CAAOC,aAAcf,EAAKa,GAAO5nC,MAAOmnC,EAAOS,GAAQ,OAAS,YAC9DG,QAAQ,WACRC,aAAc,CACZC,SAAU,SACVC,WAAY,SAEdvlC,GAAI,CACFyD,MAAO,OACP6H,OAAQ,OACR,sBAAuB,CACrBijB,SAAU,SACViX,QAAS,aACTx+B,aAAc,OACdy+B,WAAY,EACZn6B,OAAQ,WAdd,UAiBE,SAACxL,EAAA,EAAD,CAAKD,UAAU,MAAMyN,IAAG,UAAEX,EAAe+4B,eAAeT,UAAhC,aAAE,EAAqCU,IAAKliC,MAAM,OAAO6H,OAAO,YAlBrE25B,WAuB7B,SAAC56B,EAAA,EAAD,CAAYrK,GAAI,CAAEkE,UAAW,SAAUwuB,GAAI,GAAKv1B,QAAQ,KAAxD,SAA8DwP,EAAei5B,qBAC7E,SAAC1xB,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,UACGkJ,EAAAA,GAAAA,IAAM,EAAG,GAAGnhB,KAAI,SAAAqN,GAAC,aAChB,SAAC0K,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,EAAf,UACE,SAACqU,GAAA,EAAD,CAAgBhhB,QAAS,kBAAMrB,EAAkB,CAAEu+B,cAAe36B,IAAM26B,EAAgB36B,EAAI,EAAIA,KAAhG,UACE,SAAC1J,EAAA,EAAD,CAAKD,UAAU,MAAMyN,IAAG,UAAEX,EAAe+4B,eAAf,uBAA8Cl8B,WAAhD,aAAE,EAA6Em8B,IACrG3lC,IAAE,WACImkC,GAAiB36B,EAAI,GAAK,CAAEK,OAAQ,oBAE1CpG,MAAM,OAAO6H,OAAO,YANH9B,SAU3B,SAACye,GAAA,EAAD,CAAgBjoB,GAAI,CAAEiF,EAAG,GAAKgC,QAAS,kBAAMs2B,EAAS,cAAtD,UACE,SAACrpB,GAAA,GAAD,CAAMC,WAAS,EAACuB,QAAS,EAAGtB,QAAS,EAArC,UACGkJ,EAAAA,GAAAA,IAAM,EAAG,GAAGnhB,KAAI,SAAAqN,GAAC,OAAI,SAAC0K,GAAA,GAAD,CAAcG,MAAI,EAACT,GAAI,EAAGtI,OAAO,OAAjC,UAAwC,SAAC2pB,GAAA,EAAD,CAAmB9T,aAAc+iB,EAAK16B,GAAIxL,MAAOwL,KAA9EA,gBCpI3C,IAAMq8B,GAAgB,CACpBjyB,GAAI,GACJ+W,GAAI,EACJ9W,GAAI,GAGS,SAASiyB,KACtB,OAAsCrgC,EAAAA,EAAAA,YAAWC,EAAAA,GAAzCC,EAAR,EAAQA,UAAWgH,EAAnB,EAAmBA,eACX9G,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACFD,GAAoByxB,EAAAA,EAAAA,GAAoB1xB,EAAUvJ,KAGlDoO,EAAY3E,EAAKS,IAAIuM,GAAAA,GAAAA,KAAWpY,MAChC0pC,EAAgBt+B,EAAKS,IAAIuM,GAAAA,GAAAA,eAAqBpY,MAE9CG,GAAQoB,EAAAA,GAAAA,KACR+pC,GAAOrE,EAAAA,GAAAA,GAAc9mC,EAAM+mC,YAAYC,GAAG,OAC1CoE,GAAqB9pC,EAAAA,EAAAA,UAAQ,kBAAMohB,EAAAA,GAAAA,IAAM,EAAG,GAAGnhB,KAAI,SAAAqN,GAAC,OACxD,SAACy8B,GAAD,CACEC,UAAS,uBAAkB18B,GAC3B8d,SAAQ,4BAAuB9d,GAC/B28B,aAAc,kBAAMvgC,EAAkB,CAAEu+B,cAAe36B,IAAM26B,EAAgB36B,EAAI,EAAIA,YAClF,CAAC26B,EAAev+B,IACvB,OAAO,iCACL,SAACwgC,GAAD,KACA,UAAClyB,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,UAEG2xB,IAAQ,UAAC7xB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAIC,GAAI,GAAIoB,GAAI,EAAGjV,GAAI,CAAE0D,QAAS,OAAQoG,cAAe,SAAU9E,IAAK,GAAvF,WACP,SAACkK,EAAA,EAAD,WAAW,SAACjG,EAAA,EAAD,WAAa,UAACoB,EAAA,EAAD,CAAYlN,QAAQ,KAAK6C,GAAI,CAAEkE,UAAW,UAA1C,+BAAyEigC,SAChG6B,EAAmB7pC,KAAI,SAACyhB,EAAGpU,GAAJ,OAAU,SAAC1J,EAAA,EAAD,CAAaE,GAAI,CAAEilB,QAASkf,GAAkB36B,EAAI,EAAK,EAAI,IAA3D,SAAoEoU,GAA1DpU,UAE9C,UAAC0K,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAIC,GAAI,GAAIoB,GAAI,EAAGd,WAAS,EAACC,QAAS,EAArD,UArBmB,CAAC,CAAC,OAAQ,yBAA0B,CAAC,QAAS,mBAAoB,CAAC,QAAS,oBAuB7EjY,KAAI,+BAAE8oC,EAAF,KAAQoB,EAAR,YAClB,SAACnyB,GAAA,IAAD,kBAAMG,MAAI,GAAgBwxB,IAA1B,cACE,SAACI,GAAD,CACEC,UAAWjB,EACX3d,SAAU+e,MAHEpB,QAMft4B,EAAe+4B,eAAe,YAAc,SAACxxB,GAAA,IAAD,kBAAMG,MAAI,GAAKwxB,IAAf,cAC7C,SAACI,GAAD,CACEC,UAAU,SACV5e,SAAS,4BAGV3a,EAAe+4B,eAAe,aAAc,SAACxxB,GAAA,IAAD,kBAAMG,MAAI,GAAKwxB,IAAf,cAC7C,SAACI,GAAD,CACEC,UAAU,UACV5e,SAAS,eAtC+D,CAAC,CAAC,WAAY,0BAA2B,GAAI,CAAC,WAAY,0BAA2B,GAAI,CAAC,WAAY,sBAAuB,IA0C3LnrB,KAAI,YAAyB,IAAD,eAAtB8oC,EAAsB,KAAhBoB,EAAgB,KAATC,EAAS,KACpCC,EAAU/7B,GAAa87B,EAC3B,OAAK35B,EAAe+4B,eAAeT,IAC5B,SAAC/wB,GAAA,IAAD,kBAAMG,MAAI,EAAYjZ,MAAO,CAAE6pB,QAASshB,EAAU,EAAI,KAAWV,IAAjE,cACL,SAACI,GAAD,CACEC,UAAWjB,EACX3d,SAAU+e,MAHSpB,GAD0B,YAUnDc,IAAQ,UAAC7xB,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAIC,GAAI,GAAIoB,GAAI,EAAGd,WAAS,EAACC,QAAS,EAArD,WACR,SAACF,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAf,UACE,SAAC1E,EAAA,EAAD,WAAW,SAACjG,EAAA,EAAD,WAAa,UAACoB,EAAA,EAAD,CAAYlN,QAAQ,KAAK6C,GAAI,CAAEkE,UAAW,UAA1C,+BAAyEigC,WAElG6B,EAAmB7pC,KAAI,SAACyhB,EAAGpU,GAAJ,OAAU,SAAC0K,GAAA,IAAD,kBAAMG,MAAI,EAASrU,GAAI,CAAEilB,QAASkf,GAAkB36B,EAAI,EAAK,EAAI,KAAWq8B,IAA5E,aAA6FjoB,IAA7EpU,eAK1D,SAAS48B,KACP,IACMz1B,GADWlL,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACc+2B,aAAajsB,SACnC,OAAO,SAACzB,EAAA,EAAD,WACL,SAACjG,EAAA,EAAD,WACE,SAACiL,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,SACGpV,OAAOC,QAAQ0R,GAAU9G,QAAO,gDAAqBoF,WAAS9S,KAAI,YAAkB,IAAD,eAAfC,EAAe,KAAViT,EAAU,KAClF,OAAO,SAAC6E,GAAA,GAAD,CAAMG,MAAI,EAAV,UACL,SAACxL,EAAA,EAAD,WAAU,SAACI,EAAA,EAAD,CAAajJ,GAAI,CAAEiF,EAAG,EAAG,eAAgB,CAAEiE,GAAI,IAA/C,UACR,SAAC,MAAD,CAAkBmG,KAAMA,SAFLjT,YAWjC,IAAMoqC,GAAe,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAMxC,SAASP,GAAT,GAAyF,IAA7DC,EAA4D,EAA5DA,UAAW5e,EAAiD,EAAjDA,SAAU6e,EAAuC,EAAvCA,aAC/C,GAAqE1gC,EAAAA,EAAAA,YAAWC,EAAAA,GAA3D+gC,EAArB,EAAQ9gC,UAAa8gC,OAAU95B,EAA/B,EAA+BA,eAAgB/G,EAA/C,EAA+CA,kBACvCC,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KAEF6gC,GAAoBvjC,EAAAA,EAAAA,cACxB,SAAAhD,GAAQ,OAAI,SAAC8nB,GAAA,EAAD,CAAgBhhB,QAASk/B,EAAzB,SAAwChmC,MACpD,CAACgmC,IAGGQ,GAAiBxjC,EAAAA,EAAAA,cAAY,SAAC8hC,EAA6B2B,GAA9B,OACjChhC,EAAkB,CAAE6gC,QAAO,oBAAMA,GAAP,eAAgBxB,EAAO2B,QAAwB,CAACH,EAAQ7gC,IAEhFoD,EAA6B,KAEjC,GAAIk9B,KAAaO,EAAQ,CACvB,IAAMI,EAAahhC,EAAKS,IAAIuM,GAAAA,GAAAA,MAAYqzB,IAAuBzrC,MACzD8P,EAAQ1E,EAAKS,IAAIuM,GAAAA,GAAAA,MAAYqzB,IAAYzrC,MACzC6rC,EAAMzgC,EAAKS,IAAIuM,GAAAA,GAAAA,KAAWpY,MAEhCuO,GAAS,SAACzB,GAAA,EAAD,CAAgBT,WAAS,EAAChC,MAAK,qBAAgByF,GAASlN,MAAOwpC,EAAa,OAAS,UAAW7mC,GAAI,CAAEgH,aAAc,GAApH,UACNsW,EAAAA,GAAAA,IAAM,EAAGkpB,GAAaF,IAAMnqC,KAAI,SAAAqN,GAAC,OAChC,UAACxO,GAAA,EAAD,CAAkB8C,SAAU2oC,EAAOP,KAAgB18B,EAAI7G,SAAU8jC,EAAOP,KAAgB18B,EAAIvC,QAAS,kBAAM0/B,EAAeT,EAAW18B,IAArI,wBAAqJA,EAAIq9B,IAA1Ir9B,QAGrB,IAAMs9B,EAAcn6B,EAAe+4B,eAAeQ,GAYlD,OAAO,UAACh3B,EAAA,EAAD,CAAWlP,GAAI,CAAEsL,OAAQ,QAAzB,UACJtC,GACD,UAACC,EAAA,EAAD,YACE,SAACwf,GAAA,EAAD,CAAoBC,YAAayd,EAAcxd,QAAS+d,EAAxD,UACE,UAACxyB,GAAA,GAAD,CAAMC,WAAS,EAACnU,GAAI,CAAEiT,SAAU,UAAhC,WACE,SAACiB,GAAA,GAAD,CAAMG,MAAI,EAAV,UACE,SAACvU,EAAA,EAAD,CAAKD,UAAU,MAAMyN,IAAG,OAAEw5B,QAAF,IAAEA,OAAF,EAAEA,EAAanB,IAAK3lC,GAAI,CAAEyD,MAAO,GAAI6H,OAAQ,aAEvE,UAAC4I,GAAA,GAAD,CAAMG,MAAI,EAAClQ,SAAU,EAAGnE,GAAI,CAAEgE,GAAI,GAAlC,WACE,SAACqG,EAAA,EAAD,CAAYlN,QAAQ,KAApB,gBAA0B2pC,QAA1B,IAA0BA,OAA1B,EAA0BA,EAAapgC,QACvC,SAAC2D,EAAA,EAAD,CAAYlN,QAAQ,YAApB,SAAiCmqB,YAK3B,OAAXwf,QAAW,IAAXA,GAAAA,EAAa19B,UAAW,SAACD,GAAA,EAAD,CAAiBC,SAAU09B,EAAY19B,SAAUT,UAAQ,EAACD,WAxBpE,SAACkB,GAAuC,IAAD,EACpDm9B,EAAY,UAAGn9B,EAAQZ,cAAX,aAAG,EAAgBjE,OACnC,SAAIgiC,GAAyC,kBAAjBA,IACNA,EAAahsC,MAAMoF,SAASpF,MAAMoN,MAC3CvK,SAASsoC,MAoB4F,W,8CC9IvG,SAASc,KACtB,OAAO,SAAC,KAAD,CAAKtjC,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAAGrB,WAAW,UAA9D,UACL,UAACuQ,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,WACE,UAACF,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAIC,GAAI,EAAGoB,GAAI,EAAGjV,GAAI,CAAE0D,QAAS,OAAQoG,cAAe,SAAU9E,IAAK,GAAtF,WACE,SAACiiC,GAAD,KACA,SAACC,GAAD,QAED5pB,EAAAA,GAAAA,IAAM,EAAG,GAAGnhB,KAAI,SAAAqN,GAAC,OAAI,SAAC0K,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAIC,GAAI,EAAGoB,GAAI,EAA9B,UACpB,SAACkyB,GAAD,CAAiBnpC,MAAOwL,KADkCA,WAM3D,SAASy9B,KAAmB,IAAD,MAChC,GAA0BxhC,EAAAA,EAAAA,YAAWK,EAAAA,GAA7BD,EAAR,EAAQA,KAAM6Q,EAAd,EAAcA,QACR0wB,EAAYvhC,EAAKwhC,cACjB7wB,EAAgD,GAOtD,OANAxX,OAAOC,QAAP,UAAemoC,EAAU7gB,aAAzB,QAAkC,IAAIvM,SAAQ,+BAAE5d,EAAF,KAAOiT,EAAP,YAC3CA,EAAKJ,SAA0B,IAAfI,EAAK5U,OAAe+b,EAAMwJ,KAAK,CAAC,CAAC,QAAS5jB,GAAMiT,OACnErQ,OAAOC,QAAP,UAAemoC,EAAUE,cAAzB,QAAmC,IAAIttB,SAAQ,+BAAE5d,EAAF,KAAOiT,EAAP,YAC5CA,EAAKJ,SAA0B,IAAfI,EAAK5U,OAAe+b,EAAMwJ,KAAK,CAAC,CAAC,SAAU5jB,GAAMiT,OACpErQ,OAAOC,QAAP,UAAemoC,EAAUG,aAAzB,QAAkC,IAAIvtB,SAAQ,+BAAE5d,EAAF,KAAOiT,EAAP,YAC3CA,EAAKJ,SAAiC,kBAAfI,EAAK5U,OAAqC,IAAf4U,EAAK5U,OAAe+b,EAAMwJ,KAAK,CAAC,CAAC,QAAS5jB,GAAMiT,OAChGmH,EAAMhZ,QACJ,UAAC0R,EAAA,EAAD,YACL,SAACjG,EAAA,EAAD,WACE,SAACoB,EAAA,EAAD,4BAEF,SAAC7C,EAAA,EAAD,KACA,SAACyB,EAAA,EAAD,WACE,SAACiL,GAAA,GAAD,CAAMC,WAAS,EAAf,SACGqC,EAAMra,KAAI,iCAAEgK,EAAF,KAAQmR,EAAR,YAAeA,IAAK,SAACpD,GAAA,GAAD,CAAMG,MAAI,EAACT,GAAI,GAAf,UAC7B,SAAC,MAAD,CAAkBvE,KAAMiI,EAAGR,SAAQ,WAAE6iB,EAAAA,GAAAA,IAAY,OAACjjB,QAAD,IAACA,OAAD,EAACA,EAAS2wB,cAAelhC,UAAvC,aAAE,EAA4C1L,SAD5Bsc,KAAKC,UAAUM,EAAE/G,iBARpD,KAe5B,SAAS22B,KACP,IAAQroC,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACAgH,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KAEF2hC,GAD0B/hC,EAAAA,EAAAA,YAAWC,EAAAA,GAAnCC,UAAau+B,KACEvmB,QAAO,SAAC5b,EAAGlD,GAAJ,OAAUkD,GAAKlD,EAAI,EAAI,KAAI,GACzD,OAAO,iCACL,SAACqQ,EAAA,EAAD,WACE,SAAClB,EAAA,EAAD,CAAYlJ,OAAO,4BAAOjG,EAAU,yBAAjB,KAA2C,6BAAQ,UAAC,KAAD,CAAWxB,MAAOmqC,GAAa,EAAI,UAAY,UAA/C,cAA4DA,EAA5D,WAAnD,KAAkJ,SAACp9B,GAAA,EAAD,CAAatF,OAAO,SAACuF,EAAA,EAAD,UAAaxL,EAAb,wDACvL4oC,qBAAsB,CAAEtqC,QAAS,iBAEpCuqC,GAAAA,EAAAA,KAAoB,SAACC,EAAKn+B,GACzB,IAAMlL,GAAO,SAAC8L,GAAA,EAAD,CAAatF,OAAO,SAACuF,EAAA,EAAD,UAAas9B,EAAIC,SAC5C9iC,GAAQ,4BAAO6iC,EAAIjhC,KAAX,IAAkBpI,KAChC,OAAO,UAAC4Q,EAAA,EAAD,CAAmBlP,GAAI,CAAEilB,QAAS0iB,EAAIl+B,QAAQ5D,GAAQ,EAAI,IAA1D,WACL,SAACmI,EAAA,EAAD,CAAYlJ,MAAOA,EAAOC,OAAQ4iC,EAAIrpC,KAAMmpC,qBAAsB,CAAEtqC,QAAS,eAC5EwqC,EAAIl+B,QAAQ5D,KAAS,SAAC2B,EAAA,EAAD,IACrBmgC,EAAIl+B,QAAQ5D,KAAS,SAACoD,EAAA,EAAD,WACpB,SAACE,GAAA,EAAD,CAAiBC,SAAUu+B,EAAIv+B,SAAUC,cAAY,EAACV,UAAQ,QAJ3Ca,SAU7B,SAAS29B,GAAT,GAAwD,IAA7BnpC,EAA4B,EAA5BA,MACjB85B,GAAaryB,EAAAA,EAAAA,YAAWK,EAAAA,GAAxBgyB,SACAj5B,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACR,GAAyF4G,EAAAA,EAAAA,YAAWC,EAAAA,GAAjFmiC,EAAnB,EAAQliC,UAAqCmiC,EAA7C,EAA2BniC,UAAavJ,IAA2BwJ,EAAnE,EAAmEA,kBAC7DmiC,EAAcF,EAAO3D,KAAKlmC,GAC1BkmC,GAAOhoC,EAAAA,EAAAA,UAAQ,iBAAM,CAAC4rC,GAAD,gBAAwBD,EAAO3D,OAAMr6B,QAAO,SAAChL,EAAG2K,GAAJ,OAAWA,EAAI,IAAOxL,OAAQ,CAAC6pC,EAAO3D,KAAM4D,EAAoB9pC,IACjIgqC,GAAiBj7B,EAAAA,EAAAA,KACjBk7B,GAAc9kC,EAAAA,EAAAA,cAAY,SAACimB,GAAD,OAAgCxjB,EAAkB,CAAEnI,KAAM,OAAQO,MAAAA,EAAOorB,QAAAA,MAAY,CAACprB,EAAO4H,IAEvHsiC,EAAapQ,EAASiQ,GACtBI,GAA4DjsC,EAAAA,EAAAA,UAAQ,wBAAMgsC,GAAc,CAC5FviC,WAAU,oBAAMuiC,EAAWviC,WAAlB,IAA6BR,YAAW,UAAE0iC,EAAOO,gBAAgBL,UAAzB,QAAyC,KAC1Fp7B,eAAgBu7B,EAAWv7B,eAC3B/G,kBAAmB,SAACyB,GAClB,GAAK0gC,GACC,gBAAiB1gC,EAAvB,CACA,IAAQlC,EAAgBkC,EAAhBlC,YACRS,EAAkB,CAAEnI,KAAM,kBAAmBsqC,YAAaA,EAAa5iC,YAAAA,SAExE,CAAC0iC,EAAQE,EAAaG,EAAYtiC,IAC/ByiC,GAAkDnsC,EAAAA,EAAAA,UAAQ,kBAAMgsC,GAAc,CAClFriC,KAAMqiC,EAAW3zB,OACjBujB,SAAUA,KACT,CAACoQ,EAAYpQ,IAChB,OAAO,UAAC5oB,EAAA,EAAD,YACL,SAACo5B,GAAD,CAAsBnnB,aAAc4mB,EAAa7D,KAAMA,EACrDqE,QAASN,EACTlsC,MAAO8C,EAAE,WAAY,CAAE6Z,MAAO1a,EAAQ,MAEvC+pC,GAAeI,IAA4B,SAACziC,EAAA,WAAD,CAA2BjL,MAAO0tC,EAAlC,SACzCE,IAAuB,SAACviC,EAAA,WAAD,CAAsBrL,MAAO4tC,EAA7B,UACtB,SAAC3L,GAAA,EAAD,CAAevb,aAAc4mB,EAC3BS,cAAeR,EAEfS,kBAAkB,SAAC/iC,EAAA,WAAD,CAA2BjL,MAAO0tC,EAAlC,UAChB,SAACriC,EAAA,WAAD,CAAsBrL,MAAO4tC,EAA7B,UACE,SAACK,GAAD,QAGJC,gBAAgB,SAACjjC,EAAA,WAAD,CAA2BjL,MAAO0tC,EAAlC,UACd,SAACriC,EAAA,WAAD,CAAsBrL,MAAO4tC,EAA7B,UACE,SAACO,GAAD,QAGJC,mBAAmB,SAACnjC,EAAA,WAAD,CAA2BjL,MAAO0tC,EAAlC,UACjB,SAACriC,EAAA,WAAD,CAAsBrL,MAAO4tC,EAA7B,UACE,SAACS,GAAD,QAGJC,gBAAc,WAMxB,SAASL,KACP,IAAQ7iC,GAAUJ,EAAAA,EAAAA,YAAWK,EAAAA,GAArBD,KACFnH,GAAiBC,EAAAA,EAAAA,IAAW,kBAAMC,GAAAA,EAAAA,SAAsB,IACxDwK,GAAWlN,EAAAA,EAAAA,UAAQ,kBAAMwC,GAC7BM,OAAOC,QAAQL,GAAAA,EAAAA,WAAyBF,EAAgBmH,IACrD3G,SAAQ,+BAAE0hB,EAAF,iBACC1hB,SAAQ,SAAA8pC,GAAE,OAAItqC,EAAekiB,GAASK,kBAAkB+nB,WAClE,CAACtqC,EAAgBmH,IACrB,OAAKuD,GACE,SAACD,GAAA,EAAD,CAAiBC,SAAUA,EAAUC,cAAc,IADpC,KAGxB,SAASu/B,KACP,IAA0Bxf,GAAc3jB,EAAAA,EAAAA,YAAWC,EAAAA,GAA3CC,UAAavJ,IAEfkvB,GADe7lB,EAAAA,EAAAA,YAAWK,EAAAA,GAAxBgyB,SACqB1O,GAAUkC,YACvC,OAAKA,EAAYtK,UACV,SAAC7X,GAAA,EAAD,CAAiBC,SAAUkiB,EAAYtK,SAAU3X,cAAc,IADpC,KAGpC,SAASy/B,KACP,IAA0B1f,GAAc3jB,EAAAA,EAAAA,YAAWC,EAAAA,GAA3CC,UAAavJ,IAEfuQ,GADelH,EAAAA,EAAAA,YAAWK,EAAAA,GAAxBgyB,SACwB1O,GAAUzc,eACpCvD,EAAWpK,OAAOqJ,OAAOsE,EAAe85B,QAAQvnC,SAAQ,SAAA+pC,GAAG,OAAIA,EAAI7/B,YACzE,OAAKA,GACE,SAACD,GAAA,EAAD,CAAiBC,SAAUA,EAAUC,cAAc,IADpC,KAIxB,SAASi/B,GAAT,GACoQ,IADpOnnB,EACmO,EADnOA,aAAc+iB,EACqN,EADrNA,KAAMnoC,EAC+M,EAD/MA,MAAOwsC,EACwM,EADxMA,QACwM,IAD/LW,kBAAAA,OAC+L,MAD3K,GAC2K,EACzPrqC,GAAMC,EAAAA,EAAAA,GAAe,CAAC,gBAAiB,iBAAkB,cAAzDD,EACAgQ,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACAub,GAAWC,EAAAA,EAAAA,KAAXD,OACF+e,GAAkBxqC,EAAAA,EAAAA,IAAW,kBAAM2rB,EAAAA,EAAAA,SAAuB,IAC1D8e,GAASjmC,EAAAA,EAAAA,cAAY,SAAC/G,GAAD,aAA+BA,EAAIitC,WAAW,YAAf,UAAgCxqC,EAAE,iBAAD,QAAkByqC,EAAAA,EAAAA,IAAkBltC,EAAKguB,KAA1E,aAAyFvrB,EAAE,qBAAD,cAAsBsqC,QAAtB,IAAsBA,GAAtB,UAAsBA,EAAkB/sC,EAAKguB,UAA7C,aAAsB,EAAgCjT,aAAhJ,KAAmKtY,EAAE,iBAAD,OAAkBzC,MAAQ,CAAC+sC,EAAiBtqC,EAAGurB,IACvQmf,GAAQpmC,EAAAA,EAAAA,cAAY,SAAC/G,GAAD,YAAoC,KAARA,GAAa,SAACotC,GAAA,EAAD,IAAgBL,GAAkB,SAAC97B,EAAA,EAAD,CAAWC,IAAG,UAAE67B,EAAgB/sC,EAAKguB,UAAvB,aAAE,EAA8B7c,aAAcvN,GAAI,CAAEypC,GAAI,MAAU,0BAAO,CAACN,EAAiB/e,IACxMsf,GAAavmC,EAAAA,EAAAA,cAAY,SAAC/G,GAAD,OAAuByS,EAASi0B,SAASx8B,IAAIlK,GAAKqoC,WAAU,CAAC51B,IACtF86B,GAAYxmC,EAAAA,EAAAA,cAAY,gBAAG/G,EAAH,EAAGA,IAAH,OAAyC8nC,EAAKr6B,QAAO,SAAAhL,GAAC,OAAIA,GAAKA,IAAMsiB,KAAcvjB,SAASxB,IAASA,EAAIitC,WAAW,aAAenF,EAAKvrB,MAAK,SAAC9Z,EAAG2K,GAAJ,OAAU3K,EAAEwqC,WAAW,iBAAe,CAACnF,EAAM/iB,IAClN9Y,GAAyDnM,EAAAA,EAAAA,UAAQ,kBAAO,CAC5EE,IAAK,GACLL,MAAO8C,EAAF,6CAFgE,gBAIpEgQ,EAASwa,MAAMjkB,KACfjJ,KAAI,SAAAS,GAAC,MAAK,CAAER,IAAKQ,EAAGb,MAAOqtC,EAAOxsC,GAAI6nC,SAAUiF,EAAW9sC,OAC3DyC,MAAK,SAAC0C,EAAGC,GACR,OAAID,EAAE0iC,WAAaziC,EAAEyiC,UAAkB,GAClC1iC,EAAE0iC,UAAYziC,EAAEyiC,SAAiB,EAC/B1iC,EAAEhG,MAAM6tC,cAAc5nC,EAAEjG,cAEhC,CAAC8C,EAAGuqC,EAAQM,EAAY76B,IAC3B,OAAO,SAAC,EAAA7B,SAAD,CAAUC,UAAU,SAACqB,EAAA,EAAD,CAAUnR,QAAQ,OAAOsG,MAAO,MAApD,UAA6D,SAAComC,GAAA,GAAD,SAAqB9iC,KAAK,QAAQhL,MAAOA,EAAOE,QAASoM,EAAQyhC,SAAU3oB,EAAc4oB,SAAS,GAAGrtC,SAAU6rC,EAAS9mC,kBAAmBkoC,EAAWJ,MAAOA,GAAWL,M,0IC9I9O,IAAMc,GAAuBv9B,EAAAA,MAAW,kBAAM,kCAG/B,SAASw9B,KAAkB,IAAD,IAC/Bp7B,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACM6H,GAAYjR,EAAAA,EAAAA,YAAWK,EAAAA,GAA7BD,KACR,GAAwGJ,EAAAA,EAAAA,YAAWC,EAAAA,GAA3GC,EAAR,EAAQA,UAAR,IAAmBA,UAAkBwb,EAArC,EAAgC/kB,IAAmBu6B,EAAnD,EAAmDA,YAAehqB,EAAlE,EAAkEA,eAAgB/G,EAAlF,EAAkFA,kBAC5EC,ECpDO,SAAmBsb,EAA4B+oB,GAC5D,IAAQr7B,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACR,GAA4BhM,EAAAA,EAAAA,WAAS,kBAAMgM,EAASs7B,QAAQC,YAAYjpB,EAAc+oB,MAAtF,eAAOG,EAAP,KAAeC,EAAf,KAKA,OAJA9mC,EAAAA,EAAAA,YAAU,kBAAM8mC,EAAUz7B,EAASs7B,QAAQC,YAAYjpB,EAAc+oB,MAAa,CAACr7B,EAAUsS,EAAc+oB,KAC3G1mC,EAAAA,EAAAA,YAAU,kBACR2d,EAAetS,EAASs7B,QAAQ5oB,OAAOJ,GAAc,SAAClL,EAAG/J,EAAGtP,GAAP,MAAmB,WAANsP,GAAkBo+B,EAAU1tC,WAAMwB,IACpG,CAAC+iB,EAAcmpB,EAAWz7B,IACrBw7B,ED6CME,CAAUppB,GAAcqpB,EAAAA,GAAAA,IAAwB79B,EAAewzB,gBACtEsK,GAAUtnC,EAAAA,EAAAA,cAAY,SAAC0C,GAAD,OAAmBgJ,EAASs7B,QAAQ/qC,IAAI+hB,EAActb,KAAO,CAACsb,EAActS,IAClG67B,GAAYvnC,EAAAA,EAAAA,cAAY,WAC5BsnC,GAAQE,EAAAA,GAAAA,IAAWH,EAAAA,GAAAA,IAAwB79B,EAAewzB,mBACzD,CAACsK,EAAS99B,IACPi+B,GAAYznC,EAAAA,EAAAA,cAChB,SAAC4B,GACC0lC,GAAQ,oBAAK5kC,GAAN,IAAYulB,QAAO,oBAAMvlB,EAAKulB,QAAWrmB,QAElD,CAAC0lC,EAAS5kC,IAGNglC,GAAW1nC,EAAAA,EAAAA,cACf,SAAC2nC,EAAwBpsB,GACvB,IAAMqsB,GAAUJ,EAAAA,GAAAA,GAAWG,EAAQ1uC,KACnC2uC,EAAQC,SAAS5iB,SAAS3qB,KAAOoI,EAAKmlC,SAAS5iB,SAAS3qB,KAExDstC,EAAQ3f,OAAO7gB,MAAQugC,EAAQvgC,MAC/BwgC,EAAQ3f,OAAO5gB,UAAYsgC,EAAQtgC,UACnCugC,EAAQ3f,OAAOrf,WAAa++B,EAAQ/+B,WAEpC,IAAMiT,EAAO,GACbN,EAAM1E,SAAQ,SAAAmC,GAAQ,IAAD,EACnB,GAAKA,EAAL,CACA,IAAQmG,EAA0DnG,EAA1DmG,QAAS1B,EAAiDzE,EAAjDyE,OAAQwH,EAAyCjM,EAAzCiM,SAAUD,EAA+BhM,EAA/BgM,YAAa5d,EAAkB4R,EAAlB5R,MAAOpL,EAAWgd,EAAXhd,OACvD4rC,EAAQC,SAASnmB,MAAMvC,GAAS/X,MAAQA,EACxCwgC,EAAQC,SAASnmB,MAAMvC,GAAS5N,QAAUyT,EAC1C4iB,EAAQC,SAASnmB,MAAMvC,GAASnjB,OAASA,EACzC6f,EAAK4B,IAAU,UAAC5B,EAAK4B,UAAN,QAAiB,GAAK,EACrCwH,EAASpO,SAAQ,SAAAwc,GAAY,IAAD,EACtBA,EAAQp6B,MAAK2uC,EAAQC,SAAS5iB,SAAS6iB,MAAMzU,EAAQp6B,MAAO,UAAC2uC,EAAQC,SAAS5iB,SAAS6iB,MAAMzU,EAAQp6B,YAAzC,QAAiD,GAAKo6B,EAAQC,sBAGlIsU,EAAQC,SAAShsB,KAAOhgB,OAAOoc,YAAYpc,OAAOC,QAAQ+f,GAAM7iB,KAAI,+BAAEC,EAAF,KAAO3B,EAAP,WAAkB,CAAC2B,EAC3E,IAAV3B,EAAc,EACF,IAAVA,EAAc,EACF,IAAVA,GAAiB2B,EAAeitC,WAAW,cAAoB5uC,EAAJ,MAC9DoP,QAAO,oDACV4gC,EAAQM,KAEV,CAACllC,EAAM4kC,IAGMS,GAAf,WADiB5N,EAAAA,EAAAA,MACqBj2B,aAAtC,QAAmF,CAAEqX,WAAOtgB,IAApFsgB,OACRlb,EAAAA,EAAAA,YAAU,WACR,GAAK0nC,EAAL,CACA,IAAMJ,EAAUj8B,EAAS8d,QAAQrmB,IAAIX,EAAUgvB,gBAC/CkW,EAASC,EAASI,EAAS/uC,KAAI,SAAAqN,GAAC,OAAIqF,EAASmJ,KAAK1R,IAAIkD,UAGrD,CAAC0hC,EAAUr8B,IAEd,IAAMs8B,GAAmBhoC,EAAAA,EAAAA,cACvB,WACE,IAAM2nC,EAAUj8B,EAAS8d,QAAQrmB,IAAIX,EAAUgvB,gBAC/CkW,EAASC,EAAS9rC,OAAOqJ,OAAO1C,EAAUumB,mBAAmB/vB,KAAI,SAAA4F,GAAC,OAAI8M,EAASmJ,KAAK1R,IAAIvE,MAAK8H,QAAO,SAAA9H,GAAC,OAAIA,QAE3G,CAAC8M,EAAUlJ,EAAUumB,kBAAmBvmB,EAAUgvB,eAAgBkW,IAG9Dzf,GAAwBlvB,EAAAA,EAAAA,UAAQ,WACpC,OAAO,oBACF2J,EAAKulB,QADV,IAEE/C,SAAU,GACV+iB,MAAM,EACN3vB,GAAI,OAEL,CAAC5V,IACEwlC,GAAcloC,EAAAA,EAAAA,cAAY,SAAC6nC,GAC/B,IAAMM,GAAQrlC,EAAAA,GAAAA,IAAUJ,GACxBylC,EAAMN,SAAWA,EACjBP,EAAQa,KACP,CAACzlC,EAAM4kC,IAEJc,GAAkBpoC,EAAAA,EAAAA,cAAY,SAACtE,GACnC,IAAMysC,GAAQrlC,EAAAA,GAAAA,IAAUJ,GACxBylC,EAAMN,SAAS5iB,SAAS3qB,KAAOoB,EAC/B4rC,EAAQa,KACP,CAACzlC,EAAM4kC,IAEJe,GAAcroC,EAAAA,EAAAA,cAAY,SAACqoC,GAC/B,IAAMF,GAAQrlC,EAAAA,GAAAA,IAAUJ,GACxBylC,EAAMN,SAAS5iB,SAAS6iB,MAAQO,EAChCf,EAAQa,KACP,CAACzlC,EAAM4kC,IAEJgB,GAAehL,EAAAA,EAAAA,kBAAiB56B,GAChC6lC,GAAmBxvC,EAAAA,EAAAA,UAAQ,WAC/B,IAAM+uC,GAAK,WAAQQ,EAAaT,SAAS5iB,SAAS6iB,OAGlD,OAFAjsC,OAAOqJ,OAAOojC,EAAaT,SAASnmB,OAAO7K,SAAQ,kBAAGtF,EAAH,EAAGA,QAASvV,EAAZ,EAAYA,OAAQoL,EAApB,EAAoBA,MAApB,OACjD0gC,EAAMv2B,IAAW,UAACu2B,EAAMv2B,UAAP,QAAmB,GAAKwU,GAAAA,GAAAA,cAAuBxU,EAASvV,EAAQoL,MAC5E,CACL4R,KAAKjB,EAAAA,GAAAA,IAAU+vB,GAAO,SAACruC,EAAGqZ,GAAJ,OAAUA,EAAEsgB,SAAS,MAAOvkB,EAAAA,GAAAA,IAAQpV,EAAI,MAAOue,EAAAA,GAAAA,IAASve,MAC9EymB,QAAQnI,EAAAA,GAAAA,IAAUuwB,EAAaT,SAAShsB,MAAM,SAAApiB,GAAC,OAAIue,EAAAA,GAAAA,IAASve,SAE7D,CAAC6uC,IAEEE,GAAgCzvC,EAAAA,EAAAA,UAAQ,iBAAO,CACnDuf,GAAI,GACJ4M,SAAU,GACVjsB,IAAKyJ,EAAKulB,OAAOhvB,IACjBmO,MAAO1E,EAAKulB,OAAO7gB,MACnBC,UAAW3E,EAAKulB,OAAO5gB,UACvBuB,WAAYlG,EAAKulB,OAAOrf,WACxBq/B,MAAM,KACJ,CAACvlC,IACCiyB,GAAWC,EAAAA,EAAAA,GAAY5W,EAAc,EAAGuqB,EAAkBC,GAEhDC,GAAhB,iBAA+B9T,QAA/B,IAA+BA,OAA/B,EAA+BA,EAAW3W,UAA1C,QAA2D,IAAnD5M,OAEFs3B,GAA+C3vC,EAAAA,EAAAA,UAAQ,WAC3D,GAAK47B,GAAa8T,EAClB,MAAO,CACL/lC,KAAM+lC,EACN9T,SAAAA,KAED,CAAC8T,EAAY9T,IACVgU,GAAsD5vC,EAAAA,EAAAA,UAAQ,WAClE,GAAK2vC,EACL,OAAO,oBACFA,GADL,IAEEn1B,QAASigB,EAAcjgB,OAAUtY,MAElC,CAACytC,EAAkBlV,EAAajgB,IACnC,OAAO,UAACvB,GAAA,EAAD,CAAOf,QAAS,EAAhB,WACL,SAAClF,EAAA,EAAD,WACE,UAACpP,EAAA,EAAD,CAAKE,GAAI,CAAE0D,QAAS,OAAQsB,IAAK,EAAGC,EAAG,GAAvC,WACE,UAACnF,EAAA,EAAD,CAAKE,GAAI,CAAEmE,SAAU,EAAGT,QAAS,OAAQsB,IAAK,GAA9C,WACE,SAAC6B,EAAA,EAAD,CAAQxJ,MAAM,OAAO4J,QAASkkC,EAAkBjkC,WAAW,SAAC6kC,GAAA,EAAD,IAA3D,iCACA,SAACllC,EAAA,EAAD,CAAQxJ,MAAM,QAAQ4J,QAASyjC,EAAWxjC,WAAW,SAAC8kC,GAAA,EAAD,IAArD,uBAEF,UAAClP,GAAA,EAAD,CAAwBC,WAAS,EAACtiC,MAAOk8B,EAAaj6B,SAAU,SAAC0G,EAAGxG,GAAJ,OAAUgJ,EAAkB,CAAE+wB,YAAa/5B,KAAMmK,KAAK,QAAtH,WACE,SAACi2B,GAAA,EAAD,CAAcviC,OAAO,EAAOkI,UAAWg0B,EAAvC,4BACA,SAACqG,GAAA,EAAD,CAAcviC,OAAO,EAAMkI,SAAUg0B,EAArC,0CAILkV,GAAmB,SAAC/lC,EAAA,WAAD,CAAsBrL,MAAOoxC,EAA7B,UAClB,UAAC33B,GAAA,GAAD,CAAMC,WAAS,EAACC,QAAS,EAAGpU,GAAI,CAAEmT,eAAgB,UAAlD,WACE,UAACe,GAAA,GAAD,CAAMG,MAAI,EAACrU,GAAI,CAAEmE,UAAW,GAA5B,WACE,SAAC8nC,GAAD,CAAkB7gB,OAAQA,EAAQwf,UAAWA,EAAWzK,cAAexzB,EAAewzB,iBACtF,SAAC+L,GAAD,CAAuBC,aAActmC,EAAKmlC,SAAUoB,gBAAiBf,QAEvE,SAACn3B,GAAA,GAAD,CAAMG,MAAI,EAACrU,GAAI,CAAEmE,SAAU,GAA3B,UACE,SAACkoC,GAAD,CAAiBjkB,SAAUviB,EAAKmlC,SAAS5iB,SAAS6iB,MAAOO,YAAaA,EAAac,aAAczmC,EAAKmlC,SAAS5iB,SAAS3qB,KAAM8tC,gBAAiBA,EAAiBlrC,aAAcrB,OAAOqJ,OAAOxC,EAAKmlC,SAASnmB,OAAO1oB,KAAI,SAAAoN,GAAC,OAAIA,EAAEmL,qBAGxM,SAACpG,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,OAC/E,SAAC4D,EAAA,EAAD,CAAWlP,GAAI,CAAEmE,SAAU,EAAGc,EAAG,GAAjC,SACG6mC,GAA0B,SAAChmC,EAAA,WAAD,CAAsBrL,MAAOqxC,EAA7B,UACzB,SAACrhB,GAAD,OACwB,SAACnc,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,WAMrF,SAAS2gC,GAAT,GAAmL,IAAvJ7gB,EAAsJ,EAAtJA,OAAQwf,EAA8I,EAA9IA,UAAWzK,EAAmI,EAAnIA,cACrC/jC,EAAkDgvB,EAAlDhvB,IAAR,EAA0DgvB,EAA7C7gB,MAAAA,OAAb,MAAqB,EAArB,IAA0D6gB,EAAlCrf,WAAAA,OAAxB,MAAqC,EAArC,IAA0Dqf,EAAlB5gB,UAAAA,OAAxC,MAAoD,EAApD,EACM8gB,GAAc3sB,EAAAA,EAAAA,IAAW,kBAAM4sB,GAAAA,EAAAA,IAAgBnvB,KAAM,CAACA,IAC5D,GAA+B22B,EAAAA,EAAAA,KAA/B,eAAO7lB,EAAP,KAAaixB,EAAb,KAAqBhxB,EAArB,KACQtH,GAASJ,EAAAA,EAAAA,YAAWK,EAAAA,GAApBD,KACF0mC,GAAerwC,EAAAA,EAAAA,UAAQ,kBAAMovB,GAAeF,IAAUI,EAAAA,GAAAA,IAAc,CAACF,EAAYzlB,MAAM4lB,EAAAA,GAAAA,IAAiBL,OAAW,CAACE,EAAaF,IACvI,OAAO,UAAClc,EAAA,EAAD,CAAWlP,GAAI,CAAEiF,EAAG,EAAGuJ,GAAI,GAA3B,WACL,SAACw7B,GAAD,CAAsBx/B,UAAWA,EAAW0C,KAAMA,EAAMC,OAAQA,EAAQC,SAAU,SAAA6I,GAAC,OAAI20B,EAAU,CAAExuC,IAAK6Z,KAAMu2B,iBAAkBrM,KAChI,UAACrgC,EAAA,EAAD,CAAK4D,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAAhD,WACE,UAAClF,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAzB,UACGsmB,IAAe,SAACxrB,EAAA,EAAD,CACd+jB,UAAS,eAAUyH,EAAYnsB,OAAtB,QACTU,UAAU,MACVyN,IAAKge,EAAYK,OAAOP,EAAO5gB,WAC/BxK,GAAI,CAAEysC,WAAY,EAAGr6B,UAAW,EAAG4W,SAAU,MAAOhiB,aAAc,MAEpE,UAACmO,GAAA,EAAD,CAAOf,QAAS,EAAGjQ,SAAU,EAA7B,WACE,SAAC0C,EAAA,EAAD,CAAQC,WAAS,EAACzJ,MAAM,OAAO2C,GAAI,CAAEmE,SAAU,GAAK8C,QAASk3B,EAA7D,UAAqE,SAACr+B,EAAA,EAAD,CAAKE,GAAI,CAAEgpB,SAAU,QAArB,gBAAgCsC,QAAhC,IAAgCA,OAAhC,EAAgCA,EAAa5kB,UACtG,OAAX4kB,QAAW,IAAXA,OAAA,EAAAA,EAAaM,iBAAiB,SAAC9f,GAAA,EAAD,CAAoBC,WAAYA,EAAYC,cAAe,SAAAE,GAAC,OAAI0+B,EAAU,CAAE7+B,WAAYG,aAG1Hof,IAAe,SAAChhB,EAAA,EAAD,CAAaC,MAAOA,EAAOC,UAAWA,EAAW/H,QAASmoC,EAAWngC,QAAS6gB,EAAYM,iBAC1G,UAAC/iB,EAAA,EAAD,YACE,SAACmF,EAAA,EAAD,CAAYlJ,MAAO,aAAc2iC,qBAAsB,CAAEtqC,QAAS,gBAClE,SAACqK,EAAA,EAAD,IACC+kC,IAAgB,SAAC51B,GAAA,GAAD,UACd,CAAC9D,GAAAA,GAAAA,OAAAA,KAAmBA,GAAAA,GAAAA,OAAAA,IAAkBA,GAAAA,GAAAA,OAAAA,MAAmB1W,KAAI,SAACkT,EAAM7F,GACnE,IAAM8N,EAAIi1B,EAAajmC,IAAI+I,GAC3B,OAAIiI,EAAErI,UAAYqI,EAAE7c,MAAc,MAC3B,SAAC,MAAD,CAA+C4U,KAAMiI,EAAGzX,UAAWgX,GAAAA,IAA5CE,KAAKC,UAAUM,EAAE/G,eAIpD1K,IAAI,OAAIylB,QAAJ,IAAIA,OAAJ,EAAIA,EAAatK,YAAY,SAAC7X,GAAA,EAAD,CAAiBC,SAAUkiB,EAAYtK,iBAK/E,SAASkrB,GAAT,GAC6F,IAD5DC,EAC2D,EAD3DA,aAAcC,EAC6C,EAD7CA,gBAEvCM,GAAUvpC,EAAAA,EAAAA,cAAY,SAACmf,GAAD,OAAsB,SAAC9G,GACjD,IAAMmxB,GAAgB1mC,EAAAA,GAAAA,IAAUkmC,GAChCQ,EAAc9nB,MAAMvC,GAAW9G,EAC/B4wB,EAAgBO,MACf,CAACR,EAAcC,IAEZQ,GAAYzpC,EAAAA,EAAAA,cAAY,SAACkgB,GAC7B,IAAMspB,GAAgB1mC,EAAAA,GAAAA,IAAUkmC,GAChCQ,EAAc3tB,KAAOqE,EACrB+oB,EAAgBO,KACf,CAACR,EAAcC,IAElB,OAAO,UAACj3B,GAAA,EAAD,CAAOf,QAAS,EAAhB,WACL,SAAClF,EAAA,EAAD,CAAWlP,GAAI,CAAEiF,EAAG,GAApB,UACE,SAACkQ,GAAA,EAAD,CAAOf,QAAS,EAAhB,SACGmH,EAAAA,GAAAA,KAAgB,SAAAhS,GAAC,OAAI,SAACsjC,GAAD,CAA+BvqB,QAAS/Y,EAAGiS,KAAM2wB,EAAatnB,MAAMtb,GAAImjC,QAASA,EAAQnjC,IAA7DA,WAGtD,SAAC,EAAAyD,SAAD,CAAUC,UAAU,SAACqB,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,MAAzE,UACE,SAACwhC,GAAD,CAAoBzpB,OAAQ8oB,EAAantB,KAAM4tB,UAAWA,SAIhE,SAASC,GAAT,GAAqK,IAAD,EAAnIvqB,EAAmI,EAAnIA,QAAS9G,EAA0H,EAA1HA,KAAeuxB,EAA2G,EAApHL,QACtCniC,EAA2BiR,EAA3BjR,MAAOmK,EAAoB8G,EAApB9G,QAASvV,EAAWqc,EAAXrc,OAClBiG,EAAO8jB,GAAAA,GAAAA,cAAuB5G,GAC9BoqB,GAAUvpC,EAAAA,EAAAA,cAAY,SAAC4B,GAC3BgoC,GAAY,oBAAKvxB,GAASzW,MACzB,CAACyW,EAAMuxB,IACJ1M,GAAYl9B,EAAAA,EAAAA,cAChB,SAAC+I,GAAuB,IAAD,EACf8gC,EAAI,UAAGC,GAAAA,GAAiB/gC,UAApB,QAA0B,EAClBwgC,EAAdniC,EAAQyiC,EAAc,CAAE7tC,OAAQ+M,EAAG3B,MAAOyiC,GACjC,CAAE7tC,OAAQ+M,MACtB,CAAC3B,EAAOmiC,IAEb,OAAO,UAAC5sC,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAGmO,eAAe,gBAAgBxP,WAAW,SAAtE,WACL,SAACupC,GAAA,EAAD,CAAoB5uC,KAAM6uC,GAAAA,GAAY7qB,MACtC,SAACzZ,EAAA,EAAD,CAAU7I,GAAI,CAAEsL,OAAQ,OAAQyiB,SAAU,MAAO5pB,SAAU,EAAGT,QAAS,QAAvE,SACmB,IAAhB0B,EAAK5H,QACJ,UAACsC,EAAA,EAAD,CAAKmF,EAAG,EAAGkO,eAAe,SAASxP,WAAW,SAASF,MAAM,OAAOC,QAAQ,OAAOsB,IAAK,EAAxF,UAA4FxE,GAAAA,EAAS4E,EAAK,IAAKzH,GAAAA,GAAAA,OAAcyH,EAAK,QAClI,SAACmC,GAAA,EAAD,CAAgBvH,GAAI,CAAE+D,GAAI,GAAK+C,WAAS,EAAChC,OAAO,SAAC,KAAD,CAAc4P,QAASA,IAAarX,MAAK,UAAEM,GAAAA,GAAAA,WAAkB+W,UAApB,QAAgC,UAAzH,SACGtP,EAAKjJ,KAAI,SAAAixC,GAAG,OACX,SAACpyC,GAAA,EAAD,CAAoB2H,SAAU+R,IAAY04B,EAAKnmC,QAAS,kBAAMylC,EAAQ,CAAEh4B,QAAS04B,KAAjF,UACE,SAAC,KAAD,CAAqB14B,QAAS04B,KADjBA,WAKvB,SAAC7lC,GAAA,EAAD,CAAgBvH,GAAI,CAAE+D,GAAI,GAAKe,OAAO,4BAAO3F,EAAP,KAAe,SAAC,KAAD,CAAiBb,KAAM+uC,GAAAA,SAA5E,SACG,CAAC,EAAG,EAAG,GAAGlxC,KAAI,SAAA+P,GAAC,OACd,SAAClR,GAAA,EAAD,CAAkB2H,SAAUxD,IAAW+M,EAAGjF,QAAS,kBAAMo5B,EAAUn0B,IAAnE,UACE,4BAAOA,EAAP,KAAU,SAAC,KAAD,CAAiB5N,KAAM+uC,GAAAA,UADpBnhC,SAInB,SAACiG,GAAA,GAAD,CAAmBzQ,eAAe,IAAIjH,MAAO8P,EAAOlN,MAAO6rB,GAAAA,GAAAA,aAAsB3e,GAAQ7N,SAAU,SAAA4G,GAAC,YAAUlF,IAANkF,GAAmBopC,EAAQ,CAAEniC,MAAOjH,KAAMtD,GAAI,CAAEgH,aAAc,EAAGhD,GAAI,EAAGspC,GAAI,EAAGhiC,OAAQ,QAAUrH,WAAY,CAAEjE,GAAI,CAAEgE,GAAI,GAAKP,MAAO,OAASgB,IAAK,GAAID,IAAK,MACpQ,SAACqE,EAAA,EAAD,CAAU7I,GAAI,CAAEsL,OAAQ,OAAQyiB,SAAU,OAA1C,UACE,SAACjuB,EAAA,EAAD,CAAKmF,EAAG,EAAGf,UAAU,SAArB,oBAAkC2lB,EAAAA,GAAAA,IAAiBX,GAAAA,GAAAA,cAAuBxU,EAASvV,EAAQoL,GAAQ5M,GAAAA,GAAAA,KAAY+W,KAA/G,OAA2H/W,GAAAA,GAAAA,KAAY+W,WAK7I,SAASo4B,GAAT,GAA+F,IAAjEzpB,EAAgE,EAAhEA,OAAQupB,EAAwD,EAAxDA,UAC9BluC,GAAiBC,EAAAA,EAAAA,IAAW,kBAAMC,GAAAA,EAAAA,SAAsB,IACxD2uC,GAASpqC,EAAAA,EAAAA,cAAY,SAACyd,GACrBA,GAAWliB,GAChBkuC,GAAU,oBAAKvpB,GAAN,eAAezC,EAASyE,SAASrmB,OAAOoG,KAAK1G,EAAekiB,GAAQmE,YAAY,SACxF,CAAC1B,EAAQupB,EAAWluC,IAEjB8uC,GAAWrqC,EAAAA,EAAAA,cAAY,SAACyd,GAAD,OAA4B,SAACnmB,GAAD,OAAsBmyC,GAAU,oBAAKvpB,GAAN,eAAezC,EAASnmB,QAAU,CAAC4oB,EAAQupB,IAC7Ha,GAActqC,EAAAA,EAAAA,cAAY,SAACyd,GAAD,OAA4B,WACzByC,EAAxBzC,GAAT,IAAwB8sB,GAAxB,QAAiCrqB,EAAjC,CAASzC,GAAT,WACAgsB,GAAU,WAAKc,OACd,CAACrqB,EAAQupB,IAENrtB,EAAY,EAAIvgB,OAAOqJ,OAAOgb,GAAQ1F,QAAO,SAAC5b,EAAGC,GAAJ,OAAUD,EAAIC,IAAG,GAEpE,OAAO,UAACmT,GAAA,EAAD,CAAOf,QAAS,EAAGpU,GAAI,CAAEmE,SAAU,GAAnC,UACJnF,OAAOC,QAAQokB,GAAQlnB,KAAI,+BAAEykB,EAAF,KAAUnmB,EAAV,YAAqB,SAACkzC,GAAD,CAAgC/sB,OAAQA,EAAQnmB,MAAOA,EAAO+yC,SAAUA,EAAS5sB,GAAS6sB,YAAaA,EAAY7sB,GAASrB,UAAWA,GAA/GqB,OACzE,SAAC1R,EAAA,EAAD,CAAWlP,GAAI,CAAEmE,SAAU,GAA3B,UACE,SAAC,MAAD,CACElD,aAAW,EACX2sC,kBAAgB,EAChB7mC,KAAK,QACLlF,UAAW,GACXC,aAAcyrC,EACdvtC,GAAI,SAACpF,GAAD,MAAY,CACduJ,SAAU,EACV,uBAAwB,CACtBs/B,wBAAyB7oC,EAAMykB,MAAMrY,aACrC08B,uBAAwB9oC,EAAMykB,MAAMrY,gBAGxC9F,YAAa,mBACbF,QAAS,SAAC4f,GAAD,OAAY5hB,OAAOoG,KAAKie,GAAQzlB,SAASgjB,MAAW,OAACliB,QAAD,IAACA,GAAAA,EAAiBkiB,KAAW5hB,OAAOoG,KAAK1G,EAAekiB,GAAQmE,YAAY/V,OAAM,SAAAsI,GAAC,OAAI+N,SAAS/N,GAAKiI,aAM1K,SAASouB,GAAT,GAA6M,IAAhL/sB,EAA+K,EAA/KA,OAAQnmB,EAAuK,EAAvKA,MAAO+yC,EAAgK,EAAhKA,SAAUC,EAAsJ,EAAtJA,YAAaluB,EAAyI,EAAzIA,UAC3DkO,GAAgB9uB,EAAAA,EAAAA,IAAW,kBAAMC,GAAAA,EAAAA,IAAkBgiB,KAAS,IAG5DkE,GAAe5oB,EAAAA,EAAAA,UAAQ,WAC3B,OAAIzB,EAAQ,IAAMgzB,EAAsB,GACjCzuB,OAAOoG,KAAKqoB,EAAc1I,YAAYlb,QAAO,SAAAgX,GAAS,uBAAI4M,EAAc1I,WAAWlE,UAA7B,aAAI,EAAqCG,SAASrI,MAAK,SAAAqM,GAAG,MAAI,WAAYA,UACtI,CAACyI,EAAehzB,IAEnB,OAAKgzB,GACE,UAACve,EAAA,EAAD,YACL,UAACpP,EAAA,EAAD,CAAK4D,QAAQ,OAAb,WACE,SAACkqB,GAAA,EAAD,CAAoBH,cAAeA,EAAeC,SAAUjzB,EAA5D,UACE,UAACqF,EAAA,EAAD,CAAKqE,SAAU,EAAGc,EAAG,EAAGvB,QAAQ,OAAOsB,IAAK,EAAGrB,WAAW,SAA1D,WACE,SAACwL,GAAA,EAAD,CAASpI,KAAM,EAAG/G,GAAI,CAAEoP,GAAI,GAAK9B,IAAKmgB,EAAcvI,cACpD,SAACplB,EAAA,EAAD,UAAO2tB,EAAcogB,WACrB,SAACC,GAAA,EAAD,UAGJ,UAACpmC,GAAA,EAAD,YACE,SAACH,GAAA,EAAD,CAAgBR,KAAK,QAAQjC,OAAO,UAAChF,EAAA,EAAD,CAAKyL,WAAW,SAAhB,UAA0B9Q,EAA1B,UAApC,SACGuE,OAAOoG,KAAKqoB,EAAc1I,YAAY5oB,KAAI,SAAAykB,GAAM,OAAIyE,SAASzE,MAASzkB,KAAI,SAAAykB,GAAM,OAC/E,UAAC5lB,GAAA,EAAD,CAAuB2H,SAAUlI,IAAUmmB,GAAUA,EAAUrB,EAAY9kB,EAAQwM,QAAS,kBAAMumC,EAAS5sB,IAA3G,UAAkIA,EAAlI,SAAeA,SAGnB,SAAC/Z,EAAA,EAAD,CAAQxJ,MAAM,QAAQ0J,KAAK,QAAQE,QAASwmC,EAA5C,UACE,SAACM,GAAA,EAAD,cAIHjpB,EAAatnB,SAAU,SAAC2X,GAAA,EAAD,CAAOf,QAAS,EAAGpU,GAAI,CAAEiF,EAAG,GAA5B,SACvB6f,EAAa3oB,KAAI,SAAA0kB,GAAS,OACzB,SAACF,GAAD,CAAkCC,OAAQA,EAAQC,UAAWwE,SAASxE,GAAsBnY,YAAU,EAACoY,kBAAgB,GAAhGD,WAvBF,KA4B7B,SAASwrB,GAAT,GAA4S,IAAjRjkB,EAAgR,EAAhRA,SAAUojB,EAAsQ,EAAtQA,YAAac,EAAyP,EAAzPA,aAAcf,EAA2O,EAA3OA,gBAAiBlrC,EAA0N,EAA1NA,aACzEmtC,GAAWrqC,EAAAA,EAAAA,cAAY,SAAC/G,GAAD,OAAqB,SAACQ,GAAD,OAAe4uC,GAAY,oBAAKpjB,GAAN,eAAiBhsB,EAAMQ,QAAM,CAACwrB,EAAUojB,IAC5G3sC,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACFmvC,EAA6F,IAAxFhvC,OAAOC,QAAQmpB,GAAUzK,QAAO,SAAC9e,EAAD,sBAAKoX,EAAL,YAAepX,EAAf,KAAwBqqB,GAAAA,GAAAA,aAAsBjT,KAAK,GACxF+T,EAAQhrB,OAAOC,QAAQmpB,GAAUzK,QAAO,SAAC9e,EAAD,sBAAKoX,EAAL,YAAepX,EAAf,KAAwBqqB,GAAAA,GAAAA,aAAsBjT,OAAG7X,EAAWkuC,KAAgB,GAC1H,OAAO,UAACp9B,EAAA,EAAD,CAAWlP,GAAI,CAAEiF,EAAG,EAAGqG,OAAQ,QAA/B,WACL,UAACxL,EAAA,EAAD,CAAKE,GAAI,CAAEwO,GAAI,EAAG9K,QAAS,OAAQsB,IAAK,GAAxC,WACE,SAACuC,GAAA,EAAD,CAAgBT,WAAS,EAAChC,MAAOjG,EAAE,8BAAD,OAA+BytC,IAAjE,SACG2B,EAAAA,GAAAA,KAAgB,SAAAxmC,GAAE,OAAI,SAACzM,GAAA,EAAD,CAAmB2H,SAAU2pC,IAAiB7kC,EAAIR,QAAS,kBAAMskC,EAAgB9jC,IAAjF,SAAuF5I,EAAE,8BAAD,OAA+B4I,KAAxGA,SAExC,SAACiiB,GAAA,EAAD,CAAkB5kB,OAAO,SAACuF,EAAA,EAAD,UAAaxL,EAAb,sDAA4D8qB,UAAU,MAA/F,UACE,UAAC9gB,EAAA,EAAD,CAAU7I,GAAI,CAAEkE,UAAW,SAAUuT,GAAI,GAAK1T,GAAI,EAAGgqB,SAAU,OAAQxiB,WAAY,SAAU7H,QAAS,OAAQsB,IAAK,EAAGmO,eAAgB,WAAYxP,WAAY,UAA9J,WACE,UAAC,KAAD,CAAWtG,MAAO2sB,EAAQ,GAAK,eAAY5rB,EAA3C,qBAA8D,4BAAS4rB,EAAMvC,QAAQ,SACrF,UAAC,KAAD,CAAWpqB,MAAO2sB,EAAQ,GAAK,eAAY5rB,EAA3C,kBAA2D,8BAAS4vC,EAAGvmB,QAAQ,GAApB,mBAIjE,SAACtS,GAAA,EAAD,CAAOf,QAAS,EAAhB,SACGpV,OAAOC,QAAQmpB,GAAUjsB,KAAI,+BAAE8Z,EAAF,KAAKrZ,EAAL,YAAY,SAACsxC,GAAD,CAA+Bx5B,QAASuB,EAAGxb,MAAOmC,EAAG4wC,SAAUA,EAASv3B,GAAIq2B,aAAcA,EAAcjsC,aAAcA,GAA1F4V,WAI5E,SAASi4B,GAAT,GAAyN,IAAxLx5B,EAAuL,EAAvLA,QAASja,EAA8K,EAA9KA,MAAO+yC,EAAuK,EAAvKA,SAAUlB,EAA6J,EAA7JA,aAAcjsC,EAA+I,EAA/IA,aAC/DxB,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACFsvC,EAAejlB,GAAAA,GAAAA,aAAsBxU,EAAS,EAAG43B,GACvD,GAA0BzpC,EAAAA,EAAAA,WAAS,kBAAMpI,EAAQ0zC,KAAjD,eAAOnkB,EAAP,KAAcokB,EAAd,MACA5qC,EAAAA,EAAAA,YAAU,kBAAM4qC,EAAS3zC,EAAQ0zC,KAAe,CAAC1zC,EAAO0zC,IAExD,IAAMjkB,EAAOvsB,GAAAA,GAAAA,KAAY+W,GACnB25B,EAAerkB,EAAQmkB,EAEvBH,EAAMhkB,EAAQmkB,EAAgBjlB,GAAAA,GAAAA,aAAsBxU,GAAW,IAC/D45B,EAAWjuC,EAAasd,QAAO,SAAC9e,EAAG0vC,GAAJ,OAAW1vC,GAAK0vC,IAAO75B,EAAU,EAAI,KAAI,GACxE85B,EAA4B,GAAhB,EAAIF,GAEhBG,EAAWzkB,EAAQ,KAAUwkB,EAC7BE,GAAYvrC,EAAAA,EAAAA,cAAY,SAAC+I,GAAD,OAAeshC,EAASthC,EAAIiiC,KAAe,CAACX,EAAUW,IAEpF,OAAO,UAACh5B,GAAA,EAAD,CAAOf,QAAS,GAAhB,WACL,UAACtU,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAGmO,eAAe,gBAAgBxP,WAAW,SAAtE,WACE,UAACkF,EAAA,EAAD,CAAU7I,GAAI,CAAEiF,EAAG,GAAK8oB,SAAU,OAAQ5pB,SAAU,EAAGT,QAAS,OAAQsB,IAAK,EAAGrB,WAAY,SAAUwP,eAAgB,UAAtH,UACG3S,GAAAA,EAASkU,GAAU/W,GAAAA,GAAAA,OAAc+W,GAAU/W,GAAAA,GAAAA,KAAY+W,OAE1D,SAACgV,GAAA,EAAD,CAAkB5kB,OAAO,SAACuF,EAAA,EAAD,UAAaxL,EAAEyvC,EAAQ,wDAA8D,CAAE7zC,MAAO+zC,MAA2B7kB,UAAU,MAA5J,UACE,SAAC9gB,EAAA,EAAD,CAAU7I,GAAI,CAAEkE,UAAW,SAAUe,EAAG,GAAK8oB,SAAU,OAAvD,UACE,UAAC,KAAD,CAAW1wB,MAAOoxC,EAAU,eAAYrwC,EAAxC,kBAAuD,8BAAS4vC,EAAGvmB,QAAQ,GAApB,kBAI7D,UAAC3nB,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAGmO,eAAe,gBAAgBxP,WAAW,SAAtE,WACE,SAACwO,GAAA,GAAD,CACE9U,MAAOgxC,EAAe,UAAY,UAClCh8B,MAAgC,MAAzB1U,GAAAA,GAAAA,KAAY+W,GACnBpC,aAAc3U,GAAAA,GAAAA,KAAY+W,KAAY,SAAC5U,EAAA,EAAD,CAAK2D,MAAM,MAAM5D,UAAU,SACjEpF,MAAOk0C,WAAWN,EAAa5mB,QAAQ,IACvC/qB,SAAU,SAAAE,GAAC,YAAUwB,IAANxB,GAAmB4wC,EAAS5wC,IAC3CoD,GAAI,CAAEgH,aAAc,EAAGjD,GAAI,EAAGuH,OAAQ,OAAQ7H,MAAO,OACrDQ,WAAY,CAAEjE,GAAI,CAAEkE,UAAW,SAAWM,IAAK,MACjD,SAACqE,EAAA,EAAD,CAAU7I,GAAI,CAAE+D,GAAI,EAAGI,SAAU,EAAGT,QAAS,OAAQsB,IAAK,EAAGrB,WAAY,SAAUwP,eAAgB,UAAnG,UACE,SAACy7B,GAAA,GAAD,CACE7nC,KAAK,QACLtM,MAAOuvB,EACPvlB,IAAK+pC,EACLhqC,IAAK,EACLE,KAAM,EACNC,OAAK,EACLjI,SAAU,SAAC0G,EAAGxG,GAAJ,OAAUwxC,EAASxxC,IAC7B0H,kBAAmB,SAAClB,EAAGxG,GAAJ,OAAU8xC,EAAU9xC,SAG3C,SAACuV,GAAA,GAAD,CACE9U,MAAO5C,EAASg0C,EAAU,UAAY,UAAa,UACnDp8B,OAAK,EACL3Q,gBAAgB,UAAC5B,EAAA,EAAD,CAAKE,GAAI,CAAEuL,WAAY,SAAU9H,MAAO,MAAOC,QAAS,OAAQyP,eAAgB,iBAAhF,WAAmG,6BAAO0W,EAAAA,GAAAA,IAAiBskB,EAAcjkB,GAAOA,MAAY,mCAC5KzvB,MAAOk0C,WAAW3kB,EAAMvC,QAAQ,IAChC/qB,SAAU,SAAAE,GAAC,YAAUwB,IAANxB,GAAmB4wC,EAAS5wC,EAAIuxC,IAC/CnuC,GAAI,CAAEgH,aAAc,EAAGjD,GAAI,EAAGupC,GAAI,EAAGhiC,OAAQ,OAAQ7H,MAAO,OAC5DQ,WAAY,CAAEjE,GAAI,CAAEkE,UAAW,QAASulC,GAAI,IAAQjlC,IAAK,EAAGE,KAAM,W,gBEzc3D,SAASmqC,KACtB,IACQzyC,GADcqJ,EAAAA,EAAAA,YAAWC,EAAAA,GAAzBC,UACAvJ,IACF0Q,GAAeC,EAAAA,EAAAA,KACrB,IAAM3Q,EAAIitC,WAAW,YAAc,OAAO,KAE1C,IAAMlyB,EAAa23B,EAAAA,EAAAA,MAAiB,SAAA1rC,GAAC,OAAIhH,EAAI2yC,cAAcnxC,SAASwF,MAEpE,OAAO,SAACmE,GAAA,EAAD,CAAgBlK,MAAO8Z,EAAYrS,OAAO,6BAASkqC,EAAAA,GAAAA,IAAI,WAAD,OAAY73B,MAAlE,SACJ83B,EAAAA,GAAAA,KAAqB,SAAAt6B,GAAM,OAC1B,SAAC3Z,GAAA,EAAD,CAAuB8C,SAAUqZ,IAAexC,EAAQhS,SAAUwU,IAAexC,EAAQ1N,QAAS,kBAAM6F,GAAaoiC,EAAAA,EAAAA,IAAkB9yC,EAAoBuY,KAA3J,UACE,6BAAQ,SAAC,KAAD,CAAWtX,MAAOsX,EAAlB,UAA2Bq6B,EAAAA,GAAAA,IAAI,WAAD,OAAYr6B,SADrCA,Q,+BCXN,SAASw6B,KACtB,IAAQtwC,GAAMC,EAAAA,EAAAA,GAAe,MAArBD,EACAgQ,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SAEAzS,GADcqJ,EAAAA,EAAAA,YAAWC,EAAAA,GAAzBC,UACAvJ,IACAguB,GAAWC,EAAAA,EAAAA,KAAXD,OACFglB,GAAejsC,EAAAA,EAAAA,cAAY,kBAAM0L,EAASwgC,OAAOjwC,IAAI,CAAEgrB,OAAmB,MAAXA,EAAiB,IAAM,QAAQ,CAACA,EAAQvb,IAC7G,OAAMzS,EAAIitC,WAAW,aACd,UAACxiC,EAAA,EAAD,CAAQI,QAASmoC,EAAcloC,UAAsB,MAAXkjB,GAAiB,SAACklB,GAAA,EAAD,KAAa,SAACC,GAAA,EAAD,IAAxE,WAAkF,4BAAS1wC,EAAE,UAAD,OAAWurB,MAAvG,QADmC,KCqB7B,SAASolB,KACtB,IAAMjS,GAAWC,EAAAA,EAAAA,MACT3uB,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SACFd,GAAU5K,EAAAA,EAAAA,cAAY,kBAAMo6B,EAAS,iBAAgB,CAACA,IACtDpc,GAAiBsuB,EAAAA,EAAAA,MAAjBtuB,aAEN,OADoBtS,EAASwa,MAAMjkB,KAAKxH,SAASujB,IAExC,SAAC,KAAD,CAAUiS,GAAG,iBAEf,SAACtzB,EAAA,EAAD,CAAKwtC,GAAI,EAAG5pC,QAAQ,OAAOoG,cAAc,SAAS9E,IAAK,EAAvD,UACL,SAAC,EAAAgI,SAAD,CAAUC,UAAU,SAACqB,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,MAAzE,SACG6V,IAAgB,SAACuuB,GAAD,CAAsBvuB,aAAcA,EAAcpT,QAASA,QASlF,SAAS2hC,GAAT,GAAqF,IAAD,MAApDvuB,EAAoD,EAApDA,aAAcpT,EAAsC,EAAtCA,QACtCpI,GAAY+uB,EAAAA,EAAAA,GAAavT,GACvBiJ,GAAWC,EAAAA,EAAAA,KAAXD,OACFzd,GAAiBhO,EAAAA,EAAAA,IAAW,kBAAM2rB,EAAAA,EAAAA,IAAmBnJ,EAAciJ,KAAS,CAACjJ,EAAciJ,IAC3F0N,GAAWC,EAAAA,EAAAA,GAAY5W,GACbyqB,GAAhB,iBAA+B9T,QAA/B,IAA+BA,OAA/B,EAA+BA,EAAW3W,UAA1C,QAA2D,IAAnD5M,OACR,cAAuCo7B,EAAAA,EAAAA,IAAS,CAAExpC,KAAM,4BAA6BypC,KAAK,WAA1F,QAAsG,CAAE3yC,OAAQ,CAAE4yC,IAAK,cAAjH5yC,OAAU4yC,IAAAA,OAAhB,MAAsB,WAAtB,EACQhxC,GAAMC,EAAAA,EAAAA,GAAe,CAAC,gBAAiB,mBAAvCD,GAERixC,EAAAA,EAAAA,IAAS5zC,EAAAA,EAAAA,UAAQ,2BAAS2C,EAAE,iBAAD,QAAkByqC,EAAAA,EAAAA,IAAkBnoB,EAAciJ,KAA5D,cAA4EvrB,EAAE,uBAAD,OAAwBgxC,OAAU,CAAChxC,EAAGsiB,EAAciJ,EAAQylB,KAE1J,IAAMjqC,GAAoByxB,EAAAA,EAAAA,GAAmB,iBAAC1xB,QAAD,IAACA,OAAD,EAACA,EAAWvJ,WAAZ,QAAmB,IAE1DyvC,GAA+C3vC,EAAAA,EAAAA,UAAQ,WAC3D,GAAK47B,GAAa8T,EAClB,MAAO,CACL/lC,KAAM+lC,EACN9T,SAAAA,EACAphB,aAAStY,KAEV,CAACwtC,EAAY9T,IAEViY,GAAyD7zC,EAAAA,EAAAA,UAAQ,WACrE,GAAKyJ,GAAcgH,EACnB,MAAO,CACLhH,UAAAA,EACAgH,eAAAA,EACA/G,kBAAAA,KAED,CAACD,EAAWgH,EAAgB/G,IAC/B,OAAO,SAACiD,EAAA,EAAD,UACJgjC,GAAoBkE,GAAwB,SAACrqC,EAAA,WAAD,CAA2BjL,MAAOs1C,EAAlC,UAAyD,SAACjqC,EAAA,WAAD,CAAsBrL,MAAOoxC,EAA7B,UACpG,SAAC,IAAD,WAAoB,UAAC5iC,EAAA,EAAD,CAAajJ,GAAI,CAAE0D,QAAS,OAAQoG,cAAe,SAAU9E,IAAK,GAAlE,WAClB,UAAClF,EAAA,EAAD,CAAK4D,QAAQ,OAAb,WACE,UAAC5D,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAGiO,SAAS,OAAO9O,SAAU,EAAtD,WACE,SAACuI,EAAD,KACA,SAACmiC,GAAD,KACA,SAACM,GAAD,KACA,SAACa,GAAD,KACA,SAACC,EAAA,EAAD,KACA,SAACC,GAAD,SAECniC,IAAW,SAACE,EAAA,EAAD,CAAahH,QAAS8G,QAEtC,UAACjO,EAAA,EAAD,CAAK4D,QAAQ,OAAOsB,IAAK,EAAGiO,SAAS,OAArC,UACGtN,IAAa,SAAC2E,EAAA,EAAD,CAAaC,MAAO5E,EAAU4E,MAAOC,UAAW7E,EAAU6E,UAAW/H,QAASmD,KAC5F,SAAC,KAAD,CAAemB,KAAK,WACpB,SAAC,KAAD,KACA,SAAC,KAAD,CAAgBA,KAAK,cAEvB,SAACmI,EAAA,EAAD,WACE,SAACihC,GAAD,CAAQN,IAAKA,OAEf,SAACO,GAAD,KACA,SAAClhC,EAAA,EAAD,WACE,SAACihC,GAAD,CAAQN,IAAKA,gBAGmC,SAACvhC,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,QAI/G,SAAS8kC,KACP,OAAO,SAAC,EAAApjC,SAAD,CAAUC,UAAU,SAACqB,EAAA,EAAD,CAAUnR,QAAQ,cAAcsG,MAAM,OAAO6H,OAAQ,MAAzE,UACL,UAAC,KAAD,YAEE,SAAC,KAAD,CAAOtN,OAAK,EAACC,SAAS,SAAC6lC,GAAD,OACtB,SAAC,KAAD,CAAO39B,KAAK,UAAUlI,SAAS,SAAC,GAAD,OAC/B,SAAC,KAAD,CAAOkI,KAAK,aAAalI,SAAS,SAAC+oC,GAAD,OAClC,SAAC,KAAD,CAAO7gC,KAAK,YAAYlI,SAAS,SAACy4B,GAAD,OACjC,SAAC,KAAD,CAAOvwB,KAAK,eAAelI,SAAS,SAACgsC,GAAD,WAI1C,SAASkG,GAAT,GAA2C,IAAzBN,EAAwB,EAAxBA,IACRhxC,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACR,OAAO,UAACwxC,EAAA,EAAD,CACL51C,MAAOo1C,EACP1yC,QAAQ,aACRmzC,0BAAwB,EACxBtwC,GAAI,CACF,uBAAwB,CACtBsR,WAAY,8BACZjF,gBAAiB,0BAPhB,WAWL,SAACkkC,EAAA,EAAD,CAAKvwC,GAAI,CAAE+tB,SAAU,OAAStzB,MAAM,WAAWsB,MAAO8C,EAAE,iBAAkBP,MAAM,SAACkyC,EAAA,EAAD,IAAY3wC,UAAW48B,EAAAA,GAAYrJ,GAAG,MACtH,SAACmd,EAAA,EAAD,CAAKvwC,GAAI,CAAE+tB,SAAU,OAAStzB,MAAM,SAASsB,MAAO8C,EAAE,eAAgBP,MAAM,SAACmyC,EAAA,EAAD,IAAe5wC,UAAW48B,EAAAA,GAAYrJ,GAAG,YACrH,SAACmd,EAAA,EAAD,CAAKvwC,GAAI,CAAE+tB,SAAU,OAAStzB,MAAM,YAAYsB,MAAO8C,EAAE,kBAAmBP,MAAM,SAACoyC,EAAA,EAAD,IAAY7wC,UAAW48B,EAAAA,GAAYrJ,GAAG,eACxH,SAACmd,EAAA,EAAD,CAAKvwC,GAAI,CAAE+tB,SAAU,OAAStzB,MAAM,WAAWsB,MAAO8C,EAAE,iBAAkBP,MAAM,SAACu+B,EAAA,EAAD,IAAgBh9B,UAAW48B,EAAAA,GAAYrJ,GAAG,cAC1H,SAACmd,EAAA,EAAD,CAAKvwC,GAAI,CAAE+tB,SAAU,OAAStzB,MAAM,cAAcsB,MAAO8C,EAAE,oBAAqBP,MAAM,SAACs/B,EAAA,EAAD,IAAa/9B,UAAW48B,EAAAA,GAAYrJ,GAAG,mBAKjI,SAAS4c,KACP,IAAQnxC,GAAMC,EAAAA,EAAAA,GAAe,kBAArBD,EACR,GAAgCk0B,EAAAA,EAAAA,KAAhC,eAAOjlB,EAAP,KAAa+T,EAAb,KAAqB9T,EAArB,KACqByH,GAAiB/P,EAAAA,EAAAA,YAAWC,EAAAA,GAAzCC,UAAa6P,WACfm7B,EAAY3xC,OAAOoG,KAAKoQ,GAAYhY,OAC1C,OAAO,iCACL,UAACqJ,EAAA,EAAD,CAAQxJ,MAAM,OAAO6J,WAAW,SAAC0pC,EAAA,EAAD,IAAc3pC,QAAS4a,EAAvD,UACGhjB,EADH,wCACwB8xC,IAAa,SAACrpC,EAAA,EAAD,CAAStH,GAAI,CAAEkI,GAAI,GAAK7K,MAAM,UAA9B,SAA0CszC,QAE/E,SAACz7B,GAAD,CAAWpH,KAAMA,EAAMC,QAASA,OAGpC,SAASmiC,KACP,IAAQW,GAAgBprC,EAAAA,EAAAA,YAAWiI,EAAAA,GAA3BmjC,YACR,OAAO,iCACL,UAAChqC,EAAA,EAAD,CAAQxJ,MAAM,OAAO6J,WAAW,SAAC4pC,EAAA,EAAD,IAAe7pC,QAAS4pC,EAAxD,sBAA+E,IAA/E,aACA,SAACrjC,GAAD,S,0ZC/IW,SAAS2zB,EAAT,GAA+G,IAAD,EAAxFhW,EAAwF,EAAxFA,SAAUlkB,EAA8E,EAA9EA,QAASo7B,EAAqE,EAArEA,OAAQ0O,EAA6D,EAA7DA,SAA6D,IAAnD7iB,SAAAA,OAAmD,SAAjC4R,EAAiC,EAAjCA,aAClFjhC,GAAMC,EAAAA,EAAAA,GAAe,CAAC,cAAe,OAArCD,EACAgQ,GAAapJ,EAAAA,EAAAA,YAAWqJ,EAAAA,GAAxBD,SAEFuc,GADiBC,EAAAA,EAAAA,GAAUF,GAE3BG,GAAc3sB,EAAAA,EAAAA,IAAW,kBAAY,OAANysB,QAAM,IAANA,GAAAA,EAAQhvB,IAAMmvB,EAAAA,EAAAA,IAAgBH,EAAOhvB,UAAOgC,IAAW,QAACgtB,QAAD,IAACA,OAAD,EAACA,EAAQhvB,MAE/FyN,GAAS1G,EAAAA,EAAAA,cAAY,SAAC6tC,GAAD,OAAwBA,EAAG7Q,iBAAH,OAAqB7U,QAArB,IAAqBA,OAArB,EAAqBA,EAAaqV,cAAY,CAACrV,IAE5F/V,GAAcpS,EAAAA,EAAAA,cAAY,SAAAhD,GAAQ,OAAI,SAAC,IAAD,CAAgB8G,QAAS,yBAAMA,QAAN,IAAMA,OAAN,EAAMA,EAAUkkB,IAAzC,SAAsDhrB,MAA4B,CAAC8G,EAASkkB,IAClI8lB,GAAmB9tC,EAAAA,EAAAA,cAAY,SAAAhD,GAAQ,OAAI,SAAC,IAAD,UAAOA,MAAiB,IACnE+wC,GAAc/tC,EAAAA,EAAAA,cAAY,SAAC8S,GAAD,OAAoBkV,GAAYtc,EAAS8d,QAAQvtB,IAAI+rB,EAAU,CAAE9C,SAAUpS,MAAM,CAACpH,EAAUsc,IAEtH/H,GAASlnB,EAAAA,EAAAA,UAAQ,kBAAMovB,GAAeF,IAAUI,EAAAA,EAAAA,IAAc,CAACF,EAAYzlB,MAAM4lB,EAAAA,EAAAA,IAAiBL,OAAW,CAACE,EAAaF,IAEjI,IAAKA,IAAWE,IAAgBlI,EAAQ,OAAO,KAC/C,IAAQ7Y,EAA0D6gB,EAA1D7gB,MAAOC,EAAmD4gB,EAAnD5gB,UAAWuB,EAAwCqf,EAAxCrf,WAAY0P,GAA4B2P,EAA5B3P,GAAtC,GAAkE2P,EAAxB/C,SAAAA,QAA1C,OAAqD,GAArD,GAAyD+iB,GAAShgB,EAATggB,KACnDjL,GAAgB/c,EAAO9c,IAAIuM,EAAAA,GAAAA,OAAAA,MAAmBpY,MAC9CwwC,GAAQ,CAACp4B,EAAAA,GAAAA,OAAAA,KAAmBA,EAAAA,GAAAA,OAAAA,IAAkBA,EAAAA,GAAAA,OAAAA,MAAmB1W,KAAI,SAAAyc,GAAC,OAAIwK,EAAO9c,IAAIsS,MACrF+sB,GAAMra,EAAYK,OAAOnhB,GAE/B,OAAO,SAAC,EAAAwC,SAAD,CAAUC,UAAU,SAAC,IAAD,CAAU9P,QAAQ,cAAc6C,GAAI,CAAEyD,MAAO,OAAQ6H,OAAQ,OAAQ6kB,UAAW,OAApG,UACL,UAAC,IAAD,CAAWnwB,GAAI,CAAEsL,OAAQ,OAAQ5H,QAAS,OAAQoG,cAAe,SAAUqJ,eAAgB,iBAA3F,WACE,UAAC,IAAD,CAAoBuV,YAAazhB,EAAS0hB,QAASpT,EAAa47B,aAAcF,EAA9E,WACE,UAAC,IAAD,CAAKptB,UAAS,eAAUyH,EAAYnsB,OAAtB,QAAoCa,GAAI,CAAE4oB,SAAU,WAAY1a,GAAI,EAAGnK,GAAI,GAAzF,WACIkD,IAAW,SAAC,IAAD,CAAY5J,MAAM,UAAU4J,QAAS,kBAAM4H,EAAS8d,QAAQvtB,IAAIqc,GAAI,CAAE2vB,MAAOA,MAASprC,GAAI,CAAE4oB,SAAU,WAAYkc,MAAO,EAAGtb,OAAQ,EAAGC,OAAQ,GAA/I,SACV2hB,IAAO,SAAC,IAAD,KAAW,SAAC,IAAD,OAErB,UAAC,IAAD,CAAKprC,GAAI,CAAE4oB,SAAU,WAAYa,OAAQ,GAAzC,WACE,UAAC,IAAD,CAAK5pB,UAAU,MAAMG,GAAI,CAAE0D,QAAS,OAAQC,WAAY,SAAUqB,IAAK,EAAGwJ,GAAI,GAA9E,WACE,SAAC,IAAD,CAASxO,GAAI,CAAEuuB,SAAU,SAAWjhB,IAAG,UAAE4a,EAAAA,EAAAA,mBAAF,aAAE,EAAqBiY,OAC9D,SAAC,IAAD,CAAYiR,QAAM,EAACpxC,GAAI,CAAEkE,UAAW,SAAUmI,gBAAiB,yBAA0BrF,aAAc,MAAOjD,GAAI,GAAlH,UAAuH,4BAASunB,EAAY5kB,aAE9I,UAAC,IAAD,CAAY7G,UAAU,OAAO1C,QAAQ,KAArC,iBAA+CoN,MAC/C,UAAC,IAAD,CAAY1K,UAAU,OAAO1C,QAAQ,KAAKE,MAAM,iBAAhD,cAAmEuN,EAAAA,GAAkBJ,OACrF,UAAC,IAAD,CAAYrN,QAAQ,KAApB,yBAAoC,4BAAS4O,QAC7C,SAAC,IAAD,WAAY,SAAC,IAAD,CAAc7L,MAAOorB,EAAYnsB,OAAQwlC,SAAO,UAE9D,SAAC,IAAD,CAAK3kC,GAAI,CAAEsL,OAAQ,OAAQsd,SAAU,WAAYkc,MAAO,EAAG7kC,IAAK,GAAhE,UACE,SAAC,IAAD,CACEJ,UAAU,MACVyN,IAAG,OAAEq4B,SAAF,IAAEA,GAAAA,GAAO,GACZliC,MAAM,OACN6H,OAAO,OACPtL,GAAI,CAAEqS,MAAO,iBAInB,SAAC,IAAD,UACG44B,GAAM9uC,KAAI,SAAAkT,GACT,OAAKA,EAAKkB,KAAK7J,MACR,UAAC,IAAD,CAAqC1G,GAAI,CAAE0D,QAAS,QAApD,WACL,UAAC,IAAD,CAAYS,SAAU,EAAtB,UAA0BkL,EAAKkB,KAAKjS,KAApC,IAA2C+Q,EAAKkB,KAAK7J,SACrD,SAAC,IAAD,WAAa8J,EAAAA,EAAAA,GAASnB,OAFP0H,KAAKC,UAAU3H,EAAKkB,OADT,cAQlC,UAAC,IAAD,CAAKvQ,GAAI,CAAEiF,EAAG,EAAGvB,QAAS,OAAQsB,IAAK,EAAGmO,eAAgB,gBAAiBxP,WAAY,UAAvF,WACE,SAAC,IAAD,CAAK3D,GAAI,CAAEmE,SAAU,GAArB,SACG+pB,GACG,SAAC,IAAD,CAAsB7F,SAAUA,GAAU6oB,YAAaA,EAAarnC,OAAQA,EAAQq/B,kBAAmB,CAAEznC,kBAAmB,SAAA5C,GAAC,OAAKA,EAAEzC,KAAKwxC,kBAAkB,MAC3J,SAAC,IAAD,CAAcvlB,SAAUA,QAE9B,UAAC,IAAD,CAAaroB,GAAI,CAAEsL,OAAQ,QAA3B,YACK+2B,IAAU,SAAC,IAAD,CAASv9B,OAAO,SAAC,IAAD,UAAajG,EAAb,wCAAgD8qB,UAAU,MAAM2U,OAAK,EAArF,UACX,SAAC,IAAD,CAAQjhC,MAAM,OAAO4J,QAAS,kBAAMo7B,EAAO5mB,KAA3C,UACE,SAAC,IAAD,CAAiBnd,KAAM+yC,EAAAA,IAAQxtB,UAAU,gBAG1CktB,IAAY,SAAC,IAAD,CAAQ1zC,MAAM,QAAQ4J,QAAS,kBAAM8pC,EAASt1B,KAAK9Y,WAAY0lB,IAAY+iB,GAA3E,UACb,SAAC,IAAD,CAAiB9sC,KAAMgzC,EAAAA,IAAYztB,UAAU,YAE9Cic","sources":["Components/MenuItemWithImage.tsx","Components/Artifact/ArtifactAutocomplete.tsx","Components/Artifact/ArtifactLevelSlider.tsx","Components/Card/CardHeaderCustom.tsx","Components/Conditional/ConditionalSelector.tsx","Components/Conditional/ConditionalDisplay.tsx","Components/DocumentDisplay.tsx","Components/LevelSelect.tsx","Components/RefinementDropdown.tsx","Components/TextButton.tsx","PageCharacter/CharacterDisplay/CharSelectDropdown.tsx","PageCharacter/CharacterDisplay/FormulaModal.tsx","Components/ExpandButton.tsx","Components/StatInput.tsx","Components/EnemyEditor.tsx","PageCharacter/CharacterDisplay/StatModal.tsx","Context/OptimizationTargetContext.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/common.ts","Components/Artifact/SetEffectDisplay.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/useBuildSetting.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ArtifactSetConfig.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/AssumeFullLevelToggle.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BonusStatsCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BuildAlert.tsx","Components/Artifact/ArtifactCardNano.tsx","Components/Character/StatDisplayComponent.tsx","Components/Weapon/WeaponCardNano.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BuildDisplayItem.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ChartCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/MainStatSelectionCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/StatFilterCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/UseEquipped.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/UseExcluded.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/foreground.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/useBuildResult.ts","PageCharacter/CharacterDisplay/Tabs/TabOverview/CompareBuildButton.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview/ArtifactSwapModal.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview/WeaponSwapModal.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview/EquipmentSection.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabTalent.tsx","PageCharacter/CharacterDisplay/Tabs/TabTeambuffs.tsx","PageCharacter/CharacterDisplay/Tabs/TabTheorycraft/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabTheorycraft/useCharTC.tsx","PageCharacter/CharacterDisplay/TravelerElementSelect.tsx","PageCharacter/CharacterDisplay/TravelerGenderSelect.tsx","PageCharacter/CharacterDisplay/index.tsx","PageWeapon/WeaponCard.tsx"],"sourcesContent":["import { ListItemIcon, ListItemText, MenuItem, Theme } from \"@mui/material\";\r\n\r\ntype MenuItemWithImageProps = {\r\n  value: string\r\n  image?: Displayable\r\n  text: Displayable\r\n  theme: Theme\r\n  isSelected?: boolean\r\n  addlElement?: Displayable\r\n  props?: object\r\n}\r\n\r\nexport default function MenuItemWithImage({ value, image = \"\", text, theme, isSelected, addlElement, props }: MenuItemWithImageProps) {\r\n  return <MenuItem key={value} value={value} {...props}>\r\n    <ListItemIcon>{image}</ListItemIcon>\r\n    <ListItemText primaryTypographyProps={{ style: { fontWeight: isSelected ? theme.typography.fontWeightMedium : theme.typography.fontWeightRegular } }}>\r\n      {text}\r\n    </ListItemText>\r\n    {addlElement && addlElement}\r\n  </MenuItem>\r\n}\r\n","import { Autocomplete, AutocompleteProps, AutocompleteRenderGroupParams, Box, Chip, List, ListSubheader, TextField, useTheme } from '@mui/material';\r\nimport { useMemo } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { ArtifactSheet } from '../../Data/Artifacts/ArtifactSheet';\r\nimport i18n from '../../i18n';\r\nimport KeyMap from '../../KeyMap';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport { allMainStatKeys, allSubstatKeys, MainStatKey, SubstatKey } from '../../Types/artifact';\r\nimport { allElementsWithPhy, ArtifactRarity, ArtifactSetKey } from '../../Types/consts';\r\nimport ColorText from '../ColoredText';\r\nimport MenuItemWithImage from '../MenuItemWithImage';\r\nimport SolidColoredTextField from '../SolidColoredTextfield';\r\nimport { StarsDisplay } from '../StarDisplay';\r\nimport StatIcon from '../StatIcon';\r\n\r\ntype Grouper = string | number | undefined\r\n\r\ntype ArtifactMultiAutocompleteKey = ArtifactSetKey | MainStatKey | SubstatKey\r\ntype ArtifactMultiAutocompleteOption<T extends ArtifactMultiAutocompleteKey, G extends Grouper> = {\r\n  key: T\r\n  label: string\r\n  grouper?: G\r\n}\r\ntype ArtifactMultiAutocompleteProps<T extends ArtifactMultiAutocompleteKey, G extends Grouper> = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<T, G>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  allArtifactKeysWithGrouper: readonly { key: T, grouper?: G }[]\r\n  selectedArtifactKeys: T[]\r\n  setArtifactKeys: (keys: T[]) => void\r\n  getName: (key: T) => string\r\n  getImage: (key: T) => JSX.Element\r\n  label: string\r\n}\r\nfunction ArtifactMultiAutocomplete<T extends ArtifactMultiAutocompleteKey, G extends Grouper>({ allArtifactKeysWithGrouper, selectedArtifactKeys, setArtifactKeys, getName, getImage, label, ...props }:\r\n  ArtifactMultiAutocompleteProps<T, G>) {\r\n  const theme = useTheme()\r\n\r\n  const handleChange = (_, value: ArtifactMultiAutocompleteOption<T, G>[]) => {\r\n    setArtifactKeys(value.map(v => v.key))\r\n  }\r\n  const options = useMemo(() => allArtifactKeysWithGrouper.map(({ key, grouper }) => ({ key, label: getName(key), grouper })), [allArtifactKeysWithGrouper, getName])\r\n  return <Autocomplete\r\n    autoHighlight\r\n    multiple\r\n    disableCloseOnSelect\r\n    options={options}\r\n    value={selectedArtifactKeys.map(key => ({ key: key, label: getName(key) }))}\r\n    onChange={handleChange}\r\n    getOptionLabel={(option) => option.label}\r\n    isOptionEqualToValue={(option, value) => option.key === value.key}\r\n    renderInput={(params) => <TextField\r\n      {...params}\r\n      label={label}\r\n      variant=\"filled\"\r\n      InputLabelProps={{ style: { color: theme.palette.text.primary } }}\r\n      color={selectedArtifactKeys.length ? \"success\" : \"primary\"}\r\n      type=\"search\"\r\n    />}\r\n    renderOption={(props, option) => (\r\n      <MenuItemWithImage\r\n        key={option.key}\r\n        value={option.key}\r\n        image={<ColorText color={KeyMap.getVariant(option.key)}>{getImage(option.key)}</ColorText>}\r\n        text={<ColorText color={KeyMap.getVariant(option.key)}>{option.label}</ColorText>}\r\n        theme={theme}\r\n        isSelected={selectedArtifactKeys.includes(option.key)}\r\n        props={props}\r\n      />\r\n    )}\r\n    renderTags={(selected, getTagProps) => selected.map((value, index) => {\r\n      const element = allElementsWithPhy.find(ele => value.key === `${ele}_dmg_`)\r\n      const color = element ? element : undefined\r\n      return <Chip {...getTagProps({ index })} key={value.key} icon={getImage(value.key)} label={value.label} color={color} />\r\n    })}\r\n    {...props}\r\n  />\r\n}\r\n\r\ntype ArtifactSetMultiAutocompleteProps = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<ArtifactSetKey, ArtifactRarity>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  artSetKeys: ArtifactSetKey[]\r\n  setArtSetKeys: (keys: ArtifactSetKey[]) => void\r\n}\r\nexport function ArtifactSetMultiAutocomplete({ artSetKeys, setArtSetKeys, ...props }: ArtifactSetMultiAutocompleteProps) {\r\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\r\n  const { t } = useTranslation([\"artifact\", \"artifactNames_gen\"])\r\n  if (!artifactSheets) return null\r\n\r\n  const allArtifactSetsAndRarities = Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets))\r\n    .flatMap(([rarity, sets]) => sets.map(set => ({ key: set, grouper: +rarity as ArtifactRarity })))\r\n    .sort(sortByRarityAndName)\r\n\r\n  return <ArtifactMultiAutocomplete<ArtifactSetKey, ArtifactRarity>\r\n    allArtifactKeysWithGrouper={allArtifactSetsAndRarities}\r\n    selectedArtifactKeys={artSetKeys}\r\n    setArtifactKeys={setArtSetKeys}\r\n    getName={(key: ArtifactSetKey) => t(`artifactNames_gen:${key}`)}\r\n    getImage={(key: ArtifactSetKey) => artifactSheets(key).defIcon}\r\n    label={t(\"artifact:autocompleteLabels.sets\")}\r\n    groupBy={(option) => option.grouper?.toString() ?? \"\"}\r\n    renderGroup={(params: AutocompleteRenderGroupParams) => params.group && <List key={params.group} component={Box}>\r\n      <ListSubheader key={`${params.group}Header`} sx={{ top: \"-1em\" }}>\r\n        {params.group} <StarsDisplay stars={+params.group as ArtifactRarity} />\r\n      </ListSubheader>\r\n      {params.children}\r\n    </List>}\r\n    {...props}\r\n  />\r\n}\r\n\r\ntype ArtifactMainStatMultiAutocompleteProps = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<MainStatKey, undefined>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  mainStatKeys: MainStatKey[]\r\n  setMainStatKeys: (keys: MainStatKey[]) => void\r\n}\r\nexport function ArtifactMainStatMultiAutocomplete({ mainStatKeys, setMainStatKeys, ...props }: ArtifactMainStatMultiAutocompleteProps) {\r\n  const { t } = useTranslation(\"artifact\")\r\n  return <ArtifactMultiAutocomplete<MainStatKey, undefined>\r\n    allArtifactKeysWithGrouper={allMainStatKeys.map(key => ({ key }))}\r\n    selectedArtifactKeys={mainStatKeys}\r\n    setArtifactKeys={setMainStatKeys}\r\n    getName={(key: MainStatKey) => KeyMap.getArtStr(key)}\r\n    getImage={(key: MainStatKey) => StatIcon[key]}\r\n    label={t(\"autocompleteLabels.mainStats\")}\r\n    {...props}\r\n  />\r\n}\r\n\r\ntype ArtifactSubstatMultiAutocompleteProps = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<SubstatKey, undefined>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  substatKeys: SubstatKey[]\r\n  setSubstatKeys: (keys: SubstatKey[]) => void\r\n}\r\nexport function ArtifactSubstatMultiAutocomplete({ substatKeys, setSubstatKeys, ...props }: ArtifactSubstatMultiAutocompleteProps) {\r\n  const { t } = useTranslation(\"artifact\")\r\n  return <ArtifactMultiAutocomplete<SubstatKey, undefined>\r\n    allArtifactKeysWithGrouper={allSubstatKeys.map(key => ({ key }))}\r\n    selectedArtifactKeys={substatKeys}\r\n    setArtifactKeys={setSubstatKeys}\r\n    getName={(key: SubstatKey) => KeyMap.getArtStr(key)}\r\n    getImage={(key: SubstatKey) => StatIcon[key]}\r\n    label={t(\"autocompleteLabels.substats\")}\r\n    {...props}\r\n  />\r\n}\r\n\r\ntype ArtifactSingleAutocompleteKey = ArtifactSetKey | MainStatKey | SubstatKey | \"\"\r\ntype ArtifactSingleAutocompleteOption<T extends ArtifactSingleAutocompleteKey, G extends Grouper> = {\r\n  key: T\r\n  label: string\r\n  grouper?: G\r\n}\r\ntype ArtifactSingleAutocompleteProps<T extends ArtifactSingleAutocompleteKey, G extends Grouper> = Omit<AutocompleteProps<ArtifactSingleAutocompleteOption<T, G>, false, true, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  allArtifactKeysWithGrouper: readonly { key: T, grouper?: G }[]\r\n  selectedArtifactKey: T\r\n  setArtifactKey: (key: T | \"\") => void\r\n  getName: (key: T) => string\r\n  getImage: (key: T) => JSX.Element\r\n  label: string\r\n  disable?: (v: any) => boolean\r\n  showDefault?: boolean\r\n  defaultText?: string\r\n  defaultIcon?: Displayable\r\n}\r\nfunction ArtifactSingleAutocomplete<T extends ArtifactSingleAutocompleteKey, G extends Grouper>({ allArtifactKeysWithGrouper, selectedArtifactKey, setArtifactKey, getName, getImage, label, disable = () => false, showDefault = false, defaultText = \"\", defaultIcon = \"\", ...props }:\r\n  ArtifactSingleAutocompleteProps<T, G>) {\r\n  const theme = useTheme();\r\n\r\n  const options = useMemo(() =>\r\n    (showDefault\r\n      ? [{ key: \"\" as T, label: defaultText }]\r\n      : []\r\n    ).concat(allArtifactKeysWithGrouper.map(({ key, grouper }) => (\r\n      { key, label: getName(key), grouper }\r\n    ))), [allArtifactKeysWithGrouper, getName, defaultText, showDefault])\r\n\r\n  return <Autocomplete\r\n    autoHighlight\r\n    options={options}\r\n    clearIcon={selectedArtifactKey ? undefined : \"\"} // Hide the clear icon if the value is already default\r\n    value={{ key: selectedArtifactKey, label: getName(selectedArtifactKey) }}\r\n    onChange={(event, newValue, reason) => (event.type !== \"change\" || reason !== \"clear\") && setArtifactKey(newValue ? newValue.key : \"\")}\r\n    getOptionLabel={(option) => option.label ? option.label : defaultText}\r\n    isOptionEqualToValue={(option, value) => option.key === value.key}\r\n    getOptionDisabled={option => disable(option.key)}\r\n    renderInput={(props) => <SolidColoredTextField\r\n      {...props}\r\n      label={label}\r\n      startAdornment={getImage(selectedArtifactKey)}\r\n      hasValue={selectedArtifactKey ? true : false}\r\n    />}\r\n    renderOption={(props, option) => (\r\n      <MenuItemWithImage\r\n        key={option.key}\r\n        value={option.key}\r\n        image={getImage(option.key)}\r\n        text={option.label}\r\n        theme={theme}\r\n        isSelected={selectedArtifactKey === option.key}\r\n        props={props}\r\n      />\r\n    )}\r\n    {...props}\r\n  />\r\n}\r\n\r\ntype ArtifactSetSingleAutocompleteProps = Omit<AutocompleteProps<ArtifactSingleAutocompleteOption<ArtifactSetKey | \"\", ArtifactRarity>, false, true, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  artSetKey: ArtifactSetKey | \"\"\r\n  setArtSetKey: (key: ArtifactSetKey | \"\") => void\r\n  label?: string\r\n  disable?: (v: any) => boolean\r\n  showDefault?: boolean\r\n  defaultText?: string\r\n  defaultIcon?: Displayable\r\n}\r\nexport function ArtifactSetSingleAutocomplete({ artSetKey, setArtSetKey, label = \"\", ...props }: ArtifactSetSingleAutocompleteProps) {\r\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\r\n  const { t } = useTranslation([\"artifact\", \"artifactNames_gen\"])\r\n  label = label ? label : t(\"artifact:autocompleteLabels.set\")\r\n  if (!artifactSheets) return null\r\n\r\n  const allArtifactSetsAndRarities = Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets))\r\n    .flatMap(([rarity, sets]) => sets.map(set => ({ key: set, grouper: +rarity as ArtifactRarity })))\r\n    .sort(sortByRarityAndName)\r\n\r\n  return <ArtifactSingleAutocomplete<ArtifactSetKey | \"\", ArtifactRarity>\r\n    allArtifactKeysWithGrouper={allArtifactSetsAndRarities}\r\n    selectedArtifactKey={artSetKey}\r\n    setArtifactKey={setArtSetKey}\r\n    getName={(key: ArtifactSetKey | \"\") => key && t(`artifactNames_gen:${key}`)}\r\n    getImage={(key: ArtifactSetKey | \"\") => key ? artifactSheets(key).defIcon : <></>}\r\n    label={label}\r\n    groupBy={(option) => option.grouper?.toString() ?? \"\"}\r\n    renderGroup={(params: AutocompleteRenderGroupParams) => params.group && <List key={params.group} component={Box}>\r\n      <ListSubheader key={`${params.group}Header`} sx={{ top: \"-1em\" }}>\r\n        {params.group} <StarsDisplay stars={+params.group as ArtifactRarity} />\r\n      </ListSubheader>\r\n      {params.children}\r\n    </List>}\r\n    {...props}\r\n  />\r\n}\r\n\r\nfunction sortByRarityAndName(a: { key: ArtifactSetKey, grouper: ArtifactRarity }, b: { key: ArtifactSetKey, grouper: ArtifactRarity }) {\r\n  if (a.grouper > b.grouper) {\r\n    return -1\r\n  }\r\n  if (a.grouper < b.grouper) {\r\n    return 1\r\n  }\r\n\r\n  const aName = i18n.t(`artifactNames_gen:${a.key}`)\r\n  const bName = i18n.t(`artifactNames_gen:${b.key}`)\r\n  if (aName < bName) {\r\n    return -1\r\n  }\r\n  if (aName > bName) {\r\n    return 1\r\n  }\r\n\r\n  return 0\r\n}\r\n","import { Card, Slider } from \"@mui/material\"\r\nimport { useCallback, useEffect, useState } from \"react\"\r\nimport { clamp } from \"../../Util/Util\"\r\nimport CustomNumberInput from \"../CustomNumberInput\"\r\n\r\nexport default function ArtifactLevelSlider({ levelLow, levelHigh, setLow, setHigh, setBoth, dark = false, disabled = false, showLevelText = false }: {\r\n  levelLow: number,\r\n  levelHigh: number,\r\n  setLow: (low: number) => void,\r\n  setHigh: (high: number) => void,\r\n  setBoth: (low: number, high: number) => void,\r\n  dark?: boolean,\r\n  disabled?: boolean,\r\n  showLevelText?: boolean,\r\n}) {\r\n  const [sliderLow, setsliderLow] = useState(levelLow)\r\n  const [sliderHigh, setsliderHigh] = useState(levelHigh)\r\n  const setSlider = useCallback(\r\n    (e: unknown, value: number | number[]) => {\r\n      if (typeof value == \"number\") throw new TypeError()\r\n      const [l, h] = value\r\n      setsliderLow(l)\r\n      setsliderHigh(h)\r\n    },\r\n    [setsliderLow, setsliderHigh])\r\n  useEffect(() => setsliderLow(levelLow), [setsliderLow, levelLow])\r\n\r\n  useEffect(() => setsliderHigh(levelHigh), [setsliderHigh, levelHigh])\r\n  return <Card sx={{ width: \"100%\", display: \"flex\", alignItems: \"center\", bgcolor: dark ? \"contentDark.main\" : \"contentLight.main\" }}>\r\n    <CustomNumberInput\r\n      value={sliderLow}\r\n      onChange={val => setLow(clamp(val, 0, levelHigh))}\r\n      sx={{ px: 1, pl: showLevelText ? 2 : undefined, width: showLevelText ? 100 : 50, }}\r\n      inputProps={{ sx: { textAlign: showLevelText ? \"right\" : \"center\" } }}\r\n      startAdornment={showLevelText ? \"Level: \" : undefined}\r\n      disabled={disabled}\r\n    />\r\n    <Slider sx={{ width: 100, flexGrow: 1, mx: 2 }}\r\n      getAriaLabel={() => 'Arifact Level Range'}\r\n      value={[sliderLow, sliderHigh]}\r\n      onChange={setSlider}\r\n      onChangeCommitted={(e, value) => setBoth(value[0], value[1])}\r\n      valueLabelDisplay=\"auto\"\r\n      min={0} max={20} step={1} marks\r\n      disabled={disabled}\r\n    />\r\n    <CustomNumberInput\r\n      value={sliderHigh}\r\n      onChange={val => setHigh(clamp(val, levelLow, 20))}\r\n      sx={{ px: 1, width: 50, }}\r\n      inputProps={{ sx: { textAlign: \"center\" } }}\r\n      disabled={disabled}\r\n    />\r\n  </Card>\r\n}\r\n","import { Typography } from \"@mui/material\";\r\nimport { Box } from \"@mui/system\";\r\n\r\nexport default function CardHeaderCustom({ avatar, title, action }: { avatar?: Displayable, title: Displayable, action?: Displayable }) {\r\n  return <Box display=\"flex\" gap={1} p={2} alignItems=\"center\" >\r\n    {avatar}\r\n    <Typography variant=\"subtitle1\" sx={{ flexGrow: 1 }}>{title}</Typography>\r\n    {action && <Typography variant=\"caption\">{action}</Typography>}\r\n  </Box>\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank } from '@mui/icons-material';\r\nimport { Button, ButtonGroup, ButtonProps, Divider, MenuItem } from '@mui/material';\r\nimport React, { useCallback, useContext } from 'react';\r\nimport { CharacterContext } from '../../Context/CharacterContext';\r\nimport { DataContext } from '../../Context/DataContext';\r\nimport { DocumentConditional, IDocumentConditionalExclusive, IDocumentConditionalMultiple } from '../../Types/sheet';\r\nimport { deepClone, deletePropPath, layeredAssignment } from '../../Util/Util';\r\nimport DropdownButton from '../DropdownMenu/DropdownButton';\r\nimport SqBadge from '../SqBadge';\r\nimport { Translate } from '../Translate';\r\n\r\ninterface ConditionalSelectorProps {\r\n  conditional: DocumentConditional,\r\n  disabled?: boolean,\r\n}\r\nexport default function ConditionalSelector({ conditional, disabled = false, }: ConditionalSelectorProps) {\r\n  if (Object.keys(conditional.states).length === 1 && \"path\" in conditional) {\r\n    return <SimpleConditionalSelector conditional={conditional} disabled={disabled} />\r\n  } else if (\"path\" in conditional) {\r\n    return <ExclusiveConditionalSelector conditional={conditional} disabled={disabled} />\r\n  } else /*if (\"path\" in Object.entries(conditional.states)[0]) */ {\r\n    return <MultipleConditionalSelector conditional={conditional} disabled={disabled} />\r\n  }\r\n}\r\n\r\ninterface SimpleConditionalSelectorProps extends ConditionalSelectorProps {\r\n  conditional: IDocumentConditionalExclusive\r\n}\r\nfunction SimpleConditionalSelector({ conditional, disabled }: SimpleConditionalSelectorProps) {\r\n  const { character, characterDispatch } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n  const setConditional = useCallback((v?: string) => {\r\n    const conditionalValues = deepClone(character.conditional)\r\n    if (v) {\r\n      layeredAssignment(conditionalValues, conditional.path, v)\r\n    } else {\r\n      deletePropPath(conditionalValues, conditional.path)\r\n    }\r\n    characterDispatch({ conditional: conditionalValues })\r\n  }, [conditional, character, characterDispatch])\r\n\r\n  const conditionalValue = data.get(conditional.value).value\r\n  const [stateKey, st] = Object.entries(conditional.states)[0]\r\n  const badge = getStateBadge(st.name)\r\n  const condName = getCondName(conditional.name)\r\n\r\n  return <Button fullWidth size=\"small\" sx={{ borderRadius: 0 }} color={conditionalValue ? \"success\" : \"primary\"} onClick={() => setConditional(conditionalValue ? undefined : stateKey)} disabled={disabled} startIcon={conditionalValue ? <CheckBox /> : <CheckBoxOutlineBlank />}>\r\n    {condName} {badge}\r\n  </Button>\r\n}\r\n\r\ninterface ExclusiveConditionalSelectorProps extends ConditionalSelectorProps {\r\n  conditional: IDocumentConditionalExclusive\r\n}\r\nfunction ExclusiveConditionalSelector({ conditional, disabled }: ExclusiveConditionalSelectorProps) {\r\n  const { character, characterDispatch } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n  const setConditional = useCallback((v?: string) => {\r\n    const conditionalValues = deepClone(character.conditional)\r\n    if (v) {\r\n      layeredAssignment(conditionalValues, conditional.path, v)\r\n    } else {\r\n      deletePropPath(conditionalValues, conditional.path)\r\n    }\r\n    characterDispatch({ conditional: conditionalValues })\r\n  }, [conditional, character, characterDispatch])\r\n\r\n  const conditionalValue = data.get(conditional.value).value\r\n  const state = conditionalValue ? conditional.states[conditionalValue] : undefined\r\n  const badge = state ? getStateBadge(state.name) : <SqBadge color=\"secondary\">Not Active</SqBadge>\r\n  const condName = getCondName(conditional.name)\r\n\r\n  return <DropdownButton fullWidth size=\"small\" sx={{ borderRadius: 0 }} color={conditionalValue ? \"success\" : \"primary\"} title={<span>{condName} {badge}</span>} disabled={disabled}>\r\n    <MenuItem onClick={() => setConditional()} selected={!state} disabled={!state}>\r\n      <span>Not Active</span>\r\n    </MenuItem>\r\n    <Divider />\r\n    {Object.entries(conditional.states).map(([stateKey, st]) =>\r\n      <MenuItem key={stateKey} onClick={() => setConditional(stateKey)} selected={conditionalValue === stateKey} disabled={conditionalValue === stateKey} >{st.name}</MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n\r\ninterface MultipleConditionalSelectorProps extends ConditionalSelectorProps {\r\n  conditional: IDocumentConditionalMultiple\r\n}\r\nfunction MultipleConditionalSelector({ conditional, disabled }: MultipleConditionalSelectorProps) {\r\n  const { character, characterDispatch } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n  const setConditional = useCallback((path: readonly string[], v?: string) => {\r\n    const conditionalValues = deepClone(character.conditional)\r\n    if (v) {\r\n      layeredAssignment(conditionalValues, path, v)\r\n    } else {\r\n      deletePropPath(conditionalValues, path)\r\n    }\r\n    characterDispatch({ conditional: conditionalValues })\r\n  }, [character, characterDispatch])\r\n\r\n  return <ButtonGroup fullWidth orientation=\"vertical\" disableElevation color=\"secondary\" >\r\n    {Object.entries(conditional.states).map(([stateKey, st]) => {\r\n      const conditionalValue = data.get(st.value).value\r\n      const isSelected = conditionalValue === stateKey\r\n      return <Button\r\n        color={isSelected ? \"success\" : \"primary\"}\r\n        disabled={disabled}\r\n        fullWidth\r\n        key={stateKey}\r\n        onClick={() => setConditional(st.path, conditionalValue ? undefined : stateKey)}\r\n        size=\"small\"\r\n        startIcon={isSelected ? <CheckBox /> : <CheckBoxOutlineBlank />}\r\n        sx={{ borderRadius: 0 }}\r\n      >\r\n        {getCondName(st.name)}\r\n      </Button>\r\n    })}\r\n  </ButtonGroup>\r\n}\r\n\r\nfunction isElement(disp: Displayable): disp is JSX.Element {\r\n  return (typeof disp !== \"string\")\r\n}\r\n\r\n// Use colored badges instead of colored text inside these buttons\r\nfunction getStateBadge(stateName: Displayable | undefined): Displayable {\r\n  if (!stateName) return \"\"\r\n\r\n  let badgeColor: ButtonProps['color'] = \"primary\"\r\n  let badgeText = stateName\r\n  if (stateName && isElement(stateName)) {\r\n    if (stateName.props.color) {\r\n      badgeColor = stateName.props.color\r\n      badgeText = <span>{stateName.props.children}</span>\r\n    }\r\n  }\r\n  return <SqBadge sx={{ ml: 0.5 }} color={badgeColor}>{badgeText}</SqBadge>\r\n}\r\n\r\n// Use colored badges instead of colored text inside these buttons\r\nfunction getCondName(condName: Displayable): Displayable {\r\n  if (isElement(condName)) {\r\n    const key = condName.props.key18\r\n    const ns = condName.props.ns\r\n    const values = condName.props.values\r\n    return <Translate ns={ns} key18={key} values={values} useBadge />\r\n  }\r\n  return condName\r\n}\r\n","import { CardContent } from \"@mui/material\"\r\nimport { useContext } from \"react\"\r\nimport { DataContext } from \"../../Context/DataContext\"\r\nimport { DocumentConditional, DocumentSection } from \"../../Types/sheet\"\r\nimport { evalIfFunc } from \"../../Util/Util\"\r\nimport CardDark from \"../Card/CardDark\"\r\nimport { HeaderDisplay } from \"../DocumentDisplay\"\r\nimport FieldsDisplay from \"../FieldDisplay\"\r\nimport ConditionalSelector from \"./ConditionalSelector\"\r\n\r\ntype ConditionalDisplayProps = {\r\n  conditional: DocumentConditional,\r\n  hideHeader?: boolean | ((section: DocumentSection) => boolean),\r\n  hideDesc?: boolean,\r\n}\r\n\r\nexport default function ConditionalDisplay({ conditional, hideHeader = false, hideDesc = false }: ConditionalDisplayProps) {\r\n  const { data } = useContext(DataContext)\r\n  let fields\r\n  if (\"path\" in conditional) {\r\n    const condVal = data.get(conditional.value).value\r\n    fields = condVal && conditional.states[condVal]?.fields\r\n  } else /* if (\"path\" in Object.entries(conditional.states)[0]) */ {\r\n    fields = Object.values(conditional.states).flatMap(state => {\r\n      const stateVal = data.get(state.value).value\r\n      return stateVal ? state.fields : []\r\n    })\r\n  }\r\n  return <CardDark>\r\n    {!evalIfFunc(hideHeader, conditional) && <HeaderDisplay header={conditional.header} hideDesc={hideDesc} />}\r\n    <CardContent sx={{ p: 0, \"&:last-child\": { pb: 0 } }}>\r\n      <ConditionalSelector conditional={conditional} />\r\n    </CardContent>\r\n    {fields && <FieldsDisplay fields={fields} />}\r\n  </CardDark>\r\n}\r\n","import { Box, Divider, Typography } from \"@mui/material\"\r\nimport { useContext } from \"react\"\r\nimport { DataContext } from \"../Context/DataContext\"\r\nimport { DocumentSection, IDocumentFields, IDocumentHeader, IDocumentText } from \"../Types/sheet\"\r\nimport { evalIfFunc } from \"../Util/Util\"\r\nimport CardDark from \"./Card/CardDark\"\r\nimport CardHeaderCustom from \"./Card/CardHeaderCustom\"\r\nimport ConditionalDisplay from \"./Conditional/ConditionalDisplay\"\r\nimport FieldsDisplay from \"./FieldDisplay\"\r\nimport InfoTooltip from \"./InfoTooltip\"\r\n\r\ntype DocumentDisplayProps = {\r\n  sections: DocumentSection[],\r\n  teamBuffOnly?: boolean,\r\n  hideDesc?: boolean,\r\n  hideHeader?: boolean | ((section: DocumentSection) => boolean),\r\n}\r\n\r\nexport default function DocumentDisplay({ sections, teamBuffOnly, hideDesc = false, hideHeader = false }: DocumentDisplayProps) {\r\n  const { data } = useContext(DataContext)\r\n  if (!sections.length) return null\r\n  const sectionDisplays = sections.map((s, i) => {\r\n    // If we can't show this section, return null\r\n    if (s.canShow && !data.get(s.canShow).value) return null\r\n    // If we are showing only teambuffs, and this section is not a teambuff, return null\r\n    if (teamBuffOnly && !s.teamBuff) return null\r\n    return <SectionDisplay section={s} key={i} hideDesc={hideDesc} hideHeader={hideHeader} />\r\n  }).filter(s => s)\r\n  if (!sectionDisplays.length) return null\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>{sectionDisplays}</Box>\r\n}\r\n\r\nfunction SectionDisplay({ section, hideDesc = false, hideHeader = false }: { section: DocumentSection, hideDesc?: boolean, hideHeader?: boolean | ((section: DocumentSection) => boolean) }) {\r\n  if (\"fields\" in section) {\r\n    return <FieldsSectionDisplay section={section} hideDesc={hideDesc} hideHeader={hideHeader} />\r\n  } else if (\"states\" in section) {\r\n    return <ConditionalDisplay conditional={section} hideDesc={hideDesc} hideHeader={hideHeader} />\r\n  } else /* if (\"text\" in section) */ {\r\n    return <TextSectionDisplay section={section} />\r\n  }\r\n}\r\n\r\nfunction FieldsSectionDisplay({ section, hideDesc, hideHeader }: { section: IDocumentFields, hideDesc?: boolean, hideHeader?: boolean | ((section: DocumentSection) => boolean) }) {\r\n  return <CardDark>\r\n    {!evalIfFunc(hideHeader, section) && section.header &&\r\n      <HeaderDisplay header={section.header} hideDesc={hideDesc} hideDivider={section.fields.length === 0} />\r\n    }\r\n    <FieldsDisplay fields={section.fields} />\r\n  </CardDark>\r\n}\r\n\r\nfunction TextSectionDisplay({ section }: { section: IDocumentText }) {\r\n  const { data } = useContext(DataContext)\r\n  return <div>\r\n    {evalIfFunc(section.text, data)}\r\n  </div>\r\n}\r\n\r\nexport function HeaderDisplay({ header, hideDesc, hideDivider }: { header: IDocumentHeader, hideDesc?: boolean, hideDivider?: boolean | ((section: DocumentSection) => boolean) }) {\r\n  const { data } = useContext(DataContext)\r\n  let { icon, title, action } = header\r\n  icon = evalIfFunc(icon, data)\r\n  const description = !hideDesc && evalIfFunc(header.description, data)\r\n  const displayTitle = hideDesc ? title : <span>{title} <InfoTooltip title={<Typography>{description}</Typography>} /></span>\r\n  return <>\r\n    <CardHeaderCustom avatar={icon} title={displayTitle} action={action} />\r\n    {!hideDivider && <Divider />}\r\n  </>\r\n}\r\n","import { Button, ButtonGroup, MenuItem } from '@mui/material';\r\nimport { useCallback } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { ambiguousLevel, ambiguousLevelLow, ascensionMaxLevel, ascensionMaxLevelLow, maxLevel, maxLevelLow, milestoneLevels, milestoneLevelsLow } from '../Data/LevelData';\r\nimport { Ascension } from '../Types/consts';\r\nimport { clamp } from '../Util/Util';\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from './CustomNumberInput';\r\nimport DropdownButton from './DropdownMenu/DropdownButton';\r\n\r\nexport default function LevelSelect({ level, ascension, setBoth, useLow = false }: { level: number, ascension: Ascension, setBoth: (action: { level?: number, ascension?: Ascension }) => void, useLow?: boolean }) {\r\n  const { t } = useTranslation(\"ui\")\r\n  const ascensionMaxLevels = useLow ? ascensionMaxLevelLow : ascensionMaxLevel\r\n  const setLevel = useCallback((level: number = 1) => {\r\n    level = clamp(level, 1, useLow ? maxLevelLow : maxLevel)\r\n    const ascension = ascensionMaxLevels.findIndex(ascenML => level <= ascenML) as Ascension\r\n    setBoth({ level, ascension })\r\n  }, [setBoth, ascensionMaxLevels, useLow])\r\n  const setAscension = useCallback(() => {\r\n    const lowerAscension = ascensionMaxLevels.findIndex(ascenML => level !== 90 && level === ascenML) as Ascension\r\n    if (ascension === lowerAscension) setBoth({ ascension: (ascension + 1) as Ascension })\r\n    else setBoth({ ascension: lowerAscension })\r\n  }, [setBoth, ascensionMaxLevels, ascension, level])\r\n  return <ButtonGroup sx={{ bgcolor: t => t.palette.contentDark.main }} >\r\n    <CustomNumberInputButtonGroupWrapper >\r\n      <CustomNumberInput onChange={setLevel} value={level}\r\n        startAdornment=\"Lv. \"\r\n        inputProps={{ min: 1, max: 90, sx: { textAlign: \"center\", width: \"3em\" } }}\r\n        sx={{ height: \"100%\", pl: 2 }} />\r\n    </CustomNumberInputButtonGroupWrapper>\r\n    <Button sx={{ pl: 1, whiteSpace: 'nowrap' }} disabled={!(useLow ? ambiguousLevelLow : ambiguousLevel)(level)} onClick={setAscension}><strong>/ {ascensionMaxLevel[ascension]}</strong></Button>\r\n    <DropdownButton title={t(\"selectlevel\")} sx={{ flexGrow: 1 }}>\r\n      {[...(useLow ? milestoneLevelsLow : milestoneLevels)].map(([lv, as]) => {\r\n        const selected = lv === level && as === ascension\r\n        return <MenuItem key={`${lv}/${as}`} selected={selected} disabled={selected} onClick={() => setBoth({ level: lv, ascension: as })}>\r\n          {lv === ascensionMaxLevels[as] ? `Lv. ${lv}` : `Lv. ${lv}/${ascensionMaxLevels[as]}`}\r\n        </MenuItem>\r\n      })}\r\n    </DropdownButton>\r\n  </ButtonGroup>\r\n}\r\n","import { MenuItem } from \"@mui/material\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { allRefinement, Refinement } from \"../Types/consts\"\r\nimport DropdownButton from \"./DropdownMenu/DropdownButton\"\r\n\r\nexport default function RefinementDropdown({ refinement, setRefinement }: { refinement: Refinement, setRefinement: (r: Refinement) => void }) {\r\n  const { t } = useTranslation(\"ui\")\r\n  return <DropdownButton title={t(\"refinement\", { value: refinement })}>\r\n    {allRefinement.map(r =>\r\n      <MenuItem key={r} onClick={() => setRefinement(r)} selected={refinement === r} disabled={refinement === r}>\r\n        {t(\"refinement\", { value: r })}\r\n      </MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n","import { Button, ButtonProps, styled } from \"@mui/material\";\r\n\r\nconst DisabledButton = styled(Button)(({ theme }) => ({\r\n  \"&.Mui-disabled\": {\r\n    backgroundColor: theme.palette.primary.dark,\r\n    color: theme.palette.text.secondary,\r\n  }\r\n}))\r\n\r\nexport default function TextButton({ children, disabled, ...props }: ButtonProps) {\r\n  return <DisabledButton {...props} disabled  >\r\n    {children}\r\n  </DisabledButton>\r\n}\r\n","import { Button } from '@mui/material';\r\nimport React, { Suspense, useContext, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport ThumbSide from '../../Components/Character/ThumbSide';\r\nimport { CharacterContext } from '../../Context/CharacterContext';\r\nimport useCharSelectionCallback from '../../ReactHooks/useCharSelectionCallback';\r\n\r\nconst CharacterSelectionModal = React.lazy(() => import('../CharacterSelectionModal'))\r\n\r\nexport default function CharSelectDropdown() {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { characterSheet } = useContext(CharacterContext)\r\n  const [showModal, setshowModal] = useState(false)\r\n  const setCharacter = useCharSelectionCallback()\r\n  return <>\r\n    <Suspense fallback={false}>\r\n      <CharacterSelectionModal show={showModal} onHide={() => setshowModal(false)} onSelect={setCharacter} />\r\n    </Suspense>\r\n    <Button color=\"info\" onClick={() => setshowModal(true)} startIcon={<ThumbSide src={characterSheet?.thumbImgSide} />} >{characterSheet?.name ?? t(\"selectCharacter\")}</Button>\r\n  </>\r\n}\r\n","import { ExpandMore } from '@mui/icons-material';\r\nimport { Accordion, AccordionDetails, AccordionSummary, Box, CardContent, CardHeader, Divider, Skeleton, Typography } from '@mui/material';\r\nimport { MutableRefObject, Suspense, useCallback, useContext, useEffect, useRef, useState } from 'react';\r\nimport AmpReactionModeText from '../../Components/AmpReactionModeText';\r\nimport CardDark from '../../Components/Card/CardDark';\r\nimport CardHeaderCustom from '../../Components/Card/CardHeaderCustom';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport CloseButton from '../../Components/CloseButton';\r\nimport ColorText from '../../Components/ColoredText';\r\nimport ImgIcon from '../../Components/Image/ImgIcon';\r\nimport ModalWrapper from \"../../Components/ModalWrapper\";\r\nimport SqBadge from '../../Components/SqBadge';\r\nimport { DataContext } from '../../Context/DataContext';\r\nimport { FormulaDataContext } from '../../Context/FormulaDataContext';\r\nimport { DatabaseContext } from '../../Database/Database';\r\nimport { getDisplayHeader, getDisplaySections } from '../../Formula/DisplayUtil';\r\nimport { DisplaySub, Variant } from '../../Formula/type';\r\nimport { NodeDisplay, nodeVStr } from '../../Formula/uiData';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport { allAmpReactions, AmpReactionKey } from '../../Types/consts';\r\n\r\nexport default function FormulaModal() {\r\n  const { modalOpen } = useContext(FormulaDataContext)\r\n  const { setFormulaData } = useContext(FormulaDataContext)\r\n  const onCloseHandler = useCallback(() => setFormulaData?.(undefined, undefined), [setFormulaData])\r\n  return <ModalWrapper open={!!modalOpen} onClose={onCloseHandler}>\r\n    <CardDark>\r\n      <CardHeader title=\"Formulas & Calculations\" action={<CloseButton onClick={onCloseHandler} />} />\r\n      <CardContent sx={{ pt: 0 }}>\r\n        <CalculationDisplay />\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n\r\nfunction CalculationDisplay() {\r\n  const { data } = useContext(DataContext)\r\n  const { data: contextData } = useContext(FormulaDataContext)\r\n  const sections = getDisplaySections(contextData ?? data)\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />} >\r\n    <Box sx={{ mr: -1, mb: -1 }}>\r\n      {sections.map(([key, Nodes]) =>\r\n        <FormulaCalc key={key} displayNs={Nodes} sectionKey={key} />)}\r\n    </Box>\r\n  </Suspense>\r\n}\r\nfunction FormulaCalc({ sectionKey, displayNs }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string }) {\r\n  const { data } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const { data: contextData } = useContext(FormulaDataContext)\r\n  const header = usePromise(() => getDisplayHeader(contextData ?? data, sectionKey, database), [contextData, data, sectionKey])\r\n  if (!header) return null\r\n  if (Object.entries(displayNs).every(([_, node]) => node.isEmpty)) return null\r\n  const { title, icon, action } = header\r\n  return <CardLight sx={{ mb: 1 }}>\r\n    <CardHeaderCustom avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action && <SqBadge>{action}</SqBadge>} />\r\n    <Divider />\r\n    <CardContent>\r\n      {Object.entries(displayNs).map(([key, node]) => !node.isEmpty && <FormulaAccordian key={key} node={node} />)}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\nfunction FormulaAccordian({ node }: { node: NodeDisplay }) {\r\n  const { node: contextNode } = useContext(FormulaDataContext)\r\n  const [expanded, setExpanded] = useState(false);\r\n  const handleChange = useCallback((e: React.SyntheticEvent, isExpanded: boolean) => setExpanded(isExpanded), [])\r\n  const scrollRef = useRef<HTMLDivElement>() as MutableRefObject<HTMLDivElement | null>\r\n\r\n  useEffect(() => {\r\n    if (node === contextNode) setTimeout(() => scrollRef?.current?.scrollIntoView?.({ behavior: \"smooth\" }), 300)\r\n  }, [scrollRef, node, contextNode])\r\n\r\n  return <Accordion sx={{ bgcolor: \"contentDark.main\" }} expanded={node === contextNode || expanded} onChange={handleChange} ref={scrollRef} >\r\n    <AccordionSummary expandIcon={<ExpandMore />} >\r\n      <Typography><ColorText color={node.info.variant}>{node.info.name}</ColorText> <strong>{nodeVStr(node)}</strong></Typography>\r\n      {allAmpReactions.includes(node.info.variant as any) && <Box sx={{ display: \"inline-block\", ml: \"auto\", mr: 2 }}>\r\n        <AmpReactionModeText reaction={node.info.variant as AmpReactionKey} trigger={node.info.subVariant as Variant} />\r\n      </Box>}\r\n    </AccordionSummary>\r\n    <AccordionDetails >\r\n      {node.formulas.map((subform, i) => <Typography key={i} component=\"div\">{subform}</Typography>)}\r\n    </AccordionDetails>\r\n  </Accordion>\r\n}\r\n","import { IconButton, IconButtonProps, styled } from \"@mui/material\";\r\n\r\ninterface ExpandMoreProps extends IconButtonProps {\r\n  expand: boolean;\r\n}\r\nconst ExpandButton = styled((props: ExpandMoreProps) => {\r\n  const { expand, ...other } = props;\r\n  return <IconButton {...other} />;\r\n})(({ theme, expand }) => ({\r\n  transform: !expand ? 'rotate(0deg)' : 'rotate(180deg)',\r\n  marginLeft: 'auto',\r\n  transition: (theme as any).transitions.create('transform', {\r\n    duration: (theme as any).transitions.duration.shortest,\r\n  }),\r\n}));\r\n\r\nexport default ExpandButton","import { Replay } from \"@mui/icons-material\"\r\nimport { Button, ButtonGroup, ButtonGroupProps, styled } from \"@mui/material\"\r\nimport { ReactNode } from \"react\"\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"./CustomNumberInput\"\r\nimport TextButton from \"./TextButton\"\r\n\r\ntype StatInputInput = ButtonGroupProps & {\r\n  name: Displayable,\r\n  children?: ReactNode,\r\n  value: number,\r\n  placeholder?: string,\r\n  defaultValue?: number,\r\n  onValueChange: (newValue: number | undefined) => void,\r\n  percent?: boolean,\r\n  disabled?: boolean,\r\n  onReset?: () => void\r\n}\r\nconst FlexButtonGroup = styled(ButtonGroup)({\r\n  display: \"flex\"\r\n})\r\n\r\nexport default function StatInput({ name, children, value, placeholder, defaultValue = 0, onValueChange, percent = false, disabled = false, onReset, ...restProps }: StatInputInput) {\r\n\r\n  return <FlexButtonGroup {...restProps} >\r\n    {children}\r\n    <TextButton sx={{ px: 1 }}>\r\n      {name}\r\n    </TextButton>\r\n    <CustomNumberInputButtonGroupWrapper sx={{ flexBasis: \"10em\", flexGrow: 1 }} >\r\n      <CustomNumberInput\r\n        sx={{ px: 1 }}\r\n        inputProps={{\r\n          sx: { textAlign: \"right\" }\r\n        }}\r\n        float={percent}\r\n        placeholder={placeholder}\r\n        value={value}\r\n        onChange={onValueChange}\r\n        disabled={disabled}\r\n        endAdornment={percent ? \"%\" : undefined}\r\n      />\r\n    </CustomNumberInputButtonGroupWrapper>\r\n    <Button sx={{ flexShrink: 2 }} size=\"small\" color=\"error\" onClick={() => onReset ? onReset() : onValueChange(defaultValue)} disabled={disabled || value === defaultValue} >\r\n      <Replay />\r\n    </Button>\r\n  </FlexButtonGroup>\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank, ExpandMore, Replay } from \"@mui/icons-material\";\r\nimport { Box, Button, CardContent, Chip, Collapse, Grid, Typography } from \"@mui/material\";\r\nimport { useCallback, useContext, useState } from 'react';\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { CharacterContext } from \"../Context/CharacterContext\";\r\nimport { DataContext } from \"../Context/DataContext\";\r\nimport { uiInput as input } from \"../Formula\";\r\nimport { nodeVStr } from \"../Formula/uiData\";\r\nimport KeyMap from '../KeyMap';\r\nimport { allElementsWithPhy, ElementKeyWithPhy } from \"../Types/consts\";\r\nimport CardLight from \"./Card/CardLight\";\r\nimport ColorText from \"./ColoredText\";\r\nimport ExpandButton from \"./ExpandButton\";\r\nimport StatIcon from \"./StatIcon\";\r\nimport StatInput from \"./StatInput\";\r\n\r\nexport function EnemyExpandCard() {\r\n  const { t } = useTranslation(\"ui\")\r\n  const { characterDispatch } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n  const [expanded, setexpanded] = useState(false)\r\n  const toggle = useCallback(() => setexpanded(!expanded), [setexpanded, expanded])\r\n  const eLvlNode = data.get(input.enemy.level)\r\n  const eDefRed = data.get(input.enemy.defRed)\r\n  const eDefIgn = data.get(input.enemy.defIgn)\r\n  const onReset = useCallback(() => characterDispatch({ enemyOverride: {} }), [characterDispatch])\r\n\r\n  return <CardLight>\r\n    <CardContent sx={{ display: \"flex\", gap: 1, alignItems: \"center\", flexWrap: \"wrap\" }}>\r\n      <Chip size=\"small\" color=\"success\" label={<span>{eLvlNode.info.name} <strong>{eLvlNode.value}</strong></span>} />\r\n      {allElementsWithPhy.map(element => <Typography key={element} ><EnemyResText element={element} /></Typography>)}\r\n      <Typography>DEF Red. {nodeVStr(eDefRed)}</Typography>\r\n      <Typography>DEF Ignore {nodeVStr(eDefIgn)}</Typography>\r\n      <Box flexGrow={1} display=\"flex\" justifyContent=\"flex-end\" gap={1}>\r\n        <Button size=\"small\" color=\"error\" onClick={onReset} startIcon={<Replay />}>{t`reset`}</Button>\r\n        <ExpandButton\r\n          expand={expanded}\r\n          onClick={toggle}\r\n          aria-expanded={expanded}\r\n          aria-label=\"show more\"\r\n          size=\"small\"\r\n          sx={{ marginLeft: 0 }}\r\n        >\r\n          <ExpandMore />\r\n        </ExpandButton>\r\n      </Box>\r\n    </CardContent>\r\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n      <CardContent sx={{ pt: 0 }}>\r\n        <EnemyEditor />\r\n      </CardContent>\r\n    </Collapse>\r\n  </CardLight>\r\n}\r\n\r\nexport function EnemyResText({ element }: { element: ElementKeyWithPhy }) {\r\n  const { data } = useContext(DataContext)\r\n  const node = data.get(input.enemy[`${element}_res_`])\r\n  const immune = !isFinite(node.value)\r\n  const content = immune ? <span >{StatIcon[element]} &#8734;</span> :\r\n    <span >{StatIcon[element]} <strong>{nodeVStr(node)}</strong></span>\r\n  return <ColorText color={element}>{content}</ColorText>\r\n}\r\n\r\nexport function EnemyEditor({ bsProps = { xs: 12, md: 6 } }: { bsProps?: object }) {\r\n  const { character: { enemyOverride }, characterDispatch } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n  const defaultVal = 10\r\n\r\n  const eLvl = enemyOverride.enemyLevel ?? data.get(input.lvl).value\r\n  const eDefRed = enemyOverride.enemyDefIgn_ ?? 0\r\n  const eDefIgn = enemyOverride.enemyDefRed_ ?? 0\r\n  return <Grid container spacing={1}>\r\n    <Grid item {...bsProps}>\r\n      <Button fullWidth sx={{ height: \"100%\" }} size=\"small\" component=\"a\" color=\"warning\" href=\"https://genshin-impact.fandom.com/wiki/Resistance#Base_Enemy_Resistances\" target=\"_blank\" rel=\"noreferrer\">\r\n        To get the specific resistance values of enemies, please visit the wiki.\r\n      </Button>\r\n    </Grid>\r\n    <Grid item {...bsProps}>\r\n      <StatInput\r\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n        name={<b>{KeyMap.get(\"enemyLevel\")}</b>}\r\n        value={eLvl}\r\n        placeholder={KeyMap.getStr(\"enemyLevel\")}\r\n        defaultValue={data.get(input.lvl).value}\r\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyLevel\", value })}\r\n        onReset={() => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyLevel\", value: undefined })}\r\n      />\r\n    </Grid>\r\n    {allElementsWithPhy.map(eleKey => {\r\n      const statKey = `${eleKey}_enemyRes_`\r\n      const val = enemyOverride[statKey]\r\n      const elementImmunity = val === Number.MAX_VALUE\r\n      return <Grid item key={eleKey} {...bsProps}>\r\n        <StatInput\r\n          sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n          name={<ColorText color={eleKey}><b>{KeyMap.get(statKey)}</b></ColorText>}\r\n          value={val !== undefined ? (elementImmunity ? Infinity : val) : 10}\r\n          placeholder={elementImmunity ? \" \" : KeyMap.getStr(statKey)}\r\n          defaultValue={defaultVal}\r\n          onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey, value })}\r\n          disabled={elementImmunity}\r\n          percent\r\n        >\r\n          <Button color={eleKey} onClick={() => characterDispatch({ type: \"enemyOverride\", statKey, value: elementImmunity ? defaultVal : Number.MAX_VALUE })} startIcon={elementImmunity ? <CheckBox /> : <CheckBoxOutlineBlank />} >\r\n            Immunity\r\n          </Button>\r\n        </StatInput>\r\n      </Grid>\r\n    })}\r\n    <Grid item {...bsProps}>\r\n      <StatInput\r\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n        name={<b>{KeyMap.get(\"enemyDefIgn_\")}</b>}\r\n        value={eDefRed}\r\n        placeholder={KeyMap.getStr(\"enemyDefIgn_\")}\r\n        defaultValue={0}\r\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyDefIgn_\", value })}\r\n        percent\r\n      />\r\n    </Grid>\r\n    <Grid item {...bsProps}>\r\n      <StatInput\r\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n        name={<b>{KeyMap.get(\"enemyDefRed_\")}</b>}\r\n        value={eDefIgn}\r\n        placeholder={KeyMap.getStr(\"enemyDefRed_\")}\r\n        defaultValue={0}\r\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyDefRed_\", value })}\r\n        percent\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12}>\r\n      <small>Note: Genshin Impact halves resistance shred values below 0%. For the sake of calculations enter the RAW value and LB will do the rest. (e.g. 10% - 20% = -10%)</small>\r\n    </Grid>\r\n  </Grid>\r\n}\r\n","import { CardContent, CardHeader, Grid, ListItem, Stack, Typography } from \"@mui/material\";\r\nimport { Box } from \"@mui/system\";\r\nimport { useCallback, useContext, useMemo } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport CardDark from \"../../Components/Card/CardDark\";\r\nimport CardLight from \"../../Components/Card/CardLight\";\r\nimport CloseButton from \"../../Components/CloseButton\";\r\nimport ColorText from \"../../Components/ColoredText\";\r\nimport { EnemyExpandCard } from \"../../Components/EnemyEditor\";\r\nimport { FieldDisplayList, NodeFieldDisplay } from \"../../Components/FieldDisplay\";\r\nimport ModalWrapper from \"../../Components/ModalWrapper\";\r\nimport StatEditorList from \"../../Components/StatEditorList\";\r\nimport { CharacterContext } from \"../../Context/CharacterContext\";\r\nimport { DataContext } from \"../../Context/DataContext\";\r\nimport { allInputPremodKeys, uiInput as input } from \"../../Formula\";\r\nimport { ReadNode } from \"../../Formula/type\";\r\nimport { nodeVStr } from \"../../Formula/uiData\";\r\nimport { allEleDmgKeys, allEleResKeys } from \"../../KeyMap\";\r\n\r\nconst cols = {\r\n  xs: 1, md: 2, lg: 3\r\n}\r\n\r\nexport default function StatModal({ open, onClose }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  return <ModalWrapper open={open} onClose={onClose}>\r\n    <CardDark>\r\n      <CardHeader title={t`addStats.title`} action={<CloseButton onClick={onClose} />} />\r\n      <CardContent sx={{ pt: 0 }}>\r\n        <Stack spacing={1}>\r\n          <BonusStatsEditor />\r\n          <EnemyExpandCard />\r\n          <MainStatsCards />\r\n        </Stack>\r\n      </CardContent></CardDark>\r\n  </ModalWrapper>\r\n}\r\nconst keys = [...allInputPremodKeys]\r\nconst wrapperFunc = (e: JSX.Element) => <Grid item xs={1}>{e}</Grid>\r\nfunction BonusStatsEditor() {\r\n  const { character: { bonusStats }, characterDispatch } = useContext(CharacterContext)\r\n  const setFilter = useCallback((bonusStats) => characterDispatch({ bonusStats }), [characterDispatch],)\r\n  return <CardLight>\r\n    <CardContent sx={{ display: \"flex\" }}>\r\n      <Grid container columns={cols} sx={{ pt: 1 }} spacing={1}>\r\n        <StatEditorList statKeys={keys} statFilters={bonusStats} setStatFilters={setFilter} wrapperFunc={wrapperFunc} />\r\n      </Grid>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n\r\nconst mainBaseKeys = [\"hp\", \"atk\", \"def\"] as const\r\nconst mainSubKeys = [\"eleMas\", \"critRate_\", \"critDMG_\", \"enerRech_\", \"heal_\"] as const\r\nconst mainReadNodes = [...mainBaseKeys, ...mainSubKeys].map(k => input.total[k])\r\nconst mainEditKeys = [\"atk_\", \"atk\", \"hp_\", \"hp\", \"def_\", \"def\", ...mainSubKeys] as const\r\n\r\nconst otherStatKeys = [\r\n  ...allEleDmgKeys,\r\n  ...allEleResKeys,\r\n  \"stamina\", \"incHeal_\", \"shield_\", \"cdRed_\"\r\n] as const\r\n\r\nconst miscStatkeys = allInputPremodKeys.filter(k => !mainEditKeys.includes(k as any) && !otherStatKeys.includes(k as any))\r\n\r\n\r\nfunction StatDisplayContent({ nodes, extra }: { nodes: ReadNode<number>[], extra?: Displayable }) {\r\n  const { data, oldData } = useContext(DataContext)\r\n  return <FieldDisplayList >\r\n    {nodes.map(rn => <NodeFieldDisplay component={ListItem} key={JSON.stringify(rn.info)} node={data.get(rn)} oldValue={oldData?.get(rn)?.value} />)}\r\n    {extra}\r\n  </FieldDisplayList>\r\n}\r\n\r\nfunction MainStatsCards() {\r\n  const { characterSheet } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n  const specialNode = data.get(input.special)\r\n  const charEle = characterSheet.elementKey\r\n  const isMelee = characterSheet.isMelee()\r\n\r\n  const otherStatReadNodes = useMemo(() => {\r\n    const nodes = otherStatKeys.filter(k => {\r\n      if (k.includes(charEle)) return false\r\n      if (isMelee && k.includes(\"physical\")) return true\r\n      return true\r\n    }).map(k => input.total[k])\r\n\r\n    return nodes.filter(n => !!data.get(n).value)\r\n  }, [data, charEle, isMelee])\r\n\r\n\r\n  const miscStatReadNodes = useMemo(() => miscStatkeys.map(k => input.total[k]).filter(n => data.get(n).value), [data])\r\n\r\n  return <CardLight><CardContent>\r\n    <Grid container columns={cols} spacing={1}>\r\n      <Grid item xs={1}>\r\n        <StatDisplayCard title=\"Main Stats\">\r\n          <StatDisplayContent nodes={mainReadNodes}\r\n            extra={specialNode && <ListItem sx={{ display: \"flex\", justifyContent: \"space-between\" }}>\r\n              <span><b>Special:</b> <ColorText color={specialNode.info.variant}>{specialNode.info.icon} {specialNode.info.name}</ColorText></span>\r\n              <span >{nodeVStr(specialNode)}</span>\r\n            </ListItem>}\r\n          />\r\n        </StatDisplayCard>\r\n      </Grid>\r\n      <Grid item xs={1}>\r\n        <StatDisplayCard title=\"Other Stats\">\r\n          <StatDisplayContent nodes={otherStatReadNodes} />\r\n        </StatDisplayCard>\r\n      </Grid>\r\n      {!!miscStatReadNodes.length && <Grid item xs={1}>\r\n        <StatDisplayCard title=\"Misc Stats\">\r\n          <StatDisplayContent nodes={miscStatReadNodes} />\r\n        </StatDisplayCard>\r\n      </Grid>}\r\n    </Grid>\r\n  </CardContent></CardLight>\r\n}\r\nfunction StatDisplayCard({ title, children }) {\r\n  return <CardDark>\r\n    <CardContent sx={{ py: 1 }}>\r\n      <Box display=\"flex\" justifyContent=\"space-between\">\r\n        <Typography variant=\"subtitle1\">{title}</Typography>\r\n      </Box>\r\n    </CardContent>\r\n    {children}\r\n  </CardDark>\r\n}\r\n","import { createContext } from \"react\";\r\n\r\nexport const OptimizationTargetContext = createContext(undefined as string[] | undefined)\r\n","import { ArtSetExclusion } from \"../../../../Database/DataManagers/BuildSettingData\";\r\nimport { forEachNodes, mapFormulas } from \"../../../../Formula/internal\";\r\nimport { allOperations, constantFold, OptNode } from \"../../../../Formula/optimization\";\r\nimport { ConstantNode } from \"../../../../Formula/type\";\r\nimport { constant, customRead, max, min, threshold } from \"../../../../Formula/utils\";\r\nimport { allSlotKeys, ArtifactSetKey, SlotKey } from \"../../../../Types/consts\";\r\nimport { assertUnreachable, objectKeyMap, objectMap, range } from \"../../../../Util/Util\";\r\n\r\ntype MicropassOperation = \"reaffine\" | \"pruneArtRange\" | \"pruneNodeRange\" | \"pruneOrder\"\r\nexport function pruneAll(nodes: OptNode[], minimum: number[], arts: ArtifactsBySlot, numTop: number, exclusion: ArtSetExclusion, forced: Dict<MicropassOperation, boolean>): { nodes: OptNode[], arts: ArtifactsBySlot } {\r\n  let should = forced\r\n  /** If `key` makes progress, all operations in `value` should be performed */\r\n  const deps: StrictDict<MicropassOperation, Dict<MicropassOperation, true>> = {\r\n    pruneOrder: { pruneNodeRange: true },\r\n    pruneArtRange: { pruneNodeRange: true },\r\n    pruneNodeRange: { reaffine: true },\r\n    reaffine: { pruneOrder: true, pruneArtRange: true, pruneNodeRange: true }\r\n  }\r\n  let count = 0\r\n  while (Object.values(should).some(x => x) && count++ < 20) {\r\n    if (should.pruneOrder) {\r\n      delete should.pruneOrder\r\n      const newArts = pruneOrder(arts, numTop, exclusion)\r\n      if (arts !== newArts) {\r\n        arts = newArts\r\n        should = { ...should, ...deps.pruneOrder }\r\n      }\r\n    }\r\n    if (should.pruneArtRange) {\r\n      delete should.pruneArtRange\r\n      const newArts = pruneArtRange(nodes, arts, minimum)\r\n      if (arts !== newArts) {\r\n        arts = newArts\r\n        should = { ...should, ...deps.pruneArtRange }\r\n      }\r\n    }\r\n    if (should.pruneNodeRange) {\r\n      delete should.pruneNodeRange\r\n      const newNodes = pruneNodeRange(nodes, arts)\r\n      if (nodes !== newNodes) {\r\n        nodes = newNodes\r\n        should = { ...should, ...deps.pruneNodeRange }\r\n      }\r\n    }\r\n    if (should.reaffine) {\r\n      delete should.reaffine\r\n      const { nodes: newNodes, arts: newArts } = reaffine(nodes, arts)\r\n      if (nodes !== newNodes || arts !== newArts) {\r\n        nodes = newNodes\r\n        arts = newArts\r\n        should = { ...should, ...deps.reaffine }\r\n      }\r\n    }\r\n  }\r\n  return { nodes, arts }\r\n}\r\n\r\nexport function pruneExclusion(nodes: OptNode[], exclusion: ArtSetExclusion): OptNode[] {\r\n  const maxValues: Dict<keyof typeof exclusion, number> = {}\r\n  for (const [key, e] of Object.entries(exclusion)) {\r\n    if (!e.includes(4)) continue\r\n    maxValues[key] = e.includes(2) ? 1 : 3\r\n  }\r\n  return mapFormulas(nodes, f => f, f => {\r\n    if (f.operation !== \"threshold\") return f\r\n\r\n    const [v, t, pass, fail] = f.operands\r\n    if (v.operation === \"read\" && t.operation === \"const\") {\r\n      const key = v.path[v.path.length - 1], thres = t.value\r\n      if (key in maxValues) {\r\n        const max: number = maxValues[key]\r\n        if (max < thres) return fail\r\n        if (thres === 2 && exclusion[key]!.includes(2))\r\n          return threshold(v, 4, pass, fail)\r\n      }\r\n    }\r\n    return f\r\n  })\r\n}\r\n\r\nfunction reaffine(nodes: OptNode[], arts: ArtifactsBySlot, forceRename: boolean = false): { nodes: OptNode[], arts: ArtifactsBySlot } {\r\n  const affineNodes = new Set<OptNode>(), topLevelAffine = new Set<OptNode>()\r\n\r\n  function visit(node: OptNode, isAffine: boolean) {\r\n    if (isAffine) affineNodes.add(node)\r\n    else node.operands.forEach(op => affineNodes.has(op) && topLevelAffine.add(op))\r\n  }\r\n\r\n  const dynKeys = new Set<string>()\r\n\r\n  forEachNodes(nodes, _ => { }, f => {\r\n    const { operation } = f\r\n    switch (operation) {\r\n      case \"read\":\r\n        dynKeys.add(f.path[1])\r\n        visit(f, true)\r\n        break\r\n      case \"add\": visit(f, f.operands.every(op => affineNodes.has(op))); break\r\n      case \"mul\": {\r\n        const nonConst = f.operands.filter(op => op.operation !== \"const\")\r\n        visit(f, nonConst.length === 0 || (nonConst.length === 1 && affineNodes.has(nonConst[0])))\r\n        break\r\n      }\r\n      case \"const\": visit(f, true); break\r\n      case \"res\": case \"threshold\": case \"sum_frac\":\r\n      case \"max\": case \"min\": visit(f, false); break\r\n      default: assertUnreachable(operation)\r\n    }\r\n  })\r\n\r\n  if ([...topLevelAffine].every(({ operation }) => operation === \"read\" || operation === \"const\") &&\r\n    Object.keys(arts.base).length === dynKeys.size)\r\n    return { nodes, arts }\r\n\r\n  let current = -1\r\n  function nextDynKey(): string {\r\n    while (dynKeys.has(`${++current}`));\r\n    return `${current}`\r\n  }\r\n\r\n  nodes.forEach(node => affineNodes.has(node) && topLevelAffine.add(node))\r\n  const affine = [...topLevelAffine].filter(f => f.operation !== \"const\")\r\n  const affineMap = new Map(affine.map(node => [node,\r\n    !forceRename && node.operation === \"read\" && node.path[0] === \"dyn\"\r\n      ? node\r\n      : { ...customRead([\"dyn\", `${nextDynKey()}`]), accu: \"add\" as const }]))\r\n  nodes = mapFormulas(nodes, f => affineMap.get(f) ?? f, f => f)\r\n\r\n  function reaffineArt(stat: DynStat): DynStat {\r\n    const values = constantFold([...affineMap.keys()], {\r\n      dyn: objectMap(stat, (value) => constant(value))\r\n    } as any, _ => true)\r\n    return Object.fromEntries([...affineMap.values()].map((v, i) => [v.path[1], (values[i] as ConstantNode<number>).value]))\r\n  }\r\n  const result = {\r\n    nodes, arts: {\r\n      base: reaffineArt(arts.base),\r\n      values: objectKeyMap(allSlotKeys, slot =>\r\n        arts.values[slot].map(({ id, set, values }) => ({ id, set, values: reaffineArt(values) })))\r\n    }\r\n  }\r\n  const offsets = Object.entries(reaffineArt({}))\r\n  for (const arts of Object.values(result.arts.values))\r\n    for (const { values } of arts)\r\n      for (const [key, baseValue] of offsets)\r\n        values[key] -= baseValue\r\n  return result\r\n}\r\n/** Remove artifacts that cannot be in top `numTop` builds */\r\nfunction pruneOrder(arts: ArtifactsBySlot, numTop: number, exclusion: ArtSetExclusion): ArtifactsBySlot {\r\n  let progress = false\r\n  const noRainbow = !exclusion.rainbow?.length\r\n  const noSwitchIn = new Set(Object.entries(exclusion).filter(([_, v]) => v.length).map(([k]) => k) as ArtifactSetKey[])\r\n  const noSwitchOut = new Set(Object.entries(exclusion).filter(([_, v]) => v.includes(2) && !v.includes(4)).map(([k]) => k) as ArtifactSetKey[])\r\n  const values = objectKeyMap(allSlotKeys, slot => {\r\n    const list = arts.values[slot]\r\n    const newList = list.filter(art => {\r\n      let count = 0\r\n      return list.every(other => {\r\n        const greaterEqual = Object.entries(other.values).every(([k, o]) => o >= art.values[k])\r\n        const greater = Object.entries(other.values).some(([k, o]) => o > art.values[k])\r\n        if (greaterEqual && (greater || other.id > art.id) &&\r\n          ((noRainbow && !noSwitchIn.has(other.set!) && !noSwitchOut.has(art.set!)) || art.set === other.set))\r\n          count++\r\n        return count < numTop\r\n      })\r\n    })\r\n    if (newList.length !== list.length) progress = true\r\n    return newList\r\n  })\r\n  return progress ? { base: arts.base, values } : arts\r\n}\r\n/** Remove artifacts that cannot reach `minimum` in any build */\r\nfunction pruneArtRange(nodes: OptNode[], arts: ArtifactsBySlot, minimum: number[]): ArtifactsBySlot {\r\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\r\n  const wrap = { arts }\r\n  while (true) {\r\n    const artRanges = objectKeyMap(allSlotKeys, slot => computeArtRange(wrap.arts.values[slot]))\r\n    const otherArtRanges = objectKeyMap(allSlotKeys, key =>\r\n      addArtRange(Object.entries(artRanges).map(a => a[0] === key ? baseRange : a[1]).filter(x => x)))\r\n\r\n    let progress = false\r\n    const values = objectKeyMap(allSlotKeys, slot => {\r\n      const result = wrap.arts.values[slot].filter(art => {\r\n        const read = addArtRange([computeArtRange([art]), otherArtRanges[slot]])\r\n        const newRange = computeNodeRange(nodes, read)\r\n        return nodes.every((node, i) => newRange.get(node)!.max >= (minimum[i] ?? -Infinity))\r\n      })\r\n      if (result.length !== wrap.arts.values[slot].length)\r\n        progress = true\r\n      return result\r\n    })\r\n    if (!progress) break\r\n    wrap.arts = { base: wrap.arts.base, values }\r\n  }\r\n  return wrap.arts\r\n}\r\nfunction pruneNodeRange(nodes: OptNode[], arts: ArtifactsBySlot): OptNode[] {\r\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\r\n  const reads = addArtRange([baseRange, ...Object.values(arts.values).map(values => computeArtRange(values))])\r\n  const nodeRange = computeNodeRange(nodes, reads)\r\n\r\n  return mapFormulas(nodes, f => {\r\n    {\r\n      const { min, max } = nodeRange.get(f)!\r\n      if (min === max) return constant(min)\r\n    }\r\n    const { operation } = f\r\n    const operandRanges = f.operands.map(x => nodeRange.get(x)!)\r\n    switch (operation) {\r\n      case \"threshold\": {\r\n        const [value, threshold, pass, fail] = operandRanges\r\n        if (value.min >= threshold.max) return f.operands[2]\r\n        else if (value.max < threshold.min) return f.operands[3]\r\n        if (pass.max === pass.min &&\r\n          fail.max === fail.min &&\r\n          pass.min === fail.min && isFinite(pass.min))\r\n          return constant(pass.max)\r\n        break\r\n      }\r\n      case \"min\": {\r\n        const newOperands = f.operands.filter((_, i) => {\r\n          const op1 = operandRanges[i]\r\n          return operandRanges.every((op2, j) => op1.min <= op2.max)\r\n        })\r\n        if (newOperands.length < operandRanges.length) return min(...newOperands)\r\n        break\r\n      }\r\n      case \"max\": {\r\n        const newOperands = f.operands.filter((_, i) => {\r\n          const op1 = operandRanges[i]\r\n          return operandRanges.every(op2 => op1.max >= op2.min)\r\n        })\r\n        if (newOperands.length < operandRanges.length) return max(...newOperands)\r\n        break\r\n      }\r\n    }\r\n    return f\r\n  }, f => f)\r\n}\r\nfunction addArtRange(ranges: DynMinMax[]): DynMinMax {\r\n  const result: DynMinMax = {}\r\n  ranges.forEach(range => {\r\n    Object.entries(range).forEach(([key, value]) => {\r\n      if (result[key]) {\r\n        result[key].min += value.min\r\n        result[key].max += value.max\r\n      } else result[key] = { ...value }\r\n    })\r\n  })\r\n  return result\r\n}\r\nfunction computeArtRange(arts: ArtifactBuildData[]): DynMinMax {\r\n  const result: DynMinMax = {}\r\n  if (arts.length) {\r\n    Object.keys(arts[0].values)\r\n      .filter(key => arts.every(art => art.values[key]))\r\n      .forEach(key => result[key] = { min: arts[0].values[key], max: arts[0].values[key] })\r\n    arts.forEach(({ values }) => {\r\n      for (const [key, value] of Object.entries(values)) {\r\n        if (!result[key]) result[key] = { min: 0, max: value }\r\n        else {\r\n          if (result[key].max < value) result[key].max = value\r\n          if (result[key].min > value) result[key].min = value\r\n        }\r\n      }\r\n    })\r\n  }\r\n  return result\r\n}\r\nexport function computeFullArtRange(arts: ArtifactsBySlot): DynMinMax {\r\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\r\n  return addArtRange([baseRange, ...Object.values(arts.values).map(values => computeArtRange(values))])\r\n}\r\nexport function computeNodeRange(nodes: OptNode[], reads: DynMinMax): Map<OptNode, MinMax> {\r\n  const range = new Map<OptNode, MinMax>()\r\n\r\n  forEachNodes(nodes, _ => { }, f => {\r\n    const { operation } = f\r\n    const operands = f.operands.map(op => range.get(op)!)\r\n    let current: MinMax\r\n    switch (operation) {\r\n      case \"read\":\r\n        if (f.path[0] !== \"dyn\")\r\n          throw new Error(`Found non-dyn path ${f.path} while computing range`)\r\n        current = reads[f.path[1]] ?? { min: 0, max: 0 }\r\n        break\r\n      case \"const\": current = computeMinMax([f.value]); break\r\n      case \"add\": case \"min\": case \"max\":\r\n        current = {\r\n          min: allOperations[operation](operands.map(x => x.min)),\r\n          max: allOperations[operation](operands.map(x => x.max)),\r\n        }; break\r\n      case \"res\": current = {\r\n        min: allOperations[operation]([operands[0].max]),\r\n        max: allOperations[operation]([operands[0].min]),\r\n      }; break\r\n      case \"mul\": current = operands.reduce((accu, current) => computeMinMax([\r\n        accu.min * current.min, accu.min * current.max,\r\n        accu.max * current.min, accu.max * current.max,\r\n      ])); break\r\n      case \"threshold\":\r\n        if (operands[0].min >= operands[1].max) current = operands[2]\r\n        else if (operands[0].max < operands[1].min) current = operands[3]\r\n        else current = computeMinMax([], [operands[2], operands[3]])\r\n        break\r\n      case \"sum_frac\": {\r\n        const [x, c] = operands, sum = { min: x.min + c.min, max: x.max + c.max }\r\n        if (sum.min <= 0 && sum.max >= 0)\r\n          current = (x.min <= 0 && x.max >= 0) ? { min: NaN, max: NaN } : { min: -Infinity, max: Infinity }\r\n        else\r\n          // TODO: Check this\r\n          current = computeMinMax([\r\n            x.min / sum.min, x.min / sum.max,\r\n            x.max / sum.min, x.max / sum.max\r\n          ])\r\n        break\r\n      }\r\n      default: assertUnreachable(operation)\r\n    }\r\n    range.set(f, current)\r\n  })\r\n  return range\r\n}\r\nfunction computeMinMax(values: readonly number[], minMaxes: readonly MinMax[] = []): MinMax {\r\n  const max = Math.max(...values, ...minMaxes.map(x => x.max))\r\n  const min = Math.min(...values, ...minMaxes.map(x => x.min))\r\n  return { min, max }\r\n}\r\n\r\nexport function filterArts(arts: ArtifactsBySlot, filters: RequestFilter): ArtifactsBySlot {\r\n  return {\r\n    base: arts.base,\r\n    values: objectKeyMap(allSlotKeys, slot => {\r\n      const filter = filters[slot]\r\n      switch (filter.kind) {\r\n        case \"id\": return arts.values[slot].filter(art => filter.ids.has(art.id))\r\n        case \"exclude\": return arts.values[slot].filter(art => !filter.sets.has(art.set!))\r\n        case \"required\": return arts.values[slot].filter(art => filter.sets.has(art.set!))\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nexport function mergeBuilds(builds: Build[][], maxNum: number): Build[] {\r\n  return builds.flatMap(x => x).sort((a, b) => b.value - a.value).slice(0, maxNum)\r\n}\r\nexport function mergePlot(plots: PlotData[]): PlotData {\r\n  let scale = 0.01, reductionScaling = 2, maxCount = 1500\r\n  let keys = new Set(plots.flatMap(x => Object.values(x).map(v => Math.round(v.plot! / scale))))\r\n  while (keys.size > maxCount) {\r\n    scale *= reductionScaling\r\n    keys = new Set([...keys].map(key => Math.round(key / reductionScaling)))\r\n  }\r\n  const result: PlotData = {}\r\n  for (const plot of plots)\r\n    for (const build of Object.values(plot)) {\r\n      const x = Math.round(build.plot! / scale) * scale\r\n      if (!result[x] || result[x]!.value < build.value)\r\n        result[x] = build\r\n    }\r\n  return result\r\n}\r\n\r\nexport function countBuilds(arts: ArtifactsBySlot): number {\r\n  return allSlotKeys.reduce((_count, slot) => _count * arts.values[slot].length, 1)\r\n}\r\n\r\n\r\nexport function* filterFeasiblePerm(filters: Iterable<RequestFilter>, _artSets: ArtifactsBySlot): Iterable<RequestFilter> {\r\n  const artSets = objectMap(_artSets.values, values => new Set(values.map(v => v.set)))\r\n  filter_loop: for (const filter of filters) {\r\n    for (const [slot, f] of Object.entries(filter)) {\r\n      const available = artSets[slot]!\r\n      switch (f.kind) {\r\n        case \"required\": if ([...f.sets].every(s => !available.has(s))) continue filter_loop; break\r\n        case \"exclude\": if ([...available].every(s => f.sets.has(s!))) continue filter_loop; break\r\n        case \"id\": break\r\n      }\r\n    }\r\n    yield filter\r\n  }\r\n}\r\nexport function exclusionToAllowed(exclusion: number[] | undefined): Set<number> {\r\n  return new Set(exclusion?.includes(2)\r\n    ? exclusion.includes(4) ? [0, 1] : [0, 1, 4, 5]\r\n    : exclusion?.includes(4) ? [0, 1, 2, 3] : [0, 1, 2, 3, 4, 5])\r\n}\r\n/** A *disjoint* set of `RequestFilter` satisfying the exclusion rules */\r\nexport function* artSetPerm(exclusion: ArtSetExclusion, _artSets: ArtifactSetKey[]): Iterable<RequestFilter> {\r\n  /**\r\n   * This generation algorithm is separated into two parts:\r\n   * - \"Shape\" generation\r\n   *   - It first generates all build \"shapes\", e.g., AABBC, ABBCD\r\n   *   - It then filters the generated shapes according to the rainbow exclusion, e.g., removes ABBCD if excluding 3 rainbows\r\n   *   - It then merges the remaining shapes into wildcards, e.g. AABAA + AABAB + AABAC => AABA*\r\n   * - Shape filling\r\n   *   - From the given shapes, it tries to fill in all non-rainbow slots, e.g., slots A and B of AABBC, with actual artifacts\r\n   *   - It then fills the rainbow slots, e.g., slot C of AABBC while ensuring the exclusion rule of each sets\r\n   */\r\n  const artSets = [...new Set(_artSets)], allowedRainbows = exclusionToAllowed(exclusion.rainbow)\r\n  let shapes: number[][] = []\r\n  function populateShapes(current: number[], list: Set<number>, rainbows: number[]) {\r\n    if (current.length === 5) {\r\n      if (allowedRainbows.has(rainbows.length))\r\n        shapes.push(current)\r\n      return\r\n    }\r\n    for (const i of list) populateShapes([...current, i], list, rainbows.filter(j => j !== i))\r\n    populateShapes([...current, current.length], new Set([...list, current.length]), [...rainbows, current.length])\r\n  }\r\n  populateShapes([0], new Set([0]), [0])\r\n  function indexOfShape(shape: number[], replacing: number) {\r\n    if (range(replacing + 1, 4).some(i => shape[i] !== 5))\r\n      return undefined\r\n    shape = [...shape]\r\n    shape[replacing] = 5\r\n    return shape.reduce((a, b) => a * 6 + b, 0)\r\n  }\r\n  for (let replacing = 4; replacing >= 0; replacing--) {\r\n    const required: Map<number, number> = new Map()\r\n    for (const shape of shapes) {\r\n      const id = indexOfShape(shape, replacing)\r\n      if (id === undefined) continue\r\n      required.set(id, (required.get(id) ?? new Set(shape.slice(0, replacing)).size + 1) - 1)\r\n    }\r\n    for (const [id, remaining] of required.entries()) {\r\n      if (remaining === 0) {\r\n        const shape = [...shapes.find(shape => indexOfShape(shape, replacing) === id)!]\r\n        shape[replacing] = 5\r\n        shapes = shapes.filter(shape => indexOfShape(shape, replacing) !== id)\r\n        shapes.push(shape)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Shapes are now calculated and merged, proceed to fill in the sets\r\n\r\n  const noFilter = { kind: \"exclude\" as const, sets: new Set<ArtifactSetKey>() }\r\n  const result: RequestFilter = objectKeyMap(allSlotKeys, _ => noFilter)\r\n\r\n  const counts = { ...objectMap(exclusion, _ => 0), ...objectKeyMap(artSets, _ => 0) }\r\n  const allowedCounts = objectMap(exclusion, exclusionToAllowed)\r\n\r\n  function* check(shape: number[]) {\r\n    const used: Set<ArtifactSetKey> = new Set()\r\n    let groupped: number[][] = [], rainbows: number[] = []\r\n    for (const i of shape) {\r\n      groupped.push([])\r\n      if (i === 5) rainbows.push(groupped.length - 1)\r\n      else groupped[i].push(groupped.length - 1)\r\n    }\r\n    groupped = groupped.filter(v => v.length).sort((a, b) => b.length - a.length)\r\n    let usableRainbows = rainbows.length\r\n\r\n    // Inception.. because js doesn't like functions inside a for-loop\r\n    function* check(i: number) {\r\n      if (i === groupped.length)\r\n        return yield* check_free(0)\r\n\r\n      for (const set of artSets) {\r\n        if (used.has(set)) continue\r\n        const length = groupped[i].length, allowedSet = allowedCounts[set]\r\n        let requiredRainbows = 0\r\n\r\n        if (allowedSet && !allowedSet.has(length)) {\r\n          // Look ahead and see if we have enough rainbows to fill to the next `allowedSet` if we use the current set\r\n          requiredRainbows = (range(length + 1, 5).find(l => allowedSet.has(l)) ?? 6) - length\r\n          if (requiredRainbows > usableRainbows) continue // Not enough rainbows. Next..\r\n        }\r\n\r\n        used.add(set)\r\n        counts[set] = groupped[i].length\r\n        groupped[i].forEach(j => result[allSlotKeys[j]] = { kind: \"required\", sets: new Set([set]) })\r\n        usableRainbows -= requiredRainbows\r\n\r\n        yield* check(i + 1)\r\n\r\n        usableRainbows += requiredRainbows\r\n        counts[set] = 0\r\n        used.delete(set)\r\n      }\r\n    }\r\n    // We separate filling rainbow slots from groupped slots because it has an entirely\r\n    // different set of rules regarding what can be filled and what states to be kept.\r\n    function* check_free(i: number) {\r\n      const remaining = rainbows.length - i, isolated: ArtifactSetKey[] = [], missing: ArtifactSetKey[] = [], rejected: ArtifactSetKey[] = []\r\n      let required = 0\r\n      for (const set of artSets) {\r\n        const allowedSet = allowedCounts[set], count = counts[set]\r\n        if (!allowedSet) continue\r\n        if (range(1, remaining).every(j => !allowedSet.has(count + j))) rejected.push(set)\r\n        else if (!allowedSet.has(count)) {\r\n          required += [...allowedSet].find(x => x > count)! - count\r\n          missing.push(set)\r\n        }\r\n        else if (range(0, remaining).some(j => !allowedSet.has(count + j))) isolated.push(set)\r\n      }\r\n      if (required > remaining) return\r\n      if (i === rainbows.length) {\r\n        yield { ...result }\r\n        return\r\n      }\r\n      if (required === remaining) {\r\n        for (const set of missing) {\r\n          counts[set]++\r\n          result[allSlotKeys[rainbows[i]]] = { kind: \"required\", sets: new Set([set]) }\r\n          yield* check_free(i + 1)\r\n          counts[set]--\r\n        }\r\n        return\r\n      }\r\n      for (const set of [...isolated, ...missing]) {\r\n        counts[set]++\r\n        result[allSlotKeys[rainbows[i]]] = { kind: \"required\", sets: new Set([set]) }\r\n        yield* check_free(i + 1)\r\n        counts[set]--\r\n      }\r\n      result[allSlotKeys[rainbows[i]]] = { kind: \"exclude\", sets: new Set([...missing, ...rejected, ...isolated]) }\r\n      yield* check_free(i + 1)\r\n    }\r\n    yield* check(0)\r\n  }\r\n  for (const shape of shapes) yield* check(shape)\r\n}\r\n\r\nexport type RequestFilter = StrictDict<SlotKey,\r\n  { kind: \"required\", sets: Set<ArtifactSetKey> } |\r\n  { kind: \"exclude\", sets: Set<ArtifactSetKey> } |\r\n  { kind: \"id\", ids: Set<string> }\r\n>\r\n\r\nexport type DynStat = { [key in string]: number }\r\nexport type ArtifactBuildData = {\r\n  id: string\r\n  set?: ArtifactSetKey\r\n  values: DynStat\r\n}\r\nexport type ArtifactsBySlot = { base: DynStat, values: StrictDict<SlotKey, ArtifactBuildData[]> }\r\n\r\nexport type PlotData = Dict<number, Build>\r\nexport interface Build {\r\n  value: number\r\n  plot?: number\r\n  artifactIds: string[]\r\n}\r\n\r\nexport type DynMinMax = { [key in string]: MinMax }\r\nexport type MinMax = { min: number, max: number }\r\n","import { Box } from \"@mui/material\"\r\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\"\r\nimport usePromise from \"../../ReactHooks/usePromise\"\r\nimport { ArtifactSetKey, SetNum } from \"../../Types/consts\"\r\nimport DocumentDisplay from \"../DocumentDisplay\"\r\n\r\ntype Data = {\r\n  setKey: ArtifactSetKey,\r\n  setNumKey: SetNum,\r\n  hideHeader?: boolean,\r\n  conditionalsOnly?: boolean\r\n}\r\n\r\nexport default function SetEffectDisplay({ setKey, setNumKey, hideHeader = false, conditionalsOnly = false }: Data) {\r\n  const sheet = usePromise(() => ArtifactSheet.get(setKey), [setKey])\r\n  if (!sheet) return null\r\n\r\n  const document = conditionalsOnly ? sheet.setEffectDocument(setNumKey)?.filter(section => \"states\" in section) : sheet.setEffectDocument(setNumKey)\r\n  return <Box display=\"flex\" flexDirection=\"column\">\r\n    {document ? <DocumentDisplay sections={document} hideHeader={hideHeader} /> : null}\r\n  </Box>\r\n}\r\n","import { useCallback, useContext, useEffect, useState } from \"react\";\r\nimport { DatabaseContext } from \"../../../../Database/Database\";\r\nimport { BuildSetting, BuildSettingReducerAction } from \"../../../../Database/DataManagers/BuildSettingData\";\r\nimport { CharacterKey } from \"../../../../Types/consts\";\r\n\r\nexport default function useBuildSetting(characterKey: CharacterKey) {\r\n  const { database } = useContext(DatabaseContext)\r\n  const [buildSetting, setBuildSetting] = useState(() => database.buildSettings.get(characterKey))\r\n  useEffect(() => setBuildSetting(database.buildSettings.get(characterKey)), [database, characterKey])\r\n  useEffect(() =>\r\n    database.buildSettings.follow(characterKey, (k, r, v) => r === \"update\" && setBuildSetting(v)),\r\n    [characterKey, setBuildSetting, database])\r\n  const buildSettingDispatch = useCallback((action: BuildSettingReducerAction) => characterKey && database.buildSettings.set(characterKey, action), [characterKey, database],)\r\n\r\n  return { buildSetting: buildSetting as BuildSetting, buildSettingDispatch }\r\n}\r\n","import { faBan, faChartLine } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { CheckBox, CheckBoxOutlineBlank, Replay, Settings } from '@mui/icons-material';\r\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, Stack, Typography } from '@mui/material';\r\nimport { useCallback, useContext, useEffect, useMemo, useState } from 'react';\r\nimport { Trans, useTranslation } from 'react-i18next';\r\nimport SetEffectDisplay from '../../../../../Components/Artifact/SetEffectDisplay';\r\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport CloseButton from '../../../../../Components/CloseButton';\r\nimport ColorText from '../../../../../Components/ColoredText';\r\nimport InfoTooltip from '../../../../../Components/InfoTooltip';\r\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\r\nimport SqBadge from '../../../../../Components/SqBadge';\r\nimport { StarsDisplay } from '../../../../../Components/StarDisplay';\r\nimport { Translate } from '../../../../../Components/Translate';\r\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\r\nimport { DataContext, dataContextObj } from '../../../../../Context/DataContext';\r\nimport { ArtifactSheet } from '../../../../../Data/Artifacts/ArtifactSheet';\r\nimport { DatabaseContext } from '../../../../../Database/Database';\r\nimport { UIData } from '../../../../../Formula/uiData';\r\nimport { constant } from '../../../../../Formula/utils';\r\nimport useForceUpdate from '../../../../../ReactHooks/useForceUpdate';\r\nimport usePromise from '../../../../../ReactHooks/usePromise';\r\nimport { allArtifactSets, allSlotKeys, ArtifactSetKey, SetNum, SlotKey } from '../../../../../Types/consts';\r\nimport { deepClone, objectKeyMap } from '../../../../../Util/Util';\r\nimport useBuildSetting from '../useBuildSetting';\r\n\r\nexport default function ArtifactSetConfig({ disabled }: { disabled?: boolean, }) {\r\n  const { t } = useTranslation([\"page_character_optimize\", \"sheet\"])\r\n  const dataContext = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const { character: { key: characterKey, conditional }, characterDispatch } = useContext(CharacterContext)\r\n  const { buildSetting: { artSetExclusion }, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const [open, setOpen] = useState(false)\r\n  const onOpen = useCallback(() => setOpen(true), [setOpen])\r\n  const onClose = useCallback(() => setOpen(false), [setOpen])\r\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\r\n\r\n  const [dbDirty, forceUpdate] = useForceUpdate()\r\n  useEffect(() => database.arts.followAny(forceUpdate), [database, forceUpdate])\r\n\r\n  const artKeys = useMemo(() => artifactSheets && Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets))\r\n    .reverse()\r\n    .flatMap(([, sets]) => sets)\r\n    .filter(key => !key.includes(\"Prayers\")),\r\n  [artifactSheets])\r\n  const artSlotCount = useMemo(() => {\r\n    const artSlotCount: Dict<ArtifactSetKey, Record<SlotKey, number>> = artKeys\r\n      ? Object.fromEntries(artKeys.map(k => [k, Object.fromEntries(allSlotKeys.map(sk => [sk, 0]))]))\r\n      : {}\r\n    database.arts.values.map(art => artSlotCount[art.setKey] && artSlotCount[art.setKey]![art.slotKey]++)\r\n    return dbDirty && artSlotCount\r\n  }, [dbDirty, database, artKeys])\r\n  const artSetKeyList = useMemo(() => artKeys\r\n    ? artKeys.sort((a, b) => {\r\n      const aCount = getNumSlots(artSlotCount[a])\r\n      const bCount = getNumSlots(artSlotCount[b])\r\n      if (aCount < bCount) return 1\r\n      if (aCount > bCount) return -1\r\n      return 0\r\n    })\r\n    : [],\r\n  [artSlotCount, artKeys])\r\n\r\n  const allowRainbow2 = !artSetExclusion.rainbow?.includes(2)\r\n  const allowRainbow4 = !artSetExclusion.rainbow?.includes(4)\r\n\r\n  const { allow2, allow4, exclude2, exclude4 } = useMemo(() => ({\r\n    allow2: artSetKeyList.filter(k => !artSetExclusion[k]?.includes(2)).length,\r\n    allow4: artSetKeyList.filter(k => !artSetExclusion[k]?.includes(4)).length,\r\n    exclude2: artSetKeyList.filter(k => artSetExclusion[k]?.includes(2)).length,\r\n    exclude4: artSetKeyList.filter(k => artSetExclusion[k]?.includes(4)).length,\r\n  }), [artSetKeyList, artSetExclusion])\r\n  const artifactCondCount = useMemo(() =>\r\n    (Object.keys(conditional)).filter(k =>\r\n      allArtifactSets.includes(k as ArtifactSetKey) && Object.keys(conditional[k]).length !== 0).length\r\n    , [conditional])\r\n  const fakeDataContextObj = useMemo(() => ({\r\n    ...dataContext,\r\n    data: new UIData({ ...dataContext.data.data[0], artSet: objectKeyMap(allArtifactSets, _ => constant(4)) }, undefined)\r\n  }), [dataContext])\r\n  const resetArtConds = useCallback(() => {\r\n    const tconditional = Object.fromEntries(Object.entries(conditional).filter(([k, v]) => !allArtifactSets.includes(k as any)))\r\n    characterDispatch({ conditional: tconditional })\r\n  }, [conditional, characterDispatch]);\r\n  const setAllExclusion = useCallback(\r\n    (setnum: number, exclude = true) => {\r\n      const artSetExclusion_ = deepClone(artSetExclusion)\r\n      artSetKeyList.forEach(k => {\r\n        if (exclude) artSetExclusion_[k] = [...(artSetExclusion_[k] ?? []), setnum];\r\n        else if (artSetExclusion_[k]) artSetExclusion_[k] = artSetExclusion_[k].filter(n => n !== setnum);\r\n      })\r\n      buildSettingDispatch({ artSetExclusion: artSetExclusion_ })\r\n    },\r\n    [artSetKeyList, artSetExclusion, buildSettingDispatch],\r\n  )\r\n\r\n  return <>\r\n    <CardLight sx={{ display: \"flex\" }}>\r\n      <CardContent sx={{ flexGrow: 1 }} >\r\n        <Typography>\r\n          <strong>{t`artSetConfig.title`}</strong>\r\n        </Typography>\r\n        <Stack spacing={1}>\r\n          <Typography>{t`artSetConfig.setEffCond`} <SqBadge color={artifactCondCount ? \"success\" : \"secondary\"}>{artifactCondCount} {t<string>(\"artSetConfig.enabled\")}</SqBadge></Typography>\r\n          <Typography>{t`sheet:2set`} <SqBadge color=\"success\">{allow2} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"artSetConfig.allowed\")}</SqBadge>{!!exclude2 && \" / \"}{!!exclude2 && <SqBadge color=\"secondary\">{exclude2} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"artSetConfig.excluded\")}</SqBadge>}</Typography>\r\n          <Typography>{t`sheet:4set`} <SqBadge color=\"success\">{allow4} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"artSetConfig.allowed\")}</SqBadge>{!!exclude4 && \" / \"}{!!exclude4 && <SqBadge color=\"secondary\">{exclude4} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"artSetConfig.excluded\")}</SqBadge>}</Typography>\r\n          <Typography>{t`artSetConfig.2rainbow`} <SqBadge color={allowRainbow2 ? \"success\" : \"secondary\"}><FontAwesomeIcon icon={allowRainbow2 ? faChartLine : faBan} className=\"fa-fw\" /> {allowRainbow2 ? t<string>(\"artSetConfig.allowed\") : \"Excluded\"}</SqBadge></Typography>\r\n          <Typography>{t`artSetConfig.4rainbow`} <SqBadge color={allowRainbow4 ? \"success\" : \"secondary\"}><FontAwesomeIcon icon={allowRainbow4 ? faChartLine : faBan} className=\"fa-fw\" /> {allowRainbow4 ? t<string>(\"artSetConfig.allowed\") : \"Excluded\"}</SqBadge></Typography>\r\n        </Stack>\r\n\r\n      </CardContent>\r\n      <Button onClick={onOpen} disabled={disabled} color=\"info\" sx={{ borderRadius: 0 }}>\r\n        <Settings />\r\n      </Button>\r\n    </CardLight>\r\n    {artifactSheets && <ModalWrapper open={open} onClose={onClose} ><CardDark>\r\n      <CardContent sx={{ display: \"flex\", gap: 1, justifyContent: \"space-between\" }}>\r\n        <Typography variant=\"h6\" >{t`artSetConfig.title`}</Typography>\r\n        <CloseButton onClick={onClose} />\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent >\r\n        <CardLight sx={{ mb: 1 }}><CardContent>\r\n          <Box display=\"flex\" gap={1}>\r\n            <Typography><strong>{t`artSetConfig.modal.setCond.title`}</strong></Typography>\r\n            <Typography sx={{ flexGrow: 1 }}><SqBadge color={artifactCondCount ? \"success\" : \"secondary\"}>{artifactCondCount} {t<string>(\"artSetConfig.selected\")}</SqBadge></Typography>\r\n            <Button size='small' onClick={resetArtConds} color=\"error\" startIcon={<Replay />}>{t`artSetConfig.modal.setCond.reset`}</Button>\r\n          </Box>\r\n          <Typography>{t`artSetConfig.modal.setCond.text`}</Typography>\r\n        </CardContent></CardLight>\r\n        <CardLight sx={{ mb: 1 }}><CardContent>\r\n          <Typography sx={{ flexGrow: 1 }}><strong>\r\n            <Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.title\" >Artifact Sets <ColorText color='success'>Allowed<FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /></ColorText> / <ColorText color='secondary' variant='light'>Excluded<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /></ColorText></Trans>\r\n          </strong></Typography>\r\n          <Typography><Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.intro\">You can allow/exclude which sets you want the builder to consider. In the following examples, <strong>A</strong> is on-set, and <strong>R</strong> is rainbow(off-set)</Trans></Typography>\r\n          <Typography><Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.2set\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 2-Set</ColorText></strong> would exclude 2-Set builds: <strong><ColorText color='secondary' variant='light'>AA</ColorText>RRR</strong> and <strong><ColorText color='secondary' variant='light'>AAA</ColorText>RR</strong>.</Trans></Typography>\r\n          <Typography><Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.4set\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 4-Set</ColorText></strong> would exclude 4-Set builds: <strong><ColorText color='secondary' variant='light'>AAAA</ColorText>R</strong> and <strong><ColorText color='secondary' variant='light'>AAAAA</ColorText></strong>.</Trans></Typography>\r\n          <Typography><Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.2rain\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 3-Rainbow</ColorText></strong> would exclude 2-Set + 3-Rainbow builds: <strong>AA<ColorText color='secondary' variant='light'>RRR</ColorText></strong> and <strong>AAA<ColorText color='secondary' variant='light'>RR</ColorText></strong>.</Trans></Typography>\r\n          <Typography><Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.4rain\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 5-Rainbow</ColorText></strong> would exclude full 5-Rainbow builds: <strong><ColorText color='secondary' variant='light'>RRRRR</ColorText></strong>.</Trans></Typography>\r\n        </CardContent></CardLight>\r\n        <Grid container columns={{ xs: 2, lg: 3 }} sx={{ mb: 1 }} spacing={1}>\r\n          <Grid item xs={1}>\r\n            <AllSetAllowExcludeCard setNum={2} numAllow={allow2} numExclude={exclude2} setAllExclusion={setAllExclusion} />\r\n          </Grid>\r\n          <Grid item xs={1}>\r\n            <AllSetAllowExcludeCard setNum={4} numAllow={allow4} numExclude={exclude4} setAllExclusion={setAllExclusion} />\r\n          </Grid>\r\n          <Grid item xs={1}>\r\n            <CardLight>\r\n              <CardContent>\r\n                <Typography gutterBottom><strong><Trans t={t} i18nKey=\"artSetConfig.alExRainbow\"><ColorText color='success'>Allow <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /></ColorText> / <ColorText color='secondary' variant='light'>Exclude <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /></ColorText> Rainbow Builds</Trans></strong></Typography>\r\n                <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n                  <Button fullWidth onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey: \"rainbow\", num: 2 })} color={allowRainbow2 ? \"success\" : \"secondary\"} startIcon={!allowRainbow2 ? <CheckBoxOutlineBlank /> : <CheckBox />} endIcon={<FontAwesomeIcon icon={allowRainbow2 ? faChartLine : faBan} className=\"fa-fw\" />}>{t`artSetConfig.2rainbow`}</Button>\r\n                  <Button fullWidth onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey: \"rainbow\", num: 4 })} color={allowRainbow4 ? \"success\" : \"secondary\"} startIcon={!allowRainbow4 ? <CheckBoxOutlineBlank /> : <CheckBox />} endIcon={<FontAwesomeIcon icon={allowRainbow4 ? faChartLine : faBan} className=\"fa-fw\" />}>{t`artSetConfig.4rainbow`}</Button>\r\n                </Box>\r\n              </CardContent>\r\n            </CardLight>\r\n          </Grid>\r\n        </Grid>\r\n        <Grid container spacing={1} columns={{ xs: 2, lg: 3 }}>\r\n          {artSetKeyList.map(setKey => {\r\n            return <ArtifactSetCard key={setKey} setKey={setKey} sheet={artifactSheets(setKey)} fakeDataContextObj={fakeDataContextObj} slotCount={artSlotCount[setKey]!} />\r\n          })}\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent sx={{ py: 1 }}>\r\n        <CloseButton large onClick={onClose} />\r\n      </CardContent>\r\n    </CardDark></ModalWrapper >}\r\n  </>\r\n}\r\nfunction AllSetAllowExcludeCard({ numAllow, numExclude, setNum, setAllExclusion }: { numAllow: number, numExclude: number, setNum: 2 | 4, setAllExclusion: (setNum: 2 | 4, exclude?: boolean) => void }) {\r\n  const { t } = useTranslation([\"page_character_optimize\", \"sheet\"])\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Typography gutterBottom><strong>{t(`sheet:${setNum}set`)}</strong> <SqBadge color=\"success\">{numAllow} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"artSetConfig.allowed\")}</SqBadge>{!!numExclude && \" / \"}{!!numExclude && <SqBadge color=\"secondary\">{numExclude} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"artSetConfig.excluded\")}</SqBadge>}</Typography>\r\n      <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n        <Button fullWidth disabled={!numExclude} onClick={() => setAllExclusion(setNum, false)} color='success' startIcon={<FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" />}>{t(`artSetConfig.allowAll${setNum}set`)}</Button>\r\n        <Button fullWidth disabled={!numAllow} onClick={() => setAllExclusion(setNum, true)} color='secondary' startIcon={<FontAwesomeIcon icon={faBan} className=\"fa-fw\" />}>{t(`artSetConfig.excludeAll${setNum}set`)}</Button>\r\n      </Box>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\nfunction ArtifactSetCard({ sheet, setKey, fakeDataContextObj, slotCount }: { setKey: ArtifactSetKey, sheet: ArtifactSheet, fakeDataContextObj: dataContextObj, slotCount: Record<SlotKey, number> }) {\r\n  const { t } = useTranslation(\"sheet\")\r\n  const { character: { key: characterKey } } = useContext(CharacterContext)\r\n  const { buildSetting, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const setExclusionSet = buildSetting?.artSetExclusion?.[setKey] ?? []\r\n  const allow4 = !setExclusionSet.includes(4)\r\n  const slots = useMemo(() => getNumSlots(slotCount), [slotCount])\r\n\r\n  /* Assumes that all conditionals are from 4-Set. needs to change if there are 2-Set conditionals */\r\n  const set4CondNums = useMemo(() => {\r\n    if (!allow4 || slots < 4) return []\r\n    return Object.keys(sheet.setEffects).filter(setNumKey => sheet.setEffects[setNumKey]?.document.some(doc => \"states\" in doc))\r\n  }, [sheet.setEffects, allow4, slots])\r\n  const exclude2 = setExclusionSet.includes(2)\r\n  const exclude4 = setExclusionSet.includes(4)\r\n  return <Grid item key={setKey} xs={1}>\r\n    <CardLight sx={{ height: \"100%\", opacity: slots < 2 ? \"50%\" : undefined }}>\r\n      <Box className={`grad-${sheet.rarity[0]}star`} width=\"100%\" sx={{ display: \"flex\" }} >\r\n        <Box component=\"img\" src={sheet.defIconSrc} sx={{ height: 100, width: \"auto\", mx: -1 }} />\r\n        <Box sx={{ flexGrow: 1, px: 1, display: \"flex\", flexDirection: \"column\", justifyContent: \"center\" }}>\r\n          <Typography variant=\"h6\">{sheet.name ?? \"\"}</Typography>\r\n          <Box display=\"flex\" gap={1}>\r\n            <Typography variant=\"subtitle1\">{sheet.rarity.map((ns, i) => <span key={ns}>{ns} <StarsDisplay stars={1} /> {i < (sheet.rarity.length - 1) ? \"/ \" : null}</span>)}</Typography>\r\n            {/* If there is ever a 2-Set conditional, we will need to change this */}\r\n            <InfoTooltip title={<Box>\r\n              <Typography><SqBadge color=\"success\">{t`2set`}</SqBadge></Typography>\r\n              <Typography><Translate ns={`artifact_${setKey}_gen`} key18={\"setEffects.2\"} /></Typography>\r\n              <Box paddingTop={2} sx={{ opacity: setExclusionSet.includes(4) ? 0.6 : 1 }} >\r\n                <Typography><SqBadge color=\"success\">{t`4set`}</SqBadge></Typography>\r\n                <Typography><Translate ns={`artifact_${setKey}_gen`} key18={\"setEffects.4\"} /></Typography>\r\n              </Box>\r\n            </Box>} />\r\n          </Box>\r\n          <Box sx={{ display: \"flex\", gap: 1 }}>{Object.entries(slotCount).map(([slotKey, count]) => <Typography key={slotKey} sx={{ flexGrow: 1 }} variant=\"subtitle2\" ><SqBadge sx={{ width: \"100%\" }} color={count ? \"primary\" : \"secondary\"}>{artifactSlotIcon(slotKey)}{count}</SqBadge></Typography>)}</Box>\r\n        </Box>\r\n      </Box>\r\n      <ButtonGroup sx={{ \".MuiButton-root\": { borderRadius: 0 } }} fullWidth>\r\n        {slots >= 2 && <Button startIcon={exclude2 ? <CheckBoxOutlineBlank /> : <CheckBox />} onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey, num: 2 })} color={exclude2 ? 'secondary' : 'success'} endIcon={<FontAwesomeIcon icon={exclude2 ? faBan : faChartLine} className=\"fa-fw\" />}>{t`2set`}</Button>}\r\n        {slots >= 4 && <Button startIcon={exclude4 ? <CheckBoxOutlineBlank /> : <CheckBox />} onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey, num: 4 })} color={exclude4 ? 'secondary' : 'success'} endIcon={<FontAwesomeIcon icon={exclude4 ? faBan : faChartLine} className=\"fa-fw\" />}>{t`4set`}</Button>}\r\n      </ButtonGroup>\r\n\r\n      {!!set4CondNums.length && <DataContext.Provider value={fakeDataContextObj}>\r\n        <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\r\n          {set4CondNums.map(setNumKey =>\r\n            <SetEffectDisplay key={setNumKey} setKey={setKey} setNumKey={parseInt(setNumKey) as SetNum} hideHeader conditionalsOnly />\r\n          )}\r\n        </CardContent>\r\n      </DataContext.Provider>}\r\n    </CardLight>\r\n  </Grid >\r\n}\r\n\r\nfunction getNumSlots(slotCount: Record<string, number> | undefined): number {\r\n  return slotCount ? Object.values(slotCount).reduce((tot, v) => tot + (v ? 1 : 0), 0) : 0\r\n}\r\n","import { MenuItem } from \"@mui/material\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport DropdownButton from \"../../../../../Components/DropdownMenu/DropdownButton\"\r\n\r\nconst levels = [0, 4, 8, 12, 16, 20] as const\r\nexport default function AssumeFullLevelToggle({ mainStatAssumptionLevel = 0, setmainStatAssumptionLevel, disabled }) {\r\n  const { t } = useTranslation(\"page_character_optimize\")\r\n  return <DropdownButton fullWidth color={mainStatAssumptionLevel ? \"success\" : \"primary\"} disabled={disabled}\r\n    title={mainStatAssumptionLevel ? t(\"mainStat.assumptionLvl.lvl\", { lvl: mainStatAssumptionLevel }) : t(\"mainStat.assumptionLvl.no\")}>\r\n    {levels.map((lvl) => <MenuItem key={lvl} onClick={() => setmainStatAssumptionLevel(lvl)}>{lvl ? t(\"mainStat.assumptionLvl.lvl\", { lvl }) : t(\"mainStat.assumptionLvl.no\")}</MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n","import { CardContent, Divider, Typography } from '@mui/material';\r\nimport { useContext } from 'react';\r\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport { NodeFieldDisplay } from '../../../../../Components/FieldDisplay';\r\nimport { DataContext } from '../../../../../Context/DataContext';\r\nimport { uiInput as input } from '../../../../../Formula';\r\nimport { NumNode } from '../../../../../Formula/type';\r\nexport default function BonusStatsCard() {\r\n  const { character: { bonusStats } } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n  const bonusStatsKeys = Object.keys(bonusStats)\r\n  if (!bonusStatsKeys.length) return null\r\n  const nodes = bonusStatsKeys.map(k => data.get(input.customBonus[k] as NumNode))\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Typography>Bonus Stats</Typography>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      {nodes.map(n => <NodeFieldDisplay key={JSON.stringify(n.info)} node={n} />)}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import { Alert, Grid, LinearProgress, styled, Typography } from '@mui/material';\r\nimport { ReactNode } from 'react';\r\nimport { timeStringMs } from '../../../../../Util/TimeUtil';\r\n\r\nexport const warningBuildNumber = 10000000\r\nexport type BuildStatus = {\r\n  type: \"active\" | \"inactive\"\r\n  tested: number      // tested, including `failed`\r\n  failed: number      // tested but fail the filter criteria, e.g., not enough EM\r\n  skipped: number\r\n  total: number\r\n  startTime?: number\r\n  finishTime?: number\r\n}\r\n\r\nconst Monospace = styled(\"strong\")({\r\n  fontFamily: \"monospace\"\r\n})\r\n\r\nconst BorderLinearProgress = styled(LinearProgress)(({ theme }) => ({\r\n  height: 10,\r\n  borderRadius: 5,\r\n}));\r\nexport default function BuildAlert({ status: { type, tested, failed, skipped, total, startTime, finishTime }, characterName }: { status: BuildStatus, characterName: Displayable }) {\r\n  const hasTotal = isFinite(total)\r\n\r\n  const generatingBuilds = type !== \"inactive\"\r\n  const unskipped = total - skipped\r\n\r\n  const testedString = <Monospace>{tested.toLocaleString()}</Monospace>\r\n  const unskippedString = <Monospace>{unskipped.toLocaleString()}</Monospace>\r\n  const skippedText = !!skipped && <span>(<b>{<Monospace>{skipped.toLocaleString()}</Monospace>}</b> skipped)</span>\r\n\r\n  const durationString = <Monospace>{timeStringMs(Math.round((finishTime ?? performance.now()) - (startTime ?? NaN)))}</Monospace>\r\n\r\n  let color = \"success\" as \"success\" | \"warning\" | \"error\"\r\n  let title = \"\" as ReactNode\r\n  let subtitle = \"\" as ReactNode\r\n  let progress = undefined as undefined | number\r\n\r\n  if (generatingBuilds) {\r\n    progress = tested * 100 / (unskipped)\r\n    title = <Typography>Generating and testing {testedString}{hasTotal ? <>/{unskippedString}</> : undefined} build configurations against the criteria for <b>{characterName}</b>. {skippedText}</Typography>\r\n    subtitle = <Typography>Time elapsed: {durationString}</Typography>\r\n  } else if (tested + skipped) {\r\n    progress = 100\r\n    title = <Typography>Generated and tested {testedString} Build configurations against the criteria for <b>{characterName}</b>. {skippedText}</Typography>\r\n    subtitle = <Typography>Total duration: {durationString}</Typography>\r\n  } else {\r\n    return null\r\n  }\r\n\r\n  return <Alert severity={color} variant=\"filled\" sx={{\r\n    \"& .MuiAlert-message\": {\r\n      flexGrow: 1\r\n    }\r\n  }}>\r\n    {title}\r\n    {subtitle}\r\n    {progress !== undefined && <Grid container spacing={1} alignItems=\"center\">\r\n      {hasTotal && <Grid item>\r\n        <Typography>{`${progress.toFixed(1)}%`}</Typography>\r\n      </Grid>}\r\n      <Grid item flexGrow={1} >\r\n        <BorderLinearProgress variant={hasTotal ? \"determinate\" : \"indeterminate\"} value={progress} color=\"primary\" />\r\n      </Grid>\r\n    </Grid>}\r\n  </Alert>\r\n}\r\n","import { BusinessCenter } from \"@mui/icons-material\";\r\nimport { alpha, Box, CardActionArea, Chip, Typography, useTheme } from \"@mui/material\";\r\nimport { useCallback, useContext } from \"react\";\r\nimport Assets from \"../../Assets/Assets\";\r\nimport Artifact from \"../../Data/Artifacts/Artifact\";\r\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\";\r\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\r\nimport { DatabaseContext } from \"../../Database/Database\";\r\nimport KeyMap, { cacheValueString } from \"../../KeyMap\";\r\nimport useArtifact from \"../../ReactHooks/useArtifact\";\r\nimport useDBMeta from \"../../ReactHooks/useDBMeta\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport { ICachedSubstat } from \"../../Types/artifact\";\r\nimport { allElementsWithPhy, CharacterKey, SlotKey } from \"../../Types/consts\";\r\nimport { clamp } from \"../../Util/Util\";\r\nimport BootstrapTooltip from \"../BootstrapTooltip\";\r\nimport CardDark from \"../Card/CardDark\";\r\nimport ColorText from \"../ColoredText\";\r\nimport ConditionalWrapper from \"../ConditionalWrapper\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport { StatColoredWithUnit } from \"../StatDisplay\";\r\nimport StatIcon from \"../StatIcon\";\r\nimport ArtifactTooltip from \"./ArtifactTooltip\";\r\n\r\ntype Data = {\r\n  artifactId?: string,\r\n  slotKey: SlotKey,\r\n  mainStatAssumptionLevel?: number,\r\n  onClick?: () => void,\r\n  showLocation?: boolean,\r\n  BGComponent?: React.ElementType\r\n}\r\n\r\nexport default function ArtifactCardNano({ artifactId, slotKey: pSlotKey, mainStatAssumptionLevel = 0, showLocation = false, onClick, BGComponent = CardDark }: Data) {\r\n  const art = useArtifact(artifactId)\r\n  const { database } = useContext(DatabaseContext)\r\n  const sheet = usePromise(() => ArtifactSheet.get(art?.setKey), [art?.setKey])\r\n  const actionWrapperFunc = useCallback(children => <CardActionArea onClick={onClick} sx={{ height: \"100%\" }}>{children}</CardActionArea>, [onClick],)\r\n  const theme = useTheme()\r\n  if (!art) return <BGComponent sx={{ display: \"flex\", height: \"100%\", alignItems: \"center\", justifyContent: \"center\" }}>\r\n    <Box component=\"img\" src={Assets.slot[pSlotKey]} sx={{ width: \"25%\", height: \"auto\", opacity: 0.7 }} />\r\n  </BGComponent>\r\n\r\n  const { slotKey, rarity, level, mainStatKey, substats, location } = art\r\n  const mainStatLevel = Math.max(Math.min(mainStatAssumptionLevel, rarity * 4), level)\r\n  const mainStatUnit = KeyMap.unit(mainStatKey)\r\n  const element = allElementsWithPhy.find(ele => art.mainStatKey.includes(ele))\r\n  const color = element ? alpha(theme.palette[element].main, 0.6) : alpha(theme.palette.secondary.main, 0.6)\r\n  return <BGComponent sx={{ height: \"100%\" }}><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}  >\r\n    <Box display=\"flex\" height=\"100%\">\r\n      <Box className={`grad-${rarity}star`} sx={{ position: \"relative\", flexGrow: 1, display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"center\" }} >\r\n        <ArtifactTooltip art={art}>\r\n          <Box\r\n            component=\"img\"\r\n            src={sheet?.slotIcons[slotKey] ?? \"\"}\r\n            sx={{ m: -1, maxHeight: \"110%\", maxWidth: \"110%\" }}\r\n          />\r\n        </ArtifactTooltip>\r\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"space-between\", pointerEvents: \"none\" }} >\r\n          <Chip size=\"small\" label={<strong>{` +${level}`}</strong>} color={Artifact.levelVariant(level)} />\r\n          {showLocation && <Chip size=\"small\" label={<LocationIcon charKey={location && database.chars.LocationToCharacterKey(location)} />} color={\"secondary\"} sx={{\r\n            overflow: \"visible\", \".MuiChip-label\": {\r\n              overflow: \"visible\"\r\n            }\r\n          }} />}\r\n        </Box>\r\n        {/* mainstats */}\r\n        <Chip size=\"small\" sx={{ position: \"absolute\", bottom: 0, mb: 1, backgroundColor: color }}\r\n          label={<Typography sx={{ display: \"flex\", gap: 0.5, px: 1, zIndex: 1 }}>\r\n            <BootstrapTooltip placement=\"top\" title={<Typography><StatColoredWithUnit statKey={mainStatKey} /></Typography>} disableInteractive>\r\n              <span>{StatIcon[mainStatKey]}</span>\r\n            </BootstrapTooltip>\r\n            <ColorText color={mainStatLevel !== level ? \"warning\" : undefined}>{cacheValueString(Artifact.mainStatValue(mainStatKey, rarity, mainStatLevel) ?? 0, KeyMap.unit(mainStatKey))}{mainStatUnit}</ColorText>\r\n          </Typography>} />\r\n      </Box>\r\n      {/* substats */}\r\n      <Box display=\"flex\" flexDirection=\"column\" justifyContent=\"space-between\" sx={{ p: 1, }}>\r\n        {substats.map((stat: ICachedSubstat, i: number) => <SubstatDisplay key={i + stat.key} stat={stat} />)}\r\n      </Box>\r\n    </Box>\r\n  </ConditionalWrapper></BGComponent >\r\n}\r\nfunction SubstatDisplay({ stat }: { stat: ICachedSubstat }) {\r\n  if (!stat.value) return null\r\n  const numRolls = stat.rolls?.length ?? 0\r\n  const rollColor = `roll${clamp(numRolls, 1, 6)}`\r\n  const unit = KeyMap.unit(stat.key)\r\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\r\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 0.5 }} color={(numRolls ? `${rollColor}.main` : \"error.main\") as any} component=\"span\">\r\n      <BootstrapTooltip placement=\"top\" title={<Typography>{stat.key && <StatColoredWithUnit statKey={stat.key} />}</Typography>} disableInteractive>\r\n        <span>{StatIcon[stat.key]}</span>\r\n      </BootstrapTooltip>\r\n      <span>{`${cacheValueString(stat.value, KeyMap.unit(stat.key))}${unit}`}</span>\r\n    </Typography>\r\n  </Box>)\r\n}\r\nfunction LocationIcon({ charKey }: { charKey: CharacterKey | \"\" }) {\r\n  const { gender } = useDBMeta()\r\n  const characterSheet = usePromise(() => CharacterSheet.get(charKey, gender), [charKey, gender])\r\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} sx={{ height: \"3em\", marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\r\n}\r\n","import { Masonry } from \"@mui/lab\"\r\nimport { Divider, ListItem } from \"@mui/material\"\r\nimport { Box } from \"@mui/system\"\r\nimport { useContext, useMemo } from \"react\"\r\nimport { DataContext } from \"../../Context/DataContext\"\r\nimport { OptimizationTargetContext } from \"../../Context/OptimizationTargetContext\"\r\nimport { DatabaseContext } from \"../../Database/Database\"\r\nimport { getDisplayHeader, getDisplaySections } from \"../../Formula/DisplayUtil\"\r\nimport { DisplaySub } from \"../../Formula/type\"\r\nimport { NodeDisplay } from \"../../Formula/uiData\"\r\nimport { customRead } from \"../../Formula/utils\"\r\nimport usePromise from \"../../ReactHooks/usePromise\"\r\nimport { objectMap } from \"../../Util/Util\"\r\nimport CardDark from \"../Card/CardDark\"\r\nimport CardHeaderCustom from \"../Card/CardHeaderCustom\"\r\nimport { FieldDisplayList, NodeFieldDisplay } from \"../FieldDisplay\"\r\nimport ImgIcon from \"../Image/ImgIcon\"\r\nimport SqBadge from \"../SqBadge\"\r\n\r\nexport default function StatDisplayComponent() {\r\n  const { data } = useContext(DataContext)\r\n  const sections = useMemo(() =>\r\n    getDisplaySections(data).filter(([, ns]) => Object.values(ns).some(n => !n.isEmpty)),\r\n    [data])\r\n  return <Box sx={{ mr: -1, mb: -1 }}>\r\n    <Masonry columns={{ xs: 1, sm: 2, md: 3, xl: 4 }} spacing={1}>\r\n      {sections.map(([key, Nodes]) =>\r\n        <Section key={key} displayNs={Nodes} sectionKey={key} />)}\r\n    </Masonry >\r\n  </Box>\r\n}\r\n\r\nfunction Section({ displayNs, sectionKey }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string }) {\r\n  const optimizationTarget = useContext(OptimizationTargetContext)\r\n  const { data, oldData } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const header = usePromise(() => getDisplayHeader(data, sectionKey, database), [data, sectionKey])\r\n  const displayNsReads = useMemo(() => objectMap(displayNs, (n, nodeKey) => customRead([\"display\", sectionKey, nodeKey])), [displayNs, sectionKey]);\r\n  if (!header) return <CardDark></CardDark>\r\n\r\n  const { title, icon, action } = header\r\n  return <CardDark >\r\n    <CardHeaderCustom avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action && <SqBadge>{action}</SqBadge>} />\r\n    <Divider />\r\n    <FieldDisplayList sx={{ m: 0 }}>\r\n      {Object.entries(displayNs).map(([nodeKey, n]) =>\r\n        <NodeFieldDisplay key={nodeKey} node={n} oldValue={oldData ? oldData.get(displayNsReads[nodeKey]!).value : undefined} component={ListItem}\r\n          emphasize={JSON.stringify(optimizationTarget) === JSON.stringify([sectionKey, nodeKey])}\r\n        />)}\r\n    </FieldDisplayList>\r\n  </CardDark>\r\n}\r\n","import { BusinessCenter } from \"@mui/icons-material\";\r\nimport { Box, CardActionArea, Chip, Skeleton, Typography } from \"@mui/material\";\r\nimport { useCallback, useContext, useMemo } from \"react\";\r\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\r\nimport WeaponSheet from \"../../Data/Weapons/WeaponSheet\";\r\nimport { DatabaseContext } from \"../../Database/Database\";\r\nimport { input } from \"../../Formula\";\r\nimport { computeUIData, dataObjForWeapon } from \"../../Formula/api\";\r\nimport { NodeDisplay, nodeVStr } from '../../Formula/uiData';\r\nimport useDBMeta from \"../../ReactHooks/useDBMeta\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport useWeapon from \"../../ReactHooks/useWeapon\";\r\nimport { LocationKey } from \"../../Types/consts\";\r\nimport BootstrapTooltip from \"../BootstrapTooltip\";\r\nimport CardDark from \"../Card/CardDark\";\r\nimport ConditionalWrapper from \"../ConditionalWrapper\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport WeaponNameTooltip from \"./WeaponNameTooltip\";\r\n\r\ntype Data = {\r\n  weaponId?: string,\r\n  onClick?: () => void,\r\n  showLocation?: boolean,\r\n  BGComponent?: React.ElementType,\r\n}\r\n\r\nexport default function WeaponCardNano({ weaponId, showLocation = false, onClick, BGComponent = CardDark, }: Data) {\r\n  const weapon = useWeapon(weaponId)\r\n  const weaponSheet = usePromise(() => weapon?.key && WeaponSheet.get(weapon.key), [weapon?.key])\r\n  const actionWrapperFunc = useCallback(children => <CardActionArea sx={{ height: \"100%\" }} onClick={onClick}>{children}</CardActionArea>, [onClick],)\r\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\r\n  if (!weapon || !weaponSheet || !UIData) return <BGComponent sx={{ height: \"100%\" }}><Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\" }} /></BGComponent>;\r\n  const { refinement, location } = weapon\r\n  return <BGComponent sx={{ height: \"100%\" }}><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}  >\r\n    <Box display=\"flex\" height=\"100%\" alignItems=\"stretch\" >\r\n      <Box className={`grad-${weaponSheet.rarity}star`} sx={{ height: \"100%\", position: \"relative\", flexGrow: 1, display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"flex-end\" }} >\r\n        <WeaponNameTooltip sheet={weaponSheet}>\r\n          <Box\r\n            component=\"img\"\r\n            src={weaponSheet.getImg(weapon.ascension)}\r\n            sx={{ mx: -1, maxHeight: \"100%\", maxWidth: \"100%\" }}\r\n          />\r\n        </WeaponNameTooltip>\r\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"space-between\", pointerEvents: \"none\" }} >\r\n          <Chip size=\"small\" label={<strong>{WeaponSheet.getLevelString(weapon)}</strong>} color=\"primary\" />\r\n          {showLocation && <Chip size=\"small\" label={<LocationIcon location={location} />} color={\"secondary\"} sx={{\r\n            overflow: \"visible\", \".MuiChip-label\": {\r\n              overflow: \"visible\"\r\n            }\r\n          }} />}\r\n        </Box>\r\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"flex-end\", alignItems: \"flex-end\" }} >\r\n          {weaponSheet.hasRefinement && <Chip size=\"small\" color=\"info\" label={<strong>R{refinement}</strong>} />}\r\n        </Box>\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"column\" sx={{ p: 1, }}>\r\n        <WeaponStat node={UIData.get(input.weapon.main)} />\r\n        <WeaponStat node={UIData.get(input.weapon.sub)} />\r\n      </Box>\r\n    </Box>\r\n  </ConditionalWrapper></BGComponent >\r\n}\r\nfunction WeaponStat({ node }: { node: NodeDisplay }) {\r\n  if (!node.info.name) return null\r\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\r\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 1 }} component=\"span\">\r\n      <BootstrapTooltip placement=\"top\" title={<Typography>{node.info.name}</Typography>} disableInteractive>\r\n        <span>{node.info.icon}</span>\r\n      </BootstrapTooltip>\r\n      <span>{nodeVStr(node)}</span>\r\n    </Typography>\r\n  </Box>)\r\n}\r\nfunction LocationIcon({ location }: { location: LocationKey }) {\r\n  const { database } = useContext(DatabaseContext)\r\n  const { gender } = useDBMeta()\r\n  const characterSheet = usePromise(() => CharacterSheet.get(location ? database.chars.LocationToCharacterKey(location) : \"\", gender), [location, gender])\r\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} sx={{ height: \"3em\", marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\r\n}\r\n","import { Checkroom, ChevronRight } from '@mui/icons-material';\r\nimport { Button, CardContent, Grid, Skeleton, Typography } from '@mui/material';\r\nimport { Box } from '@mui/system';\r\nimport { ArtifactSlotKey } from 'pipeline';\r\nimport { Suspense, useCallback, useContext, useMemo, useState } from 'react';\r\nimport ArtifactCardNano from '../../../../../Components/Artifact/ArtifactCardNano';\r\nimport ArtifactSetTooltip from '../../../../../Components/Artifact/ArtifactSetTooltip';\r\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport StatDisplayComponent from '../../../../../Components/Character/StatDisplayComponent';\r\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\r\nimport SqBadge from '../../../../../Components/SqBadge';\r\nimport WeaponCardNano from '../../../../../Components/Weapon/WeaponCardNano';\r\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\r\nimport { DataContext } from '../../../../../Context/DataContext';\r\nimport { ArtifactSheet } from '../../../../../Data/Artifacts/ArtifactSheet';\r\nimport { DatabaseContext } from '../../../../../Database/Database';\r\nimport { uiInput as input } from '../../../../../Formula';\r\nimport ArtifactCard from '../../../../../PageArtifact/ArtifactCard';\r\nimport usePromise from '../../../../../ReactHooks/usePromise';\r\nimport { allSlotKeys, ArtifactSetKey, charKeyToLocCharKey, SlotKey } from '../../../../../Types/consts';\r\nimport useBuildSetting from '../useBuildSetting';\r\n\r\ntype NewOld = {\r\n  newId: string,\r\n  oldId?: string\r\n}\r\n\r\ntype BuildDisplayItemProps = {\r\n  index?: number,\r\n  compareBuild: boolean,\r\n  disabled?: boolean,\r\n  extraButtonsRight?: JSX.Element,\r\n  extraButtonsLeft?: JSX.Element,\r\n}\r\n//for displaying each artifact build\r\nexport default function BuildDisplayItem({ index, compareBuild, extraButtonsRight, extraButtonsLeft, disabled }: BuildDisplayItemProps) {\r\n  const { character: { key: characterKey, equippedArtifacts } } = useContext(CharacterContext)\r\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\r\n  const { database } = useContext(DatabaseContext)\r\n  const dataContext = useContext(DataContext)\r\n\r\n  const { data, oldData } = dataContext\r\n  const [newOld, setNewOld] = useState(undefined as NewOld | undefined)\r\n  const close = useCallback(() => setNewOld(undefined), [setNewOld],)\r\n\r\n  const equipBuild = useCallback(() => {\r\n    if (!window.confirm(\"Do you want to equip this build to this character?\")) return\r\n    allSlotKeys.forEach(s => {\r\n      const aid = data.get(input.art[s].id).value\r\n      if (aid) database.arts.set(aid, { location: charKeyToLocCharKey(characterKey) })\r\n    })\r\n    database.weapons.set(data.get(input.weapon.id).value!, { location: charKeyToLocCharKey(characterKey) })\r\n  }, [characterKey, data, database])\r\n\r\n  const statProviderContext = useMemo(() => {\r\n    const dataContext_ = { ...dataContext }\r\n    if (!compareBuild) dataContext_.oldData = undefined\r\n    return dataContext_\r\n  }, [dataContext, compareBuild])\r\n\r\n  // Memoize Arts because of its dynamic onClick\r\n  const artNanos = useMemo(() => allSlotKeys.map(slotKey =>\r\n    <Grid item xs={1} key={slotKey} >\r\n      <ArtifactCardNano showLocation slotKey={slotKey} artifactId={data.get(input.art[slotKey].id).value} mainStatAssumptionLevel={mainStatAssumptionLevel} onClick={() => {\r\n        const oldId = equippedArtifacts[slotKey]\r\n        const newId = data.get(input.art[slotKey].id).value!\r\n        setNewOld({ oldId: oldId !== newId ? oldId : undefined, newId })\r\n      }} />\r\n    </Grid>), [data, setNewOld, equippedArtifacts, mainStatAssumptionLevel])\r\n\r\n  if (!oldData) return null\r\n  const currentlyEquipped = allSlotKeys.every(slotKey => data.get(input.art[slotKey].id).value === oldData.get(input.art[slotKey].id).value) && data.get(input.weapon.id).value === oldData.get(input.weapon.id).value\r\n\r\n  return <CardLight>\r\n    <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n      {newOld && <CompareArtifactModal newOld={newOld} mainStatAssumptionLevel={mainStatAssumptionLevel} onClose={close} />}\r\n      <CardContent>\r\n        <Box display=\"flex\" gap={1} sx={{ pb: 1 }} flexWrap=\"wrap\">\r\n          {index !== undefined && <SqBadge color=\"info\"><Typography><strong>#{index + 1}{currentlyEquipped ? \" (Equipped)\" : \"\"}</strong></Typography></SqBadge>}\r\n          <SetBadges currentlyEquipped={currentlyEquipped} />\r\n          <Box sx={{ flexGrow: 1, display: \"flex\", justifyContent: \"flex-end\" }}>\r\n          </Box>\r\n          {extraButtonsLeft}\r\n          <Button size='small' color=\"success\" onClick={equipBuild} disabled={disabled || currentlyEquipped} startIcon={<Checkroom />}>Equip Build</Button>\r\n          {extraButtonsRight}\r\n        </Box>\r\n        <Grid container spacing={1} sx={{ pb: 1 }} columns={{ xs: 2, sm: 3, md: 4, lg: 6 }}>\r\n          <Grid item xs={1}>\r\n            <WeaponCardNano showLocation weaponId={data.get(input.weapon.id).value} />\r\n          </Grid>\r\n          {artNanos}\r\n        </Grid>\r\n        <DataContext.Provider value={statProviderContext}>\r\n          <StatDisplayComponent />\r\n        </DataContext.Provider>\r\n      </CardContent>\r\n    </Suspense>\r\n  </CardLight>\r\n}\r\nfunction SetBadges({ currentlyEquipped = false }: { currentlyEquipped: boolean }) {\r\n  const { data } = useContext(DataContext)\r\n  const setToSlots: Partial<Record<ArtifactSetKey, SlotKey[]>> = {}\r\n  allSlotKeys.forEach(slotKey => {\r\n    const set = data.get(input.art[slotKey].set).value as ArtifactSetKey | undefined\r\n    if (!set) return\r\n    if (setToSlots[set]) setToSlots[set]!.push(slotKey)\r\n    else setToSlots[set] = [slotKey]\r\n  })\r\n  return <>{Object.entries(setToSlots).sort(([k1, slotarr1], [k2, slotarr2]) => slotarr2.length - slotarr1.length).map(([key, slotarr]) =>\r\n    <SetBadge key={key} setKey={key} currentlyEquipped={currentlyEquipped} slotarr={slotarr} />\r\n  )}</>\r\n\r\n}\r\nfunction SetBadge({ setKey, currentlyEquipped = false, slotarr }: { setKey: ArtifactSetKey, currentlyEquipped: boolean, slotarr: ArtifactSlotKey[] }) {\r\n  const artifactSheet = usePromise(() => ArtifactSheet.get(setKey), [])\r\n  if (!artifactSheet) return null\r\n  const numInSet = slotarr.length\r\n  const setActive = Object.keys(artifactSheet.setEffects).map((setKey) => parseInt(setKey)).filter(setNum => setNum <= numInSet)\r\n  return <Box>\r\n    <ArtifactSetTooltip artifactSheet={artifactSheet} numInSet={numInSet} >\r\n      <SqBadge color={currentlyEquipped ? \"success\" : \"primary\"} ><Typography >\r\n        {slotarr.map(slotKey => artifactSlotIcon(slotKey))} {artifactSheet.name ?? \"\"}\r\n        {setActive.map(n => <SqBadge sx={{ ml: 0.5 }} key={n} color=\"success\">{n}</SqBadge>)}\r\n      </Typography></SqBadge>\r\n    </ArtifactSetTooltip>\r\n  </Box>\r\n}\r\n\r\nfunction CompareArtifactModal({ newOld: { newId, oldId }, mainStatAssumptionLevel, onClose }: { newOld: NewOld, mainStatAssumptionLevel: number, onClose: () => void }) {\r\n  const { database } = useContext(DatabaseContext)\r\n  const { character: { key: characterKey } } = useContext(CharacterContext)\r\n  const onEquip = useCallback(() => {\r\n    if (!window.confirm(\"Do you want to equip this artifact to this character?\")) return\r\n    database.arts.set(newId, { location: charKeyToLocCharKey(characterKey) })\r\n    onClose()\r\n  }, [newId, database, characterKey, onClose])\r\n\r\n  return <ModalWrapper open={!!newId} onClose={onClose} containerProps={{ maxWidth: oldId ? \"md\" : \"xs\" }}>\r\n    <CardDark>\r\n      <CardContent sx={{ display: \"flex\", justifyContent: \"center\", alignItems: \"stretch\", gap: 2, height: \"100%\" }}>\r\n        {oldId && <Box minWidth={320}><ArtifactCard artifactId={oldId} mainStatAssumptionLevel={mainStatAssumptionLevel} canExclude canEquip editorProps={{ disableSet: true, disableSlot: true }} /></Box>}\r\n        {oldId && <Box display=\"flex\" flexGrow={1} />}\r\n        {oldId && <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\"><Button onClick={onEquip} sx={{ display: \"flex\" }}><ChevronRight sx={{ fontSize: 40 }} /></Button></Box>}\r\n        {oldId && <Box display=\"flex\" flexGrow={1} />}\r\n        <Box minWidth={320}><ArtifactCard artifactId={newId} mainStatAssumptionLevel={mainStatAssumptionLevel} canExclude canEquip editorProps={{ disableSet: true, disableSlot: true }} /></Box>\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank, Download, Replay } from '@mui/icons-material';\r\nimport { Button, CardContent, Collapse, Divider, Grid, styled, Typography } from '@mui/material';\r\nimport { useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { CartesianGrid, ComposedChart, Label, Legend, Line, ResponsiveContainer, Scatter, XAxis, YAxis, ZAxis } from 'recharts';\r\nimport BootstrapTooltip from '../../../../../Components/BootstrapTooltip';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport InfoTooltip from '../../../../../Components/InfoTooltip';\r\nimport { NumNode } from '../../../../../Formula/type';\r\nimport { Build } from '../common';\r\nimport OptimizationTargetSelector from './OptimizationTargetSelector';\r\n\r\nexport type ChartData = {\r\n  valueNode: NumNode,\r\n  plotNode: NumNode,\r\n  data: Build[]\r\n}\r\ntype ChartCardProps = {\r\n  chartData?: ChartData\r\n  plotBase?: string[],\r\n  setPlotBase: (path: string[] | undefined) => void\r\n  disabled?: boolean\r\n  showTooltip?: boolean\r\n}\r\ntype Point = { x: number, y: number, min?: number }\r\nexport default function ChartCard({ chartData, plotBase, setPlotBase, disabled = false, showTooltip = false }: ChartCardProps) {\r\n  const { t } = useTranslation([\"page_character_optimize\", \"ui\"])\r\n  const [showDownload, setshowDownload] = useState(false)\r\n  const [showMin, setshowMin] = useState(true)\r\n\r\n  const { displayData, downloadData } = useMemo(() => {\r\n    if (!chartData) return { displayData: null, downloadData: null }\r\n    const points = chartData.data.map(({ value: y, plot: x }) => ({ x, y })) as Point[]\r\n    const increasingX: Point[] = points.sort((a, b) => a.x - b.x)\r\n    const minimumData: Point[] = []\r\n    for (const point of increasingX) {\r\n      let last: Point | undefined\r\n      while ((last = minimumData.pop())) {\r\n        if (last.y > point.y) {\r\n          minimumData.push(last)\r\n          break\r\n        }\r\n      }\r\n      minimumData.push(point)\r\n    }\r\n\r\n    // Note:\r\n    // We can also just use `minimumData` if the plotter supports multiple data sources.\r\n    // It could be faster too since there're no empty entries in `minimumData`.\r\n    if (minimumData[0]?.x !== increasingX[0]?.x)\r\n      increasingX[0].min = minimumData[0].y\r\n    minimumData.forEach(x => { x.min = x.y })\r\n\r\n    const downloadData = {\r\n      minimum: minimumData.map(({ x, y }) => [x, y]),\r\n      allData: increasingX.map(({ x, y }) => [x, y]),\r\n    }\r\n    return { displayData: increasingX, downloadData }\r\n  }, [chartData])\r\n\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Grid container spacing={1} alignItems=\"center\">\r\n        <Grid item>\r\n          <Typography >{t`tcGraph.vs`}</Typography>\r\n        </Grid>\r\n        <Grid item>\r\n          <BootstrapTooltip placement=\"top\" title={showTooltip ? t(\"page_character_optimize:selectTargetFirst\") : \"\"}>\r\n            <span>\r\n              <OptimizationTargetSelector\r\n                optimizationTarget={plotBase}\r\n                setTarget={target => setPlotBase(target)}\r\n                defaultText={t(\"page_character_optimize:targetSelector.selectGraphTarget\")}\r\n                disabled={disabled}\r\n              />\r\n            </span>\r\n          </BootstrapTooltip>\r\n        </Grid>\r\n        <Grid item>\r\n          <BootstrapTooltip title={!plotBase ? \"\" : t(\"ui:reset\")} placement=\"top\">\r\n            <span><Button color=\"error\" onClick={() => setPlotBase(undefined)} disabled={!plotBase}>\r\n              <Replay />\r\n            </Button></span>\r\n          </BootstrapTooltip>\r\n        </Grid>\r\n        <Grid item flexGrow={1}>\r\n          <InfoTooltip placement=\"top\" title={t(\"page_character_optimize:tcGraph.desc\")} />\r\n        </Grid>\r\n        {!!downloadData && <Grid item>\r\n          <Button size='small' startIcon={showMin ? <CheckBox /> : <CheckBoxOutlineBlank />}\r\n            color={showMin ? \"success\" : \"secondary\"}\r\n            onClick={() => setshowMin(!showMin)}>{t`tcGraph.showMinStatThr`}</Button>\r\n        </Grid>}\r\n        {!!downloadData && <Grid item>\r\n          <Button size='small' color=\"info\" startIcon={<Download />} onClick={() => setshowDownload(!showDownload)}>{t`tcGraph.downloadData`}</Button>\r\n        </Grid>}\r\n      </Grid>\r\n    </CardContent>\r\n    {!!displayData && <Divider />}\r\n    {chartData && !!displayData && <CardContent>\r\n      <Collapse in={!!downloadData && showDownload}>\r\n        <CardDark sx={{ mb: 2 }}>\r\n          <CardContent>\r\n            <Typography>Min Data</Typography>\r\n            <DataDisplay data={downloadData?.minimum} />\r\n            <Typography>All Data</Typography>\r\n            <DataDisplay data={downloadData?.allData} />\r\n          </CardContent>\r\n        </CardDark>\r\n      </Collapse>\r\n      <Chart displayData={displayData} plotNode={chartData.plotNode} valueNode={chartData.valueNode} showMin={showMin} />\r\n    </CardContent>}\r\n  </CardLight >\r\n}\r\nconst TextArea = styled(\"textarea\")({\r\n  width: \"100%\",\r\n  fontFamily: \"monospace\",\r\n  resize: \"vertical\",\r\n  minHeight: \"5em\"\r\n})\r\nfunction DataDisplay({ data, }: { data?: object }) {\r\n  return <TextArea readOnly value={JSON.stringify(data)} onClick={e => {\r\n    const target = e.target as HTMLTextAreaElement;\r\n    target.selectionStart = 0;\r\n    target.selectionEnd = target.value.length;\r\n  }} />\r\n}\r\nfunction Chart({ displayData, plotNode, valueNode, showMin }: {\r\n  displayData: Point[],\r\n  plotNode: NumNode,\r\n  valueNode: NumNode,\r\n  showMin: boolean\r\n}) {\r\n  const { t } = useTranslation(\"page_character_optimize\")\r\n  // Below works because character translation should already be loaded\r\n  const xLabel = <Label fill=\"white\" dy={10}>\r\n    {getLabelFromNode(plotNode, t)}\r\n  </Label>\r\n  const yLabel = <Label fill=\"white\" angle={-90} dx={-40}>\r\n    {getLabelFromNode(valueNode, t)}\r\n  </Label>\r\n  return <ResponsiveContainer width=\"100%\" height={600}>\r\n    <ComposedChart data={displayData}>\r\n      <CartesianGrid strokeDasharray=\"3 3\" />\r\n      <XAxis dataKey=\"x\" scale=\"linear\" unit={plotNode.info?.unit} domain={[\"auto\", \"auto\"]} tick={{ fill: 'white' }} type=\"number\" tickFormatter={n => n > 10000 ? n.toFixed() : n.toFixed(1)} label={xLabel} height={50} />\r\n      <YAxis name=\"DMG\" domain={[\"auto\", \"auto\"]} unit={valueNode.info?.unit} allowDecimals={false} tick={{ fill: 'white' }} type=\"number\" label={yLabel} width={100} />\r\n      <ZAxis dataKey=\"y\" range={[3, 25]} />\r\n      <Legend />\r\n      <Scatter name={t`tcGraph.optTarget`} dataKey=\"y\" fill=\"#8884d8\" line lineType=\"fitting\" isAnimationActive={false} />\r\n      {showMin && <Line name={t`tcGraph.minStatReqThr`} dataKey=\"min\" stroke=\"#ff7300\" type=\"stepBefore\" connectNulls strokeWidth={2} isAnimationActive={false} />}\r\n    </ComposedChart>\r\n  </ResponsiveContainer>\r\n}\r\n\r\nfunction getLabelFromNode(node: NumNode, t: any) {\r\n  console.log(node)\r\n  return typeof node.info?.name === \"string\"\r\n    ? node.info.name\r\n    : `${t(`${node.info?.name?.props.ns}:${node.info?.name?.props.key18}`)}${node.info?.textSuffix ? ` ${node.info?.textSuffix}` : \"\"}`\r\n}\r\n","import { Replay } from '@mui/icons-material';\r\nimport { Button, CardContent, Divider, Grid, Typography } from '@mui/material';\r\nimport { Box } from '@mui/system';\r\nimport { useContext } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport BootstrapTooltip from '../../../../../Components/BootstrapTooltip';\r\nimport SqBadge from '../../../../../Components/SqBadge';\r\nimport { StatColoredWithUnit } from '../../../../../Components/StatDisplay';\r\nimport StatIcon from '../../../../../Components/StatIcon';\r\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\r\nimport Artifact from '../../../../../Data/Artifacts/Artifact';\r\nimport { allElementsWithPhy } from '../../../../../Types/consts';\r\nimport useBuildSetting from '../useBuildSetting';\r\n\r\nexport const artifactsSlotsToSelectMainStats = [\"sands\", \"goblet\", \"circlet\"] as const\r\n\r\nexport default function MainStatSelectionCard({ disabled = false, }: {\r\n  disabled?: boolean\r\n}) {\r\n  const { t } = useTranslation(\"artifact\")\r\n  const { character: { key: characterKey } } = useContext(CharacterContext)\r\n  const { buildSetting: { mainStatKeys }, buildSettingDispatch } = useBuildSetting(characterKey)\r\n\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    {artifactsSlotsToSelectMainStats.map(slotKey => {\r\n      const numSel = mainStatKeys[slotKey].length\r\n      return <Box key={slotKey}>\r\n        <Divider />\r\n        <CardContent sx={{ pt: 1 }}>\r\n          <Box sx={{ display: \"flex\", gap: 1, alignItems: \"center\", pb: 1 }}>\r\n            <BootstrapTooltip placement=\"top\" title={<Typography>{t(`slotName.${slotKey}`)}</Typography>}>\r\n              <span>{artifactSlotIcon(slotKey)}</span>\r\n            </BootstrapTooltip>\r\n            <Box flexGrow={1}>\r\n              <SqBadge color=\"info\">{numSel ? `${numSel} Selected` : `Any`}</SqBadge>\r\n            </Box>\r\n            <Button color=\"error\" size=\"small\" disabled={!mainStatKeys[slotKey].length || disabled} sx={{ mt: -1, mb: -1 }}\r\n              onClick={() => buildSettingDispatch({ type: \"mainStatKey\", slotKey })}>\r\n              <Replay />\r\n            </Button>\r\n          </Box>\r\n          <Grid container spacing={1}>\r\n            {Artifact.slotMainStats(slotKey).map((mainStatKey, i) => {\r\n              const element = allElementsWithPhy.find(ele => mainStatKey.includes(ele))\r\n              const color = mainStatKeys[slotKey].includes(mainStatKey)\r\n                ? element ?? \"success\"\r\n                : \"secondary\"\r\n              return <Grid item key={mainStatKey} flexGrow={1} xs={(i < 3 && slotKey !== \"goblet\") ? 4 : undefined} >\r\n                <BootstrapTooltip placement=\"top\" title={<Typography><strong><StatColoredWithUnit statKey={mainStatKey} /></strong></Typography>} disableInteractive>\r\n                  <Button fullWidth size=\"small\" color={color} sx={{ fontSize: \"1.2em\", height: \"100%\", pointerEvents: disabled ? \"none\" : undefined, cursor: disabled ? \"none\" : undefined }}\r\n                    onClick={() => buildSettingDispatch({ type: \"mainStatKey\", slotKey, mainStatKey })}>\r\n                    {StatIcon[mainStatKey]}\r\n                  </Button>\r\n                </BootstrapTooltip>\r\n              </Grid>\r\n            })}\r\n          </Grid>\r\n        </CardContent>\r\n      </Box>\r\n    })}\r\n  </Box >\r\n}\r\n","import { Box, CardContent, Typography } from \"@mui/material\"\r\nimport { useCallback, useContext, useMemo } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport CardLight from \"../../../../../Components/Card/CardLight\"\r\nimport InfoTooltip from \"../../../../../Components/InfoTooltip\"\r\nimport StatEditorList from \"../../../../../Components/StatEditorList\"\r\nimport { CharacterContext } from \"../../../../../Context/CharacterContext\"\r\nimport { DataContext } from \"../../../../../Context/DataContext\"\r\nimport { input } from \"../../../../../Formula\"\r\nimport { StatKey } from \"../../../../../KeyMap\"\r\nimport { ElementKey, WeaponTypeKey } from \"../../../../../Types/consts\"\r\nimport useBuildSetting from \"../useBuildSetting\"\r\n\r\nexport default function StatFilterCard({ disabled = false }: { disabled?: boolean }) {\r\n  const { t } = useTranslation(\"page_character_optimize\")\r\n  const { character: { key: characterKey } } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n  const { buildSetting: { statFilters }, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const setStatFilters = useCallback((statFilters: Dict<StatKey, number>) => buildSettingDispatch({ statFilters }), [buildSettingDispatch],)\r\n\r\n  const statKeys = useMemo(() => {\r\n    const statKeys: StatKey[] = [\"atk\", \"hp\", \"def\", \"eleMas\", \"critRate_\", \"critDMG_\", \"heal_\", \"enerRech_\"]\r\n    if (data.get(input.weaponType).value as WeaponTypeKey !== \"catalyst\") statKeys.push(\"physical_dmg_\")\r\n    const charEle = data.get(input.charEle).value as ElementKey\r\n    statKeys.push(`${charEle}_dmg_`)\r\n    return statKeys\r\n  }, [data])\r\n\r\n\r\n  return <Box>\r\n    <CardLight>\r\n      <CardContent sx={{ display: \"flex\", gap: 1, justifyContent: \"space-between\" }}>\r\n        <Typography>{t`constraintFilter.title`}</Typography>\r\n        <InfoTooltip title={<Typography>{t`constraintFilter.tooltip`}</Typography>} />\r\n      </CardContent>\r\n    </CardLight>\r\n    <Box display=\"flex\" flexDirection=\"column\" gap={0.5}>\r\n      <StatEditorList statKeys={statKeys} statFilters={statFilters} setStatFilters={setStatFilters} disabled={disabled} />\r\n    </Box>\r\n  </Box>\r\n}\r\n","import { Add, CheckBox, CheckBoxOutlineBlank, Close, KeyboardArrowDown, KeyboardArrowUp, KeyboardDoubleArrowDown, KeyboardDoubleArrowUp, Replay, Settings } from \"@mui/icons-material\";\r\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, Typography } from \"@mui/material\";\r\nimport React, { Suspense, useCallback, useContext, useEffect, useMemo, useState } from \"react\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport ArtifactCardPico from \"../../../../../Components/Artifact/ArtifactCardPico\";\r\nimport CardDark from \"../../../../../Components/Card/CardDark\";\r\nimport CardLight from \"../../../../../Components/Card/CardLight\";\r\nimport CharacterCardPico from \"../../../../../Components/Character/CharacterCardPico\";\r\nimport CloseButton from \"../../../../../Components/CloseButton\";\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"../../../../../Components/CustomNumberInput\";\r\nimport ModalWrapper from \"../../../../../Components/ModalWrapper\";\r\nimport SqBadge from \"../../../../../Components/SqBadge\";\r\nimport WeaponCardPico from \"../../../../../Components/Weapon/WeaponCardPico\";\r\nimport { CharacterContext } from \"../../../../../Context/CharacterContext\";\r\nimport { DatabaseContext } from \"../../../../../Database/Database\";\r\nimport useBoolState from \"../../../../../ReactHooks/useBoolState\";\r\nimport useCharacter from \"../../../../../ReactHooks/useCharacter\";\r\nimport useCharSelectionCallback from \"../../../../../ReactHooks/useCharSelectionCallback\";\r\nimport { ICachedCharacter } from \"../../../../../Types/character\";\r\nimport { CharacterKey } from \"../../../../../Types/consts\";\r\nimport useBuildSetting from \"../useBuildSetting\";\r\nconst CharacterSelectionModal = React.lazy(() => import('../../../../CharacterSelectionModal'))\r\n\r\nexport default function UseEquipped({ disabled = false }: { disabled?: boolean }) {\r\n  const { t } = useTranslation(\"page_character_optimize\")\r\n  const { character: { key: characterKey } } = useContext(CharacterContext)\r\n  const { buildSetting: { useEquippedArts }, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState(false)\r\n  const [{ equipmentPriority: tempEquipmentPriority }, setTO] = useState(database.displayOptimize.get())\r\n  useEffect(() => database.displayOptimize.follow((r, to) => setTO(to)), [database, setTO])\r\n  //Basic validate for the equipmentPrio list to remove dups and characters that doesnt exist.\r\n  const equipmentPriority = useMemo(() => [...new Set(tempEquipmentPriority)].filter(ck => database.chars.get(ck)), [database, tempEquipmentPriority])\r\n  const setPrio = useCallback((equipmentPriority: CharacterKey[]) => database.displayOptimize.set({ equipmentPriority }), [database])\r\n\r\n  const setPrioRank = useCallback((fromIndex, toIndex) => {\r\n    const arr = [...equipmentPriority]\r\n    var element = arr[fromIndex];\r\n    arr.splice(fromIndex, 1);\r\n    arr.splice(toIndex, 0, element);\r\n    setPrio(arr)\r\n  }, [equipmentPriority, setPrio])\r\n  const removePrio = useCallback((fromIndex) => {\r\n    const arr = [...equipmentPriority]\r\n    arr.splice(fromIndex, 1)\r\n    setPrio(arr)\r\n  }, [equipmentPriority, setPrio])\r\n  const addPrio = useCallback((ck: CharacterKey) => setPrio([...equipmentPriority, ck]), [equipmentPriority, setPrio])\r\n  const resetPrio = useCallback(() => setPrio([]), [setPrio])\r\n\r\n  const numAbove = useMemo(() => {\r\n    let numAbove = equipmentPriority.length\r\n    const index = equipmentPriority.indexOf(characterKey)\r\n    if (index >= 0) numAbove = index\r\n    return numAbove\r\n  }, [characterKey, equipmentPriority])\r\n  const numUseEquippedChar = useMemo(() => {\r\n    return database.chars.keys.length - 1 - numAbove\r\n  }, [numAbove, database])\r\n  const numUnlisted = useMemo(() => {\r\n    return database.chars.keys.length - equipmentPriority.length\r\n  }, [equipmentPriority, database])\r\n\r\n  return <Box display=\"flex\" gap={1}>\r\n    <ModalWrapper open={show} onClose={onClose} containerProps={{ maxWidth: \"sm\" }}><CardDark>\r\n      <CardContent>\r\n        <Grid container spacing={1}>\r\n          <Grid item flexGrow={1}>\r\n            <Typography variant=\"h6\">{t`useEquipped.modal.title`}</Typography>\r\n          </Grid>\r\n          <Grid item sx={{ mb: -1 }}>\r\n            <CloseButton onClick={onClose} />\r\n          </Grid>\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent>\r\n        <CardLight sx={{ mb: 1 }}>\r\n          <CardContent>\r\n            <Typography gutterBottom><Trans t={t} i18nKey=\"useEquipped.modal.desc1\">When generating a build, the Optimizer will only consider equipped artifacts from characters below the current character or those not on the list.</Trans></Typography>\r\n            <Typography gutterBottom><Trans t={t} i18nKey=\"useEquipped.modal.desc2\">If the current character is not on the list, the Optimizer will only consider equipped artifacts from others characters that are not on the list.</Trans></Typography>\r\n          </CardContent>\r\n        </CardLight>\r\n        <Box display=\"flex\" flexDirection=\"column\" gap={2}>\r\n          {equipmentPriority.map((ck, i) =>\r\n            <SelectItem key={ck} characterKey={ck} rank={i + 1} maxRank={equipmentPriority.length} setRank={(num) => num && setPrioRank(i, num - 1)} onRemove={() => removePrio(i)} numAbove={numAbove} />)}\r\n          <Box sx={{ display: \"flex\", gap: 1 }}>\r\n            <NewItem onAdd={addPrio} list={equipmentPriority} />\r\n            <Button color=\"error\" onClick={resetPrio} startIcon={<Replay />}><Trans t={t} i18nKey=\"useEquipped.modal.clearList\">Clear List</Trans></Button>\r\n          </Box>\r\n          {!!numUseEquippedChar && <SqBadge color=\"success\"><Typography><Trans t={t} i18nKey=\"useEquipped.modal.usingNum\" count={numUnlisted}>Using artifacts from <strong>{{ count: numUnlisted }}</strong> unlisted characters</Trans></Typography></SqBadge>}\r\n        </Box>\r\n      </CardContent>\r\n    </CardDark ></ModalWrapper>\r\n    <ButtonGroup sx={{ display: \"flex\", width: \"100%\" }}>\r\n      <Button sx={{ flexGrow: 1 }} onClick={() => buildSettingDispatch({ useEquippedArts: !useEquippedArts })} disabled={disabled} startIcon={useEquippedArts ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useEquippedArts ? \"success\" : \"secondary\"}>\r\n        <Box>\r\n          <span><Trans t={t} i18nKey=\"useEquipped.title\">Use Equipped Artifacts</Trans></span>\r\n          {useEquippedArts && <SqBadge><Trans t={t} i18nKey=\"useEquipped.usingNum\" count={numUseEquippedChar}>Using from <strong>{{ count: numUseEquippedChar }}</strong> characters</Trans></SqBadge>}\r\n        </Box>\r\n      </Button>\r\n      {useEquippedArts && <Button sx={{ flexShrink: 1 }} color=\"info\" onClick={onOpen} disabled={disabled}><Settings /></Button>}\r\n    </ButtonGroup>\r\n  </Box>\r\n}\r\n\r\nconst itemSize = 60\r\nfunction SelectItem({ characterKey, rank, maxRank, setRank, onRemove, numAbove }: {\r\n  characterKey: CharacterKey,\r\n  rank: number,\r\n  maxRank: number,\r\n  setRank: (r: number | undefined) => void,\r\n  onRemove: () => void,\r\n  numAbove: number,\r\n}) {\r\n  const { t } = useTranslation(\"page_character_optimize\")\r\n  const { database } = useContext(DatabaseContext)\r\n  const character = useCharacter(characterKey)\r\n  const onClick = useCharSelectionCallback()\r\n  if (!character) return null\r\n  const { equippedWeapon, equippedArtifacts } = character\r\n  return <CardLight sx={{ p: 1 }}  >\r\n    <Box sx={{ pb: 1, display: \"flex\", justifyContent: \"space-between\", gap: 1 }}>\r\n      <SqBadge color=\"info\">\r\n        <Typography>#{rank}</Typography>\r\n      </SqBadge>\r\n      <SqBadge sx={{ flexGrow: 1 }} color={numAbove === (rank - 1) ? \"warning\" : (rank - 1) < numAbove ? \"error\" : \"success\"}>\r\n        <Typography>{numAbove === (rank - 1) ? <Trans t={t} i18nKey=\"useEquipped.modal.status.curr\">Current character</Trans>\r\n          : (rank - 1) < numAbove ? <Trans t={t} i18nKey=\"useEquipped.modal.status.dont\">Don't Use artifacts</Trans> :\r\n            <Trans t={t} i18nKey=\"useEquipped.modal.status.use\">Use artifacts</Trans>}</Typography>\r\n      </SqBadge>\r\n      <Box>\r\n        <ButtonGroup sx={{ flexGrow: 1 }} size=\"small\">\r\n          <CustomNumberInputButtonGroupWrapper >\r\n            <CustomNumberInput onChange={setRank} value={rank}\r\n              // startAdornment=\"Rank:\"\r\n              inputProps={{ min: 1, max: maxRank, sx: { textAlign: \"center\" } }}\r\n              sx={{ width: \"100%\", height: \"100%\", pl: 2 }} />\r\n          </CustomNumberInputButtonGroupWrapper>\r\n          <Button disabled={rank === 1} onClick={() => setRank(1)} >\r\n            <KeyboardDoubleArrowUp />\r\n          </Button>\r\n          <Button disabled={rank === 1} onClick={() => setRank(rank - 1)}  >\r\n            <KeyboardArrowUp />\r\n          </Button>\r\n          <Button disabled={rank === maxRank} onClick={() => setRank(rank + 1)}  >\r\n            <KeyboardArrowDown />\r\n          </Button>\r\n          <Button disabled={rank === maxRank} onClick={() => setRank(maxRank)}  >\r\n            <KeyboardDoubleArrowDown />\r\n          </Button>\r\n          <Button color=\"error\" onClick={onRemove}>\r\n            <Close />\r\n          </Button>\r\n        </ButtonGroup>\r\n      </Box>\r\n    </Box>\r\n    <Grid container columns={7} spacing={1}>\r\n      <Grid item xs={1} >\r\n        <CharacterCardPico characterKey={characterKey} onClick={onClick} />\r\n      </Grid>\r\n      <Grid item xs={1}><WeaponCardPico weaponId={equippedWeapon} /></Grid>\r\n      {Object.entries(equippedArtifacts).map(([slotKey, aId]) => <Grid item xs={1} key={slotKey} ><ArtifactCardPico slotKey={slotKey} artifactObj={database.arts.get(aId)} /></Grid>)}\r\n    </Grid>\r\n\r\n  </CardLight>\r\n}\r\nfunction NewItem({ onAdd, list }: { onAdd: (ck: CharacterKey) => void, list: CharacterKey[] }) {\r\n  const { t } = useTranslation(\"page_character_optimize\")\r\n  const [show, onOpen, onClose] = useBoolState(false)\r\n  const filter = useCallback((char?: ICachedCharacter) => {\r\n    if (!char) return false\r\n    return !list.includes(char.key)\r\n  }, [list])\r\n  return <>\r\n    <Suspense fallback={false}>\r\n      <CharacterSelectionModal show={show} onHide={onClose} onSelect={onAdd} filter={filter} />\r\n    </Suspense>\r\n    <Button fullWidth sx={{ height: itemSize }} color=\"info\" onClick={onOpen} startIcon={<Add />} >\r\n      <Trans t={t} i18nKey=\"useEquipped.modal.add\">Add character to list</Trans>\r\n    </Button>\r\n  </>\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank } from \"@mui/icons-material\";\r\nimport { Box, Button } from \"@mui/material\";\r\nimport { useContext, useMemo } from \"react\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport { CharacterContext } from \"../../../../../Context/CharacterContext\";\r\nimport SqBadge from \"../../../../../Components/SqBadge\";\r\nimport { DatabaseContext } from \"../../../../../Database/Database\";\r\nimport useBuildSetting from \"../useBuildSetting\";\r\n\r\nexport default function UseExcluded({ disabled = false, artsDirty }: { disabled?: boolean, artsDirty: object }) {\r\n  const { t } = useTranslation(\"page_character_optimize\")\r\n  const { character: { key: characterKey } } = useContext(CharacterContext)\r\n  const { buildSetting: { useExcludedArts }, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const { database } = useContext(DatabaseContext)\r\n  const numExcludedArt = useMemo(() => artsDirty && database.arts.values.reduce((a, art) => a + ((art.exclude && art.location !== characterKey) ? 1 : 0), 0), [database, artsDirty, characterKey])\r\n  return <Button fullWidth onClick={() => buildSettingDispatch({ useExcludedArts: !useExcludedArts })} disabled={!numExcludedArt || disabled} startIcon={useExcludedArts ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useExcludedArts ? \"success\" : \"secondary\"}>\r\n    <Box>\r\n      <span><Trans t={t} i18nKey=\"useExcluded.title\" count={numExcludedArt}>Use Excluded Artifacts</Trans></span>\r\n      {useExcludedArts && <SqBadge><Trans t={t} i18nKey=\"useExcluded.usingNum\" count={numExcludedArt}>Using <strong>{{ count: numExcludedArt }}</strong> excluded artifacts</Trans></SqBadge>}\r\n    </Box>\r\n  </Button>\r\n}\r\n","import Artifact from \"../../../../Data/Artifacts/Artifact\";\r\nimport { input } from \"../../../../Formula\";\r\nimport { computeUIData } from \"../../../../Formula/api\";\r\nimport { formulaString } from \"../../../../Formula/debug\";\r\nimport { Data, NumNode } from \"../../../../Formula/type\";\r\nimport { constant, setReadNodeKeys } from \"../../../../Formula/utils\";\r\nimport { allMainStatKeys, allSubstatKeys, ICachedArtifact } from \"../../../../Types/artifact\";\r\nimport { deepClone, objectKeyMap, objectMap } from \"../../../../Util/Util\";\r\nimport type { ArtifactBuildData, ArtifactsBySlot, DynStat } from \"./common\";\r\n\r\nconst dynamic = setReadNodeKeys(deepClone({ dyn: { ...input.art, ...input.artSet } }))\r\nexport const dynamicData = {\r\n  art: objectKeyMap([...allMainStatKeys, ...allSubstatKeys], key => dynamic.dyn[key]),\r\n  artSet: objectMap(input.artSet, (_, key) => dynamic.dyn[key]),\r\n}\r\n\r\nexport function compactArtifacts(arts: ICachedArtifact[], mainStatAssumptionLevel: number, allowPartial: boolean): ArtifactsBySlot {\r\n  const result: ArtifactsBySlot = {\r\n    base: {},\r\n    values: { flower: [], plume: [], goblet: [], circlet: [], sands: [] }\r\n  }\r\n  const keys = new Set<string>()\r\n\r\n  for (const art of arts) {\r\n    const mainStatVal = Artifact.mainStatValue(art.mainStatKey, art.rarity, Math.max(Math.min(mainStatAssumptionLevel, art.rarity * 4), art.level))\r\n\r\n    const data: ArtifactBuildData = {\r\n      id: art.id, set: art.setKey,\r\n      values: {\r\n        [art.setKey]: 1,\r\n        [art.mainStatKey]: art.mainStatKey.endsWith('_') ? mainStatVal / 100 : mainStatVal,\r\n        ...Object.fromEntries(art.substats.map(substat =>\r\n          [substat.key, substat.key.endsWith('_') ? substat.accurateValue / 100 : substat.accurateValue]))\r\n      },\r\n    }\r\n    delete data.values[\"\"]\r\n    result.values[art.slotKey].push(data)\r\n    Object.keys(data.values).forEach(x => keys.add(x))\r\n  }\r\n  result.base = objectKeyMap([...keys], _ => 0)\r\n  if (allowPartial)\r\n    for (const value of Object.values(result.values))\r\n      value.push({ id: \"\", values: {} })\r\n  return result\r\n}\r\n\r\nexport function debugCompute(nodes: NumNode[], base: DynStat, arts: ArtifactBuildData[]) {\r\n  const stats = { ...base }\r\n  for (const art of arts) {\r\n    for (const [key, value] of Object.entries(art.values)) {\r\n      stats[key] = (stats[key] ?? 0) + value\r\n    }\r\n  }\r\n  const data = { dyn: Object.fromEntries(Object.entries(stats).map(([key, value]) => [key, constant(value)])) } as Data\r\n  const uiData = computeUIData([data])\r\n  return {\r\n    base, arts, stats,\r\n    data, uiData,\r\n    nodes: nodes.map(formulaString),\r\n    results: nodes.map(node => uiData.get(node)),\r\n  }\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank, Close, Science, TrendingUp } from '@mui/icons-material';\r\nimport { Alert, Box, Button, ButtonGroup, CardContent, Divider, Grid, Link, MenuItem, Skeleton, ToggleButton, Typography } from '@mui/material';\r\nimport React, { Suspense, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { Trans, useTranslation } from 'react-i18next';\r\nimport { Link as RouterLink, useLocation, useNavigate } from 'react-router-dom';\r\nimport ArtifactLevelSlider from '../../../../Components/Artifact/ArtifactLevelSlider';\r\nimport BootstrapTooltip from '../../../../Components/BootstrapTooltip';\r\nimport CardLight from '../../../../Components/Card/CardLight';\r\nimport CharacterCard from '../../../../Components/Character/CharacterCard';\r\nimport DropdownButton from '../../../../Components/DropdownMenu/DropdownButton';\r\nimport { HitModeToggle, ReactionToggle } from '../../../../Components/HitModeEditor';\r\nimport SolidToggleButtonGroup from '../../../../Components/SolidToggleButtonGroup';\r\nimport { CharacterContext } from '../../../../Context/CharacterContext';\r\nimport { DataContext, dataContextObj } from '../../../../Context/DataContext';\r\nimport { OptimizationTargetContext } from '../../../../Context/OptimizationTargetContext';\r\nimport { DatabaseContext } from '../../../../Database/Database';\r\nimport { defThreads } from '../../../../Database/DataEntries/DisplayOptimizeEntry';\r\nimport { mergeData, uiDataForTeam } from '../../../../Formula/api';\r\nimport { uiInput as input } from '../../../../Formula/index';\r\nimport { optimize } from '../../../../Formula/optimization';\r\nimport { NumNode } from '../../../../Formula/type';\r\nimport { UIData } from '../../../../Formula/uiData';\r\nimport useCharacterReducer from '../../../../ReactHooks/useCharacterReducer';\r\nimport useCharSelectionCallback from '../../../../ReactHooks/useCharSelectionCallback';\r\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate';\r\nimport useMediaQueryUp from '../../../../ReactHooks/useMediaQueryUp';\r\nimport useTeamData, { getTeamData } from '../../../../ReactHooks/useTeamData';\r\nimport { CharacterKey, charKeyToLocCharKey, LocationCharacterKey } from '../../../../Types/consts';\r\nimport { objPathValue, range } from '../../../../Util/Util';\r\nimport { FinalizeResult, Setup, WorkerCommand, WorkerResult } from './BackgroundWorker';\r\nimport { maxBuildsToShowList } from './Build';\r\nimport { artSetPerm, Build, filterFeasiblePerm, mergeBuilds, mergePlot, pruneAll, pruneExclusion, RequestFilter } from './common';\r\nimport ArtifactSetConfig from './Components/ArtifactSetConfig';\r\nimport AssumeFullLevelToggle from './Components/AssumeFullLevelToggle';\r\nimport BonusStatsCard from './Components/BonusStatsCard';\r\nimport BuildAlert, { BuildStatus } from './Components/BuildAlert';\r\nimport BuildDisplayItem from './Components/BuildDisplayItem';\r\nimport ChartCard, { ChartData } from './Components/ChartCard';\r\nimport MainStatSelectionCard from './Components/MainStatSelectionCard';\r\nimport OptimizationTargetSelector from './Components/OptimizationTargetSelector';\r\nimport StatFilterCard from './Components/StatFilterCard';\r\nimport UseEquipped from './Components/UseEquipped';\r\nimport UseExcluded from './Components/UseExcluded';\r\nimport { compactArtifacts, dynamicData } from './foreground';\r\nimport useBuildResult from './useBuildResult';\r\nimport useBuildSetting from './useBuildSetting';\r\n\r\nexport default function TabBuild() {\r\n  const { t } = useTranslation(\"page_character_optimize\")\r\n  const { character: { key: characterKey, compareData } } = useContext(CharacterContext)\r\n  const { database } = useContext(DatabaseContext)\r\n\r\n  const [buildStatus, setBuildStatus] = useState({ type: \"inactive\", tested: 0, failed: 0, skipped: 0, total: 0 } as BuildStatus)\r\n  const generatingBuilds = buildStatus.type !== \"inactive\"\r\n\r\n  const [chartData, setchartData] = useState(undefined as ChartData | undefined)\r\n\r\n  const [artsDirty, setArtsDirty] = useForceUpdate()\r\n\r\n  const [{ equipmentPriority, threads = defThreads }, setDisplayOptimize] = useState(database.displayOptimize.get())\r\n  useEffect(() => database.displayOptimize.follow((r, to) => setDisplayOptimize(to)), [database, setDisplayOptimize])\r\n\r\n  const maxWorkers = threads > defThreads ? defThreads : threads\r\n  const setMaxWorkers = useCallback(threads => database.displayOptimize.set({ threads }), [database],)\r\n\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const onClickTeammate = useCharSelectionCallback()\r\n\r\n  const noArtifact = useMemo(() => !database.arts.values.length, [database])\r\n\r\n  const { buildSetting, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const { plotBase, optimizationTarget, mainStatAssumptionLevel, allowPartial, maxBuildsToShow, levelLow, levelHigh } = buildSetting\r\n  const { buildResult: { builds, buildDate }, buildResultDispatch } = useBuildResult(characterKey)\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel)\r\n  const { characterSheet, target: data } = teamData?.[characterKey as CharacterKey] ?? {}\r\n  const isSM = [\"xs\", \"sm\"].includes(useMediaQueryUp())\r\n\r\n  //register changes in artifact database\r\n  useEffect(() =>\r\n    database.arts.followAny(setArtsDirty),\r\n    [setArtsDirty, database])\r\n\r\n  // Provides a function to cancel the work\r\n  const cancelToken = useRef(() => { })\r\n  //terminate worker when component unmounts\r\n  useEffect(() => () => cancelToken.current(), [])\r\n  const generateBuilds = useCallback(async () => {\r\n    const { artSetExclusion, plotBase, statFilters, mainStatKeys, optimizationTarget, mainStatAssumptionLevel, useExcludedArts, useEquippedArts, allowPartial, maxBuildsToShow, levelLow, levelHigh } = buildSetting\r\n    if (!characterKey || !optimizationTarget) return\r\n\r\n    let cantTakeList: Set<LocationCharacterKey> = new Set()\r\n    if (useEquippedArts) {\r\n      const index = equipmentPriority.indexOf(characterKey)\r\n      if (index < 0) equipmentPriority.forEach(ek => cantTakeList.add(charKeyToLocCharKey(ek)))\r\n      else equipmentPriority.slice(0, index).forEach(ek => cantTakeList.add(charKeyToLocCharKey(ek)))\r\n    }\r\n    const filteredArts = database.arts.values.filter(art => {\r\n      if (art.level < levelLow) return false\r\n      if (art.level > levelHigh) return false\r\n      const mainStats = mainStatKeys[art.slotKey]\r\n      if (mainStats?.length && !mainStats.includes(art.mainStatKey)) return false\r\n\r\n      // If its equipped on the selected character, bypass the check\r\n      if (art.location === charKeyToLocCharKey(characterKey)) return true\r\n\r\n      if (art.exclude && !useExcludedArts) return false\r\n      if (art.location && !useEquippedArts) return false\r\n      if (art.location && useEquippedArts && cantTakeList.has(art.location)) return false\r\n      return true\r\n    })\r\n    const split = compactArtifacts(filteredArts, mainStatAssumptionLevel, allowPartial)\r\n\r\n    const teamData = await getTeamData(database, characterKey, mainStatAssumptionLevel, [])\r\n    if (!teamData) return\r\n    const workerData = uiDataForTeam(teamData.teamData, characterKey)[characterKey as CharacterKey]?.target.data![0]\r\n    if (!workerData) return\r\n    Object.assign(workerData, mergeData([workerData, dynamicData])) // Mark art fields as dynamic\r\n    let unoptimizedOptimizationTargetNode = objPathValue(workerData.display ?? {}, optimizationTarget) as NumNode | undefined\r\n    if (!unoptimizedOptimizationTargetNode) return\r\n    const targetNode = unoptimizedOptimizationTargetNode\r\n    const valueFilter: { value: NumNode, minimum: number }[] = Object.entries(statFilters).map(([key, value]) => {\r\n      if (key.endsWith(\"_\")) value = value / 100 // TODO: Conversion\r\n      return { value: input.total[key], minimum: value }\r\n    }).filter(x => x.value && x.minimum > -Infinity)\r\n\r\n    setchartData(undefined)\r\n\r\n    const cancelled = new Promise<void>(r => cancelToken.current = r)\r\n\r\n    let unoptimizedNodes = [...valueFilter.map(x => x.value), unoptimizedOptimizationTargetNode], arts = split!\r\n    const setPerms = filterFeasiblePerm(artSetPerm(artSetExclusion, Object.values(split.values).flatMap(x => x.map(x => x.set!))), split)\r\n\r\n    const minimum = [...valueFilter.map(x => x.minimum), -Infinity]\r\n    const status: Omit<BuildStatus, \"type\"> = { tested: 0, failed: 0, skipped: 0, total: NaN, startTime: performance.now() }\r\n    if (plotBase) {\r\n      unoptimizedNodes.push(objPathValue(workerData.display ?? {}, plotBase))\r\n      minimum.push(-Infinity)\r\n    }\r\n\r\n    const prepruneArts = arts\r\n    let nodes = optimize(unoptimizedNodes, workerData, ({ path: [p] }) => p !== \"dyn\")\r\n    nodes = pruneExclusion(nodes, artSetExclusion);\r\n    ({ nodes, arts } = pruneAll(nodes, minimum, arts, maxBuildsToShow, artSetExclusion, {\r\n      reaffine: true, pruneArtRange: true, pruneNodeRange: true, pruneOrder: true\r\n    }))\r\n    nodes = optimize(nodes, {}, _ => false)\r\n\r\n    const plotBaseNode = plotBase ? nodes.pop() : undefined\r\n    let optimizationTargetNode = nodes.pop()!\r\n\r\n    const wrap = { buildValues: Array(maxBuildsToShow).fill(0).map(_ => ({ src: \"\", val: -Infinity })) }\r\n\r\n    const minFilterCount = 16_000_000, maxRequestFilterInFlight = maxWorkers * 16\r\n    const unprunedFilters = setPerms[Symbol.iterator](), requestFilters: RequestFilter[] = []\r\n    const idleWorkers: number[] = [], splittingWorkers = new Set<number>()\r\n    const workers: Worker[] = []\r\n\r\n    function getThreshold(): number {\r\n      return wrap.buildValues[maxBuildsToShow - 1].val\r\n    }\r\n    function fetchContinueWork(): WorkerCommand {\r\n      return { command: \"split\", filter: undefined, minCount: minFilterCount, threshold: getThreshold() }\r\n    }\r\n    function fetchPruningWork(): WorkerCommand | undefined {\r\n      const { done, value } = unprunedFilters.next()\r\n      return done ? undefined : {\r\n        command: \"split\", minCount: minFilterCount,\r\n        threshold: getThreshold(), filter: value,\r\n      }\r\n    }\r\n    function fetchRequestWork(): WorkerCommand | undefined {\r\n      const filter = requestFilters.pop()\r\n      return !filter ? undefined : {\r\n        command: \"iterate\",\r\n        threshold: getThreshold(), filter\r\n      }\r\n    }\r\n\r\n    const filters = nodes\r\n      .map((value, i) => ({ value, min: minimum[i] }))\r\n      .filter(x => x.min > -Infinity)\r\n\r\n    const finalizedList: Promise<FinalizeResult>[] = []\r\n    for (let i = 0; i < maxWorkers; i++) {\r\n      const worker = new Worker(new URL('./BackgroundWorker.ts', import.meta.url))\r\n\r\n      const setup: Setup = {\r\n        command: \"setup\",\r\n        id: i, arts,\r\n        optimizationTarget: optimizationTargetNode,\r\n        plotBase: plotBaseNode,\r\n        maxBuilds: maxBuildsToShow,\r\n        filters\r\n      }\r\n      worker.postMessage(setup, undefined)\r\n      if (i === 0) {\r\n        const countCommand: WorkerCommand = { command: \"count\", exclusion: artSetExclusion, arts: [arts, prepruneArts] }\r\n        worker.postMessage(countCommand, undefined)\r\n      }\r\n      let finalize: (_: FinalizeResult) => void\r\n      const finalized = new Promise<FinalizeResult>(r => finalize = r)\r\n      worker.onmessage = async ({ data }: { data: { id: number } & WorkerResult }) => {\r\n        switch (data.command) {\r\n          case \"interim\":\r\n            status.tested += data.tested\r\n            status.failed += data.failed\r\n            status.skipped += data.skipped\r\n            if (data.buildValues) {\r\n              wrap.buildValues = wrap.buildValues.filter(({ src }) => src !== data.source)\r\n              wrap.buildValues.push(...data.buildValues.map(val => ({ src: data.source, val })))\r\n              wrap.buildValues.sort((a, b) => b.val - a.val).splice(maxBuildsToShow)\r\n            }\r\n            break\r\n          case \"split\":\r\n            if (data.filter) {\r\n              requestFilters.push(data.filter)\r\n              splittingWorkers.add(data.id)\r\n            } else splittingWorkers.delete(data.id)\r\n            idleWorkers.push(data.id)\r\n            break\r\n          case \"iterate\":\r\n            idleWorkers.push(data.id)\r\n            break\r\n          case \"finalize\":\r\n            worker.terminate()\r\n            finalize(data);\r\n            return\r\n          case \"count\":\r\n            const [pruned, prepruned] = data.counts\r\n            status.total = prepruned\r\n            status.skipped += prepruned - pruned\r\n            return\r\n          default: console.log(\"DEBUG\", data)\r\n        }\r\n        while (idleWorkers.length) {\r\n          const id = idleWorkers.pop()!, worker = workers[id]\r\n          let work: WorkerCommand | undefined\r\n          if (requestFilters.length < maxRequestFilterInFlight) {\r\n            work = fetchPruningWork()\r\n            if (!work && splittingWorkers.has(id)) work = fetchContinueWork()\r\n          }\r\n          if (!work) work = fetchRequestWork()\r\n          if (work) worker.postMessage(work)\r\n          else {\r\n            idleWorkers.push(id)\r\n            if (idleWorkers.length === 4 * maxWorkers) {\r\n              const command: WorkerCommand = { command: \"finalize\" }\r\n              workers.forEach(worker => worker.postMessage(command))\r\n            }\r\n            break\r\n          }\r\n        }\r\n      }\r\n\r\n      workers.push(worker)\r\n      cancelled.then(() => worker.terminate())\r\n      finalizedList.push(finalized)\r\n    }\r\n    for (let i = 0; i < 3; i++)\r\n      idleWorkers.push(...range(0, maxWorkers - 1))\r\n\r\n    const buildTimer = setInterval(() => setBuildStatus({ type: \"active\", ...status }), 100)\r\n    const results = await Promise.any([Promise.all(finalizedList), cancelled])\r\n    clearInterval(buildTimer)\r\n    cancelToken.current = () => { }\r\n\r\n    if (!results) {\r\n      status.tested = 0\r\n      status.failed = 0\r\n      status.skipped = 0\r\n      status.total = 0\r\n    } else {\r\n      if (plotBase) {\r\n        const plotData = mergePlot(results.map(x => x.plotData!))\r\n        const plotBaseNode = objPathValue(workerData.display ?? {}, plotBase) as NumNode\r\n        let data = Object.values(plotData)\r\n        if (targetNode.info?.unit === \"%\")\r\n          data = data.map(({ value, plot }) => ({ value: value * 100, plot })) as Build[]\r\n        if (plotBaseNode.info?.unit === \"%\")\r\n          data = data.map(({ value, plot }) => ({ value, plot: (plot ?? 0) * 100 })) as Build[]\r\n        setchartData({\r\n          valueNode: targetNode,\r\n          plotNode: plotBaseNode,\r\n          data\r\n        })\r\n      }\r\n      const builds = mergeBuilds(results.map(x => x.builds), maxBuildsToShow)\r\n      if (process.env.NODE_ENV === \"development\") console.log(\"Build Result\", builds)\r\n      buildResultDispatch({ builds: builds.map(build => build.artifactIds), buildDate: Date.now() })\r\n    }\r\n    setBuildStatus({ ...status, type: \"inactive\", finishTime: performance.now() })\r\n  }, [characterKey, database, buildResultDispatch, maxWorkers, buildSetting, equipmentPriority])\r\n\r\n  const characterName = characterSheet?.name ?? \"Character Name\"\r\n\r\n  const setPlotBase = useCallback(plotBase => {\r\n    buildSettingDispatch({ plotBase })\r\n    setchartData(undefined)\r\n  }, [buildSettingDispatch])\r\n  const dataContext: dataContextObj | undefined = useMemo(() => {\r\n    return data && teamData && { data, teamData }\r\n  }, [data, teamData])\r\n\r\n  const targetSelector = <OptimizationTargetSelector\r\n    optimizationTarget={optimizationTarget}\r\n    setTarget={target => buildSettingDispatch({ optimizationTarget: target })}\r\n    disabled={!!generatingBuilds}\r\n  />\r\n\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    {noArtifact && <Alert severity=\"warning\" variant=\"filled\"> Opps! It looks like you haven't added any artifacts to LB yet! You should go to the <Link component={RouterLink} to=\"/artifact\">Artifacts</Link> page and add some!</Alert>}\r\n    {/* Build Generator Editor */}\r\n    {dataContext && <DataContext.Provider value={dataContext}>\r\n\r\n      <Grid container spacing={1} >\r\n        {/* 1*/}\r\n        <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          {/* character card */}\r\n          <Box><CharacterCard characterKey={characterKey} onClickTeammate={onClickTeammate} /></Box>\r\n        </Grid>\r\n\r\n        {/* 2 */}\r\n        <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          <CardLight>\r\n            <CardContent  >\r\n              <Typography gutterBottom>{t`mainStat.title`}</Typography>\r\n              <BootstrapTooltip placement=\"top\" title={<Box>\r\n                <Typography variant=\"h6\">{t`mainStat.levelAssTooltip.title`}</Typography>\r\n                <Typography>{t`mainStat.levelAssTooltip.desc`}</Typography>\r\n              </Box>}>\r\n                <Box>\r\n                  <AssumeFullLevelToggle mainStatAssumptionLevel={mainStatAssumptionLevel} setmainStatAssumptionLevel={mainStatAssumptionLevel => buildSettingDispatch({ mainStatAssumptionLevel })} disabled={generatingBuilds} />\r\n                </Box>\r\n              </BootstrapTooltip>\r\n            </CardContent>\r\n            {/* main stat selector */}\r\n            <MainStatSelectionCard disabled={generatingBuilds} />\r\n          </CardLight>\r\n          <BonusStatsCard />\r\n        </Grid>\r\n\r\n        {/* 3 */}\r\n        <Grid item xs={12} sm={6} lg={6} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          <ArtifactSetConfig disabled={generatingBuilds} />\r\n\r\n          {/* use excluded */}\r\n          <UseExcluded disabled={generatingBuilds} artsDirty={artsDirty} />\r\n\r\n          {/* use equipped */}\r\n          <UseEquipped disabled={generatingBuilds} />\r\n\r\n          <Button\r\n            fullWidth\r\n            startIcon={allowPartial ? <CheckBox /> : <CheckBoxOutlineBlank />}\r\n            color={allowPartial ? \"success\" : \"secondary\"}\r\n            onClick={() => buildSettingDispatch({ allowPartial: !allowPartial })}\r\n            disabled={generatingBuilds}\r\n          >\r\n              {t`allowPartial`}\r\n          </Button>\r\n          { /* Level Filter */}\r\n          <CardLight>\r\n            <CardContent>{t`levelFilter`}</CardContent>\r\n            <ArtifactLevelSlider levelLow={levelLow} levelHigh={levelHigh}\r\n              setLow={levelLow => buildSettingDispatch({ levelLow })}\r\n              setHigh={levelHigh => buildSettingDispatch({ levelHigh })}\r\n              setBoth={(levelLow, levelHigh) => buildSettingDispatch({ levelLow, levelHigh })}\r\n              disabled={generatingBuilds}\r\n            />\r\n          </CardLight>\r\n\r\n          {/*Minimum Final Stat Filter */}\r\n          <StatFilterCard disabled={generatingBuilds} />\r\n\r\n        </Grid>\r\n      </Grid>\r\n      {/* Footer */}\r\n      {isSM && targetSelector}\r\n      <ButtonGroup>\r\n        {!isSM && targetSelector}\r\n        <DropdownButton disabled={generatingBuilds || !characterKey}\r\n          title={<Trans t={t} i18nKey=\"build\" count={maxBuildsToShow}>\r\n            {{ count: maxBuildsToShow }} Builds\r\n          </Trans>}>\r\n          <MenuItem>\r\n            <Typography variant=\"caption\" color=\"info.main\">\r\n              {t(\"buildDropdownDesc\")}\r\n            </Typography>\r\n          </MenuItem>\r\n          <Divider />\r\n          {maxBuildsToShowList.map(v => <MenuItem key={v}\r\n            onClick={() => buildSettingDispatch({ maxBuildsToShow: v })}>\r\n            <Trans t={t} i18nKey=\"build\" count={v}>\r\n              {{ count: v }} Builds\r\n            </Trans>\r\n          </MenuItem>)}\r\n        </DropdownButton>\r\n        <DropdownButton disabled={generatingBuilds || !characterKey}\r\n          sx={{ borderRadius: \"4px 0px 0px 4px\" }}\r\n          title={<Trans t={t} i18nKey=\"thread\" count={maxWorkers}>\r\n            {{ count: maxWorkers }} Threads\r\n          </Trans>}>\r\n          <MenuItem>\r\n            <Typography variant=\"caption\" color=\"info.main\">\r\n              {t(\"threadDropdownDesc\")}\r\n            </Typography>\r\n          </MenuItem>\r\n          <Divider />\r\n          {range(1, defThreads).reverse().map(v => <MenuItem key={v}\r\n            onClick={() => setMaxWorkers(v)}>\r\n            <Trans t={t} i18nKey=\"thread\" count={v}>\r\n              {{ count: v }} Threads\r\n            </Trans>\r\n          </MenuItem>)}\r\n        </DropdownButton>\r\n        <BootstrapTooltip placement=\"top\" title={!optimizationTarget ? t(\"selectTargetFirst\") : \"\"}>\r\n          <span>\r\n            <Button\r\n              disabled={!characterKey || !optimizationTarget || !objPathValue(data?.getDisplay(), optimizationTarget)}\r\n              color={generatingBuilds ? \"error\" : \"success\"}\r\n              onClick={generatingBuilds ? () => cancelToken.current() : generateBuilds}\r\n              startIcon={generatingBuilds ? <Close /> : <TrendingUp />}\r\n              sx={{ borderRadius: \"0px 4px 4px 0px\" }}\r\n            >{generatingBuilds ? \"Cancel\" : \"Generate Builds\"}</Button>\r\n          </span>\r\n        </BootstrapTooltip>\r\n      </ButtonGroup>\r\n\r\n      {!!characterKey && <BuildAlert {...{ status: buildStatus, characterName, maxBuildsToShow }} />}\r\n      <Box >\r\n        <ChartCard disabled={generatingBuilds || !optimizationTarget} chartData={chartData} plotBase={plotBase} setPlotBase={setPlotBase} showTooltip={!optimizationTarget} />\r\n      </Box>\r\n      <CardLight>\r\n        <CardContent>\r\n          <Box display=\"flex\" alignItems=\"center\" gap={1} mb={1} >\r\n            <Typography sx={{ flexGrow: 1 }}>\r\n              {builds ? <span>Showing <strong>{builds.length}</strong> Builds generated for {characterName}. {!!buildDate && <span>Build generated on: <strong>{(new Date(buildDate)).toLocaleString()}</strong></span>}</span>\r\n                : <span>Select a character to generate builds.</span>}\r\n            </Typography>\r\n            <Button disabled={!builds.length} color=\"error\" onClick={() => buildResultDispatch({ builds: [], buildDate: 0 })} >Clear Builds</Button>\r\n          </Box>\r\n          <Grid container display=\"flex\" spacing={1}>\r\n            <Grid item><HitModeToggle size=\"small\" /></Grid>\r\n            <Grid item><ReactionToggle size=\"small\" /></Grid>\r\n            <Grid item flexGrow={1} />\r\n            <Grid item><SolidToggleButtonGroup exclusive value={compareData} onChange={(e, v) => characterDispatch({ compareData: v })} size=\"small\">\r\n              <ToggleButton value={false} disabled={!compareData}>Show new builds</ToggleButton>\r\n              <ToggleButton value={true} disabled={compareData}>Compare vs. equipped</ToggleButton>\r\n            </SolidToggleButtonGroup></Grid>\r\n          </Grid>\r\n        </CardContent>\r\n      </CardLight>\r\n      <OptimizationTargetContext.Provider value={optimizationTarget}>\r\n        <BuildList builds={builds} characterKey={characterKey} data={data} compareData={compareData} disabled={!!generatingBuilds} />\r\n      </OptimizationTargetContext.Provider>\r\n    </DataContext.Provider>}\r\n  </Box>\r\n}\r\nfunction BuildList({ builds, characterKey, data, compareData, disabled }: {\r\n  builds: string[][],\r\n  characterKey?: \"\" | CharacterKey,\r\n  data?: UIData,\r\n  compareData: boolean,\r\n  disabled: boolean,\r\n}) {\r\n  // Memoize the build list because calculating/rendering the build list is actually very expensive, which will cause longer optimization times.\r\n  const list = useMemo(() => <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n    {builds?.map((build, index) => characterKey && data && <DataContextWrapper\r\n      key={index + build.join()}\r\n      characterKey={characterKey}\r\n      build={build}\r\n      oldData={data}\r\n    >\r\n      <BuildItemWrapper index={index} build={build} compareData={compareData} disabled={disabled} />\r\n    </DataContextWrapper>\r\n    )}\r\n  </Suspense>, [builds, characterKey, data, compareData, disabled])\r\n  return list\r\n}\r\nfunction BuildItemWrapper({ index, build, compareData, disabled }: {\r\n  index: number\r\n  build: string[],\r\n  compareData: boolean,\r\n  disabled: boolean,\r\n}) {\r\n  const location = useLocation()\r\n  const navigate = useNavigate()\r\n  const toTC = useCallback(() => {\r\n    const paths = location.pathname.split(\"/\")\r\n    paths.pop()\r\n    navigate(`${paths.join(\"/\")}/theorycraft`, { state: { build } })\r\n  }, [navigate, build, location.pathname])\r\n\r\n  return <BuildDisplayItem index={index} compareBuild={compareData} disabled={disabled}\r\n    extraButtonsLeft={<Button color=\"info\" size=\"small\" startIcon={<Science />} onClick={toTC}>Theorycraft</Button>} />\r\n}\r\n\r\ntype Prop = {\r\n  children: React.ReactNode\r\n  characterKey: CharacterKey,\r\n  build: string[],\r\n  oldData: UIData,\r\n}\r\nfunction DataContextWrapper({ children, characterKey, build, oldData }: Prop) {\r\n  const { database } = useContext(DatabaseContext)\r\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\r\n  // Update the build when the build artifacts are changed.\r\n  const [dirty, setDirty] = useForceUpdate()\r\n  useEffect(() => database.arts.followAny((id) => build.includes(id) && setDirty()), [database, build, setDirty])\r\n  const buildsArts = useMemo(() => dirty && build.map(i => database.arts.get(i)!), [dirty, build, database])\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, buildsArts)\r\n  const providerValue = useMemo(() => teamData && ({ data: teamData[characterKey]!.target, teamData, oldData }), [teamData, oldData, characterKey])\r\n  if (!providerValue) return null\r\n  return <DataContext.Provider value={providerValue}>\r\n    {children}\r\n  </DataContext.Provider>\r\n}\r\n","import { useCallback, useContext, useEffect, useState } from \"react\";\r\nimport { DatabaseContext } from \"../../../../Database/Database\";\r\nimport { IBuildResult } from \"../../../../Database/DataManagers/BuildResult\";\r\nimport { CharacterKey } from \"../../../../Types/consts\";\r\n\r\nexport default function useBuildResult(characterKey: CharacterKey) {\r\n  const { database } = useContext(DatabaseContext)\r\n  const [buildResult, setBuildResult] = useState(() => database.buildResult.get(characterKey))\r\n  useEffect(() => setBuildResult(database.buildResult.get(characterKey)), [database, characterKey])\r\n  useEffect(() =>\r\n    database.buildResult.follow(characterKey, (k, r, v) => r === \"update\" && setBuildResult(v)),\r\n    [characterKey, setBuildResult, database])\r\n  const buildResultDispatch = useCallback((action: Partial<IBuildResult>) => characterKey && database.buildResult.set(characterKey, action), [characterKey, database],)\r\n\r\n  return { buildResult, buildResultDispatch }\r\n}\r\n","import { Close, Difference } from \"@mui/icons-material\"\r\nimport { Button, Skeleton, Tooltip, Typography } from \"@mui/material\"\r\nimport { Suspense, useContext, useMemo } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { CharacterContext } from \"../../../../Context/CharacterContext\"\r\nimport { HitModeToggle, ReactionToggle } from \"../../../../Components/HitModeEditor\"\r\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\r\nimport { DatabaseContext } from \"../../../../Database/Database\"\r\nimport { DataContext } from \"../../../../Context/DataContext\"\r\nimport useBoolState from \"../../../../ReactHooks/useBoolState\"\r\nimport useTeamData from \"../../../../ReactHooks/useTeamData\"\r\nimport { objectMap } from \"../../../../Util/Util\"\r\nimport useBuildSetting from \"../TabOptimize/useBuildSetting\"\r\nimport BuildDisplayItem from \"../TabOptimize/Components/BuildDisplayItem\"\r\n\r\nexport default function CompareBuildButton({ artId, weaponId }: { artId?: string, weaponId?: string }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const [show, onShow, onHide] = useBoolState(false)\r\n\r\n  return <>\r\n    <ModalWrapper open={show} onClose={onHide} containerProps={{ maxWidth: \"xl\" }}>\r\n      <CompareContent artId={artId} weaponId={weaponId} onHide={onHide} />\r\n    </ModalWrapper>\r\n    <Tooltip title={<Typography>{t`tabEquip.compare`}</Typography>} placement=\"top\" arrow>\r\n      <Button color=\"info\" size=\"small\" onClick={onShow} ><Difference /></Button>\r\n    </Tooltip>\r\n  </>\r\n}\r\nfunction CompareContent({ artId, weaponId, onHide }: { artId?: string, weaponId?: string, onHide: () => void }) {\r\n  const { database } = useContext(DatabaseContext)\r\n  const { character: { key: characterKey, equippedArtifacts } } = useContext(CharacterContext)\r\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\r\n  const { data: oldData } = useContext(DataContext)\r\n  const build = useMemo(() => {\r\n    const newArt = database.arts.get(artId ?? \"\")\r\n    const artmap = objectMap(equippedArtifacts, (id, slot) => slot === newArt?.slotKey ? newArt : database.arts.get(id))\r\n    return Object.values(artmap).filter(a => a)\r\n  }, [database, equippedArtifacts, artId])\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, build, weaponId ? database.weapons.get(weaponId) : undefined)\r\n  const dataProviderValue = useMemo(() => teamData && ({ data: teamData[characterKey]!.target, teamData, oldData }), [characterKey, teamData, oldData])\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n    {dataProviderValue && <DataContext.Provider value={dataProviderValue}>\r\n      <BuildDisplayItem compareBuild={true} extraButtonsLeft={<><HitModeToggle size=\"small\" /><ReactionToggle size=\"small\" /></>} extraButtonsRight={<><Button size='small' color=\"error\" onClick={onHide} ><Close /></Button></>} />\r\n    </DataContext.Provider>}\r\n  </Suspense>\r\n}\r\n","import { Box, CardContent, Divider, Grid, Skeleton, Typography } from \"@mui/material\"\r\nimport { lazy, Suspense, useCallback, useContext, useEffect, useMemo, useReducer } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport Assets from \"../../../../Assets/Assets\"\r\nimport CardDark from \"../../../../Components/Card/CardDark\"\r\nimport CloseButton from \"../../../../Components/CloseButton\"\r\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\"\r\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\r\nimport { DatabaseContext } from \"../../../../Database/Database\"\r\nimport ArtifactCard from \"../../../../PageArtifact/ArtifactCard\"\r\nimport { artifactFilterConfigs, FilterOption, initialFilterOption } from \"../../../../PageArtifact/ArtifactSort\"\r\nimport useForceUpdate from \"../../../../ReactHooks/useForceUpdate\"\r\nimport useMediaQueryUp from \"../../../../ReactHooks/useMediaQueryUp\"\r\nimport { SlotKey } from \"../../../../Types/consts\"\r\nimport { filterFunction } from \"../../../../Util/SortByFilters\"\r\nimport CompareBuildButton from \"./CompareBuildButton\"\r\nconst numToShowMap = { xs: 6, sm: 6, md: 9, lg: 12, xl: 12 }\r\n\r\nconst ArtifactFilterDisplay = lazy(() => import('../../../../Components/Artifact/ArtifactFilterDisplay'))\r\n\r\nexport default function ArtifactSwapModal({ onChangeId, slotKey, show, onClose }:\r\n  { onChangeId: (id: string) => void, slotKey: SlotKey, show: boolean, onClose: () => void }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { database } = useContext(DatabaseContext)\r\n  const clickHandler = useCallback((id) => {\r\n    onChangeId(id)\r\n    onClose()\r\n  }, [onChangeId, onClose])\r\n  const filterOptionReducer = useCallback((state, action) => ({ ...state, ...action, slotKeys: [slotKey] }), [slotKey],)\r\n\r\n  const [filterOption, filterOptionDispatch]: [FilterOption, (action: any) => void] = useReducer(filterOptionReducer, { ...initialFilterOption(), slotKeys: [slotKey] })\r\n\r\n  const [dbDirty, forceUpdate] = useForceUpdate()\r\n  useEffect(() => { return database.arts.followAny(forceUpdate) }, [database, forceUpdate])\r\n\r\n  const brPt = useMediaQueryUp()\r\n\r\n  const filterConfigs = useMemo(() => artifactFilterConfigs(), [])\r\n  const artIdList = useMemo(() => {\r\n    const filterFunc = filterFunction(filterOption, filterConfigs)\r\n    return dbDirty && database.arts.values.filter(filterFunc).map(art => art.id).slice(0, numToShowMap[brPt])\r\n  }, [dbDirty, database, filterConfigs, filterOption, brPt])\r\n\r\n  return <ModalWrapper open={show} onClose={onClose} containerProps={{ maxWidth: \"xl\" }} >\r\n    <CardDark>\r\n      <CardContent sx={{ py: 1, display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n        <Typography variant=\"h6\">{slotKey ? <ImgIcon src={Assets.slot[slotKey]} /> : null} {t`tabEquip.swapArt`}</Typography>\r\n        <CloseButton onClick={onClose} />\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent>\r\n        <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={200} />}>\r\n          <ArtifactFilterDisplay filterOption={filterOption} filterOptionDispatch={filterOptionDispatch} disableSlotFilter />\r\n        </Suspense>\r\n        <Box mt={1}>\r\n          <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={300} />}>\r\n            <Grid container spacing={1} columns={{ xs: 2, md: 3, lg: 4 }}>\r\n              {artIdList.map(id =>\r\n                <Grid item key={id} xs={1} >\r\n                  <ArtifactCard\r\n                    artifactId={id}\r\n                    extraButtons={<CompareBuildButton artId={id} />}\r\n                    onClick={clickHandler}\r\n                  />\r\n                </Grid>)}\r\n            </Grid>\r\n          </Suspense>\r\n        </Box>\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n","import { Box, CardContent, Divider, Grid, TextField, ToggleButton, Typography } from \"@mui/material\"\r\nimport { ChangeEvent, useCallback, useContext, useDeferredValue, useEffect, useMemo, useState } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport Assets from \"../../../../Assets/Assets\"\r\nimport CardDark from \"../../../../Components/Card/CardDark\"\r\nimport CloseButton from \"../../../../Components/CloseButton\"\r\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\"\r\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\r\nimport SolidToggleButtonGroup from \"../../../../Components/SolidToggleButtonGroup\"\r\nimport { StarsDisplay } from \"../../../../Components/StarDisplay\"\r\nimport WeaponSheet from \"../../../../Data/Weapons/WeaponSheet\"\r\nimport { DatabaseContext } from \"../../../../Database/Database\"\r\nimport WeaponCard from \"../../../../PageWeapon/WeaponCard\"\r\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate'\r\nimport usePromise from \"../../../../ReactHooks/usePromise\"\r\nimport { allRarities, Rarity, WeaponTypeKey } from \"../../../../Types/consts\"\r\nimport { handleMultiSelect } from \"../../../../Util/MultiSelect\"\r\nimport { filterFunction, sortFunction } from '../../../../Util/SortByFilters'\r\nimport { weaponFilterConfigs, weaponSortConfigs, weaponSortMap } from '../../../../Util/WeaponSort'\r\nimport CompareBuildButton from \"./CompareBuildButton\"\r\n\r\nconst rarityHandler = handleMultiSelect([...allRarities])\r\n\r\nexport default function WeaponSwapModal({ onChangeId, weaponTypeKey, show, onClose }: { onChangeId: (id: string) => void, weaponTypeKey: WeaponTypeKey, show: boolean, onClose: () => void }) {\r\n  const { t } = useTranslation([\"page_character\", \"page_weapon\", \"weaponNames_gen\"])\r\n  const { database } = useContext(DatabaseContext)\r\n  const clickHandler = useCallback((id: string) => {\r\n    onChangeId(id)\r\n    onClose()\r\n  }, [onChangeId, onClose])\r\n\r\n  const [dbDirty, forceUpdate] = useForceUpdate()\r\n  useEffect(() => database.weapons.followAny(forceUpdate), [forceUpdate, database])\r\n\r\n  const weaponSheets = usePromise(() => WeaponSheet.getAll, [])\r\n\r\n  const [rarity, setRarity] = useState<Rarity[]>([5, 4, 3])\r\n  const [searchTerm, setSearchTerm] = useState(\"\")\r\n  const deferredSearchTerm = useDeferredValue(searchTerm)\r\n\r\n  const weaponIdList = useMemo(() => (weaponSheets && dbDirty && database.weapons.values\r\n    .filter(filterFunction({ weaponType: weaponTypeKey, rarity, name: deferredSearchTerm }, weaponFilterConfigs(weaponSheets)))\r\n    .sort(sortFunction(weaponSortMap[\"level\"] ?? [], false, weaponSortConfigs(weaponSheets)))\r\n    .map(weapon => weapon.id)) ?? []\r\n    , [dbDirty, database, weaponSheets, rarity, weaponTypeKey, deferredSearchTerm])\r\n\r\n  return <ModalWrapper open={show} onClose={onClose} >\r\n    <CardDark>\r\n      <CardContent sx={{ py: 1 }}>\r\n        <Grid container>\r\n          <Grid item flexGrow={1}>\r\n            <Typography variant=\"h6\">{weaponTypeKey ? <ImgIcon src={Assets.weaponTypes[weaponTypeKey]} /> : null} {t`page_character:tabEquip.swapWeapon`}</Typography>\r\n          </Grid>\r\n          <Grid item>\r\n            <CloseButton onClick={onClose} />\r\n          </Grid>\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent>\r\n        <Grid container spacing={1} mb={1}>\r\n          <Grid item>\r\n            <SolidToggleButtonGroup sx={{ height: \"100%\" }} value={rarity} size=\"small\">\r\n              {allRarities.map(star => <ToggleButton key={star} value={star} onClick={() => setRarity(rarityHandler(rarity, star))}>\r\n                <Box display=\"flex\" gap={1}><strong>{star}</strong><StarsDisplay stars={1} /></Box>\r\n              </ToggleButton>)}\r\n            </SolidToggleButtonGroup>\r\n          </Grid>\r\n          <Grid item flexGrow={1}>\r\n            <TextField\r\n              autoFocus\r\n              size=\"small\"\r\n              value={searchTerm}\r\n              onChange={(e: ChangeEvent<HTMLTextAreaElement>) => setSearchTerm(e.target.value)}\r\n              label={t(\"page_weapon:weaponName\")}\r\n              sx={{ height: \"100%\" }}\r\n              InputProps={{\r\n                sx: { height: \"100%\" }\r\n              }}\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n        <Grid container spacing={1}>\r\n          {weaponIdList.map(weaponId =>\r\n            <Grid item key={weaponId} xs={6} sm={6} md={4} lg={3} >\r\n              <WeaponCard\r\n                weaponId={weaponId}\r\n                onClick={clickHandler}\r\n                extraButtons={<CompareBuildButton weaponId={weaponId} />}\r\n              />\r\n            </Grid>)}\r\n        </Grid>\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n","import { Settings, SwapHoriz } from '@mui/icons-material';\r\nimport { Box, Button, CardContent, Divider, Grid, ListItem, Stack, Tooltip, Typography, useMediaQuery } from '@mui/material';\r\nimport { useTheme } from \"@mui/system\";\r\nimport { lazy, Suspense, useCallback, useContext, useDeferredValue, useEffect, useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport SetEffectDisplay from '../../../../Components/Artifact/SetEffectDisplay';\r\nimport SlotNameWithIcon from '../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport SubstatToggle from '../../../../Components/Artifact/SubstatToggle';\r\nimport CardDark from '../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../Components/Card/CardLight';\r\nimport DocumentDisplay from \"../../../../Components/DocumentDisplay\";\r\nimport { BasicFieldDisplay, FieldDisplayList } from '../../../../Components/FieldDisplay';\r\nimport ModalWrapper from '../../../../Components/ModalWrapper';\r\nimport PercentBadge from '../../../../Components/PercentBadge';\r\nimport { CharacterContext } from '../../../../Context/CharacterContext';\r\nimport { DataContext } from '../../../../Context/DataContext';\r\nimport Artifact from '../../../../Data/Artifacts/Artifact';\r\nimport { ArtifactSheet } from '../../../../Data/Artifacts/ArtifactSheet';\r\nimport { DatabaseContext } from '../../../../Database/Database';\r\nimport { uiInput as input } from '../../../../Formula';\r\nimport ArtifactCard from '../../../../PageArtifact/ArtifactCard';\r\nimport WeaponCard from '../../../../PageWeapon/WeaponCard';\r\nimport useBoolState from '../../../../ReactHooks/useBoolState';\r\nimport useCharMeta from '../../../../ReactHooks/useCharMeta';\r\nimport usePromise from '../../../../ReactHooks/usePromise';\r\nimport { allSubstatKeys } from '../../../../Types/artifact';\r\nimport { allSlotKeys, charKeyToLocCharKey, SlotKey, WeaponTypeKey } from '../../../../Types/consts';\r\nimport { IFieldDisplay } from '../../../../Types/fieldDisplay';\r\nimport useBuildSetting from '../TabOptimize/useBuildSetting';\r\nimport ArtifactSwapModal from './ArtifactSwapModal';\r\nimport WeaponSwapModal from './WeaponSwapModal';\r\n\r\nconst WeaponEditor = lazy(() => import('../../../../PageWeapon/WeaponEditor'))\r\n\r\nexport default function EquipmentSection() {\r\n  const { character: { equippedWeapon, key: characterKey }, characterSheet } = useContext(CharacterContext)\r\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\r\n  const { teamData, data } = useContext(DataContext)\r\n  const weaponSheet = teamData[characterKey]?.weaponSheet\r\n  const [weaponId, setweaponId] = useState(\"\")\r\n  const showWeapon = useCallback(() => setweaponId(equippedWeapon), [equippedWeapon],)\r\n  const hideWeapon = useCallback(() => setweaponId(\"\"), [])\r\n\r\n  //triggers when character swap weapons\r\n  useEffect(() => {\r\n    if (weaponId && weaponId !== equippedWeapon)\r\n      setweaponId(equippedWeapon)\r\n  }, [weaponId, equippedWeapon])\r\n\r\n  const theme = useTheme();\r\n  const breakpoint = useMediaQuery(theme.breakpoints.up('lg'));\r\n\r\n  const weaponDoc = useMemo(() => weaponSheet && weaponSheet.document.length > 0 && <CardLight><CardContent><DocumentDisplay sections={weaponSheet.document} /></CardContent></CardLight>, [weaponSheet])\r\n  const { rvFilter } = useCharMeta(characterKey)\r\n  const deferredRvFilter = useDeferredValue(rvFilter)\r\n  const deferredRvSet = useMemo(() => new Set(deferredRvFilter), [deferredRvFilter])\r\n  return <Box >\r\n    <Suspense fallback={false}>\r\n      <WeaponEditor\r\n        weaponId={weaponId}\r\n        footer\r\n        onClose={hideWeapon}\r\n        extraButtons={<LargeWeaponSwapButton weaponTypeKey={characterSheet.weaponTypeKey} />}\r\n      />\r\n    </Suspense>\r\n    <Grid container spacing={1}>\r\n      {breakpoint && <Grid item xs={12} md={12} lg={3} xl={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\r\n        {weaponDoc && weaponDoc}\r\n        <ArtifactSectionCard />\r\n      </Grid>}\r\n      <Grid item xs={12} md={12} lg={9} xl={9} container spacing={1}>\r\n        <Grid item xs={12} sm={6} md={4} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          <WeaponCard weaponId={equippedWeapon} onEdit={showWeapon} canEquip extraButtons={<WeaponSwapButton weaponTypeKey={characterSheet.weaponTypeKey} />} />\r\n        </Grid>\r\n        {allSlotKeys.map(slotKey => <Grid item xs={12} sm={6} md={4} key={slotKey} >\r\n          {!!data.get(input.art[slotKey].id).value ?\r\n            <ArtifactCard artifactId={data.get(input.art[slotKey].id).value} mainStatAssumptionLevel={mainStatAssumptionLevel} effFilter={deferredRvSet}\r\n              extraButtons={<ArtifactSwapButton slotKey={slotKey} />} editorProps={{}} canExclude canEquip /> :\r\n            <ArtSwapCard slotKey={slotKey} />}\r\n        </Grid>)}\r\n      </Grid>\r\n      {!breakpoint && <Grid item xs={12} md={12} xl={3} container spacing={1} >\r\n        {weaponDoc && <Grid item xs={12} md={6} lg={4}>{weaponDoc}</Grid>}\r\n        <Grid item xs={12} md={6} lg={4} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n          <ArtifactSectionCard />\r\n        </Grid>\r\n      </Grid>}\r\n    </Grid>\r\n  </Box>\r\n}\r\nfunction ArtSwapCard({ slotKey }: { slotKey: SlotKey }) {\r\n  const { character: { key: characterKey } } = useContext(CharacterContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <CardLight sx={{ height: \"100%\", width: \"100%\", minHeight: 300, display: \"flex\", flexDirection: \"column\" }}>\r\n    <CardContent>\r\n      <Typography><SlotNameWithIcon slotKey={slotKey} /></Typography>\r\n    </CardContent>\r\n    <Divider />\r\n    <Box sx={{\r\n      flexGrow: 1,\r\n      display: \"flex\",\r\n      justifyContent: \"center\",\r\n      alignItems: \"center\"\r\n    }}\r\n    >\r\n      <ArtifactSwapModal slotKey={slotKey} show={show} onClose={onClose} onChangeId={id => database.arts.set(id, { location: charKeyToLocCharKey(characterKey) })} />\r\n      <Button onClick={onOpen} color=\"info\" sx={{ borderRadius: \"1em\", }}>\r\n        <SwapHoriz sx={{ height: 100, width: 100 }} />\r\n      </Button>\r\n    </Box>\r\n  </CardLight>\r\n}\r\nfunction WeaponSwapButton({ weaponTypeKey }: { weaponTypeKey: WeaponTypeKey }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(CharacterContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <>\r\n    <Tooltip title={<Typography>{t`tabEquip.swapWeapon`}</Typography>} placement=\"top\" arrow>\r\n      <Button color=\"info\" size=\"small\" onClick={onOpen} ><SwapHoriz /></Button>\r\n    </Tooltip>\r\n    <WeaponSwapModal weaponTypeKey={weaponTypeKey} onChangeId={id => database.weapons.set(id, { location: charKeyToLocCharKey(characterKey) })} show={show} onClose={onClose} />\r\n  </>\r\n}\r\nfunction LargeWeaponSwapButton({ weaponTypeKey }: { weaponTypeKey: WeaponTypeKey }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(CharacterContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <>\r\n    <Button color=\"info\" onClick={onOpen} startIcon={<SwapHoriz />} >{t`tabEquip.swapWeapon`}</Button>\r\n    <WeaponSwapModal weaponTypeKey={weaponTypeKey} onChangeId={id => database.weapons.set(id, { location: charKeyToLocCharKey(characterKey) })} show={show} onClose={onClose} />\r\n  </>\r\n}\r\nfunction ArtifactSwapButton({ slotKey }: { slotKey: SlotKey }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(CharacterContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <>\r\n    <Tooltip title={<Typography>{t`tabEquip.swapArt`}</Typography>} placement=\"top\" arrow>\r\n      <Button color=\"info\" size=\"small\" onClick={onOpen} ><SwapHoriz /></Button>\r\n    </Tooltip>\r\n    <ArtifactSwapModal slotKey={slotKey} show={show} onClose={onClose} onChangeId={id => database.arts.set(id, { location: charKeyToLocCharKey(characterKey) })} />\r\n  </>\r\n}\r\nfunction ArtifactSectionCard() {\r\n  const { t } = useTranslation([\"page_character\", \"artifact\"])\r\n  const { database } = useContext(DatabaseContext)\r\n  const { character, character: { key: characterKey, equippedArtifacts } } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\r\n  const hasEquipped = useMemo(() => !!Object.values(equippedArtifacts).filter(i => i).length, [equippedArtifacts])\r\n  const unequipArts = useCallback(() => {\r\n    if (!character) return\r\n    if (!window.confirm(\"Do you want to move all currently equipped artifacts to inventory?\")) return\r\n    Object.values(equippedArtifacts).forEach(aid => database.arts.set(aid, { location: \"\" }))\r\n  }, [character, database, equippedArtifacts])\r\n\r\n  const setEffects = useMemo(() => artifactSheets && ArtifactSheet.setEffects(artifactSheets, data), [artifactSheets, data])\r\n  const { rvFilter } = useCharMeta(characterKey)\r\n  const setRVFilter = useCallback(rvFilter => database.charMeta.set(characterKey, { rvFilter }), [database, characterKey],)\r\n\r\n  const [show, onShow, onHide] = useBoolState()\r\n  const deferredrvFilter = useDeferredValue(rvFilter)\r\n  const { rvField, rvmField } = useMemo(() => {\r\n    const { currentEfficiency, currentEfficiency_, maxEfficiency, maxEfficiency_ } = Object.values(equippedArtifacts).reduce((a, artid) => {\r\n      const art = database.arts.get(artid)\r\n      if (art) {\r\n        const { currentEfficiency, maxEfficiency } = Artifact.getArtifactEfficiency(art, new Set(deferredrvFilter))\r\n        const { currentEfficiency: currentEfficiency_, maxEfficiency: maxEfficiency_ } = Artifact.getArtifactEfficiency(art, new Set(allSubstatKeys))\r\n        a.currentEfficiency = a.currentEfficiency + currentEfficiency\r\n        a.maxEfficiency = a.maxEfficiency + maxEfficiency\r\n\r\n        a.currentEfficiency_ = a.currentEfficiency_ + currentEfficiency_\r\n        a.maxEfficiency_ = a.maxEfficiency_ + maxEfficiency_\r\n      }\r\n      return a\r\n    }, { currentEfficiency: 0, currentEfficiency_: 0, maxEfficiency: 0, maxEfficiency_: 0 })\r\n    const rvField: IFieldDisplay = {\r\n      text: t`artifact:editor.curSubEff`,\r\n      value: !(currentEfficiency - currentEfficiency_) ? <PercentBadge value={currentEfficiency} max={4500} valid /> :\r\n        <span><PercentBadge value={currentEfficiency} max={4500} valid /> / <PercentBadge value={currentEfficiency_} max={4500} valid /></span>\r\n    }\r\n    const rvmField: IFieldDisplay = {\r\n      text: t`artifact:editor.maxSubEff`,\r\n      canShow: () => !!(currentEfficiency_ - maxEfficiency_),\r\n      value: !(maxEfficiency - maxEfficiency_) ? <PercentBadge value={maxEfficiency} max={4500} valid /> :\r\n        <span><PercentBadge value={maxEfficiency} max={4500} valid /> / <PercentBadge value={maxEfficiency_} max={4500} valid /></span>\r\n    }\r\n    return { rvField, rvmField }\r\n  }, [t, deferredrvFilter, equippedArtifacts, database])\r\n\r\n  return <CardLight>\r\n    {hasEquipped && <Button color=\"error\" onClick={unequipArts} fullWidth sx={{ borderBottomRightRadius: 0, borderBottomLeftRadius: 0 }}>{t`tabEquip.unequipArts`}</Button>}\r\n    <CardContent >\r\n      <Stack spacing={1}>\r\n        <CardDark >\r\n          <Button fullWidth color=\"info\" startIcon={<Settings />} sx={{ borderBottomLeftRadius: 0, borderBottomRightRadius: 0 }} onClick={onShow}>RV Filter</Button>\r\n          <ModalWrapper open={show} onClose={onHide}>\r\n            <CardDark>\r\n              <CardContent>\r\n                <SubstatToggle selectedKeys={rvFilter} onChange={setRVFilter} />\r\n              </CardContent>\r\n            </CardDark>\r\n          </ModalWrapper>\r\n          <FieldDisplayList >\r\n            <BasicFieldDisplay field={rvField} component={ListItem} />\r\n            {rvmField?.canShow?.(data) && <BasicFieldDisplay field={rvmField} component={ListItem} />}\r\n          </FieldDisplayList>\r\n        </CardDark>\r\n        {artifactSheets && setEffects && Object.entries(setEffects).flatMap(([setKey, setNumKeyArr]) =>\r\n          setNumKeyArr.map(setNumKey => <CardDark key={setKey + setNumKey} sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\r\n            <SetEffectDisplay key={setKey + setNumKey} setKey={setKey} setNumKey={setNumKey} />\r\n          </CardDark>)\r\n        )}\r\n      </Stack>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import { Favorite, FavoriteBorder } from \"@mui/icons-material\";\r\nimport { Badge, Box, CardActionArea, Chip, Grid, IconButton, Stack, Typography } from \"@mui/material\";\r\nimport { useCallback, useContext, useRef } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Assets from \"../../../../Assets/Assets\";\r\nimport ArtifactCardNano from \"../../../../Components/Artifact/ArtifactCardNano\";\r\nimport CardLight from \"../../../../Components/Card/CardLight\";\r\nimport CharacterCardPico from \"../../../../Components/Character/CharacterCardPico\";\r\nimport StatDisplayComponent from \"../../../../Components/Character/StatDisplayComponent\";\r\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\";\r\nimport SqBadge from \"../../../../Components/SqBadge\";\r\nimport { StarsDisplay } from \"../../../../Components/StarDisplay\";\r\nimport StatIcon from \"../../../../Components/StatIcon\";\r\nimport WeaponCardNano from \"../../../../Components/Weapon/WeaponCardNano\";\r\nimport { CharacterContext } from \"../../../../Context/CharacterContext\";\r\nimport { DataContext } from \"../../../../Context/DataContext\";\r\nimport { TalentSheetElementKey } from \"../../../../Data/Characters/CharacterSheet\";\r\nimport { getLevelString } from \"../../../../Data/LevelData\";\r\nimport { DatabaseContext } from \"../../../../Database/Database\";\r\nimport { uiInput as input } from \"../../../../Formula\";\r\nimport useCharacterReducer from \"../../../../ReactHooks/useCharacterReducer\";\r\nimport useCharMeta from \"../../../../ReactHooks/useCharMeta\";\r\nimport { allSlotKeys, Ascension, ElementKey } from \"../../../../Types/consts\";\r\nimport { range } from \"../../../../Util/Util\";\r\nimport EquipmentSection from \"./EquipmentSection\";\r\n\r\nexport default function TabOverview() {\r\n  const scrollRef = useRef<HTMLDivElement>()\r\n  const onScroll = useCallback(() => scrollRef?.current?.scrollIntoView?.({ behavior: \"smooth\" }), [scrollRef])\r\n\r\n  return <Stack spacing={1}>\r\n    <Grid container spacing={1} sx={{ justifyContent: \"center\" }}>\r\n      <Grid item xs={8} sm={5} md={4} lg={2.3}  >\r\n        <CharacterProfileCard />\r\n      </Grid>\r\n      <Grid item xs={12} sm={7} md={8} lg={9.7} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\r\n        <EquipmentRow onClick={onScroll} />\r\n        <CardLight sx={{ flexGrow: 1, p: 1 }}>\r\n          <StatDisplayComponent />\r\n        </CardLight>\r\n      </Grid>\r\n    </Grid >\r\n    <Box ref={scrollRef}>\r\n      <EquipmentSection />\r\n    </Box>\r\n  </Stack>\r\n}\r\nfunction EquipmentRow({ onClick }: { onClick: () => void }) {\r\n  const { character: { equippedWeapon } } = useContext(CharacterContext)\r\n  const { data, } = useContext(DataContext)\r\n\r\n  return <Grid container spacing={1} columns={{ xs: 2, sm: 2, md: 3, lg: 6, xl: 6 }}>\r\n    <Grid item xs={1}>\r\n      <WeaponCardNano weaponId={equippedWeapon} BGComponent={CardLight} onClick={onClick} />\r\n    </Grid>\r\n    {allSlotKeys.map(slotKey =>\r\n      <Grid item key={slotKey} xs={1} >\r\n        <ArtifactCardNano artifactId={data.get(input.art[slotKey].id).value} slotKey={slotKey} BGComponent={CardLight} onClick={onClick} />\r\n      </Grid>)}\r\n  </Grid>\r\n}\r\n/* Image card with star and name and level */\r\nfunction CharacterProfileCard() {\r\n  const { database } = useContext(DatabaseContext)\r\n  const { characterSheet, character: { key: characterKey, team } } = useContext(CharacterContext)\r\n  const { data, } = useContext(DataContext)\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const navigate = useNavigate()\r\n  const charEle = data.get(input.charEle).value as ElementKey\r\n  const weaponTypeKey = characterSheet.weaponTypeKey\r\n  const level = data.get(input.lvl).value\r\n  const ascension = data.get(input.asc).value as Ascension\r\n  const constellation = data.get(input.constellation).value\r\n  const tlvl = {\r\n    auto: data.get(input.total.auto).value,\r\n    skill: data.get(input.total.skill).value,\r\n    burst: data.get(input.total.burst).value,\r\n  }\r\n  const tBoost = {\r\n    auto: data.get(input.bonus.auto).value,\r\n    skill: data.get(input.bonus.skill).value,\r\n    burst: data.get(input.bonus.burst).value,\r\n  }\r\n  const { favorite } = useCharMeta(characterKey)\r\n  return <CardLight sx={{ height: \"100%\" }} >\r\n    <Box sx={{ position: \"relative\" }}>\r\n      <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\" }}>\r\n        <Typography variant=\"h6\" sx={{ position: \"absolute\", left: \"50%\", bottom: 0, transform: \"translate(-50%, -50%)\", opacity: 0.75 }}>\r\n          <StarsDisplay stars={characterSheet.rarity} colored />\r\n        </Typography>\r\n        <Box sx={{ position: \"absolute\", left: \"50%\", bottom: \"5%\", transform: \"translate(-50%, -50%)\", opacity: 0.85, width: \"100%\", display: \"flex\", justifyContent: \"center\", px: 1 }}>\r\n          <Chip color={charEle} sx={{ height: \"auto\" }}\r\n            label={<Typography variant=\"h6\" sx={{ display: \"flex\", gap: 1, alignItems: \"center\" }} >\r\n              {StatIcon[charEle]}\r\n              <Box sx={{ whiteSpace: \"normal\", textAlign: \"center\" }}>{characterSheet.name}</Box>\r\n              <ImgIcon src={Assets.weaponTypes?.[weaponTypeKey]} />\r\n            </Typography>} />\r\n        </Box>\r\n        <Box sx={{ position: \"absolute\", left: 0, top: 0 }}>\r\n          <IconButton sx={{ p: 1 }} color=\"error\" onClick={() => database.charMeta.set(characterKey, { favorite: !favorite })}>\r\n            {favorite ? <Favorite /> : <FavoriteBorder />}\r\n          </IconButton>\r\n        </Box>\r\n        <Typography sx={{ p: 1, position: \"absolute\", right: 0, top: 0, opacity: 0.8 }}>\r\n          <SqBadge>{getLevelString(level, ascension)}</SqBadge>\r\n        </Typography>\r\n      </Box>\r\n      <Box src={characterSheet.cardImg} component=\"img\" width=\"100%\" height=\"auto\" />\r\n    </Box>\r\n    <Box>\r\n      <CardActionArea sx={{ p: 1 }} onClick={() => navigate(\"talent\")}>\r\n        <Grid container spacing={1} mt={-1}>\r\n          {([\"auto\", \"skill\", \"burst\"] as TalentSheetElementKey[]).map(tKey =>\r\n            <Grid item xs={4} key={tKey}>\r\n              <Badge badgeContent={tlvl[tKey]} color={tBoost[tKey] ? \"info\" : \"secondary\"}\r\n                overlap=\"circular\"\r\n                anchorOrigin={{\r\n                  vertical: 'bottom',\r\n                  horizontal: 'right',\r\n                }}\r\n                sx={{\r\n                  width: \"100%\",\r\n                  height: \"100%\",\r\n                  \"& > .MuiBadge-badge\": {\r\n                    fontSize: \"1.25em\",\r\n                    padding: \".25em .4em\",\r\n                    borderRadius: \".5em\",\r\n                    lineHeight: 1,\r\n                    height: \"1.25em\"\r\n                  }\r\n                }}>\r\n                <Box component=\"img\" src={characterSheet.getTalentOfKey(tKey)?.img} width=\"100%\" height=\"auto\" />\r\n              </Badge>\r\n            </Grid>)}\r\n        </Grid>\r\n      </CardActionArea>\r\n      <Typography sx={{ textAlign: \"center\", mt: 1 }} variant=\"h6\">{characterSheet.constellationName}</Typography>\r\n      <Grid container spacing={1}>\r\n        {range(1, 6).map(i =>\r\n          <Grid item xs={4} key={i}>\r\n            <CardActionArea onClick={() => characterDispatch({ constellation: i === constellation ? i - 1 : i })}>\r\n              <Box component=\"img\" src={characterSheet.getTalentOfKey(`constellation${i}` as TalentSheetElementKey)?.img}\r\n                sx={{\r\n                  ...(constellation >= i ? {} : { filter: \"brightness(50%)\" })\r\n                }}\r\n                width=\"100%\" height=\"auto\" />\r\n            </CardActionArea>\r\n          </Grid>)}\r\n      </Grid>\r\n      <CardActionArea sx={{ p: 1 }} onClick={() => navigate(\"teambuffs\")}>\r\n        <Grid container columns={3} spacing={1}>\r\n          {range(0, 2).map(i => <Grid key={i} item xs={1} height=\"100%\"><CharacterCardPico characterKey={team[i]} index={i} /></Grid>)}\r\n        </Grid>\r\n      </CardActionArea>\r\n    </Box>\r\n  </CardLight >\r\n}\r\n","import { Box, CardActionArea, CardContent, Grid, MenuItem, Typography, useMediaQuery } from \"@mui/material\";\r\nimport { useTheme } from \"@mui/system\";\r\nimport { useCallback, useContext, useMemo } from 'react';\r\nimport CardDark from \"../../../Components/Card/CardDark\";\r\nimport CardLight from \"../../../Components/Card/CardLight\";\r\nimport ConditionalWrapper from \"../../../Components/ConditionalWrapper\";\r\nimport DocumentDisplay from \"../../../Components/DocumentDisplay\";\r\nimport DropdownButton from \"../../../Components/DropdownMenu/DropdownButton\";\r\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\r\nimport { CharacterContext } from \"../../../Context/CharacterContext\";\r\nimport { DataContext } from '../../../Context/DataContext';\r\nimport { TalentSheetElementKey } from \"../../../Data/Characters/CharacterSheet\";\r\nimport { uiInput as input } from \"../../../Formula\";\r\nimport { NumNode } from \"../../../Formula/type\";\r\nimport { NodeDisplay } from '../../../Formula/uiData';\r\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\r\nimport { DocumentSection } from \"../../../Types/sheet\";\r\nimport { range } from \"../../../Util/Util\";\r\n\r\nconst talentSpacing = {\r\n  xs: 12,\r\n  sm: 6,\r\n  md: 4\r\n}\r\n\r\nexport default function CharacterTalentPane() {\r\n  const { character, characterSheet } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n  const characterDispatch = useCharacterReducer(character.key)\r\n  const skillBurstList = [[\"auto\", \"Normal/Charged Attack\"], [\"skill\", \"Elemental Skill\"], [\"burst\", \"Elemental Burst\"]] as [TalentSheetElementKey, string][]\r\n  const passivesList: [tKey: TalentSheetElementKey, tText: string, asc: number][] = [[\"passive1\", \"Unlocked at Ascension 1\", 1], [\"passive2\", \"Unlocked at Ascension 4\", 4], [\"passive3\", \"Unlocked by Default\", 0]]\r\n  const ascension = data.get(input.asc).value\r\n  const constellation = data.get(input.constellation).value\r\n\r\n  const theme = useTheme();\r\n  const grlg = useMediaQuery(theme.breakpoints.up('lg'));\r\n  const constellationCards = useMemo(() => range(1, 6).map(i =>\r\n    <SkillDisplayCard\r\n      talentKey={`constellation${i}` as TalentSheetElementKey}\r\n      subtitle={`Constellation Lv. ${i}`}\r\n      onClickTitle={() => characterDispatch({ constellation: i === constellation ? i - 1 : i })}\r\n    />), [constellation, characterDispatch])\r\n  return <>\r\n    <ReactionDisplay />\r\n    <Grid container spacing={1}>\r\n      {/* constellations for 4column */}\r\n      {grlg && <Grid item xs={12} md={12} lg={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\r\n        <CardLight><CardContent><Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography></CardContent></CardLight>\r\n        {constellationCards.map((c, i) => <Box key={i} sx={{ opacity: constellation >= (i + 1) ? 1 : 0.5 }} >{c}</Box>)}\r\n      </Grid>}\r\n      <Grid item xs={12} md={12} lg={9} container spacing={1} >\r\n        {/* auto, skill, burst */}\r\n        {skillBurstList.map(([tKey, tText]) =>\r\n          <Grid item key={tKey} {...talentSpacing} >\r\n            <SkillDisplayCard\r\n              talentKey={tKey}\r\n              subtitle={tText}\r\n            />\r\n          </Grid>)}\r\n        {!!characterSheet.getTalentOfKey(\"sprint\",) && <Grid item {...talentSpacing} >\r\n          <SkillDisplayCard\r\n            talentKey=\"sprint\"\r\n            subtitle=\"Alternative Sprint\"\r\n          />\r\n        </Grid>}\r\n        {!!characterSheet.getTalentOfKey(\"passive\") && <Grid item {...talentSpacing} >\r\n          <SkillDisplayCard\r\n            talentKey=\"passive\"\r\n            subtitle=\"Passive\"\r\n          />\r\n        </Grid>}\r\n        {/* passives */}\r\n        {passivesList.map(([tKey, tText, asc]) => {\r\n          let enabled = ascension >= asc\r\n          if (!characterSheet.getTalentOfKey(tKey)) return null\r\n          return <Grid item key={tKey} style={{ opacity: enabled ? 1 : 0.5 }} {...talentSpacing} >\r\n            <SkillDisplayCard\r\n              talentKey={tKey}\r\n              subtitle={tText}\r\n            />\r\n          </Grid>\r\n        })}\r\n      </Grid>\r\n      {/* constellations for < 4 columns */}\r\n      {!grlg && <Grid item xs={12} md={12} lg={3} container spacing={1} >\r\n        <Grid item xs={12}>\r\n          <CardLight><CardContent><Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography></CardContent></CardLight>\r\n        </Grid>\r\n        {constellationCards.map((c, i) => <Grid item key={i} sx={{ opacity: constellation >= (i + 1) ? 1 : 0.5 }} {...talentSpacing} >{c}</Grid>)}\r\n      </Grid>}\r\n    </Grid>\r\n  </>\r\n}\r\nfunction ReactionDisplay() {\r\n  const { data } = useContext(DataContext)\r\n  const reaction = data.getDisplay().reaction as { [key: string]: NodeDisplay }\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Grid container spacing={1}>\r\n        {Object.entries(reaction).filter(([_, node]) => !node.isEmpty).map(([key, node]) => {\r\n          return <Grid item key={key}>\r\n            <CardDark><CardContent sx={{ p: 1, \"&:last-child\": { pb: 1 } }}>\r\n              <NodeFieldDisplay node={node} />\r\n            </CardContent></CardDark>\r\n          </Grid>\r\n        })}\r\n      </Grid>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n\r\nconst talentLimits = [1, 1, 2, 4, 6, 8, 10]\r\ntype SkillDisplayCardProps = {\r\n  talentKey: TalentSheetElementKey,\r\n  subtitle: string,\r\n  onClickTitle?: (any) => any\r\n}\r\nfunction SkillDisplayCard({ talentKey, subtitle, onClickTitle }: SkillDisplayCardProps) {\r\n  const { character: { talent }, characterSheet, characterDispatch } = useContext(CharacterContext)\r\n  const { data } = useContext(DataContext)\r\n\r\n  const actionWrapeprFunc = useCallback(\r\n    children => <CardActionArea onClick={onClickTitle}>{children}</CardActionArea>,\r\n    [onClickTitle],\r\n  )\r\n\r\n  const setTalentLevel = useCallback((tKey: TalentSheetElementKey, newTalentLevelKey: number) =>\r\n    characterDispatch({ talent: { ...talent, [tKey]: newTalentLevelKey } }), [talent, characterDispatch])\r\n\r\n  let header: Displayable | null = null\r\n\r\n  if (talentKey in talent) {\r\n    const levelBoost = data.get(input.bonus[talentKey] as NumNode).value\r\n    const level = data.get(input.total[talentKey]).value\r\n    const asc = data.get(input.asc).value\r\n\r\n    header = <DropdownButton fullWidth title={`Talent Lv. ${level}`} color={levelBoost ? \"info\" : \"primary\"} sx={{ borderRadius: 0 }}>\r\n      {range(1, talentLimits[asc]).map(i =>\r\n        <MenuItem key={i} selected={talent[talentKey] === (i)} disabled={talent[talentKey] === (i)} onClick={() => setTalentLevel(talentKey, i)}>Talent Lv. {i + levelBoost}</MenuItem>)}\r\n    </DropdownButton>\r\n  }\r\n  const talentSheet = characterSheet.getTalentOfKey(talentKey)\r\n\r\n  // Hide header if the header matches the current talent\r\n  const hideHeader = (section: DocumentSection): boolean => {\r\n    let headerAction = section.header?.action\r\n    if (headerAction && (typeof headerAction !== \"string\")) {\r\n      const key: string = headerAction.props.children.props.key18\r\n      return key.includes(talentKey)\r\n    }\r\n    return false\r\n  }\r\n\r\n  return <CardLight sx={{ height: \"100%\" }}>\r\n    {header}\r\n    <CardContent>\r\n      <ConditionalWrapper condition={!!onClickTitle} wrapper={actionWrapeprFunc} >\r\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\r\n          <Grid item>\r\n            <Box component=\"img\" src={talentSheet?.img} sx={{ width: 60, height: \"auto\" }} />\r\n          </Grid>\r\n          <Grid item flexGrow={1} sx={{ pl: 1 }}>\r\n            <Typography variant=\"h6\">{talentSheet?.name}</Typography>\r\n            <Typography variant=\"subtitle1\">{subtitle}</Typography>\r\n          </Grid>\r\n        </Grid>\r\n      </ConditionalWrapper>\r\n      {/* Display document sections */}\r\n      {talentSheet?.sections ? <DocumentDisplay sections={talentSheet.sections} hideDesc hideHeader={hideHeader} /> : null}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import { PersonAdd } from \"@mui/icons-material\";\r\nimport { AutocompleteProps, CardContent, CardHeader, Divider, Grid, Skeleton, Typography } from \"@mui/material\";\r\nimport { Box } from \"@mui/system\";\r\nimport { Suspense, useCallback, useContext, useMemo } from 'react';\r\nimport { useTranslation } from \"react-i18next\";\r\nimport CardLight from \"../../../Components/Card/CardLight\";\r\nimport CharacterCard from \"../../../Components/Character/CharacterCard\";\r\nimport ThumbSide from \"../../../Components/Character/ThumbSide\";\r\nimport ColorText from \"../../../Components/ColoredText\";\r\nimport DocumentDisplay from \"../../../Components/DocumentDisplay\";\r\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\r\nimport GeneralAutocomplete, { GeneralAutocompleteOption } from \"../../../Components/GeneralAutocomplete\";\r\nimport InfoTooltip from \"../../../Components/InfoTooltip\";\r\nimport { CharacterContext, CharacterContextObj } from \"../../../Context/CharacterContext\";\r\nimport { DataContext, dataContextObj } from \"../../../Context/DataContext\";\r\nimport { ArtifactSheet } from \"../../../Data/Artifacts/ArtifactSheet\";\r\nimport CharacterSheet from \"../../../Data/Characters/CharacterSheet\";\r\nimport { resonanceSheets } from \"../../../Data/Resonance\";\r\nimport { DatabaseContext } from \"../../../Database/Database\";\r\nimport { NodeDisplay } from \"../../../Formula/uiData\";\r\nimport useCharSelectionCallback from \"../../../ReactHooks/useCharSelectionCallback\";\r\nimport useDBMeta from \"../../../ReactHooks/useDBMeta\";\r\nimport usePromise from \"../../../ReactHooks/usePromise\";\r\nimport { CharacterKey, charKeyToCharName } from \"../../../Types/consts\";\r\nimport { objPathValue, range } from \"../../../Util/Util\";\r\n\r\nexport default function TabTeambuffs() {\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1} alignItems=\"stretch\">\r\n    <Grid container spacing={1}>\r\n      <Grid item xs={12} md={6} lg={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n        <TeamBuffDisplay />\r\n        <ResonanceDisplay />\r\n      </Grid>\r\n      {range(0, 2).map(i => <Grid item xs={12} md={6} lg={3} key={i}>\r\n        <TeammateDisplay index={i} />\r\n      </Grid>)}\r\n    </Grid>\r\n  </Box>\r\n}\r\nexport function TeamBuffDisplay() {\r\n  const { data, oldData } = useContext(DataContext)\r\n  const teamBuffs = data.getTeamBuff()\r\n  const nodes: Array<[string[], NodeDisplay<number>]> = []\r\n  Object.entries(teamBuffs.total ?? {}).forEach(([key, node]) =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"total\", key], node]))\r\n  Object.entries(teamBuffs.premod ?? {}).forEach(([key, node]) =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"premod\", key], node]))\r\n  Object.entries(teamBuffs.enemy ?? {}).forEach(([key, node]) =>\r\n    !node.isEmpty && typeof node.value === \"number\" && node.value !== 0 && nodes.push([[\"enemy\", key], node as NodeDisplay<number>]))\r\n  if (!nodes.length) return null\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Typography>Team Buffs</Typography>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      <Grid container>\r\n        {nodes.map(([path, n]) => n && <Grid item xs={12} key={JSON.stringify(n.info)} >\r\n          <NodeFieldDisplay node={n} oldValue={objPathValue(oldData?.getTeamBuff(), path)?.value} />\r\n        </Grid>)}\r\n      </Grid>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\nfunction ResonanceDisplay() {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { data } = useContext(DataContext)\r\n  const { character: { team } } = useContext(CharacterContext)\r\n  const teamCount = team.reduce((a, t) => a + (t ? 1 : 0), 1)\r\n  return <>\r\n    <CardLight>\r\n      <CardHeader title={<span>{t<string>(\"tabTeambuff.team_reso\")} <strong><ColorText color={teamCount >= 4 ? \"success\" : \"warning\"}>({teamCount}/4)</ColorText></strong> <InfoTooltip title={<Typography>{t`tabTeambuff.resonance_tip`}</Typography>} /></span>}\r\n        titleTypographyProps={{ variant: \"subtitle2\" }} />\r\n    </CardLight>\r\n    {resonanceSheets.map((res, i) => {\r\n      const icon = <InfoTooltip title={<Typography>{res.desc}</Typography>} />\r\n      const title = <span>{res.name} {icon}</span>\r\n      return <CardLight key={i} sx={{ opacity: res.canShow(data) ? 1 : 0.5, }}>\r\n        <CardHeader title={title} action={res.icon} titleTypographyProps={{ variant: \"subtitle2\" }} />\r\n        {res.canShow(data) && <Divider />}\r\n        {res.canShow(data) && <CardContent>\r\n          <DocumentDisplay sections={res.sections} teamBuffOnly hideDesc />\r\n        </CardContent>}\r\n      </CardLight>\r\n    })}\r\n  </>\r\n}\r\nfunction TeammateDisplay({ index }: { index: number }) {\r\n  const { teamData } = useContext(DataContext)\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: active, character: { key: activeCharacterKey }, characterDispatch } = useContext(CharacterContext)\r\n  const teamMateKey = active.team[index]\r\n  const team = useMemo(() => [activeCharacterKey, ...active.team].filter((t, i) => (i - 1) !== index), [active.team, activeCharacterKey, index])\r\n  const onClickHandler = useCharSelectionCallback()\r\n  const setTeammate = useCallback((charKey: CharacterKey | \"\") => characterDispatch({ type: \"team\", index, charKey }), [index, characterDispatch])\r\n\r\n  const dataBundle = teamData[teamMateKey]\r\n  const teammateCharacterContext: CharacterContextObj | undefined = useMemo(() => dataBundle && {\r\n    character: { ...dataBundle.character, conditional: active.teamConditional[teamMateKey] ?? {} },\r\n    characterSheet: dataBundle.characterSheet,\r\n    characterDispatch: (state) => {\r\n      if (!teamMateKey) return\r\n      if (!(\"conditional\" in state)) return\r\n      const { conditional } = state\r\n      characterDispatch({ type: \"teamConditional\", teamMateKey: teamMateKey, conditional })\r\n    }\r\n  }, [active, teamMateKey, dataBundle, characterDispatch])\r\n  const teamMateDataContext: dataContextObj | undefined = useMemo(() => dataBundle && {\r\n    data: dataBundle.target,\r\n    teamData: teamData,\r\n  }, [dataBundle, teamData])\r\n  return <CardLight>\r\n    <TeammateAutocomplete characterKey={teamMateKey} team={team}\r\n      setChar={setTeammate}\r\n      label={t(\"teammate\", { count: index + 1 })}\r\n    />\r\n    {teamMateKey && teammateCharacterContext && <CharacterContext.Provider value={teammateCharacterContext}>\r\n      {teamMateDataContext && <DataContext.Provider value={teamMateDataContext}>\r\n        <CharacterCard characterKey={teamMateKey}\r\n          onClickHeader={onClickHandler}\r\n          // Need to wrap these elements with the providers for them to use the correct functions.\r\n          artifactChildren={<CharacterContext.Provider value={teammateCharacterContext}>\r\n            <DataContext.Provider value={teamMateDataContext}>\r\n              <CharArtifactCondDisplay />\r\n            </DataContext.Provider>\r\n          </CharacterContext.Provider>}\r\n          weaponChildren={<CharacterContext.Provider value={teammateCharacterContext}>\r\n            <DataContext.Provider value={teamMateDataContext}>\r\n              <CharWeaponCondDisplay />\r\n            </DataContext.Provider>\r\n          </CharacterContext.Provider>}\r\n          characterChildren={<CharacterContext.Provider value={teammateCharacterContext}>\r\n            <DataContext.Provider value={teamMateDataContext}>\r\n              <CharTalentCondDisplay />\r\n            </DataContext.Provider>\r\n          </CharacterContext.Provider>}\r\n          isTeammateCard\r\n        />\r\n      </DataContext.Provider>}\r\n    </CharacterContext.Provider>}\r\n  </CardLight>\r\n}\r\nfunction CharArtifactCondDisplay() {\r\n  const { data, } = useContext(DataContext)\r\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\r\n  const sections = useMemo(() => artifactSheets &&\r\n    Object.entries(ArtifactSheet.setEffects(artifactSheets, data))\r\n      .flatMap(([setKey, setNums]) =>\r\n        setNums.flatMap(sn => artifactSheets(setKey)!.setEffectDocument(sn)!))\r\n    , [artifactSheets, data])\r\n  if (!sections) return null\r\n  return <DocumentDisplay sections={sections} teamBuffOnly={true} />\r\n}\r\nfunction CharWeaponCondDisplay() {\r\n  const { character: { key: charKey } } = useContext(CharacterContext)\r\n  const { teamData } = useContext(DataContext)\r\n  const weaponSheet = teamData[charKey]!.weaponSheet\r\n  if (!weaponSheet.document) return null\r\n  return <DocumentDisplay sections={weaponSheet.document} teamBuffOnly={true} />\r\n}\r\nfunction CharTalentCondDisplay() {\r\n  const { character: { key: charKey } } = useContext(CharacterContext)\r\n  const { teamData } = useContext(DataContext)\r\n  const characterSheet = teamData[charKey]!.characterSheet\r\n  const sections = Object.values(characterSheet.talent).flatMap(sts => sts.sections)\r\n  if (!sections) return null\r\n  return <DocumentDisplay sections={sections} teamBuffOnly={true} />\r\n}\r\n\r\nfunction TeammateAutocomplete({ characterKey, team, label, setChar, autoCompleteProps = {} }:\r\n  { characterKey, team: Array<CharacterKey | \"\">, label: string, setChar: (k: CharacterKey | \"\") => void, autoCompleteProps?: Omit<AutocompleteProps<GeneralAutocompleteOption<CharacterKey | \"\">, false, true, false>, \"renderInput\" | \"onChange\" | \"options\"> }) {\r\n  const { t } = useTranslation([\"charNames_gen\", \"page_character\", \"sheet_gen\"])\r\n  const { database } = useContext(DatabaseContext)\r\n  const { gender } = useDBMeta()\r\n  const characterSheets = usePromise(() => CharacterSheet.getAll, [])\r\n  const toText = useCallback((key: CharacterKey): string => key.startsWith(\"Traveler\") ? `${t(`charNames_gen:${charKeyToCharName(key, gender)}`)} (${t(`sheet_gen:element.${characterSheets?.(key, gender)?.elementKey}`)})` : t(`charNames_gen:${key}`), [characterSheets, t, gender])\r\n  const toImg = useCallback((key: CharacterKey | \"\") => key === \"\" ? <PersonAdd /> : characterSheets ? <ThumbSide src={characterSheets(key, gender)?.thumbImgSide} sx={{ pr: 1 }} /> : <></>, [characterSheets, gender])//\r\n  const isFavorite = useCallback((key: CharacterKey) => database.charMeta.get(key).favorite, [database])\r\n  const onDisable = useCallback(({ key }: { key: CharacterKey | \"\" }) => team.filter(t => t && t !== characterKey).includes(key) || (key.startsWith(\"Traveler\") && team.some((t, i) => t.startsWith(\"Traveler\"))), [team, characterKey])\r\n  const values: GeneralAutocompleteOption<CharacterKey | \"\">[] = useMemo(() => [{\r\n    key: \"\",\r\n    label: t`page_character:none`,\r\n  },\r\n  ...database.chars.keys\r\n    .map(v => ({ key: v, label: toText(v), favorite: isFavorite(v) }))\r\n    .sort((a, b) => {\r\n      if (a.favorite && !b.favorite) return -1\r\n      if (!a.favorite && b.favorite) return 1\r\n      return a.label.localeCompare(b.label)\r\n    })\r\n  ], [t, toText, isFavorite, database])\r\n  return <Suspense fallback={<Skeleton variant=\"text\" width={100} />}><GeneralAutocomplete size=\"small\" label={label} options={values} valueKey={characterKey} clearKey=\"\" onChange={setChar} getOptionDisabled={onDisable} toImg={toImg} {...autoCompleteProps} /></Suspense>\r\n}\r\n","import { faStar } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { CopyAll, DeleteForever, Info, Refresh } from \"@mui/icons-material\";\r\nimport { Box, Button, ButtonGroup, CardHeader, Divider, Grid, ListItem, MenuItem, Skeleton, Slider, Stack, ToggleButton, Typography } from \"@mui/material\";\r\nimport { WeaponTypeKey } from \"pipeline\";\r\nimport React, { Suspense, useCallback, useContext, useDeferredValue, useEffect, useMemo, useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { ArtifactSetSingleAutocomplete } from \"../../../../Components/Artifact/ArtifactAutocomplete\";\r\nimport ArtifactSetTooltip from \"../../../../Components/Artifact/ArtifactSetTooltip\";\r\nimport SetEffectDisplay from \"../../../../Components/Artifact/SetEffectDisplay\";\r\nimport { slotIconSVG } from \"../../../../Components/Artifact/SlotNameWIthIcon\";\r\nimport BootstrapTooltip from \"../../../../Components/BootstrapTooltip\";\r\nimport CardDark from \"../../../../Components/Card/CardDark\";\r\nimport CardLight from \"../../../../Components/Card/CardLight\";\r\nimport StatDisplayComponent from \"../../../../Components/Character/StatDisplayComponent\";\r\nimport ColorText from \"../../../../Components/ColoredText\";\r\nimport CustomNumberInput from \"../../../../Components/CustomNumberInput\";\r\nimport DocumentDisplay from \"../../../../Components/DocumentDisplay\";\r\nimport DropdownButton from \"../../../../Components/DropdownMenu/DropdownButton\";\r\nimport { FieldDisplayList, NodeFieldDisplay } from \"../../../../Components/FieldDisplay\";\r\nimport FontAwesomeSvgIcon from \"../../../../Components/FontAwesomeSvgIcon\";\r\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\";\r\nimport LevelSelect from \"../../../../Components/LevelSelect\";\r\nimport RefinementDropdown from \"../../../../Components/RefinementDropdown\";\r\nimport SolidToggleButtonGroup from \"../../../../Components/SolidToggleButtonGroup\";\r\nimport { StatColoredWithUnit, StatWithUnit } from \"../../../../Components/StatDisplay\";\r\nimport StatIcon from \"../../../../Components/StatIcon\";\r\nimport { CharacterContext } from \"../../../../Context/CharacterContext\";\r\nimport { DataContext, dataContextObj } from \"../../../../Context/DataContext\";\r\nimport Artifact, { maxArtifactLevel } from \"../../../../Data/Artifacts/Artifact\";\r\nimport { ArtifactSheet } from \"../../../../Data/Artifacts/ArtifactSheet\";\r\nimport WeaponSheet from \"../../../../Data/Weapons/WeaponSheet\";\r\nimport { initCharTC } from \"../../../../Database/DataManagers/CharacterTCData\";\r\nimport { DatabaseContext } from \"../../../../Database/Database\";\r\nimport { uiInput as input } from \"../../../../Formula\";\r\nimport { computeUIData, dataObjForWeapon } from \"../../../../Formula/api\";\r\nimport { constant, percent } from \"../../../../Formula/utils\";\r\nimport KeyMap, { cacheValueString } from \"../../../../KeyMap\";\r\nimport useBoolState from \"../../../../ReactHooks/useBoolState\";\r\nimport usePromise from \"../../../../ReactHooks/usePromise\";\r\nimport useTeamData from \"../../../../ReactHooks/useTeamData\";\r\nimport { ICachedArtifact, MainStatKey, SubstatKey } from \"../../../../Types/artifact\";\r\nimport { ICharTC, ICharTCArtifactSlot } from \"../../../../Types/character\";\r\nimport { allSlotKeys, ArtifactRarity, ArtifactSetKey, SetNum, SlotKey, SubstatType, substatType } from \"../../../../Types/consts\";\r\nimport { ICachedWeapon } from \"../../../../Types/weapon\";\r\nimport { deepClone, objectMap } from \"../../../../Util/Util\";\r\nimport { defaultInitialWeaponKey } from \"../../../../Util/WeaponUtil\";\r\nimport useCharTC from \"./useCharTC\";\r\nconst WeaponSelectionModal = React.lazy(() => import('../../../../Components/Weapon/WeaponSelectionModal'))\r\n\r\ntype ISet = Partial<Record<ArtifactSetKey, 1 | 2 | 4>>\r\nexport default function TabTheorycraft() {\r\n  const { database } = useContext(DatabaseContext)\r\n  const { data: oldData } = useContext(DataContext)\r\n  const { character, character: { key: characterKey, compareData }, characterSheet, characterDispatch } = useContext(CharacterContext)\r\n  const data = useCharTC(characterKey, defaultInitialWeaponKey(characterSheet.weaponTypeKey))\r\n  const setData = useCallback((data: ICharTC) => database.charTCs.set(characterKey, data), [characterKey, database])\r\n  const resetData = useCallback(() => {\r\n    setData(initCharTC(defaultInitialWeaponKey(characterSheet.weaponTypeKey)))\r\n  }, [setData, characterSheet])\r\n  const setWeapon = useCallback(\r\n    (action: Partial<ICharTC[\"weapon\"]>) => {\r\n      setData({ ...data, weapon: { ...data.weapon, ...action } })\r\n    },\r\n    [setData, data],\r\n  )\r\n\r\n  const copyFrom = useCallback(\r\n    (eWeapon: ICachedWeapon, build: ICachedArtifact[]) => {\r\n      const newData = initCharTC(eWeapon.key)\r\n      newData.artifact.substats.type = data.artifact.substats.type\r\n\r\n      newData.weapon.level = eWeapon.level\r\n      newData.weapon.ascension = eWeapon.ascension\r\n      newData.weapon.refinement = eWeapon.refinement\r\n\r\n      const sets = {}\r\n      build.forEach(art => {\r\n        if (!art) return\r\n        const { slotKey, setKey, substats, mainStatKey, level, rarity } = art\r\n        newData.artifact.slots[slotKey].level = level\r\n        newData.artifact.slots[slotKey].statKey = mainStatKey\r\n        newData.artifact.slots[slotKey].rarity = rarity\r\n        sets[setKey] = (sets[setKey] ?? 0) + 1\r\n        substats.forEach(substat => {\r\n          if (substat.key) newData.artifact.substats.stats[substat.key] = (newData.artifact.substats.stats[substat.key] ?? 0) + substat.accurateValue\r\n        })\r\n      })\r\n      newData.artifact.sets = Object.fromEntries(Object.entries(sets).map(([key, value]) => [key,\r\n        value === 3 ? 2 :\r\n          value === 5 ? 4 :\r\n            value === 1 && !(key as string).startsWith(\"PrayersFor\") ? 0 : value\r\n      ]).filter(([key, value]) => value))\r\n      setData(newData)\r\n    },\r\n    [data, setData],\r\n  )\r\n  const location = useLocation()\r\n  const { build: locBuild } = (location.state as { build: string[] } | undefined) ?? { build: undefined }\r\n  useEffect(() => {\r\n    if (!locBuild) return\r\n    const eWeapon = database.weapons.get(character.equippedWeapon)!\r\n    copyFrom(eWeapon, locBuild.map(i => database.arts.get(i)!))\r\n    // WARNING: if copyFrom is included, it will cause a render loop due to its setData <---> data\r\n    // eslint-disable-next-line\r\n  }, [locBuild, database])\r\n\r\n  const copyFromEquipped = useCallback(\r\n    () => {\r\n      const eWeapon = database.weapons.get(character.equippedWeapon)!\r\n      copyFrom(eWeapon, Object.values(character.equippedArtifacts).map(a => database.arts.get(a)!).filter(a => a))\r\n    },\r\n    [database, character.equippedArtifacts, character.equippedWeapon, copyFrom],\r\n  )\r\n\r\n  const weapon: ICachedWeapon = useMemo(() => {\r\n    return {\r\n      ...data.weapon,\r\n      location: \"\",\r\n      lock: false,\r\n      id: \"\"\r\n    }\r\n  }, [data])\r\n  const setArtifact = useCallback((artifact: ICharTC[\"artifact\"]) => {\r\n    const data_ = deepClone(data)\r\n    data_.artifact = artifact\r\n    setData(data_)\r\n  }, [data, setData])\r\n\r\n  const setSubstatsType = useCallback((t: SubstatType) => {\r\n    const data_ = deepClone(data)\r\n    data_.artifact.substats.type = t\r\n    setData(data_)\r\n  }, [data, setData])\r\n\r\n  const setSubstats = useCallback((setSubstats: Record<SubstatKey, number>) => {\r\n    const data_ = deepClone(data)\r\n    data_.artifact.substats.stats = setSubstats\r\n    setData(data_)\r\n  }, [data, setData])\r\n\r\n  const deferredData = useDeferredValue(data)\r\n  const overriderArtData = useMemo(() => {\r\n    const stats = { ...deferredData.artifact.substats.stats }\r\n    Object.values(deferredData.artifact.slots).forEach(({ statKey, rarity, level }) =>\r\n      stats[statKey] = (stats[statKey] ?? 0) + Artifact.mainStatValue(statKey, rarity, level))\r\n    return {\r\n      art: objectMap(stats, (v, k) => k.endsWith(\"_\") ? percent(v / 100) : constant(v)),\r\n      artSet: objectMap(deferredData.artifact.sets, v => constant(v)),\r\n    }\r\n  }, [deferredData])\r\n\r\n  const overrideWeapon: ICachedWeapon = useMemo(() => ({\r\n    id: \"\",\r\n    location: \"\",\r\n    key: data.weapon.key,\r\n    level: data.weapon.level,\r\n    ascension: data.weapon.ascension,\r\n    refinement: data.weapon.refinement,\r\n    lock: false\r\n  }), [data])\r\n  const teamData = useTeamData(characterKey, 0, overriderArtData, overrideWeapon)\r\n\r\n  const { target: charUIData } = teamData?.[characterKey] ?? {}\r\n\r\n  const dataContextValue: dataContextObj | undefined = useMemo(() => {\r\n    if (!teamData || !charUIData) return undefined\r\n    return {\r\n      data: charUIData,\r\n      teamData,\r\n    }\r\n  }, [charUIData, teamData])\r\n  const dataContextValueWithOld: dataContextObj | undefined = useMemo(() => {\r\n    if (!dataContextValue) return undefined\r\n    return {\r\n      ...dataContextValue,\r\n      oldData: compareData ? oldData : undefined,\r\n    }\r\n  }, [dataContextValue, compareData, oldData])\r\n  return <Stack spacing={1}>\r\n    <CardLight>\r\n      <Box sx={{ display: \"flex\", gap: 1, p: 1 }}>\r\n        <Box sx={{ flexGrow: 1, display: \"flex\", gap: 1 }}>\r\n          <Button color=\"info\" onClick={copyFromEquipped} startIcon={<CopyAll />}>Copy from equipped</Button>\r\n          <Button color=\"error\" onClick={resetData} startIcon={<Refresh />}>Reset</Button>\r\n        </Box>\r\n        <SolidToggleButtonGroup exclusive value={compareData} onChange={(e, v) => characterDispatch({ compareData: v })} size=\"small\">\r\n          <ToggleButton value={false} disabled={!compareData}>Show TC stats</ToggleButton>\r\n          <ToggleButton value={true} disabled={compareData}>Compare vs. equipped</ToggleButton>\r\n        </SolidToggleButtonGroup>\r\n      </Box>\r\n    </CardLight>\r\n    {dataContextValue ? <DataContext.Provider value={dataContextValue}>\r\n      <Grid container spacing={1} sx={{ justifyContent: \"center\" }}>\r\n        <Grid item sx={{ flexGrow: -1 }}  >\r\n          <WeaponEditorCard weapon={weapon} setWeapon={setWeapon} weaponTypeKey={characterSheet.weaponTypeKey} />\r\n          <ArtifactMainLevelCard artifactData={data.artifact} setArtifactData={setArtifact} />\r\n        </Grid>\r\n        <Grid item sx={{ flexGrow: 1 }}  >\r\n          <ArtifactSubCard substats={data.artifact.substats.stats} setSubstats={setSubstats} substatsType={data.artifact.substats.type} setSubstatsType={setSubstatsType} mainStatKeys={Object.values(data.artifact.slots).map(s => s.statKey)} />\r\n        </Grid>\r\n      </Grid >\r\n    </DataContext.Provider> : <Skeleton variant='rectangular' width='100%' height={500} />}\r\n    <CardLight sx={{ flexGrow: 1, p: 1 }}>\r\n      {dataContextValueWithOld ? <DataContext.Provider value={dataContextValueWithOld}>\r\n        <StatDisplayComponent />\r\n      </DataContext.Provider> : <Skeleton variant='rectangular' width='100%' height={500} />}\r\n    </CardLight>\r\n\r\n  </Stack>\r\n}\r\n\r\nfunction WeaponEditorCard({ weapon, setWeapon, weaponTypeKey }: { weapon: ICachedWeapon, weaponTypeKey: WeaponTypeKey, setWeapon: (action: Partial<ICharTC[\"weapon\"]>) => void }) {\r\n  const { key, level = 0, refinement = 1, ascension = 0 } = weapon\r\n  const weaponSheet = usePromise(() => WeaponSheet.get(key), [key])\r\n  const [show, onShow, onHide] = useBoolState()\r\n  const { data } = useContext(DataContext)\r\n  const weaponUIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\r\n  return <CardLight sx={{ p: 1, mb: 1 }} >\r\n    <WeaponSelectionModal ascension={ascension} show={show} onHide={onHide} onSelect={k => setWeapon({ key: k })} weaponTypeFilter={weaponTypeKey} />\r\n    <Box display=\"flex\" flexDirection=\"column\" gap={1}>\r\n      <Box display=\"flex\" gap={1}>\r\n        {weaponSheet && <Box\r\n          className={`grad-${weaponSheet.rarity}star`}\r\n          component=\"img\"\r\n          src={weaponSheet.getImg(weapon.ascension)}\r\n          sx={{ flexshrink: 1, flexBasis: 0, maxWidth: \"30%\", borderRadius: 1 }}\r\n        />}\r\n        <Stack spacing={1} flexGrow={1}>\r\n          <Button fullWidth color=\"info\" sx={{ flexGrow: 1 }} onClick={onShow}><Box sx={{ maxWidth: \"10em\" }}>{weaponSheet?.name}</Box></Button>\r\n          {weaponSheet?.hasRefinement && <RefinementDropdown refinement={refinement} setRefinement={r => setWeapon({ refinement: r })} />}\r\n        </Stack>\r\n      </Box>\r\n      {weaponSheet && <LevelSelect level={level} ascension={ascension} setBoth={setWeapon} useLow={!weaponSheet.hasRefinement} />}\r\n      <CardDark >\r\n        <CardHeader title={\"Main Stats\"} titleTypographyProps={{ variant: \"subtitle2\" }} />\r\n        <Divider />\r\n        {weaponUIData && <FieldDisplayList>\r\n          {[input.weapon.main, input.weapon.sub, input.weapon.sub2].map((node, i) => {\r\n            const n = weaponUIData.get(node)\r\n            if (n.isEmpty || !n.value) return null\r\n            return <NodeFieldDisplay key={JSON.stringify(n.info)} node={n} component={ListItem} />\r\n          })}\r\n        </FieldDisplayList>}\r\n      </CardDark>\r\n      {data && weaponSheet?.document && <DocumentDisplay sections={weaponSheet.document} />}\r\n    </Box>\r\n  </CardLight >\r\n}\r\n\r\nfunction ArtifactMainLevelCard({ artifactData, setArtifactData }:\r\n  { artifactData: ICharTC[\"artifact\"], setArtifactData: (a: ICharTC[\"artifact\"]) => void }) {\r\n  const setSlot = useCallback((slotKey: SlotKey) => (slot: ICharTCArtifactSlot) => {\r\n    const artifactData_ = deepClone(artifactData)\r\n    artifactData_.slots[slotKey] = slot\r\n    setArtifactData(artifactData_)\r\n  }, [artifactData, setArtifactData])\r\n\r\n  const setArtSet = useCallback((artSet: ISet) => {\r\n    const artifactData_ = deepClone(artifactData)\r\n    artifactData_.sets = artSet\r\n    setArtifactData(artifactData_)\r\n  }, [artifactData, setArtifactData])\r\n\r\n  return <Stack spacing={1} >\r\n    <CardLight sx={{ p: 1 }}>\r\n      <Stack spacing={1}>\r\n        {allSlotKeys.map(s => <ArtifactMainLevelSlot key={s} slotKey={s} slot={artifactData.slots[s]} setSlot={setSlot(s)} />)}\r\n      </Stack>\r\n    </CardLight>\r\n    <Suspense fallback={<Skeleton variant='rectangular' width='100%' height={200} />}>\r\n      <ArtifactSetsEditor artSet={artifactData.sets} setArtSet={setArtSet} />\r\n    </Suspense>\r\n  </Stack>\r\n}\r\nfunction ArtifactMainLevelSlot({ slotKey, slot, setSlot: setSlotProp }: { slotKey: SlotKey, slot: ICharTCArtifactSlot, setSlot: (s: ICharTCArtifactSlot) => void }) {\r\n  const { level, statKey, rarity } = slot\r\n  const keys = Artifact.slotMainStats(slotKey)\r\n  const setSlot = useCallback((action: Partial<ICharTCArtifactSlot>) => {\r\n    setSlotProp({ ...slot, ...action })\r\n  }, [slot, setSlotProp])\r\n  const setRarity = useCallback(\r\n    (r: ArtifactRarity) => {\r\n      const mLvl = maxArtifactLevel[r] ?? 0\r\n      if (level > mLvl) setSlot({ rarity: r, level: mLvl })\r\n      else setSlot({ rarity: r })\r\n    }, [level, setSlot])\r\n\r\n  return <Box display=\"flex\" gap={1} justifyContent=\"space-between\" alignItems=\"center\">\r\n    <FontAwesomeSvgIcon icon={slotIconSVG[slotKey]} />\r\n    <CardDark sx={{ height: \"100%\", minWidth: \"5em\", flexGrow: 1, display: \"flex\" }}>\r\n      {keys.length === 1 ?\r\n        <Box p={1} justifyContent=\"center\" alignItems=\"center\" width=\"100%\" display=\"flex\" gap={1}>{StatIcon[keys[0]]}{KeyMap.getStr(keys[0])}</Box> :\r\n        <DropdownButton sx={{ px: 0 }} fullWidth title={<StatWithUnit statKey={statKey} />} color={KeyMap.getVariant(statKey) ?? \"success\"}>\r\n          {keys.map(msk =>\r\n            <MenuItem key={msk} disabled={statKey === msk} onClick={() => setSlot({ statKey: msk })}>\r\n              <StatColoredWithUnit statKey={msk} />\r\n            </MenuItem>)}\r\n        </DropdownButton>}\r\n    </CardDark>\r\n    <DropdownButton sx={{ px: 0 }} title={<span>{rarity} <FontAwesomeIcon icon={faStar} /></span>} >\r\n      {[5, 4, 3].map(r =>\r\n        <MenuItem key={r} disabled={rarity === r} onClick={() => setRarity(r as ArtifactRarity)}>\r\n          <span>{r} <FontAwesomeIcon icon={faStar} /></span>\r\n        </MenuItem>)}\r\n    </DropdownButton>\r\n    <CustomNumberInput startAdornment=\"+\" value={level} color={Artifact.levelVariant(level)} onChange={l => l !== undefined && setSlot({ level: l })} sx={{ borderRadius: 1, pl: 1, my: 0, height: \"100%\" }} inputProps={{ sx: { pl: 0.5, width: \"2em\" }, max: 20, min: 0 }} />\r\n    <CardDark sx={{ height: \"100%\", minWidth: \"4em\" }}>\r\n      <Box p={1} textAlign=\"center\">{`${cacheValueString(Artifact.mainStatValue(statKey, rarity, level), KeyMap.unit(statKey))}${KeyMap.unit(statKey)}`}</Box>\r\n    </CardDark>\r\n  </Box>\r\n}\r\n\r\nfunction ArtifactSetsEditor({ artSet, setArtSet }: { artSet: ISet, setArtSet(artSet: ISet) }) {\r\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\r\n  const setSet = useCallback((setKey: ArtifactSetKey | \"\") => {\r\n    if (!setKey || !artifactSheets) return\r\n    setArtSet({ ...artSet, [setKey]: parseInt(Object.keys(artifactSheets(setKey).setEffects)[0]) })\r\n  }, [artSet, setArtSet, artifactSheets])\r\n\r\n  const setValue = useCallback((setKey: ArtifactSetKey) => (value: 1 | 2 | 4) => setArtSet({ ...artSet, [setKey]: value }), [artSet, setArtSet])\r\n  const deleteValue = useCallback((setKey: ArtifactSetKey) => () => {\r\n    const { [setKey]: _, ...rest } = artSet\r\n    setArtSet({ ...rest })\r\n  }, [artSet, setArtSet])\r\n\r\n  const remaining = 5 - Object.values(artSet).reduce((a, b) => a + b, 0)\r\n\r\n  return <Stack spacing={1} sx={{ flexGrow: 1 }}>\r\n    {Object.entries(artSet).map(([setKey, value]) => <ArtifactSetEditor key={setKey} setKey={setKey} value={value} setValue={setValue(setKey)} deleteValue={deleteValue(setKey)} remaining={remaining} />)}\r\n    <CardLight sx={{ flexGrow: 1 }}>\r\n      <ArtifactSetSingleAutocomplete\r\n        showDefault\r\n        disableClearable\r\n        size=\"small\"\r\n        artSetKey={\"\"}\r\n        setArtSetKey={setSet}\r\n        sx={(theme) => ({\r\n          flexGrow: 1,\r\n          \".MuiFilledInput-root\": {\r\n            borderBottomRightRadius: theme.shape.borderRadius,\r\n            borderBottomLeftRadius: theme.shape.borderRadius\r\n          }\r\n        })}\r\n        defaultText={\"New Artifact Set\"}\r\n        disable={(setKey) => Object.keys(artSet).includes(setKey) || !artifactSheets?.(setKey) || Object.keys(artifactSheets(setKey).setEffects).every(n => parseInt(n) > remaining)}\r\n      />\r\n    </CardLight>\r\n\r\n  </Stack>\r\n}\r\nfunction ArtifactSetEditor({ setKey, value, setValue, deleteValue, remaining }: { setKey: ArtifactSetKey, value: 1 | 2 | 4, setValue: (v: 1 | 2 | 4) => void, deleteValue: () => void, remaining: number }) {\r\n  const artifactSheet = usePromise(() => ArtifactSheet.get(setKey), [])\r\n\r\n  /* Assumes that all conditionals are from 4-Set. needs to change if there are 2-Set conditionals */\r\n  const set4CondNums = useMemo(() => {\r\n    if (value < 4 || !artifactSheet) return []\r\n    return Object.keys(artifactSheet.setEffects).filter(setNumKey => artifactSheet.setEffects[setNumKey]?.document.some(doc => \"states\" in doc))\r\n  }, [artifactSheet, value])\r\n\r\n  if (!artifactSheet) return null\r\n  return <CardLight>\r\n    <Box display=\"flex\">\r\n      <ArtifactSetTooltip artifactSheet={artifactSheet} numInSet={value}>\r\n        <Box flexGrow={1} p={1} display=\"flex\" gap={1} alignItems=\"center\">\r\n          <ImgIcon size={2} sx={{ m: -1 }} src={artifactSheet.defIconSrc} />\r\n          <Box >{artifactSheet.setName}</Box>\r\n          <Info />\r\n        </Box>\r\n      </ArtifactSetTooltip>\r\n      <ButtonGroup>\r\n        <DropdownButton size=\"small\" title={<Box whiteSpace=\"nowrap\">{value}-set</Box>}>\r\n          {Object.keys(artifactSheet.setEffects).map(setKey => parseInt(setKey)).map(setKey =>\r\n            <MenuItem key={setKey} disabled={value === setKey || setKey > (remaining + value)} onClick={() => setValue(setKey as 1 | 2 | 4)}>{setKey}-set</MenuItem>\r\n          )}\r\n        </DropdownButton>\r\n        <Button color=\"error\" size=\"small\" onClick={deleteValue}>\r\n          <DeleteForever />\r\n        </Button>\r\n      </ButtonGroup>\r\n    </Box>\r\n    {!!set4CondNums.length && <Stack spacing={1} sx={{ p: 1 }}>\r\n      {set4CondNums.map(setNumKey =>\r\n        <SetEffectDisplay key={setNumKey} setKey={setKey} setNumKey={parseInt(setNumKey) as SetNum} hideHeader conditionalsOnly />\r\n      )}\r\n    </Stack>}\r\n  </CardLight>\r\n}\r\nfunction ArtifactSubCard({ substats, setSubstats, substatsType, setSubstatsType, mainStatKeys }: { substats: Record<SubstatKey, number>, setSubstats: (substats: Record<SubstatKey, number>) => void, substatsType: SubstatType, setSubstatsType: (t: SubstatType) => void, mainStatKeys: MainStatKey[] }) {\r\n  const setValue = useCallback((key: SubstatKey) => (v: number) => setSubstats({ ...substats, [key]: v }), [substats, setSubstats])\r\n  const { t } = useTranslation(\"page_character\")\r\n  const rv = Object.entries(substats).reduce((t, [k, v]) => t + (v / Artifact.substatValue(k)), 0) * 100\r\n  const rolls = Object.entries(substats).reduce((t, [k, v]) => t + (v / Artifact.substatValue(k, undefined, substatsType)), 0)\r\n  return <CardLight sx={{ p: 1, height: \"100%\" }}>\r\n    <Box sx={{ mb: 1, display: \"flex\", gap: 1 }}>\r\n      <DropdownButton fullWidth title={t(`tabTheorycraft.substatType.${substatsType}`)}>\r\n        {substatType.map(st => <MenuItem key={st} disabled={substatsType === st} onClick={() => setSubstatsType(st)}>{t(`tabTheorycraft.substatType.${st}`)}</MenuItem>)}\r\n      </DropdownButton>\r\n      <BootstrapTooltip title={<Typography>{t`tabTheorycraft.maxTotalRolls`}</Typography>} placement=\"top\">\r\n        <CardDark sx={{ textAlign: \"center\", py: 0.5, px: 1, minWidth: \"15em\", whiteSpace: \"nowrap\", display: \"flex\", gap: 2, justifyContent: \"flex-end\", alignItems: \"center\" }}>\r\n          <ColorText color={rolls > 45 ? \"warning\" : undefined} >Rolls: <strong>{rolls.toFixed(0)}</strong></ColorText>\r\n          <ColorText color={rolls > 45 ? \"warning\" : undefined} >RV: <strong>{rv.toFixed(1)}%</strong></ColorText>\r\n        </CardDark>\r\n      </BootstrapTooltip>\r\n    </Box>\r\n    <Stack spacing={1}>\r\n      {Object.entries(substats).map(([k, v]) => <ArtifactSubstatEditor key={k} statKey={k} value={v} setValue={setValue(k)} substatsType={substatsType} mainStatKeys={mainStatKeys} />)}\r\n    </Stack>\r\n  </CardLight>\r\n}\r\nfunction ArtifactSubstatEditor({ statKey, value, setValue, substatsType, mainStatKeys }: { statKey: SubstatKey, value: number, setValue: (v: number) => void, substatsType: SubstatType, mainStatKeys: MainStatKey[] }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const substatValue = Artifact.substatValue(statKey, 5, substatsType)\r\n  const [rolls, setRolls] = useState(() => value / substatValue)\r\n  useEffect(() => setRolls(value / substatValue), [value, substatValue])\r\n\r\n  const unit = KeyMap.unit(statKey)\r\n  const displayValue = rolls * substatValue\r\n\r\n  const rv = (rolls * substatValue) / Artifact.substatValue(statKey) * 100\r\n  const numMains = mainStatKeys.reduce((t, ms) => t + (ms === statKey ? 1 : 0), 0)\r\n  const maxRolls = (5 - numMains) * 6\r\n  // 0.0001 to nudge float comparasion\r\n  const invalid = (rolls - 0.0001) > maxRolls\r\n  const setRValue = useCallback((r: number) => setValue(r * substatValue), [setValue, substatValue])\r\n\r\n  return <Stack spacing={0.5}>\r\n    <Box display=\"flex\" gap={1} justifyContent=\"space-between\" alignItems=\"center\">\r\n      <CardDark sx={{ p: 0.5, minWidth: \"11em\", flexGrow: 1, display: \"flex\", gap: 1, alignItems: \"center\", justifyContent: \"center\" }}>\r\n        {StatIcon[statKey]}{KeyMap.getStr(statKey)}{KeyMap.unit(statKey)}\r\n      </CardDark>\r\n      <BootstrapTooltip title={<Typography>{t(numMains ? `tabTheorycraft.maxRollsMain` : `tabTheorycraft.maxRolls`, { value: maxRolls })}</Typography>} placement=\"top\">\r\n        <CardDark sx={{ textAlign: \"center\", p: 0.5, minWidth: \"8em\" }}>\r\n          <ColorText color={invalid ? \"warning\" : undefined}>RV: <strong>{rv.toFixed(1)}%</strong></ColorText>\r\n        </CardDark>\r\n      </BootstrapTooltip>\r\n    </Box>\r\n    <Box display=\"flex\" gap={1} justifyContent=\"space-between\" alignItems=\"center\">\r\n      <CustomNumberInput\r\n        color={displayValue ? \"success\" : \"primary\"}\r\n        float={KeyMap.unit(statKey) === \"%\"}\r\n        endAdornment={KeyMap.unit(statKey) || <Box width=\"1em\" component=\"span\" />}\r\n        value={parseFloat(displayValue.toFixed(2))}\r\n        onChange={v => v !== undefined && setValue(v)}\r\n        sx={{ borderRadius: 1, px: 1, height: \"100%\", width: \"6em\" }}\r\n        inputProps={{ sx: { textAlign: \"right\" }, min: 0 }} />\r\n      <CardDark sx={{ px: 2, flexGrow: 1, display: \"flex\", gap: 1, alignItems: \"center\", justifyContent: \"center\" }}>\r\n        <Slider\r\n          size=\"small\"\r\n          value={rolls}\r\n          max={maxRolls}\r\n          min={0}\r\n          step={1}\r\n          marks\r\n          onChange={(e, v) => setRolls(v as number)}\r\n          onChangeCommitted={(e, v) => setRValue(v as number)}\r\n        />\r\n      </CardDark>\r\n      <CustomNumberInput\r\n        color={value ? (invalid ? \"warning\" : \"success\") : \"primary\"}\r\n        float\r\n        startAdornment={<Box sx={{ whiteSpace: \"nowrap\", width: \"7em\", display: \"flex\", justifyContent: \"space-between\" }}><span>{cacheValueString(substatValue, unit)}{unit}</span><span>x</span></Box>}\r\n        value={parseFloat(rolls.toFixed(2))}\r\n        onChange={v => v !== undefined && setValue(v * substatValue)}\r\n        sx={{ borderRadius: 1, px: 1, my: 0, height: \"100%\", width: \"7em\" }}\r\n        inputProps={{ sx: { textAlign: \"right\", pr: 0.5, }, min: 0, step: 1 }} />\r\n    </Box>\r\n  </Stack>\r\n}\r\n","import { useContext, useEffect, useState } from \"react\"\r\nimport { DatabaseContext } from \"../../../../Database/Database\"\r\nimport { CharacterKey, WeaponKey } from \"../../../../Types/consts\"\r\n\r\nexport default function useCharTC(characterKey: CharacterKey, defWeapon: WeaponKey) {\r\n  const { database } = useContext(DatabaseContext)\r\n  const [charTC, setCharTC] = useState(() => database.charTCs.getWithInit(characterKey, defWeapon))\r\n  useEffect(() => setCharTC(database.charTCs.getWithInit(characterKey, defWeapon)), [database, characterKey, defWeapon])\r\n  useEffect(() =>\r\n    characterKey ? database.charTCs.follow(characterKey, (k, r, v) => r === \"update\" && setCharTC(v)) : undefined,\r\n    [characterKey, setCharTC, database])\r\n  return charTC\r\n}\r\n","import { MenuItem } from '@mui/material';\r\nimport { useContext } from 'react';\r\nimport ColorText from '../../Components/ColoredText';\r\nimport DropdownButton from '../../Components/DropdownMenu/DropdownButton';\r\nimport { CharacterContext } from '../../Context/CharacterContext';\r\nimport { stg } from '../../Data/SheetUtil';\r\nimport useCharSelectionCallback from '../../ReactHooks/useCharSelectionCallback';\r\nimport { allElements, travelerElements, TravelerKey, TravelerToElement } from '../../Types/consts';\r\n\r\nexport default function TravelerElementSelect() {\r\n  const { character } = useContext(CharacterContext)\r\n  const { key } = character\r\n  const setCharacter = useCharSelectionCallback()\r\n  if (!(key.startsWith(\"Traveler\"))) return null\r\n\r\n  const elementKey = allElements.find(e => key.toLowerCase().includes(e))!\r\n\r\n  return <DropdownButton color={elementKey} title={<strong>{stg(`element.${elementKey}`)}</strong>}>\r\n    {travelerElements.map(eleKey =>\r\n      <MenuItem key={eleKey} selected={elementKey === eleKey} disabled={elementKey === eleKey} onClick={() => setCharacter(TravelerToElement(key as TravelerKey, eleKey))}>\r\n        <strong><ColorText color={eleKey}>{stg(`element.${eleKey}`)}</ColorText></strong></MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n","import { Female, Male } from '@mui/icons-material';\r\nimport { Button } from '@mui/material';\r\nimport { useCallback, useContext } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { CharacterContext } from '../../Context/CharacterContext';\r\nimport { DatabaseContext } from '../../Database/Database';\r\nimport useDBMeta from '../../ReactHooks/useDBMeta';\r\n\r\nexport default function TravelerGenderSelect() {\r\n  const { t } = useTranslation(\"ui\")\r\n  const { database } = useContext(DatabaseContext)\r\n  const { character } = useContext(CharacterContext)\r\n  const { key } = character\r\n  const { gender } = useDBMeta()\r\n  const toggleGender = useCallback(() => database.dbMeta.set({ gender: gender === \"F\" ? \"M\" : \"F\" }), [gender, database])\r\n  if (!(key.startsWith(\"Traveler\"))) return null\r\n  return <Button onClick={toggleGender} startIcon={gender === \"F\" ? <Female /> : <Male />}><strong>{t(`gender.${gender}`)}</strong>  </Button>\r\n}\r\n","import { BarChart, Calculate, FactCheck, Groups, Person, Science, TrendingUp } from '@mui/icons-material';\r\nimport { Box, Button, CardContent, Skeleton, Tab, Tabs } from '@mui/material';\r\nimport { Suspense, useCallback, useContext, useMemo } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Link as RouterLink, Navigate, Route, Routes, useMatch, useNavigate, useParams } from 'react-router-dom';\r\nimport CardDark from '../../Components/Card/CardDark';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport CloseButton from '../../Components/CloseButton';\r\nimport { HitModeToggle, InfusionAuraDropdown, ReactionToggle } from '../../Components/HitModeEditor';\r\nimport LevelSelect from '../../Components/LevelSelect';\r\nimport SqBadge from '../../Components/SqBadge';\r\nimport { CharacterContext, CharacterContextObj } from '../../Context/CharacterContext';\r\nimport { DataContext, dataContextObj } from '../../Context/DataContext';\r\nimport { FormulaDataContext, FormulaDataWrapper } from '../../Context/FormulaDataContext';\r\nimport CharacterSheet from '../../Data/Characters/CharacterSheet';\r\nimport { DatabaseContext } from '../../Database/Database';\r\nimport useBoolState from '../../ReactHooks/useBoolState';\r\nimport useCharacter from '../../ReactHooks/useCharacter';\r\nimport useCharacterReducer from '../../ReactHooks/useCharacterReducer';\r\nimport useDBMeta from '../../ReactHooks/useDBMeta';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport useTeamData from '../../ReactHooks/useTeamData';\r\nimport useTitle from '../../ReactHooks/useTitle';\r\nimport { CharacterKey, charKeyToCharName } from '../../Types/consts';\r\nimport { CustomMultiTargetButton } from '../CustomMultiTarget';\r\nimport CharSelectDropdown from './CharSelectDropdown';\r\nimport FormulaModal from './FormulaModal';\r\nimport StatModal from './StatModal';\r\nimport TabBuild from './Tabs/TabOptimize';\r\nimport TabOverview from './Tabs/TabOverview';\r\nimport TabTalent from './Tabs/TabTalent';\r\nimport TabTeambuffs from './Tabs/TabTeambuffs';\r\nimport TabTheorycraft from './Tabs/TabTheorycraft';\r\nimport TravelerElementSelect from './TravelerElementSelect';\r\nimport TravelerGenderSelect from './TravelerGenderSelect';\r\n\r\nexport default function CharacterDisplay() {\r\n  const navigate = useNavigate();\r\n  const { database } = useContext(DatabaseContext)\r\n  const onClose = useCallback(() => navigate(\"/characters\"), [navigate])\r\n  let { characterKey } = useParams<{ characterKey?: CharacterKey }>();\r\n  const invalidKey = !database.chars.keys.includes(characterKey as CharacterKey)\r\n  if (invalidKey)\r\n    return <Navigate to=\"/characters\" />\r\n\r\n  return <Box my={1} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />}>\r\n      {characterKey && <CharacterDisplayCard characterKey={characterKey} onClose={onClose} />}\r\n    </Suspense>\r\n  </Box>\r\n}\r\n\r\ntype CharacterDisplayCardProps = {\r\n  characterKey: CharacterKey,\r\n  onClose?: () => void,\r\n}\r\nfunction CharacterDisplayCard({ characterKey, onClose }: CharacterDisplayCardProps) {\r\n  const character = useCharacter(characterKey)\r\n  const { gender } = useDBMeta()\r\n  const characterSheet = usePromise(() => CharacterSheet.get(characterKey, gender), [characterKey, gender])\r\n  const teamData = useTeamData(characterKey)\r\n  const { target: charUIData } = teamData?.[characterKey] ?? {}\r\n  let { params: { tab = \"overview\" } } = useMatch({ path: \"/characters/:charKey/:tab\", end: false }) ?? { params: { tab: \"overview\" } }\r\n  const { t } = useTranslation([\"charNames_gen\", \"page_character\"])\r\n\r\n  useTitle(useMemo(() => `${t(`charNames_gen:${charKeyToCharName(characterKey, gender)}`)} - ${t(`page_character:tabs.${tab}`)}`, [t, characterKey, gender, tab]))\r\n\r\n  const characterDispatch = useCharacterReducer(character?.key ?? \"\")\r\n\r\n  const dataContextValue: dataContextObj | undefined = useMemo(() => {\r\n    if (!teamData || !charUIData) return undefined\r\n    return {\r\n      data: charUIData,\r\n      teamData,\r\n      oldData: undefined,\r\n    }\r\n  }, [charUIData, teamData])\r\n\r\n  const characterContextValue: CharacterContextObj | undefined = useMemo(() => {\r\n    if (!character || !characterSheet) return undefined\r\n    return {\r\n      character,\r\n      characterSheet,\r\n      characterDispatch\r\n    }\r\n  }, [character, characterSheet, characterDispatch])\r\n  return <CardDark >\r\n    {dataContextValue && characterContextValue ? <CharacterContext.Provider value={characterContextValue}><DataContext.Provider value={dataContextValue}>\r\n      <FormulaDataWrapper><CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n        <Box display=\"flex\" >\r\n          <Box display=\"flex\" gap={1} flexWrap=\"wrap\" flexGrow={1}>\r\n            <CharSelectDropdown />\r\n            <TravelerElementSelect />\r\n            <TravelerGenderSelect />\r\n            <DetailStatButton />\r\n            <CustomMultiTargetButton />\r\n            <FormulasButton />\r\n          </Box>\r\n          {!!onClose && <CloseButton onClick={onClose} />}\r\n        </Box>\r\n        <Box display=\"flex\" gap={1} flexWrap=\"wrap\">\r\n          {character && <LevelSelect level={character.level} ascension={character.ascension} setBoth={characterDispatch} />}\r\n          <HitModeToggle size=\"small\" />\r\n          <InfusionAuraDropdown />\r\n          <ReactionToggle size=\"small\" />\r\n        </Box>\r\n        <CardLight>\r\n          <TabNav tab={tab} />\r\n        </CardLight>\r\n        <CharacterPanel />\r\n        <CardLight>\r\n          <TabNav tab={tab} />\r\n        </CardLight>\r\n      </CardContent></FormulaDataWrapper>\r\n    </DataContext.Provider></CharacterContext.Provider> : <Skeleton variant='rectangular' width='100%' height={1000} />\r\n    }\r\n  </CardDark >\r\n}\r\nfunction CharacterPanel() {\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={500} />}>\r\n    <Routes>\r\n      {/* Character Panel */}\r\n      <Route index element={<TabOverview />} />\r\n      <Route path=\"/talent\" element={<TabTalent />} />\r\n      <Route path=\"/teambuffs\" element={<TabTeambuffs />} />\r\n      <Route path=\"/optimize\" element={<TabBuild />} />\r\n      <Route path=\"/theorycraft\" element={<TabTheorycraft />} />\r\n    </Routes>\r\n  </Suspense>\r\n}\r\nfunction TabNav({ tab }: { tab: string }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  return <Tabs\r\n    value={tab}\r\n    variant=\"scrollable\"\r\n    allowScrollButtonsMobile\r\n    sx={{\r\n      \"& .MuiTab-root:hover\": {\r\n        transition: \"background-color 0.25s ease\",\r\n        backgroundColor: \"rgba(255,255,255,0.1)\"\r\n      },\r\n    }}\r\n  >\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"overview\" label={t(\"tabs.overview\")} icon={<Person />} component={RouterLink} to=\"\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"talent\" label={t(\"tabs.talent\")} icon={<FactCheck />} component={RouterLink} to=\"talent\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"teambuffs\" label={t(\"tabs.teambuffs\")} icon={<Groups />} component={RouterLink} to=\"teambuffs\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"optimize\" label={t(\"tabs.optimize\")} icon={<TrendingUp />} component={RouterLink} to=\"optimize\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"theorycraft\" label={t(\"tabs.theorycraft\")} icon={<Science />} component={RouterLink} to=\"theorycraft\" />\r\n  </Tabs>\r\n}\r\n\r\n\r\nfunction DetailStatButton() {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const [open, onOpen, onClose] = useBoolState()\r\n  const { character: { bonusStats } } = useContext(CharacterContext)\r\n  const bStatsNum = Object.keys(bonusStats).length\r\n  return <>\r\n    <Button color=\"info\" startIcon={<BarChart />} onClick={onOpen}>\r\n      {t`addStats.title`}{!!bStatsNum && <SqBadge sx={{ ml: 1 }} color=\"success\" >{bStatsNum}</SqBadge>}\r\n    </Button>\r\n    <StatModal open={open} onClose={onClose} />\r\n  </>\r\n}\r\nfunction FormulasButton() {\r\n  const { onModalOpen } = useContext(FormulaDataContext)\r\n  return <>\r\n    <Button color=\"info\" startIcon={<Calculate />} onClick={onModalOpen}>Formulas {\"&\"} Calcs</Button>\r\n    <FormulaModal />\r\n  </>\r\n}\r\n","import { faEdit, faTrashAlt } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { Lock, LockOpen } from \"@mui/icons-material\"\r\nimport { Box, Button, ButtonGroup, CardActionArea, CardContent, IconButton, Skeleton, Tooltip, Typography } from \"@mui/material\"\r\nimport { Suspense, useCallback, useContext, useMemo } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport Assets from \"../Assets/Assets\"\r\nimport CardLight from \"../Components/Card/CardLight\"\r\nimport { LocationAutocomplete } from \"../Components/Character/LocationAutocomplete\"\r\nimport LocationName from \"../Components/Character/LocationName\"\r\nimport ConditionalWrapper from \"../Components/ConditionalWrapper\"\r\nimport ImgIcon from \"../Components/Image/ImgIcon\"\r\nimport { StarsDisplay } from \"../Components/StarDisplay\"\r\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\"\r\nimport { ascensionMaxLevel } from \"../Data/LevelData\"\r\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\"\r\nimport { DatabaseContext } from \"../Database/Database\"\r\nimport { uiInput as input } from \"../Formula\"\r\nimport { computeUIData, dataObjForWeapon } from \"../Formula/api\"\r\nimport { nodeVStr } from \"../Formula/uiData\"\r\nimport usePromise from \"../ReactHooks/usePromise\"\r\nimport useWeapon from \"../ReactHooks/useWeapon\"\r\nimport { LocationKey } from \"../Types/consts\"\r\n\r\ntype WeaponCardProps = { weaponId: string, onClick?: (weaponId: string) => void, onEdit?: (weaponId: string) => void, onDelete?: (weaponId: string) => void, canEquip?: boolean, extraButtons?: JSX.Element }\r\nexport default function WeaponCard({ weaponId, onClick, onEdit, onDelete, canEquip = false, extraButtons }: WeaponCardProps) {\r\n  const { t } = useTranslation([\"page_weapon\", \"ui\"]);\r\n  const { database } = useContext(DatabaseContext)\r\n  const databaseWeapon = useWeapon(weaponId)\r\n  const weapon = databaseWeapon\r\n  const weaponSheet = usePromise(() => weapon?.key ? WeaponSheet.get(weapon.key) : undefined, [weapon?.key])\r\n\r\n  const filter = useCallback((cs: CharacterSheet) => cs.weaponTypeKey === weaponSheet?.weaponType, [weaponSheet])\r\n\r\n  const wrapperFunc = useCallback(children => <CardActionArea onClick={() => onClick?.(weaponId)} >{children}</CardActionArea>, [onClick, weaponId],)\r\n  const falseWrapperFunc = useCallback(children => <Box >{children}</Box>, [])\r\n  const setLocation = useCallback((k: LocationKey) => weaponId && database.weapons.set(weaponId, { location: k }), [database, weaponId])\r\n\r\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\r\n\r\n  if (!weapon || !weaponSheet || !UIData) return null;\r\n  const { level, ascension, refinement, id, location = \"\", lock } = weapon\r\n  const weaponTypeKey = UIData.get(input.weapon.type).value!\r\n  const stats = [input.weapon.main, input.weapon.sub, input.weapon.sub2].map(x => UIData.get(x))\r\n  const img = weaponSheet.getImg(ascension)\r\n\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 300 }} />}>\r\n    <CardLight sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\", justifyContent: \"space-between\" }}>\r\n      <ConditionalWrapper condition={!!onClick} wrapper={wrapperFunc} falseWrapper={falseWrapperFunc}>\r\n        <Box className={`grad-${weaponSheet.rarity}star`} sx={{ position: \"relative\", pt: 2, px: 2, }}>\r\n          {!onClick && <IconButton color=\"primary\" onClick={() => database.weapons.set(id, { lock: !lock })} sx={{ position: \"absolute\", right: 0, bottom: 0, zIndex: 2 }}>\r\n            {lock ? <Lock /> : <LockOpen />}\r\n          </IconButton>}\r\n          <Box sx={{ position: \"relative\", zIndex: 1 }}>\r\n            <Box component=\"div\" sx={{ display: \"flex\", alignItems: \"center\", gap: 1, mb: 1 }}>\r\n              <ImgIcon sx={{ fontSize: \"1.5em\" }} src={Assets.weaponTypes?.[weaponTypeKey]} />\r\n              <Typography noWrap sx={{ textAlign: \"center\", backgroundColor: \"rgba(100,100,100,0.35)\", borderRadius: \"1em\", px: 1 }}><strong>{weaponSheet.name}</strong></Typography>\r\n            </Box>\r\n            <Typography component=\"span\" variant=\"h5\">Lv. {level}</Typography>\r\n            <Typography component=\"span\" variant=\"h5\" color=\"text.secondary\">/{ascensionMaxLevel[ascension]}</Typography>\r\n            <Typography variant=\"h6\">Refinement <strong>{refinement}</strong></Typography>\r\n            <Typography><StarsDisplay stars={weaponSheet.rarity} colored /></Typography>\r\n          </Box>\r\n          <Box sx={{ height: \"100%\", position: \"absolute\", right: 0, top: 0 }}>\r\n            <Box\r\n              component=\"img\"\r\n              src={img ?? \"\"}\r\n              width=\"auto\"\r\n              height=\"100%\"\r\n              sx={{ float: \"right\" }}\r\n            />\r\n          </Box>\r\n        </Box>\r\n        <CardContent>\r\n          {stats.map(node => {\r\n            if (!node.info.name) return null\r\n            return <Box key={JSON.stringify(node.info)} sx={{ display: \"flex\" }}>\r\n              <Typography flexGrow={1}>{node.info.icon} {node.info.name}</Typography>\r\n              <Typography>{nodeVStr(node)}</Typography>\r\n            </Box>\r\n          })}\r\n        </CardContent>\r\n      </ConditionalWrapper>\r\n      <Box sx={{ p: 1, display: \"flex\", gap: 1, justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n        <Box sx={{ flexGrow: 1 }}>\r\n          {canEquip\r\n            ? <LocationAutocomplete location={location} setLocation={setLocation} filter={filter} autoCompleteProps={{ getOptionDisabled: t => !t.key, disableClearable: true }} />\r\n            : <LocationName location={location} />}\r\n        </Box>\r\n        <ButtonGroup sx={{ height: \"100%\" }}>\r\n          {!!onEdit && <Tooltip title={<Typography>{t`page_weapon:edit`}</Typography>} placement=\"top\" arrow>\r\n            <Button color=\"info\" onClick={() => onEdit(id)} >\r\n              <FontAwesomeIcon icon={faEdit} className=\"fa-fw\" />\r\n            </Button>\r\n          </Tooltip>}\r\n          {!!onDelete && <Button color=\"error\" onClick={() => onDelete(id)} disabled={!!location || lock} >\r\n            <FontAwesomeIcon icon={faTrashAlt} className=\"fa-fw\" />\r\n          </Button>}\r\n          {extraButtons}\r\n        </ButtonGroup>\r\n      </Box>\r\n    </CardLight>\r\n  </Suspense>\r\n}\r\n"],"names":["MenuItemWithImage","value","image","text","theme","isSelected","addlElement","props","MenuItem","ListItemIcon","ListItemText","primaryTypographyProps","style","fontWeight","typography","fontWeightMedium","fontWeightRegular","ArtifactMultiAutocomplete","allArtifactKeysWithGrouper","selectedArtifactKeys","setArtifactKeys","getName","getImage","label","useTheme","options","useMemo","map","key","grouper","Autocomplete","autoHighlight","multiple","disableCloseOnSelect","onChange","_","v","getOptionLabel","option","isOptionEqualToValue","renderInput","params","TextField","variant","InputLabelProps","color","palette","primary","length","type","renderOption","KeyMap","includes","renderTags","selected","getTagProps","index","element","allElementsWithPhy","ele","undefined","Chip","icon","ArtifactSetMultiAutocomplete","artSetKeys","setArtSetKeys","artifactSheets","usePromise","ArtifactSheet","t","useTranslation","allArtifactSetsAndRarities","Object","entries","flatMap","rarity","set","sort","sortByRarityAndName","defIcon","groupBy","toString","renderGroup","group","List","component","Box","ListSubheader","sx","top","stars","children","ArtifactMainStatMultiAutocomplete","mainStatKeys","setMainStatKeys","allMainStatKeys","StatIcon","ArtifactSubstatMultiAutocomplete","substatKeys","setSubstatKeys","allSubstatKeys","ArtifactSingleAutocomplete","selectedArtifactKey","setArtifactKey","disable","showDefault","defaultText","defaultIcon","concat","clearIcon","event","newValue","reason","getOptionDisabled","startAdornment","hasValue","ArtifactSetSingleAutocomplete","artSetKey","setArtSetKey","a","b","aName","i18n","bName","ArtifactLevelSlider","levelLow","levelHigh","setLow","setHigh","setBoth","dark","disabled","showLevelText","useState","sliderLow","setsliderLow","sliderHigh","setsliderHigh","setSlider","useCallback","e","TypeError","l","h","useEffect","width","display","alignItems","bgcolor","val","clamp","px","pl","inputProps","textAlign","flexGrow","mx","getAriaLabel","onChangeCommitted","valueLabelDisplay","min","max","step","marks","CardHeaderCustom","avatar","title","action","gap","p","ConditionalSelector","conditional","keys","states","SimpleConditionalSelector","ExclusiveConditionalSelector","MultipleConditionalSelector","useContext","CharacterContext","character","characterDispatch","data","DataContext","setConditional","conditionalValues","deepClone","layeredAssignment","path","deletePropPath","conditionalValue","get","stateKey","badge","getStateBadge","name","condName","getCondName","Button","fullWidth","size","borderRadius","onClick","startIcon","CheckBox","CheckBoxOutlineBlank","state","SqBadge","DropdownButton","Divider","st","ButtonGroup","orientation","disableElevation","isElement","disp","stateName","badgeColor","badgeText","ml","key18","ns","values","Translate","useBadge","ConditionalDisplay","fields","hideHeader","hideDesc","condVal","CardDark","evalIfFunc","HeaderDisplay","header","CardContent","pb","DocumentDisplay","sections","teamBuffOnly","sectionDisplays","s","i","canShow","teamBuff","SectionDisplay","section","filter","flexDirection","FieldsSectionDisplay","TextSectionDisplay","hideDivider","description","displayTitle","InfoTooltip","Typography","LevelSelect","level","ascension","useLow","ascensionMaxLevels","ascensionMaxLevelLow","ascensionMaxLevel","setLevel","maxLevelLow","maxLevel","findIndex","ascenML","setAscension","lowerAscension","contentDark","main","height","whiteSpace","ambiguousLevelLow","ambiguousLevel","milestoneLevelsLow","milestoneLevels","lv","as","RefinementDropdown","refinement","setRefinement","allRefinement","r","DisabledButton","styled","backgroundColor","secondary","TextButton","CharacterSelectionModal","React","CharSelectDropdown","characterSheet","showModal","setshowModal","setCharacter","useCharSelectionCallback","Suspense","fallback","show","onHide","onSelect","ThumbSide","src","thumbImgSide","FormulaModal","modalOpen","FormulaDataContext","setFormulaData","onCloseHandler","ModalWrapper","open","onClose","CardHeader","CloseButton","pt","CalculationDisplay","contextData","getDisplaySections","Skeleton","mr","mb","Nodes","FormulaCalc","displayNs","sectionKey","database","DatabaseContext","getDisplayHeader","every","isEmpty","CardLight","ImgIcon","m","node","FormulaAccordian","contextNode","expanded","setExpanded","handleChange","isExpanded","scrollRef","useRef","setTimeout","current","scrollIntoView","behavior","Accordion","ref","AccordionSummary","expandIcon","ExpandMore","info","nodeVStr","allAmpReactions","AmpReactionModeText","reaction","trigger","subVariant","AccordionDetails","formulas","subform","expand","other","IconButton","transform","marginLeft","transition","transitions","create","duration","shortest","FlexButtonGroup","StatInput","placeholder","defaultValue","onValueChange","percent","onReset","restProps","CustomNumberInput","flexBasis","float","endAdornment","flexShrink","Replay","EnemyExpandCard","setexpanded","toggle","eLvlNode","input","eDefRed","eDefIgn","enemyOverride","flexWrap","EnemyResText","justifyContent","Collapse","in","timeout","unmountOnExit","EnemyEditor","content","isFinite","bsProps","xs","md","eLvl","enemyLevel","enemyDefIgn_","enemyDefRed_","Grid","container","spacing","item","href","target","rel","contentLight","statKey","eleKey","elementImmunity","Number","MAX_VALUE","Infinity","cols","lg","StatModal","Stack","BonusStatsEditor","MainStatsCards","allInputPremodKeys","wrapperFunc","bonusStats","setFilter","columns","StatEditorList","statKeys","statFilters","setStatFilters","mainSubKeys","mainReadNodes","k","mainEditKeys","otherStatKeys","allEleDmgKeys","allEleResKeys","miscStatkeys","StatDisplayContent","nodes","extra","oldData","FieldDisplay","rn","ListItem","oldValue","JSON","stringify","specialNode","charEle","elementKey","isMelee","otherStatReadNodes","n","miscStatReadNodes","StatDisplayCard","py","OptimizationTargetContext","createContext","filterFeasiblePerm","artSetPerm","pruneAll","minimum","arts","numTop","exclusion","forced","should","deps","pruneNodeRange","reaffine","pruneOrder","pruneArtRange","count","some","x","newArts","newNodes","pruneExclusion","maxValues","mapFormulas","f","operation","operands","pass","fail","thres","threshold","forceRename","affineNodes","Set","topLevelAffine","visit","isAffine","add","forEach","op","has","dynKeys","forEachNodes","nonConst","assertUnreachable","base","nextDynKey","affine","affineMap","Map","customRead","accu","reaffineArt","stat","constantFold","dyn","objectMap","constant","fromEntries","result","objectKeyMap","allSlotKeys","slot","id","offsets","baseValue","progress","noRainbow","rainbow","noSwitchIn","noSwitchOut","list","newList","art","greaterEqual","greater","baseRange","wrap","artRanges","computeArtRange","otherArtRanges","addArtRange","read","newRange","computeNodeRange","nodeRange","operandRanges","newOperands","op1","op2","j","ranges","range","reads","Error","computeMinMax","allOperations","reduce","c","sum","NaN","minMaxes","Math","mergeBuilds","builds","maxNum","slice","mergePlot","plots","scale","round","plot","build","filters","_artSets","artSets","available","kind","sets","exclusionToAllowed","populateShapes","indexOfShape","check","shape","check_free","remaining","rainbows","isolated","missing","rejected","required","allowedSet","allowedCounts","counts","push","find","groupped","used","requiredRainbows","usableRainbows","delete","replacing","allowedRainbows","shapes","noFilter","SetEffectDisplay","setKey","setNumKey","conditionalsOnly","sheet","document","setEffectDocument","useBuildSetting","characterKey","buildSettings","buildSetting","setBuildSetting","follow","buildSettingDispatch","ArtifactSetConfig","dataContext","artSetExclusion","setOpen","onOpen","useForceUpdate","dbDirty","forceUpdate","followAny","artKeys","reverse","artSlotCount","sk","slotKey","artSetKeyList","aCount","getNumSlots","bCount","allowRainbow2","allowRainbow4","allow2","allow4","exclude2","exclude4","artifactCondCount","allArtifactSets","fakeDataContextObj","UIData","artSet","resetArtConds","tconditional","setAllExclusion","setnum","exclude","artSetExclusion_","faChartLine","className","faBan","Settings","Trans","i18nKey","AllSetAllowExcludeCard","setNum","numAllow","numExclude","gutterBottom","num","endIcon","ArtifactSetCard","slotCount","large","setExclusionSet","slots","set4CondNums","setEffects","doc","opacity","defIconSrc","paddingTop","artifactSlotIcon","parseInt","tot","levels","AssumeFullLevelToggle","mainStatAssumptionLevel","setmainStatAssumptionLevel","lvl","BonusStatsCard","bonusStatsKeys","Monospace","fontFamily","BorderLinearProgress","LinearProgress","BuildAlert","status","tested","skipped","failed","total","startTime","finishTime","characterName","hasTotal","generatingBuilds","unskipped","testedString","toLocaleString","unskippedString","skippedText","durationString","timeStringMs","performance","now","subtitle","Alert","severity","toFixed","ArtifactCardNano","artifactId","pSlotKey","showLocation","BGComponent","useArtifact","actionWrapperFunc","CardActionArea","Assets","mainStatKey","substats","location","mainStatLevel","mainStatUnit","alpha","ConditionalWrapper","condition","wrapper","position","ArtifactTooltip","slotIcons","maxHeight","maxWidth","pointerEvents","Artifact","LocationIcon","charKey","chars","LocationToCharacterKey","overflow","bottom","zIndex","BootstrapTooltip","placement","disableInteractive","cacheValueString","SubstatDisplay","numRolls","rolls","rollColor","unit","alignContent","gender","useDBMeta","CharacterSheet","marginTop","BusinessCenter","StatDisplayComponent","Masonry","sm","xl","Section","optimizationTarget","displayNsReads","nodeKey","emphasize","WeaponCardNano","weaponId","weapon","useWeapon","weaponSheet","WeaponSheet","computeUIData","dataObjForWeapon","WeaponNameTooltip","getImg","hasRefinement","WeaponStat","BuildDisplayItem","compareBuild","extraButtonsRight","extraButtonsLeft","equippedArtifacts","newOld","setNewOld","close","equipBuild","window","confirm","aid","charKeyToLocCharKey","weapons","statProviderContext","dataContext_","artNanos","oldId","newId","currentlyEquipped","CompareArtifactModal","SetBadges","Checkroom","setToSlots","slotarr1","slotarr","SetBadge","artifactSheet","numInSet","setActive","ArtifactSetTooltip","onEquip","containerProps","minWidth","ArtifactCard","canExclude","canEquip","editorProps","disableSet","disableSlot","ChevronRight","fontSize","ChartCard","chartData","plotBase","setPlotBase","showTooltip","showDownload","setshowDownload","showMin","setshowMin","displayData","downloadData","increasingX","y","minimumData","point","last","pop","allData","OptimizationTargetSelector","setTarget","Download","DataDisplay","Chart","plotNode","valueNode","TextArea","resize","minHeight","readOnly","selectionStart","selectionEnd","xLabel","Label","fill","dy","getLabelFromNode","yLabel","angle","dx","ResponsiveContainer","ComposedChart","CartesianGrid","strokeDasharray","XAxis","dataKey","domain","tick","tickFormatter","YAxis","allowDecimals","ZAxis","Legend","Scatter","line","lineType","isAnimationActive","Line","stroke","connectNulls","strokeWidth","console","log","textSuffix","artifactsSlotsToSelectMainStats","MainStatSelectionCard","numSel","mt","cursor","StatFilterCard","UseEquipped","useEquippedArts","useBoolState","displayOptimize","tempEquipmentPriority","equipmentPriority","setTO","to","ck","setPrio","setPrioRank","fromIndex","toIndex","arr","splice","removePrio","addPrio","resetPrio","numAbove","indexOf","numUseEquippedChar","numUnlisted","SelectItem","rank","maxRank","setRank","onRemove","NewItem","onAdd","useCharacter","equippedWeapon","KeyboardDoubleArrowUp","KeyboardArrowUp","KeyboardArrowDown","KeyboardDoubleArrowDown","Close","CharacterCardPico","WeaponCardPico","aId","ArtifactCardPico","artifactObj","char","Add","UseExcluded","artsDirty","useExcludedArts","numExcludedArt","dynamic","setReadNodeKeys","dynamicData","compactArtifacts","allowPartial","flower","plume","goblet","circlet","sands","mainStatVal","endsWith","substat","accurateValue","TabBuild","compareData","buildStatus","setBuildStatus","setchartData","setArtsDirty","threads","defThreads","setDisplayOptimize","maxWorkers","setMaxWorkers","useCharacterReducer","onClickTeammate","noArtifact","maxBuildsToShow","buildResult","setBuildResult","buildResultDispatch","useBuildResult","buildDate","teamData","useTeamData","isSM","useMediaQueryUp","cancelToken","generateBuilds","getThreshold","fetchContinueWork","fetchPruningWork","fetchRequestWork","requestFilters","command","unprunedFilters","next","done","minCount","minFilterCount","buildValues","cantTakeList","ek","filteredArts","mainStats","split","getTeamData","workerData","uiDataForTeam","assign","mergeData","unoptimizedOptimizationTargetNode","objPathValue","targetNode","valueFilter","cancelled","Promise","unoptimizedNodes","setPerms","prepruneArts","optimize","plotBaseNode","optimizationTargetNode","Array","maxRequestFilterInFlight","Symbol","iterator","idleWorkers","splittingWorkers","workers","finalizedList","worker","Worker","URL","setup","maxBuilds","postMessage","countCommand","finalize","finalized","onmessage","source","terminate","pruned","prepruned","work","then","buildTimer","setInterval","any","all","results","clearInterval","plotData","artifactIds","Date","targetSelector","Link","RouterLink","CharacterCard","maxBuildsToShowList","getDisplay","TrendingUp","SolidToggleButtonGroup","exclusive","ToggleButton","Provider","BuildList","DataContextWrapper","BuildItemWrapper","join","useLocation","navigate","useNavigate","toTC","paths","pathname","Science","dirty","setDirty","buildsArts","providerValue","CompareBuildButton","artId","onShow","CompareContent","Tooltip","arrow","Difference","newArt","artmap","dataProviderValue","numToShowMap","ArtifactFilterDisplay","lazy","ArtifactSwapModal","onChangeId","clickHandler","filterOptionReducer","slotKeys","useReducer","initialFilterOption","filterOption","filterOptionDispatch","brPt","filterConfigs","artifactFilterConfigs","artIdList","filterFunc","filterFunction","disableSlotFilter","extraButtons","rarityHandler","handleMultiSelect","allRarities","WeaponSwapModal","weaponTypeKey","weaponSheets","setRarity","searchTerm","setSearchTerm","deferredSearchTerm","useDeferredValue","weaponIdList","weaponType","weaponFilterConfigs","sortFunction","weaponSortMap","weaponSortConfigs","star","autoFocus","InputProps","WeaponCard","WeaponEditor","EquipmentSection","setweaponId","showWeapon","hideWeapon","breakpoint","useMediaQuery","breakpoints","up","weaponDoc","rvFilter","useCharMeta","deferredRvFilter","deferredRvSet","footer","LargeWeaponSwapButton","ArtifactSectionCard","onEdit","WeaponSwapButton","effFilter","ArtifactSwapButton","ArtSwapCard","SwapHoriz","hasEquipped","unequipArts","setRVFilter","charMeta","deferredrvFilter","artid","currentEfficiency","maxEfficiency","currentEfficiency_","maxEfficiency_","rvField","PercentBadge","valid","rvmField","borderBottomRightRadius","borderBottomLeftRadius","SubstatToggle","selectedKeys","field","TabOverview","onScroll","CharacterProfileCard","EquipmentRow","team","constellation","tlvl","auto","skill","burst","tBoost","favorite","left","colored","Favorite","FavoriteBorder","right","getLevelString","cardImg","tKey","Badge","badgeContent","overlap","anchorOrigin","vertical","horizontal","padding","lineHeight","getTalentOfKey","img","constellationName","talentSpacing","CharacterTalentPane","grlg","constellationCards","SkillDisplayCard","talentKey","onClickTitle","ReactionDisplay","tText","asc","enabled","talentLimits","talent","actionWrapeprFunc","setTalentLevel","newTalentLevelKey","levelBoost","talentSheet","headerAction","TabTeambuffs","TeamBuffDisplay","ResonanceDisplay","TeammateDisplay","teamBuffs","getTeamBuff","premod","enemy","teamCount","titleTypographyProps","resonanceSheets","res","desc","active","activeCharacterKey","teamMateKey","onClickHandler","setTeammate","dataBundle","teammateCharacterContext","teamConditional","teamMateDataContext","TeammateAutocomplete","setChar","onClickHeader","artifactChildren","CharArtifactCondDisplay","weaponChildren","CharWeaponCondDisplay","characterChildren","CharTalentCondDisplay","isTeammateCard","sn","sts","autoCompleteProps","characterSheets","toText","startsWith","charKeyToCharName","toImg","PersonAdd","pr","isFavorite","onDisable","localeCompare","GeneralAutocomplete","valueKey","clearKey","WeaponSelectionModal","TabTheorycraft","defWeapon","charTCs","getWithInit","charTC","setCharTC","useCharTC","defaultInitialWeaponKey","setData","resetData","initCharTC","setWeapon","copyFrom","eWeapon","newData","artifact","stats","locBuild","copyFromEquipped","lock","setArtifact","data_","setSubstatsType","setSubstats","deferredData","overriderArtData","overrideWeapon","charUIData","dataContextValue","dataContextValueWithOld","CopyAll","Refresh","WeaponEditorCard","ArtifactMainLevelCard","artifactData","setArtifactData","ArtifactSubCard","substatsType","weaponUIData","weaponTypeFilter","flexshrink","setSlot","artifactData_","setArtSet","ArtifactMainLevelSlot","ArtifactSetsEditor","setSlotProp","mLvl","maxArtifactLevel","FontAwesomeSvgIcon","slotIconSVG","msk","faStar","my","setSet","setValue","deleteValue","rest","ArtifactSetEditor","disableClearable","setName","Info","DeleteForever","rv","substatType","ArtifactSubstatEditor","substatValue","setRolls","displayValue","numMains","ms","maxRolls","invalid","setRValue","parseFloat","Slider","TravelerElementSelect","allElements","toLowerCase","stg","travelerElements","TravelerToElement","TravelerGenderSelect","toggleGender","dbMeta","Female","Male","CharacterDisplay","useParams","CharacterDisplayCard","useMatch","end","tab","useTitle","characterContextValue","DetailStatButton","CustomMultiTarget","FormulasButton","TabNav","CharacterPanel","Tabs","allowScrollButtonsMobile","Tab","Person","FactCheck","Groups","bStatsNum","BarChart","onModalOpen","Calculate","onDelete","cs","falseWrapperFunc","setLocation","falseWrapper","noWrap","faEdit","faTrashAlt"],"sourceRoot":""}