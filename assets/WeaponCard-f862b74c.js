import{g as D,h as N,k as e,a1 as T,i as s,l as R,B as i,c8 as k,cf as W,u as $,a as F,r as p,x as O,a6 as G,T as c,bM as K,C as H,aR as U,w as C,z as J,m as P}from"./index-ae0e5ead.js";import{a as Q,d as V,S as q,h as E,b as X,c as Y,L as Z}from"./StarDisplay-3a29ee7b.js";import{x as ee,y as ae,u as h,w as te,n as ne,C as se}from"./index-2c4aa6a3.js";import{u as oe}from"./WeaponUtil-42644eba.js";import{L as ie,a as re,b as le,d as ce}from"./LocationAutocomplete-98591767.js";import{I as pe,i as de}from"./ColoredText-c98c28ec.js";import{g as ue}from"./index-ab1db78b.js";const me=E([...T]);function ve({value:a,totals:n,onChange:u,...m}){const g=D(),d=!N(g.breakpoints.up("sm"));return e(q,{exclusive:!0,value:a,...m,children:T.map(l=>e(Q,{value:l,sx:{p:d?1:void 0,minWidth:d?0:"6em",display:"flex",gap:d?0:1},onClick:()=>u(me(a,l)),children:s(i,{display:"flex",children:[e("strong",{children:l}),e(V,{}),e(R,{label:n[l],size:"small"})]})},l))})}function Ce(){return{level:a=>a.level*(a.ascension+1),rarity:a=>k.weapon.data[a.key].rarity,name:a=>W.t(`weaponNames_gen:${a.key}`)}}function Te(){return{rarity:(a,n)=>n.includes(k.weapon.data[a.key].rarity),weaponType:(a,n)=>n.includes(k.weapon.data[a.key].weaponType),name:(a,n)=>W.t(`weaponNames_gen:${a.key}`).toLowerCase().includes(n.toLowerCase())}}const We={name:["name"],level:["level","rarity","name"],rarity:["rarity","level","name"]};function Le({weaponId:a,onClick:n,onEdit:u,onDelete:m,canEquip:g=!1,extraButtons:d}){const{t:l}=$(["page_weapon","ui"]),y=F(),r=oe(a),o=r!=null&&r.key?ue(r.key):void 0,L=p.useCallback(t=>t.weaponTypeKey===(o==null?void 0:o.weaponType),[o]),S=p.useCallback(t=>e(se,{onClick:()=>n==null?void 0:n(a),children:t}),[n,a]),z=p.useCallback(t=>e(i,{children:t}),[]),B=p.useCallback(t=>a&&y.weapons.set(a,{location:t}),[y,a]),f=p.useMemo(()=>o&&r&&ee([o.data,ae(r)]),[o,r]);if(!r||!o||!f)return null;const{level:I,ascension:v,refinement:M,id:x,location:b="",lock:w}=r,_=f.get(h.weapon.type).value,A=[h.weapon.main,h.weapon.sub,h.weapon.sub2].map(t=>f.get(t)),j=te(r.key,v>=2);return e(p.Suspense,{fallback:e(O,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:300}}),children:s(P,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[s(X,{condition:!!n,wrapper:S,falseWrapper:z,children:[s(i,{className:`grad-${o.rarity}star`,sx:{position:"relative",pt:2,px:2},children:[!n&&e(G,{color:"primary",onClick:()=>y.weapons.set(x,{lock:!w}),sx:{position:"absolute",right:0,bottom:0,zIndex:2},children:w?e(ie,{}):e(re,{})}),s(i,{sx:{position:"relative",zIndex:1},children:[s(i,{component:"div",sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e(pe,{size:2,src:de.weaponTypes[_]}),e(c,{noWrap:!0,sx:{textAlign:"center",backgroundColor:"rgba(100,100,100,0.35)",borderRadius:"1em",px:1},children:e("strong",{children:o.name})})]}),s(c,{component:"span",variant:"h5",children:["Lv. ",I]}),s(c,{component:"span",variant:"h5",color:"text.secondary",children:["/",K[v]]}),s(c,{variant:"h6",children:["Refinement ",e("strong",{children:M})]}),e(Y,{stars:o.rarity,colored:!0})]}),e(i,{sx:{height:"100%",position:"absolute",right:0,top:0},children:e(i,{component:"img",src:j??"",width:"auto",height:"100%",sx:{float:"right"}})})]}),e(H,{children:A.map(t=>t.info.name?s(i,{sx:{display:"flex"},children:[s(c,{flexGrow:1,children:[t.info.icon," ",t.info.name]}),e(c,{children:ne(t)})]},JSON.stringify(t.info)):null)})]}),s(i,{sx:{p:1,display:"flex",gap:1,justifyContent:"space-between",alignItems:"center"},children:[e(i,{sx:{flexGrow:1},children:g?e(le,{location:b,setLocation:B,filter:L,autoCompleteProps:{getOptionDisabled:t=>!t.key}}):e(Z,{location:b})}),s(i,{display:"flex",gap:1,alignItems:"stretch",height:"100%",sx:{"& .MuiButton-root":{minWidth:0,height:"100%"}},children:[!!u&&e(U,{title:e(c,{children:l`page_weapon:edit`}),placement:"top",arrow:!0,children:e(C,{color:"info",size:"small",onClick:()=>u(x),children:e(ce,{})})}),!!m&&e(C,{color:"error",size:"small",onClick:()=>m(x),disabled:!!b||w,children:e(J,{})}),d]})]})]})})}export{ve as W,Le as a,Te as b,Ce as c,We as w};
