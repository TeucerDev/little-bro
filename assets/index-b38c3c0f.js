import{q as B,s as W,j as H,v as z,r as a,i,G as n,k as t,T as k,w as A,n as w,C as m,D as L,x as O,M as dt,a as F,u as P,y as x,_ as G,z as _t,m as ft,E as ht,B as M,H as It,I as Pt,J as Tt,p as Et,K as pt,N as Mt}from"./index-ae0e5ead.js";import{u as Ft,f as $t,s as jt,P as lt}from"./StarDisplay-3a29ee7b.js";import{d as Rt,a as qt,A as mt,S as Kt,b as Lt,c as Ot,p as Vt,e as zt,f as Ut,g as Bt,h as ct}from"./StatEditorList-5845ef79.js";import{d as Wt,B as Ht}from"./Help-1fa4c6a0.js";import{C as U}from"./CloseButton-5250fd57.js";import{T as Gt,S as K}from"./index-2c4aa6a3.js";import{C as Nt}from"./ColoredText-c98c28ec.js";import{A as Jt}from"./LocationAutocomplete-98591767.js";import"./DropdownButton-02febc47.js";import"./Link-9987d9fe.js";import"./index-d23e7aaf.js";import"./SlotIcon-eec7d7dd.js";import"./InfoTooltip-b155e42f.js";const Qt=r=>r[Math.floor(Math.random()*r.length)];var N={},Xt=W;Object.defineProperty(N,"__esModule",{value:!0});var J=N.default=void 0,Yt=Xt(B()),Zt=H,te=(0,Yt.default)((0,Zt.jsx)("path",{d:"M18 23H4c-1.1 0-2-.9-2-2V7h2v14h14v2zM15 1H8c-1.1 0-1.99.9-1.99 2L6 17c0 1.1.89 2 1.99 2H19c1.1 0 2-.9 2-2V7l-6-6zm1.5 14h-6v-2h6v2zm0-6h-2v2h-2V9h-2V7h2V5h2v2h2v2z"}),"Difference");J=N.default=te;function ee({pageKey:r,text:e="",modalTitle:s="",children:c}){const[u,p,d]=z(localStorage.getItem(`infoShown_${r}`)!=="true"),[f]=a.useState(Array.isArray(e)?Qt(e):e),y=a.useCallback(()=>{d(),localStorage.setItem(`infoShown_${r}`,"true")},[d,r]);return i(w,{children:[i(n,{container:!0,children:[t(n,{item:!0,flexGrow:1,children:t(k,{variant:"caption",pl:1,children:f})}),t(n,{item:!0,xs:"auto",children:t(A,{size:"small",color:"info",variant:"contained",onClick:p,startIcon:t(Wt,{}),children:t(Gt,{ns:"ui",key18:"info"})})})]}),t(dt,{containerProps:{maxWidth:"xl"},open:u,onClose:y,children:i(w,{children:[t(m,{sx:{py:1},children:i(n,{container:!0,children:[t(n,{item:!0,flexGrow:1,children:t(k,{variant:"h6",children:s})}),t(n,{item:!0,children:t(U,{onClick:y})})]})}),t(L,{}),t(m,{children:t(a.Suspense,{fallback:t(O,{variant:"rectangular",width:"100%",height:500}),children:c})}),t(L,{}),t(m,{sx:{py:1},children:t(U,{large:!0,onClick:y})})]})})]})}function yt(){const r=F(),[e,s]=a.useState(r.displayArtifact.get());return a.useEffect(()=>r.displayArtifact.follow((c,u)=>s(u)),[r]),e}var Q={},re=W;Object.defineProperty(Q,"__esModule",{value:!0});var gt=Q.default=void 0,ae=re(B()),ie=H,ne=(0,ae.default)((0,ie.jsx)("path",{d:"M8.65 5.82C9.36 4.72 10.6 4 12 4c2.21 0 4 1.79 4 4 0 1.4-.72 2.64-1.82 3.35L8.65 5.82zM20 17.17c-.02-1.1-.63-2.11-1.61-2.62-.54-.28-1.13-.54-1.77-.76L20 17.17zm1.19 4.02L2.81 2.81 1.39 4.22l8.89 8.89c-1.81.23-3.39.79-4.67 1.45-1 .51-1.61 1.54-1.61 2.66V20h13.17l2.61 2.61 1.41-1.42z"}),"PersonOff");gt=Q.default=ne;var X={},se=W;Object.defineProperty(X,"__esModule",{value:!0});var bt=X.default=void 0,oe=se(B()),le=H,ce=(0,oe.default)((0,le.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");bt=X.default=ce;const ue=a.lazy(()=>G(()=>import("./ArtifactFilterDisplay-e47eee23.js").then(r=>r.b),["./ArtifactFilterDisplay-e47eee23.js","./index-ae0e5ead.js","./index-11aa491f.css","./StatEditorList-5845ef79.js","./Link-9987d9fe.js","./index-2c4aa6a3.js","./ColoredText-c98c28ec.js","./StarDisplay-3a29ee7b.js","./DropdownButton-02febc47.js","./index-d23e7aaf.js","./LocationAutocomplete-98591767.js","./Help-1fa4c6a0.js","./SlotIcon-eec7d7dd.js","./InfoTooltip-b155e42f.js","./totalUtils-0230c8ad.js","./sortByRarityAndName-c5d0cb85.js"],import.meta.url));function de({numShowing:r,total:e,artifactIds:s}){const{t:c}=P(["artifact","ui"]),u=F(),{filterOption:p}=yt(),d=a.useCallback(f=>u.displayArtifact.set({filterOption:{...p,...f}}),[u,p]);return t(a.Suspense,{fallback:t(O,{variant:"rectangular",width:"100%",height:300}),children:t(w,{children:i(m,{children:[i(n,{container:!0,children:[t(n,{item:!0,children:t(k,{variant:"h6",children:t(x,{t:c,i18nKey:"artifactFilter",children:"Artifact Filter"})})}),t(n,{item:!0,flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center",children:r!==e&&i(k,{children:["Filtered ",t("strong",{children:r})," / ",e]})}),t(n,{item:!0,children:t(A,{size:"small",color:"error",onClick:()=>u.displayArtifact.set({action:"reset"}),startIcon:t(bt,{}),children:t(x,{t:c,i18nKey:"ui:reset"})})})]}),t(a.Suspense,{fallback:t(O,{variant:"rectangular",width:"100%",height:200}),children:t(ue,{filterOption:p,filterOptionDispatch:d,filteredIds:s})})]})})})}function fe({artifactIds:r}){const{t:e}=P(["artifact","ui"]),s=F(),{numDelete:c,numUnequip:u,numUnlock:p,numLock:d}=a.useMemo(()=>{const l=r.map(b=>s.arts.get(b)),h=l.reduce((b,I)=>b+(I.lock?0:1),0),C=l.length-h,_=h,D=l.reduce((b,I)=>b+(I.location?1:0),0);return{numDelete:_,numUnequip:D,numUnlock:h,numLock:C}},[r,s]);return i(n,{container:!0,spacing:1,alignItems:"center",children:[t(n,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!u,onClick:()=>window.confirm(`Are you sure you want to unequip ${u} artifacts currently equipped on characters?`)&&r.map(l=>s.arts.set(l,{location:""})),startIcon:t(gt,{}),children:[t(x,{t:e,i18nKey:"button.unequipArtifacts",children:"Unequip Artifacts"}),t(K,{sx:{ml:1},color:u?"success":"secondary",children:u})]})}),t(n,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!c,onClick:()=>window.confirm(`Are you sure you want to delete ${c} artifacts?`)&&r.map(l=>{var h;return!((h=s.arts.get(l))!=null&&h.lock)&&s.arts.remove(l)}),startIcon:t(_t,{}),children:[t(x,{t:e,i18nKey:"button.deleteArtifacts",children:"Delete Artifacts"}),t(K,{sx:{ml:1},color:c?"success":"secondary",children:c})]})}),t(n,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!d,onClick:()=>window.confirm(`Are you sure you want to unlock ${d} artifacts?`)&&r.map(l=>s.arts.set(l,{lock:!1})),startIcon:t(Rt,{}),children:[t(x,{t:e,i18nKey:"button.unlockrtifacts",children:"Unlock Artifacts"}),t(K,{sx:{ml:1},color:d?"success":"secondary",children:d})]})}),t(n,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!p,onClick:()=>window.confirm(`Are you sure you want to lock ${p} artifacts?`)&&r.map(l=>s.arts.set(l,{lock:!0})),startIcon:t(qt,{}),children:[t(x,{t:e,i18nKey:"button.lockArtifacts",children:"Lock Artifacts"}),t(K,{sx:{ml:1},color:p?"success":"secondary",children:p})]})}),t(n,{item:!0,xs:12,display:"flex",justifyContent:"space-around",children:t(k,{variant:"caption",color:"text.secondary",children:i(x,{t:e,i18nKey:"buttonHint",children:["Note: the red buttons above only apply to",t("b",{children:"currently filtered artifacts"})]})})})]})}function he({show:r,onHide:e}){const{t:s}=P("artifact");return t(dt,{open:r,onClose:e,children:i(ft,{children:[i(m,{sx:{display:"flex",alignItems:"center"},children:[i(k,{variant:"h6",flexGrow:1,children:[t(J,{sx:{verticalAlign:"text-top",mr:1}}),s`showDup`]}),t(U,{onClick:e})]}),t(L,{}),t(m,{children:t(pe,{})})]})})}function pe(){const{t:r}=P("artifact"),e=F(),[s,c]=ht();a.useEffect(()=>e.arts.followAny(c),[c,e]);const u=a.useMemo(()=>{const d=s&&[];let f=e.arts.keys;for(;f.length!==0;){const y=f.shift();if(!y)continue;const T=e.arts.get(y);if(!T)continue;const{duplicated:g}=e.arts.findDups(T,f);if(!g.length)continue;const l=g.map(h=>h.id);d.push([y,...l].sort(h=>{var C;return((C=e.arts.get(h))==null?void 0:C.location)??""?-1:1})),f=f.filter(h=>!l.includes(h))}return d},[e,s]),p=a.useMemo(()=>({}),[]);return i(Pt,{spacing:2,children:[u.map(d=>t(w,{sx:{overflowX:"scroll"},children:t(m,{sx:{display:"flex",gap:1},children:d.map(f=>t(M,{sx:{minWidth:300},children:t(mt,{artifactId:f,canEquip:!0,onDelete:()=>e.arts.remove(f),editorProps:p})},f))})},d.join())),!u.length&&t(It,{variant:"filled",severity:"success",children:r`noDupAlert`})]})}const me=[...Tt];function ye({probabilityFilter:r={},setProbabilityFilter:e,disabled:s=!1}){const{t:c}=P("artifact");return i(w,{children:[t(m,{sx:{py:1},children:t(k,{variant:"h6",children:"Roll Probability Calculator"})}),t(L,{}),t(m,{children:i(n,{container:!0,spacing:1,children:[t(n,{item:!0,xs:12,md:6,children:t(ft,{children:t(m,{children:i(k,{children:['This UI only pops up when "Sort by"',t("strong",{children:"Probability"}),". In conjunction with the Artifact Filters above, this UI allows you to set a criteria for substats values, and it will sort the artifacts by those with the highest probability to roll into those criteria values.",i(Nt,{color:"warning",children:[" ","Artifacts that already reach the criteria(100%) or are at 0% are hidden."]})]})})})}),t(n,{item:!0,xs:12,md:6,spacing:1,sx:{display:"flex",flexDirection:"column",gap:1},children:t(Kt,{statKeys:me,statFilters:r,setStatFilters:e,disabled:s,label:c("probabilityFilter.label")})})]})})]})}const ge=pt.lazy(()=>G(()=>import("./ArtifactEditor-17decb46.js"),["./ArtifactEditor-17decb46.js","./index-ae0e5ead.js","./index-11aa491f.css","./index-2c4aa6a3.js","./ColoredText-c98c28ec.js","./Help-1fa4c6a0.js","./StatEditorList-5845ef79.js","./Link-9987d9fe.js","./StarDisplay-3a29ee7b.js","./DropdownButton-02febc47.js","./index-d23e7aaf.js","./LocationAutocomplete-98591767.js","./SlotIcon-eec7d7dd.js","./InfoTooltip-b155e42f.js","./ArtifactRarityDropdown-eb66d942.js","./sortByRarityAndName-c5d0cb85.js","./CloseButton-5250fd57.js","./TextButton-0795b148.js","./CardHeader-17934b00.js"],import.meta.url)),be=pt.lazy(()=>G(()=>import("./index-f4919d43.js"),["./index-f4919d43.js","./index-ae0e5ead.js","./index-11aa491f.css","./Settings-bab341d8.js","./StarDisplay-3a29ee7b.js","./DropdownButton-02febc47.js","./ColoredText-c98c28ec.js","./index-2c4aa6a3.js","./ImgFullwidth-8d8ffb8f.js","./StatEditorList-5845ef79.js","./Link-9987d9fe.js","./index-d23e7aaf.js","./LocationAutocomplete-98591767.js","./Help-1fa4c6a0.js","./SlotIcon-eec7d7dd.js","./InfoTooltip-b155e42f.js"],import.meta.url)),ut={xs:1,sm:2,md:3,lg:3,xl:4},ve={xs:10,sm:12,md:24,lg:24,xl:24};function $e(){const{t:r}=P(["artifact","ui"]),e=F(),s=yt(),[c,u,p]=z(!1),[d,f,y]=z(!1),T=Ft(),g=ve[T],{sortType:l,effFilter:h,ascending:C,probabilityFilter:_}=s,D=l==="probability",[b,I]=a.useState(0),V=a.useRef(null),[vt,Y]=ht(),Z=a.useDeferredValue(vt),E=a.useMemo(()=>new Set(h),[h]),xt=a.useCallback(o=>e.arts.remove(o),[e]);a.useEffect(()=>(Et.send({hitType:"pageview",page:"/artifact"}),e.arts.followAny(()=>Y())),[e,Y]);const At=a.useCallback(o=>e.displayArtifact.set({probabilityFilter:o}),[e]),wt=a.useMemo(()=>!e.arts.values.length,[e]),tt=a.useMemo(()=>Lt(E,_),[E,_]),et=a.useMemo(()=>Ot(E),[E]),rt=a.useDeferredValue(s),at=a.useDeferredValue(_);a.useEffect(()=>{if(D)return e.arts.values.forEach(o=>e.arts.setProbability(o.id,Vt(o,at))),()=>e.arts.values.forEach(o=>e.arts.setProbability(o.id,-1))},[e,D,at]);const{artifactIds:v,totalArtNum:$}=a.useMemo(()=>{const{sortType:o=ct[0],ascending:S=!1,filterOption:j}=rt;let R=e.arts.values;return D&&(R=R.filter(q=>q.probability&&q.probability!==1)),{artifactIds:R.filter($t(j,et)).sort(jt(zt[o]??[],S,tt)).map(q=>q.id),totalArtNum:R.length,...Z}},[rt,Z,e,tt,et,D]),{artifactIdsToShow:it,numPages:nt,currentPageIndex:kt}=a.useMemo(()=>{const o=Math.ceil(v.length/g),S=Mt(b,0,o-1);return{artifactIdsToShow:v.slice(S*g,(S+1)*g),numPages:o,currentPageIndex:S}},[v,b,g]),Dt=v.length!==$?`${v.length}/${$}`:`${$}`,St=a.useCallback((o,S)=>{var j;(j=V.current)==null||j.scrollIntoView({behavior:"smooth"}),I(S-1)},[I,V]),st={count:nt,page:kt+1,onChange:St},ot={numShowing:it.length,total:Dt,t:r,namespace:"artifact"},Ct={sortKeys:[...ct],value:l,onChange:o=>e.displayArtifact.set({sortType:o}),ascending:C,onChangeAsc:o=>e.displayArtifact.set({ascending:o})};return i(M,{display:"flex",flexDirection:"column",gap:1,my:1,children:[t(a.Suspense,{fallback:!1,children:t(ge,{artifactIdToEdit:c?"new":"",cancelEdit:p,allowUpload:!0,allowEmpty:!0})}),t(a.Suspense,{fallback:!1,children:t(he,{show:d,onHide:y})}),t(ee,{pageKey:"artifactPage",modalTitle:r`info.title`,text:r("tipsOfTheDay",{returnObjects:!0}),children:t(be,{})}),wt&&t(Ut,{}),t(de,{numShowing:v.length,total:$,artifactIds:v}),t(w,{ref:V,children:t(m,{children:t(Ht,{placement:"top",title:t(x,{t:r,i18nKey:"efficiencyFilter.title",children:"Substats to use in efficiency calculation"}),children:t(M,{children:t(Bt,{selectedKeys:h,onChange:o=>e.displayArtifact.set({effFilter:o})})})})})}),t(w,{children:i(m,{children:[t(M,{pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:t(lt,{paginationProps:st,showingTextProps:ot,displaySort:!0,sortByButtonProps:Ct})}),t(fe,{artifactIds:v})]})}),D&&t(ye,{probabilityFilter:_,setProbabilityFilter:At}),i(n,{container:!0,columns:ut,spacing:1,children:[t(n,{item:!0,xs:!0,children:t(A,{fullWidth:!0,onClick:u,color:"info",startIcon:t(Jt,{}),children:r`addNew`})}),t(n,{item:!0,xs:1,children:t(A,{fullWidth:!0,onClick:f,color:"info",startIcon:t(J,{}),children:r`showDup`})})]}),t(a.Suspense,{fallback:t(O,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:t(n,{container:!0,spacing:1,columns:ut,children:it.map(o=>t(n,{item:!0,xs:1,children:t(mt,{artifactId:o,effFilter:E,onDelete:xt,editorProps:{},canEquip:!0})},o))})}),nt>1&&t(w,{children:t(m,{children:t(M,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:t(lt,{paginationProps:st,showingTextProps:ot})})})})]})}export{$e as default};
